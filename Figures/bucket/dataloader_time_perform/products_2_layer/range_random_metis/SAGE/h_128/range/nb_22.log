main start at this time 1713204742.708747
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.031343936920166016
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009427785873413086
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.032889366149902344
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.8970861434936523
self.buckets_partition() spend  sec:  0.042351484298706055
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.84521484375 GB
    Memory Allocated: 0.31722593307495117  GigaBytes
Max Memory Allocated: 0.31722593307495117  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.37841796875 GB
    Memory Allocated: 12.455514430999756  GigaBytes
Max Memory Allocated: 12.66012191772461  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.37841796875 GB
    Memory Allocated: 12.45730447769165  GigaBytes
Max Memory Allocated: 12.66012191772461  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.38623046875 GB
    Memory Allocated: 0.3425130844116211  GigaBytes
Max Memory Allocated: 12.66012191772461  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.74755859375 GB
    Memory Allocated: 12.522303581237793  GigaBytes
Max Memory Allocated: 12.729223251342773  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.74755859375 GB
    Memory Allocated: 12.523890495300293  GigaBytes
Max Memory Allocated: 12.729223251342773  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.74755859375 GB
    Memory Allocated: 0.3487253189086914  GigaBytes
Max Memory Allocated: 12.729223251342773  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 12.546523571014404  GigaBytes
Max Memory Allocated: 12.753952980041504  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 12.548388481140137  GigaBytes
Max Memory Allocated: 12.753952980041504  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.35452699661254883  GigaBytes
Max Memory Allocated: 12.753952980041504  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.04833984375 GB
    Memory Allocated: 12.493296146392822  GigaBytes
Max Memory Allocated: 12.753952980041504  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.04833984375 GB
    Memory Allocated: 12.495041847229004  GigaBytes
Max Memory Allocated: 12.753952980041504  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.04833984375 GB
    Memory Allocated: 0.3614931106567383  GigaBytes
Max Memory Allocated: 12.753952980041504  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.04833984375 GB
    Memory Allocated: 12.5840744972229  GigaBytes
Max Memory Allocated: 12.79113483428955  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.04833984375 GB
    Memory Allocated: 12.585719108581543  GigaBytes
Max Memory Allocated: 12.79113483428955  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.04833984375 GB
    Memory Allocated: 0.36596250534057617  GigaBytes
Max Memory Allocated: 12.79113483428955  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.04833984375 GB
    Memory Allocated: 12.55717134475708  GigaBytes
Max Memory Allocated: 12.79113483428955  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.04833984375 GB
    Memory Allocated: 12.55875301361084  GigaBytes
Max Memory Allocated: 12.79113483428955  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.04833984375 GB
    Memory Allocated: 0.3712120056152344  GigaBytes
Max Memory Allocated: 12.79113483428955  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.05615234375 GB
    Memory Allocated: 12.55425500869751  GigaBytes
Max Memory Allocated: 12.79113483428955  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.05615234375 GB
    Memory Allocated: 12.55583667755127  GigaBytes
Max Memory Allocated: 12.79113483428955  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.05615234375 GB
    Memory Allocated: 0.37508106231689453  GigaBytes
Max Memory Allocated: 12.79113483428955  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.06787109375 GB
    Memory Allocated: 12.516571998596191  GigaBytes
Max Memory Allocated: 12.79113483428955  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.06787109375 GB
    Memory Allocated: 12.518239498138428  GigaBytes
Max Memory Allocated: 12.79113483428955  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.06787109375 GB
    Memory Allocated: 0.3826146125793457  GigaBytes
Max Memory Allocated: 12.79113483428955  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07177734375 GB
    Memory Allocated: 12.56715440750122  GigaBytes
Max Memory Allocated: 12.79113483428955  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.07177734375 GB
    Memory Allocated: 12.568750381469727  GigaBytes
Max Memory Allocated: 12.79113483428955  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07177734375 GB
    Memory Allocated: 0.38936281204223633  GigaBytes
Max Memory Allocated: 12.79113483428955  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07763671875 GB
    Memory Allocated: 12.588551044464111  GigaBytes
Max Memory Allocated: 12.795293807983398  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.07763671875 GB
    Memory Allocated: 12.590213298797607  GigaBytes
Max Memory Allocated: 12.795293807983398  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07763671875 GB
    Memory Allocated: 0.3920722007751465  GigaBytes
Max Memory Allocated: 12.795293807983398  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.08154296875 GB
    Memory Allocated: 12.532694816589355  GigaBytes
Max Memory Allocated: 12.795293807983398  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.08154296875 GB
    Memory Allocated: 12.53435468673706  GigaBytes
Max Memory Allocated: 12.795293807983398  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.08154296875 GB
    Memory Allocated: 0.3983588218688965  GigaBytes
Max Memory Allocated: 12.795293807983398  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 12.513474464416504  GigaBytes
Max Memory Allocated: 12.795293807983398  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 12.515093803405762  GigaBytes
Max Memory Allocated: 12.795293807983398  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.40462636947631836  GigaBytes
Max Memory Allocated: 12.795293807983398  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 12.59372329711914  GigaBytes
Max Memory Allocated: 12.79954719543457  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 12.595324039459229  GigaBytes
Max Memory Allocated: 12.79954719543457  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.411043643951416  GigaBytes
Max Memory Allocated: 12.79954719543457  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 12.595713138580322  GigaBytes
Max Memory Allocated: 12.802908897399902  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 12.597338676452637  GigaBytes
Max Memory Allocated: 12.802908897399902  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.4154524803161621  GigaBytes
Max Memory Allocated: 12.802908897399902  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.10693359375 GB
    Memory Allocated: 12.53648853302002  GigaBytes
Max Memory Allocated: 12.802908897399902  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.10693359375 GB
    Memory Allocated: 12.538114070892334  GigaBytes
Max Memory Allocated: 12.802908897399902  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.10693359375 GB
    Memory Allocated: 0.42029619216918945  GigaBytes
Max Memory Allocated: 12.802908897399902  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.10693359375 GB
    Memory Allocated: 12.609307765960693  GigaBytes
Max Memory Allocated: 12.816169261932373  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.10693359375 GB
    Memory Allocated: 12.61094856262207  GigaBytes
Max Memory Allocated: 12.816169261932373  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.10693359375 GB
    Memory Allocated: 0.4271235466003418  GigaBytes
Max Memory Allocated: 12.816169261932373  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.11669921875 GB
    Memory Allocated: 12.598033428192139  GigaBytes
Max Memory Allocated: 12.816169261932373  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.11669921875 GB
    Memory Allocated: 12.599626541137695  GigaBytes
Max Memory Allocated: 12.816169261932373  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.11669921875 GB
    Memory Allocated: 0.4327225685119629  GigaBytes
Max Memory Allocated: 12.816169261932373  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.11865234375 GB
    Memory Allocated: 12.614652156829834  GigaBytes
Max Memory Allocated: 12.821547031402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.11865234375 GB
    Memory Allocated: 12.616294860839844  GigaBytes
Max Memory Allocated: 12.821547031402588  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.11865234375 GB
    Memory Allocated: 0.4377303123474121  GigaBytes
Max Memory Allocated: 12.821547031402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 12.614354610443115  GigaBytes
Max Memory Allocated: 12.821547031402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 12.615997314453125  GigaBytes
Max Memory Allocated: 12.821547031402588  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.4445047378540039  GigaBytes
Max Memory Allocated: 12.821547031402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.13232421875 GB
    Memory Allocated: 12.633718967437744  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.13232421875 GB
    Memory Allocated: 12.63534164428711  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.13232421875 GB
    Memory Allocated: 0.44713830947875977  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.13818359375 GB
    Memory Allocated: 12.54427194595337  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.13818359375 GB
    Memory Allocated: 12.545844078063965  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.13818359375 GB
    Memory Allocated: 0.4536008834838867  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.530614376068115  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.532251358032227  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

number of input  17871685
----------------------------------------after optimizer
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4727334976196289  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.2038044929504395
pure train time :  7.115558624267578
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.03345632553100586
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012418270111083984
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0350193977355957
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.023479461669922
self.buckets_partition() spend  sec:  0.047472238540649414
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3440885543823242  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.527947902679443  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.524062633514404  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.34678125381469727  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.54090929031372  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.542550086975098  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3515324592590332  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.543503761291504  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.545186519622803  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3564438819885254  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.54124641418457  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.542863845825195  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3624739646911621  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.558032035827637  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.559628963470459  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3675351142883301  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.560404300689697  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.561991691589355  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3718380928039551  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.566375255584717  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.567962646484375  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.37763547897338867  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.497992515563965  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.499623775482178  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3839683532714844  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.563618183135986  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.565226078033447  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3894519805908203  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.53062629699707  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.532217502593994  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3941974639892578  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.570405960083008  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.572028160095215  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.399381160736084  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.54270315170288  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.544325351715088  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.40443992614746094  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.518745422363281  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.520327091217041  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4119744300842285  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.59386396408081  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.595520496368408  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.41799497604370117  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.61158561706543  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.613270282745361  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.42296409606933594  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.604965686798096  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.606637001037598  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4260067939758301  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.554293155670166  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.555893898010254  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.43413496017456055  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.610368728637695  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.611961364746094  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4397130012512207  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.628664016723633  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.630268573760986  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.44510507583618164  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.577781200408936  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.579511642456055  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.45084285736083984  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.624861240386963  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.626471996307373  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4542512893676758  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.53699016571045  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.53860092163086  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

number of input  17857963
----------------------------------------after optimizer
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4717435836791992  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.4718177318573
pure train time :  4.4960150718688965
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.03824019432067871
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015504837036132812
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04015517234802246
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.9677248001098633
self.buckets_partition() spend  sec:  0.05572962760925293
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3437318801879883  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.526948928833008  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.523053646087646  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.34326648712158203  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.468591690063477  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.470225811004639  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.35077667236328125  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.547995567321777  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.549572944641113  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.35611534118652344  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.53852653503418  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.540103912353516  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.36214399337768555  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.496690273284912  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.498283863067627  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.36737823486328125  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.512110710144043  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.513766765594482  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.37237024307250977  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.551031112670898  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.552612781524658  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3785724639892578  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.554943084716797  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.556600570678711  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3835334777832031  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.56038236618042  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.562030792236328  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3900914192199707  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.584009647369385  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.585625648498535  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.39458751678466797  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.52008581161499  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.521690368652344  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.40062522888183594  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.582269668579102  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.583874225616455  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4054079055786133  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.535572528839111  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.537262916564941  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.41037607192993164  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.512262344360352  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.51388692855835  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.41892194747924805  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.597514152526855  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.599277019500732  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.42319583892822266  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.610676765441895  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.612258911132812  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.42836904525756836  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.607383251190186  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.608965396881104  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.43314170837402344  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.613998889923096  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.615656852722168  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.44034719467163086  GigaBytes
Max Memory Allocated: 12.8406343460083  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.65580940246582  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.657410144805908  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4442143440246582  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.631796836853027  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.63336992263794  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4506239891052246  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.59559965133667  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.597190856933594  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.45450782775878906  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.574985980987549  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.57657241821289  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

number of input  17854528
----------------------------------------after optimizer
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.47184276580810547  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7300050258636475
pure train time :  4.428329229354858
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.03709101676940918
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012709617614746094
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03875923156738281
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.936403751373291
self.buckets_partition() spend  sec:  0.05153179168701172
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3453183174133301  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.530802726745605  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.526840686798096  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.34502553939819336  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.530363082885742  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.532055377960205  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.35032129287719727  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.539190769195557  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.54085636138916  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.35616016387939453  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.485671997070312  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.487337589263916  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3608250617980957  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.497012615203857  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.49867057800293  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.36754941940307617  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.569995403289795  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.571590423583984  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.37192201614379883  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.549099922180176  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.550694942474365  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.37894201278686523  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.57422399520874  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.575834274291992  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3831038475036621  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.563968658447266  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.565545558929443  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.38951635360717773  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.57506513595581  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.57663631439209  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.39618873596191406  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.596997261047363  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.598657131195068  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3989591598510742  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.546896934509277  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.548556804656982  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.40683650970458984  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.591956615447998  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.593576431274414  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4104475975036621  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.539544105529785  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.541163921356201  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.417264461517334  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.545003890991211  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.546682834625244  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4239168167114258  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.626648426055908  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.628291130065918  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.42723560333251953  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.609439373016357  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.611082077026367  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.43402099609375  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.613193988800049  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.614830493927002  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4403419494628906  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.64160442352295  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.64328145980835  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4450817108154297  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.559473514556885  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.561081409454346  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.45104217529296875  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.59400463104248  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.595669746398926  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4547109603881836  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.556192874908447  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.557923793792725  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

number of input  17864543
----------------------------------------after optimizer
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4721407890319824  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.229069232940674
pure train time :  4.559892654418945
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.03810739517211914
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01630401611328125
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03970932960510254
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.329796314239502
self.buckets_partition() spend  sec:  0.05605626106262207
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.34459352493286133  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.530474662780762  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.526641368865967  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.34368371963500977  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.51689338684082  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.5185546875  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.35037994384765625  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.537025451660156  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.538609504699707  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3566708564758301  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.539326190948486  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.540993690490723  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3617072105407715  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.543546676635742  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.545142650604248  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3673286437988281  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.546215534210205  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.547883033752441  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.37361669540405273  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.563833236694336  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.56545114517212  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3772125244140625  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.492310523986816  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.4939284324646  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3823060989379883  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.48466682434082  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.486245155334473  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3905019760131836  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.581049919128418  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.582665920257568  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3937873840332031  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.51437520980835  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.5159912109375  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4000530242919922  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.502306938171387  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.503886222839355  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4051837921142578  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.53442907333374  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.53609848022461  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.41109418869018555  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.557013511657715  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.558682918548584  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4173126220703125  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.563525199890137  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.565178394317627  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4218282699584961  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.556552410125732  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.558202743530273  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4295539855957031  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.619222164154053  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.62079668045044  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4329390525817871  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.580694198608398  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.582361698150635  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.43933773040771484  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.592303276062012  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.593953609466553  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.44587182998657227  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.647228240966797  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.648808002471924  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.45098114013671875  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.642111778259277  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.643691539764404  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.45623207092285156  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.593195915222168  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.594829082489014  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

number of input  17859916
----------------------------------------after optimizer
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4735846519470215  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.77596116065979
pure train time :  4.696869611740112
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.04180335998535156
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015414953231811523
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.043424367904663086
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.41138219833374
self.buckets_partition() spend  sec:  0.058878183364868164
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.34166479110717773  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.415719985961914  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.41193675994873  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3450193405151367  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.525758266448975  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.527411937713623  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3508763313293457  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.532863140106201  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.53451681137085  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3560190200805664  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.470407485961914  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.471976280212402  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3616795539855957  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.561485290527344  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.563084125518799  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.36684370040893555  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.514247417449951  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.515846252441406  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.37282657623291016  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.521982192993164  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.523657321929932  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3793644905090332  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.585781574249268  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.587456703186035  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.38399171829223633  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.524927616119385  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.526581764221191  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3895845413208008  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.586105346679688  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.587759494781494  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.39461660385131836  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.578408241271973  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.580033779144287  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4006767272949219  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.58384370803833  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.585469245910645  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.40700817108154297  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.60112714767456  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.602773666381836  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.40982627868652344  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.537654876708984  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.539291381835938  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4172830581665039  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.606522560119629  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.608243465423584  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4238448143005371  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.611363887786865  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.613040924072266  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4285287857055664  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.625589370727539  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.627207279205322  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4340171813964844  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.57931661605835  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.580934524536133  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4394979476928711  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.61696195602417  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.618536472320557  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.44519996643066406  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.619991779327393  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.621663093566895  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4488682746887207  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.565044403076172  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.56664514541626  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.45732736587524414  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.6520414352417  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.653687953948975  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

number of input  17861389
----------------------------------------after optimizer
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.47464895248413086  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5456578731536865
pure train time :  4.698470115661621
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.036713361740112305
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012504100799560547
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03832077980041504
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.0126237869262695
self.buckets_partition() spend  sec:  0.050870418548583984
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.34224557876586914  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.456825256347656  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.452836036682129  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3454437255859375  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.487173080444336  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.488831043243408  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3516411781311035  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.550742626190186  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.552326679229736  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.35699892044067383  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.550704956054688  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.55234956741333  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.36272573471069336  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.548248767852783  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.549816131591797  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3677186965942383  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.545167922973633  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.54675006866455  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.37404727935791016  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.56191110610962  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.563493251800537  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3783559799194336  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.564306259155273  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.56592607498169  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.38316774368286133  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.498048782348633  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.499668598175049  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3900775909423828  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.571961402893066  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.573616981506348  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.3950467109680176  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.54150676727295  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.54317045211792  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.40076255798339844  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.59235668182373  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.594020366668701  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4061555862426758  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.585659503936768  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.587285041809082  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.40944433212280273  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.52940320968628  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.531028747558594  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4172506332397461  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.602753162384033  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.604422569274902  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.42264413833618164  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.606778144836426  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.608412265777588  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.4284377098083496  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.608792781829834  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 12.610426902770996  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.14794921875 GB
    Memory Allocated: 0.43517637252807617  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.654959201812744  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.65660572052002  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.4380192756652832  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.563956260681152  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.565602779388428  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.4453868865966797  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.630587100982666  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.632220268249512  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.4509396553039551  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.636926174163818  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.638526916503906  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.45618486404418945  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.577999591827393  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.57960033416748  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

number of input  17870871
----------------------------------------after optimizer
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.47352075576782227  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3929438591003418
pure train time :  4.62819504737854
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.04064369201660156
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012539386749267578
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04224848747253418
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.570591688156128
self.buckets_partition() spend  sec:  0.05482673645019531
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.3435206413269043  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.525147438049316  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.5211763381958  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.34544801712036133  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.528296947479248  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.529865741729736  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.351806640625  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.538732051849365  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.540342330932617  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.35451650619506836  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.480293273925781  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.481860637664795  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.36219024658203125  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.555271625518799  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.556872367858887  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.36725664138793945  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.54916000366211  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.550760746002197  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.37365293502807617  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.564417839050293  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.566098690032959  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.3770480155944824  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.522810459136963  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.5244722366333  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.38327836990356445  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.572807312011719  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.574396133422852  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.3897075653076172  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.568145751953125  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.569779872894287  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.39569807052612305  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.57609510421753  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.57769250869751  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.4006648063659668  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.55469799041748  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.556295394897461  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.40613603591918945  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.538020133972168  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.539592266082764  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.410646915435791  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.585840225219727  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.58745813369751  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.41732215881347656  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.598016262054443  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.599634170532227  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.42221975326538086  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.60000467300415  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.601593494415283  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.42841577529907227  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.613122940063477  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.61471176147461  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.43386077880859375  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.586400032043457  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.58798885345459  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.43840789794921875  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.548195362091064  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.549901008605957  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.4453134536743164  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.626140117645264  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.627870559692383  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.45082521438598633  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.63508939743042  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.63675308227539  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.4568057060241699  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.645033359527588  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.646611213684082  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

number of input  17866559
----------------------------------------after optimizer
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.47409486770629883  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2734341621398926
pure train time :  4.629648447036743
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.041269779205322266
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014904260635375977
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.042928457260131836
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.010702133178711
self.buckets_partition() spend  sec:  0.05788445472717285
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.3441767692565918  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.493048191070557  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.489059448242188  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.34503650665283203  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.514721870422363  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.516358375549316  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.34938859939575195  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.492653846740723  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.494283199310303  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.3561553955078125  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.535108089447021  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.536737442016602  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.3613605499267578  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.509063243865967  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.51072883605957  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.3679189682006836  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.549866676330566  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.551525115966797  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.3725876808166504  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.578502655029297  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.58015489578247  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.38022470474243164  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.58245849609375  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.584052085876465  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.3823966979980469  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.484329223632812  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.486103534698486  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.3896026611328125  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.569056034088135  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.570723056793213  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.39520788192749023  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.573205471038818  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.574872493743896  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.40065860748291016  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.581735610961914  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.58336877822876  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.4045882225036621  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.550426483154297  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.552059650421143  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.41178321838378906  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.604146003723145  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.60572862625122  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.41881418228149414  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.607338428497314  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.609000205993652  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.42286062240600586  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.613702774047852  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.615291595458984  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.4290194511413574  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.60989236831665  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.611554622650146  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.4327688217163086  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.553520679473877  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.55515193939209  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.43900060653686523  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.617943286895752  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.619599342346191  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.44504594802856445  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.570261001586914  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.571842670440674  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.45137500762939453  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.634493827819824  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.636091709136963  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.4561738967895508  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.624744892120361  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.626312255859375  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

number of input  17866462
----------------------------------------after optimizer
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.4736614227294922  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1737924814224243
pure train time :  4.843962907791138
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.041445016860961914
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011718511581420898
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04325985908508301
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.386783599853516
self.buckets_partition() spend  sec:  0.05501723289489746
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.34286069869995117  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.452131748199463  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.448261737823486  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.3453044891357422  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.52225637435913  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.52384901046753  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.3492875099182129  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.476414680480957  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.478007316589355  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.3549838066101074  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.531044960021973  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.53271484375  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.36173295974731445  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.541749954223633  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.54341983795166  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.36669921875  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.510161876678467  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.511796951293945  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.3728466033935547  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.56100082397461  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 12.562577247619629  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.83154296875 GB
    Memory Allocated: 0.38082313537597656  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.645666599273682  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.647313117980957  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3846421241760254  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.568595886230469  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.570240497589111  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.38957929611206055  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.577103614807129  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.578748226165771  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.39499950408935547  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.567233085632324  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.568824291229248  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.40065574645996094  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.58517837524414  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.586756706237793  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4062328338623047  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.544921875  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.546500205993652  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4122452735900879  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.596620082855225  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.598224639892578  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.416107177734375  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.538116931915283  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.539721488952637  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4228196144104004  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.604330062866211  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.605944156646729  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4300246238708496  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.646234512329102  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.64784860610962  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.43264293670654297  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.553249835968018  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.554940223693848  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.43825340270996094  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.563693046569824  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.565278053283691  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4444851875305176  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.626315116882324  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.627978801727295  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.45066070556640625  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.636543273925781  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.638147830963135  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4560432434082031  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.577400207519531  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.579004764556885  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

number of input  17865367
----------------------------------------after optimizer
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4734649658203125  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0804946422576904
pure train time :  4.562838315963745
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.038573503494262695
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011798381805419922
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04015016555786133
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.332739353179932
self.buckets_partition() spend  sec:  0.05198335647583008
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3441162109375  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.488020420074463  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.48415994644165  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.34354448318481445  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.463140487670898  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.464773178100586  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3490591049194336  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.47948932647705  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.481060981750488  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.35549449920654297  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.53633737564087  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.537988185882568  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.36200952529907227  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.541790008544922  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.543421268463135  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3673887252807617  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.544899940490723  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.546531200408936  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3733549118041992  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.562801837921143  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.56445026397705  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.37841796875  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.557446956634521  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.559025287628174  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.38314056396484375  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.565570831298828  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.56714916229248  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.38990163803100586  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.534261226654053  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.535847663879395  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3942394256591797  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.547133922576904  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.54881477355957  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.40061283111572266  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.58447551727295  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.586088180541992  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.40588855743408203  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.573212146759033  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.574854373931885  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4123249053955078  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.544214725494385  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.5458345413208  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.41936588287353516  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.639172077178955  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.640751838684082  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4228086471557617  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.600130081176758  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.601709842681885  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4286942481994629  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.608906269073486  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.610475540161133  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.43391847610473633  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.612977504730225  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.614546775817871  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4392242431640625  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.582957744598389  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.584613800048828  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4454965591430664  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.642815113067627  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.644389152526855  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4508671760559082  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.642643928527832  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.64421796798706  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.45510196685791016  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.571088790893555  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.572679996490479  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

number of input  17865936
----------------------------------------after optimizer
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.47247314453125  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9996756315231323
pure train time :  4.633235454559326
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.04479646682739258
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01071929931640625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.046534061431884766
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.111845254898071
self.buckets_partition() spend  sec:  0.057290077209472656
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3443336486816406  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.525364398956299  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.52143669128418  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.34505176544189453  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.52699613571167  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.528667449951172  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.34963512420654297  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.479772567749023  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.481422901153564  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.35645151138305664  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.537518501281738  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.539142608642578  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.36174440383911133  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.543739318847656  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.545352935791016  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.36740636825561523  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.554437637329102  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.556055545806885  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3728365898132324  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.557557106018066  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.55917501449585  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3777031898498535  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.522611618041992  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.524181365966797  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3841133117675781  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.566215991973877  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.567863464355469  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3894772529602051  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.534477710723877  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.536061763763428  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.39518070220947266  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.581805229187012  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.583476543426514  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.40060901641845703  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.572698593139648  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.574299335479736  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.40842342376708984  GigaBytes
Max Memory Allocated: 12.86262321472168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.672900199890137  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.674514293670654  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4105086326599121  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.531388282775879  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.533002376556396  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4169740676879883  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.549230575561523  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.550915241241455  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.42297887802124023  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.612353324890137  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.613996028900146  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.42693042755126953  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.554050922393799  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.555693626403809  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4340200424194336  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.564301013946533  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.566010475158691  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.44135046005249023  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.632261276245117  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.63394021987915  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.44507884979248047  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.58288049697876  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.584490776062012  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.45122671127319336  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.637650966644287  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.639299392700195  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4567375183105469  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.637250900268555  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.63882303237915  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

number of input  17870663
----------------------------------------after optimizer
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.47414398193359375  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9567263126373291
pure train time :  4.576150894165039
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.038855791091918945
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011939048767089844
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04048013687133789
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.625262022018433
self.buckets_partition() spend  sec:  0.05247616767883301
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3441019058227539  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.528587341308594  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.524620056152344  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.34534692764282227  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.530269622802734  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.53184175491333  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.35059499740600586  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.538333892822266  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.539906024932861  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3565998077392578  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.487038135528564  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.488650798797607  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.36069250106811523  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.486344337463379  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.487923622131348  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3658308982849121  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.492497444152832  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.494157314300537  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.37290525436401367  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.557824611663818  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.55941104888916  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.37695884704589844  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.466430187225342  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.468071460723877  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.38431215286254883  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.564302921295166  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.56596851348877  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.38955259323120117  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.569475650787354  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.571091651916504  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.394899845123291  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.577500343322754  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.579091548919678  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.39939069747924805  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.547009468078613  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.54860258102417  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4047279357910156  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.528098106384277  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.529673099517822  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.41170787811279297  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.593459606170654  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.595052719116211  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.41809749603271484  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.631084442138672  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.632677555084229  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4233698844909668  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.611921310424805  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.613558769226074  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.42927980422973633  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.649204730987549  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.650866508483887  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4340243339538574  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.55689001083374  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.558495998382568  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.43954896926879883  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.618738651275635  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.620444297790527  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4451560974121094  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.62749719619751  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.629126071929932  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4519510269165039  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.63153076171875  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.633159637451172  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4548759460449219  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.591805458068848  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.593469142913818  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

number of input  17857009
----------------------------------------after optimizer
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4723200798034668  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9108257293701172
pure train time :  4.593224763870239
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.0371861457824707
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011095523834228516
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03877139091491699
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.304734468460083
self.buckets_partition() spend  sec:  0.04990386962890625
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.34435224533081055  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.528605461120605  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.524682521820068  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.34498071670532227  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.459789276123047  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.461407661437988  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3501591682434082  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.537172317504883  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.538766384124756  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.35632991790771484  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.539948463439941  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.541539669036865  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.36212825775146484  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.547577381134033  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.549214363098145  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.36742162704467773  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.55839490890503  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.560047149658203  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3728194236755371  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.564318180084229  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.565892696380615  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.37874746322631836  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.56054162979126  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.56221866607666  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3839130401611328  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.507122993469238  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.508712768554688  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3905482292175293  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.585057735443115  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.586647510528564  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.39502906799316406  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.547297477722168  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.548867225646973  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3999366760253906  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.578335285186768  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.5799241065979  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.40448522567749023  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.539095878601074  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.540684700012207  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.41126060485839844  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.53875732421875  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.540466785430908  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.41742515563964844  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.603002548217773  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.60464334487915  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.42179393768310547  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.609431743621826  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.611045360565186  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4284396171569824  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.613555908203125  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.615169525146484  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.43415260314941406  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.618090152740479  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.619708061218262  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.44097375869750977  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.666242122650146  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.667825698852539  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4450712203979492  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.566070079803467  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.56765365600586  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4509902000427246  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.626337051391602  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.628017902374268  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.45508527755737305  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.557482719421387  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.559150218963623  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

number of input  17865522
----------------------------------------after optimizer
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4725050926208496  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8719176650047302
pure train time :  4.788495779037476
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.03644919395446777
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010266304016113281
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0379788875579834
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.264165878295898
self.buckets_partition() spend  sec:  0.04828381538391113
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3445572853088379  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.523533821105957  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.519636154174805  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.34505367279052734  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.529994487762451  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.531632900238037  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.35044097900390625  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.460671424865723  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.462279319763184  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.35700130462646484  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.544482707977295  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.546144485473633  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.36156606674194336  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.498186588287354  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.499775409698486  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.36893653869628906  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.566034317016602  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.567724704742432  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.37332773208618164  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.572360515594482  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.57394790649414  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3783302307128906  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.511707305908203  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.513294696807861  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.38382863998413086  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.572957515716553  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.574586868286133  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3881545066833496  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.565306663513184  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.566936016082764  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3949260711669922  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.574498176574707  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.576138973236084  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3986673355102539  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.52730417251587  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.528900146484375  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4056229591369629  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.592786312103271  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.594378471374512  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4128694534301758  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.595344543457031  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.597050189971924  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4173154830932617  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.54716968536377  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.548813343048096  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.42375707626342773  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.61161994934082  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.613190174102783  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4283881187438965  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.56932258605957  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.570892810821533  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4340548515319824  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.583033084869385  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.584759712219238  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4396514892578125  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.588748455047607  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.590415954589844  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4435005187988281  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.561081409454346  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.562677383422852  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.45076704025268555  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.642470836639404  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.644149780273438  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4563460350036621  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.584083557128906  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.58566951751709  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

number of input  17865836
----------------------------------------after optimizer
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.47379589080810547  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8300210237503052
pure train time :  4.595464706420898
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.04102158546447754
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010754108428955078
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.042624473571777344
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.554852247238159
self.buckets_partition() spend  sec:  0.05341529846191406
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.344484806060791  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.523630142211914  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.519688606262207  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3456430435180664  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.541108131408691  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.54279088973999  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.35079526901245117  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.545612335205078  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.547227382659912  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3562617301940918  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.535094738006592  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.536685943603516  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.36049318313598633  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.514142036437988  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.515721321105957  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.36749982833862305  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.555107593536377  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.556769371032715  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3717012405395508  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.504720687866211  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.506319046020508  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3790125846862793  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.58488416671753  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.586464405059814  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3839092254638672  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.534805297851562  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.536470890045166  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.38838768005371094  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.577908515930176  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.579505920410156  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3939223289489746  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.573047637939453  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.574690341949463  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4003944396972656  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.518811702728271  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.520450592041016  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4063148498535156  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.602877616882324  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.604506969451904  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4121832847595215  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.6003737449646  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.601947784423828  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4160342216491699  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.593357563018799  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.594981670379639  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.42297935485839844  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.604473114013672  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.60608720779419  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4284052848815918  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.542975902557373  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.54458999633789  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.43405628204345703  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.586118698120117  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.587774753570557  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4382634162902832  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.560781955718994  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.562363624572754  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.444887638092041  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.623900413513184  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.62555456161499  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.45063209533691406  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.5987868309021  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.600366115570068  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.45539331436157227  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.554192543029785  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.555907726287842  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

number of input  17857131
----------------------------------------after optimizer
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4727177619934082  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7906228303909302
pure train time :  4.61125111579895
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.035985708236694336
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009270429611206055
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03758096694946289
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.243128299713135
self.buckets_partition() spend  sec:  0.046897172927856445
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.34427547454833984  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.495348930358887  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.491521835327148  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.34514331817626953  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.535151481628418  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.536770820617676  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.349179744720459  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.486551761627197  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.488171100616455  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.35617733001708984  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.477849960327148  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.479477405548096  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.36164283752441406  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.503182888031006  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.504826545715332  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.36763572692871094  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.570571899414062  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.572184562683105  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3729991912841797  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.562816143035889  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.564470291137695  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.37843847274780273  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.559594631195068  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.561243057250977  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3843803405761719  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.574844360351562  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.576416492462158  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3906364440917969  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.571185111999512  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.572814464569092  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.39508676528930664  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.532564163208008  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.534193515777588  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.40114450454711914  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.591782569885254  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.593350410461426  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.40640926361083984  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.561480045318604  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.563047885894775  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4135003089904785  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.610697269439697  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.612344741821289  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4181027412414551  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.608532905578613  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.610145568847656  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.42287302017211914  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.599814891815186  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.601470470428467  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.42830705642700195  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.595920085906982  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.59754991531372  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.43415069580078125  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.6217041015625  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.623316287994385  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.43793439865112305  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.612968444824219  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.614580631256104  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.44524335861206055  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.628893375396729  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.630553245544434  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4493885040283203  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.597204685211182  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.598864555358887  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4552888870239258  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.58474588394165  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.58637523651123  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

number of input  17870786
----------------------------------------after optimizer
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4727210998535156  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7598453760147095
pure train time :  4.731899738311768
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.03931903839111328
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010584115982055664
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0415802001953125
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.832277297973633
self.buckets_partition() spend  sec:  0.052208662033081055
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.34414052963256836  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.476147651672363  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.472304821014404  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3451671600341797  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.530955791473389  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.532571792602539  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.35057592391967773  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.496204376220703  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.497889041900635  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.35635852813720703  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.54439401626587  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.54605770111084  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3624997138977051  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.5406174659729  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.542192459106445  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.36719608306884766  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.497380256652832  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.49894905090332  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3715949058532715  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.51632308959961  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.518019199371338  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.37840795516967773  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.565197944641113  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.566868305206299  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.38434314727783203  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.566106796264648  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.567768573760986  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3901052474975586  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.525320529937744  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.526909351348877  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.39519262313842773  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.583116054534912  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.584726810455322  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.40033769607543945  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.536694049835205  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.538355827331543  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.40624046325683594  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.589040756225586  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.59064531326294  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4101729393005371  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.517268657684326  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.51887321472168  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.41625118255615234  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.594581604003906  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.596263885498047  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4219961166381836  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.554048538208008  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.555675983428955  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4294724464416504  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.621252536773682  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.622879981994629  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.43305301666259766  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.553915023803711  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.555539608001709  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4383845329284668  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.616243362426758  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.617897510528564  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4452533721923828  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.625250339508057  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.626830577850342  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.45143747329711914  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.636428356170654  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.638017654418945  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.45616912841796875  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.585669040679932  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.587258338928223  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

number of input  17859803
----------------------------------------after optimizer
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.47357940673828125  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.729107141494751
pure train time :  4.674396991729736
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.0380556583404541
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010944128036499023
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.039630889892578125
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.603584051132202
self.buckets_partition() spend  sec:  0.050611019134521484
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.34351062774658203  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.482723712921143  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.478810787200928  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3454422950744629  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.548922061920166  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.55060863494873  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3499922752380371  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.492706775665283  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.4943265914917  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.35611867904663086  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.538895606994629  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.540526390075684  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3629884719848633  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.547157287597656  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.5487961769104  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3660392761230469  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.500427722930908  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.502066612243652  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.37292909622192383  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.551299095153809  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.552958965301514  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3783454895019531  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.52828073501587  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.529867172241211  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.38199472427368164  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.556044578552246  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.557706356048584  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.39052629470825195  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.573115348815918  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.57470178604126  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.395688533782959  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.575919151306152  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.577611446380615  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.40060901641845703  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.546984195709229  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.548611164093018  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.40628767013549805  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.599483013153076  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.601114273071289  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4117598533630371  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.59860610961914  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.600237369537354  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4163846969604492  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.551562309265137  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.553191661834717  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.42288780212402344  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.609347343444824  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.610976696014404  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.42899513244628906  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.611598014831543  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.61319637298584  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4339151382446289  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.554763793945312  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.55635404586792  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.43949460983276367  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.62903881072998  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.63064956665039  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.44514894485473633  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.636608123779297  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.63822603225708  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4493098258972168  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.552565097808838  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.554183006286621  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.45629453659057617  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.634158611297607  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.635814189910889  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

number of input  17862038
----------------------------------------after optimizer
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4736294746398926  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7017093300819397
pure train time :  4.740614175796509
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
range partition time  0.03683137893676758
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010816335678100586
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.038428544998168945
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.269800424575806
self.buckets_partition() spend  sec:  0.04928231239318848
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.34402990341186523  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.486169338226318  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.482245445251465  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3449721336364746  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.45768690109253  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.459291458129883  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3511061668395996  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.537137508392334  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.538738250732422  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.35610103607177734  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.531508445739746  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.533109188079834  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3608250617980957  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.540388107299805  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.54198169708252  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.36812448501586914  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.589558124542236  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.591179847717285  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.37194108963012695  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.501183032989502  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.502753257751465  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.37671756744384766  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.498600006103516  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.500170230865479  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3833279609680176  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.560661792755127  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.56230354309082  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.38816118240356445  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.515767574310303  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.517337322235107  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.39378976821899414  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.513416290283203  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.515087604522705  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.3994717597961426  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.530271530151367  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.531872272491455  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4052872657775879  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.532385349273682  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.534073829650879  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4133620262145996  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.618880271911621  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.620509624481201  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.41925811767578125  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.613317012786865  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.614974975585938  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4232172966003418  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.606210708618164  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.607794761657715  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4303627014160156  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.626631736755371  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.628308773040771  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4339780807495117  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.618085384368896  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.619683742523193  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.4396810531616211  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.619444370269775  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.621042728424072  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.44517993927001953  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.645414352416992  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.64698839187622  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.45050954818725586  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.638521194458008  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.640094757080078  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.45485973358154297  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.575724124908447  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 12.577297687530518  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

number of input  17862438
----------------------------------------after optimizer
 Nvidia-smi: 23.51708984375 GB
    Memory Allocated: 0.47223377227783203  GigaBytes
Max Memory Allocated: 12.880188941955566  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6718836426734924
pure train time :  4.7957823276519775
epoch_time_list  [28.150561094284058, 27.007358074188232, 26.67938542366028, 26.900484561920166, 28.3207106590271, 30.34482765197754, 28.078964710235596, 26.42884850502014, 27.771934032440186, 24.708142280578613, 24.93643593788147, 25.68119502067566, 25.864532470703125, 24.78245973587036, 24.44637370109558, 25.51857852935791, 24.997305631637573, 25.47183132171631, 24.625048398971558, 24.569690227508545]

loading_time list   [0.5745773315429688, 0.6181988716125488, 0.5544998645782471, 0.5592913627624512, 0.5943922996520996, 0.5608532428741455, 0.6414089202880859, 0.5819003582000732, 0.5055828094482422, 0.5097079277038574, 0.5336949825286865, 0.4877185821533203, 0.4963068962097168, 0.511155366897583, 0.5472228527069092, 0.6291913986206055, 0.5473008155822754, 0.5879795551300049, 0.478374719619751, 0.5676944255828857]

 data loader gen time  15.811845302581787
	---backpack schedule time  [3.981322765350342, 4.097756385803223, 4.043798446655273, 4.009469747543335, 4.4033544063568115, 4.4950268268585205, 4.09654974937439, 4.63883376121521, 6.08727765083313, 4.446468114852905, 4.39619255065918, 5.1807639598846436, 5.697716236114502, 4.35904335975647, 4.322094678878784, 4.6169798374176025, 4.299769163131714, 4.899264335632324, 4.653722524642944, 4.324786186218262]
	---connection_check_time_list  [7.314881324768066, 8.362339973449707, 8.107255697250366, 9.06129789352417, 9.798837184906006, 10.697056293487549, 9.68250298500061, 7.852382183074951, 7.5944812297821045, 6.722311973571777, 6.975437164306641, 7.048455715179443, 6.627255916595459, 6.540993928909302, 6.508489608764648, 7.0344297885894775, 6.897457599639893, 6.871986150741577, 6.515951871871948, 6.417316913604736]
	---block_gen_time_list  [4.601743698120117, 4.616180896759033, 4.793055534362793, 4.730392217636108, 4.699594020843506, 4.8936707973480225, 4.9724204540252686, 4.66513729095459, 4.590046644210815, 4.412590980529785, 4.35947847366333, 4.366783142089844, 4.326109170913696, 4.5222296714782715, 4.393379211425781, 4.573324918746948, 4.453423500061035, 4.344440937042236, 4.240659475326538, 4.410529375076294]
training time  [11.052796125411987, 8.64322566986084, 8.50396466255188, 7.855466604232788, 8.127877473831177, 8.956259965896606, 7.996489763259888, 7.960686683654785, 8.239897727966309, 7.908590793609619, 7.959784984588623, 7.897555351257324, 7.992918491363525, 8.14574408531189, 7.9850263595581055, 7.935290098190308, 8.104031562805176, 8.000620126724243, 8.011864423751831, 8.149587154388428]
---feature block loading time  [3.9049806594848633, 4.063146352767944, 3.9921014308929443, 3.184004068374634, 3.3367135524749756, 4.164945840835571, 3.2750778198242188, 3.2290244102478027, 3.293322801589966, 3.242521047592163, 3.2232720851898193, 3.223165273666382, 3.299363136291504, 3.2538933753967285, 3.2899234294891357, 3.226970672607422, 3.275128126144409, 3.2282016277313232, 3.168269395828247, 3.252312183380127]


epoch_time avg   26.03417992591858
loading_time avg   0.5487803220748901
 data loader gen time avg 17.359528481960297
	---backpack schedule time avg 4.682365208864212
	---connection_check_time avg  7.486584156751633
	---block_gen_time avg  4.513988628983498
training time  8.085764065384865
---feature block loading time  3.311381548643112
pure train time per /epoch  [7.115558624267578, 4.4960150718688965, 4.428329229354858, 4.559892654418945, 4.696869611740112, 4.698470115661621, 4.62819504737854, 4.629648447036743, 4.843962907791138, 4.562838315963745, 4.633235454559326, 4.576150894165039, 4.593224763870239, 4.788495779037476, 4.595464706420898, 4.61125111579895, 4.731899738311768, 4.674396991729736, 4.740614175796509, 4.7957823276519775]
pure train time average  4.668258414548986
num_input list  [17871685, 17857963, 17854528, 17864543, 17859916, 17861389, 17870871, 17866559, 17866462, 17865367, 17865936, 17870663, 17857009, 17865522, 17865836, 17857131, 17870786, 17859803, 17862038, 17862438]
num_input  average  17863822.25
