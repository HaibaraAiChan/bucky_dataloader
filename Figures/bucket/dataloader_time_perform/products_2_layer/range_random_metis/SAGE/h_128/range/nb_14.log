main start at this time 1713158618.485656
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.033850669860839844
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011725902557373047
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03577256202697754
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.559842824935913
self.buckets_partition() spend  sec:  0.047530412673950195
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.91357421875 GB
    Memory Allocated: 0.39168214797973633  GigaBytes
Max Memory Allocated: 0.39168214797973633  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.12646484375 GB
    Memory Allocated: 18.167943000793457  GigaBytes
Max Memory Allocated: 18.490230083465576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.12646484375 GB
    Memory Allocated: 18.17040252685547  GigaBytes
Max Memory Allocated: 18.490230083465576  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.13427734375 GB
    Memory Allocated: 0.42299842834472656  GigaBytes
Max Memory Allocated: 18.490230083465576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.23388671875 GB
    Memory Allocated: 18.258054733276367  GigaBytes
Max Memory Allocated: 18.584031105041504  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.23388671875 GB
    Memory Allocated: 18.26051378250122  GigaBytes
Max Memory Allocated: 18.584031105041504  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.23388671875 GB
    Memory Allocated: 0.4341850280761719  GigaBytes
Max Memory Allocated: 18.584031105041504  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.20654296875 GB
    Memory Allocated: 18.257393836975098  GigaBytes
Max Memory Allocated: 18.584031105041504  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.20654296875 GB
    Memory Allocated: 18.260023593902588  GigaBytes
Max Memory Allocated: 18.584031105041504  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.20849609375 GB
    Memory Allocated: 0.44678497314453125  GigaBytes
Max Memory Allocated: 18.584031105041504  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 18.31798505783081  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 18.321094512939453  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.45403385162353516  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30419921875 GB
    Memory Allocated: 18.217316150665283  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30419921875 GB
    Memory Allocated: 18.22017478942871  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30419921875 GB
    Memory Allocated: 0.46660280227661133  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27294921875 GB
    Memory Allocated: 18.318297863006592  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.27294921875 GB
    Memory Allocated: 18.32081890106201  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27294921875 GB
    Memory Allocated: 0.47380638122558594  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27294921875 GB
    Memory Allocated: 18.268746376037598  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.27294921875 GB
    Memory Allocated: 18.271475791931152  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27294921875 GB
    Memory Allocated: 0.48424196243286133  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27294921875 GB
    Memory Allocated: 18.243813514709473  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.27294921875 GB
    Memory Allocated: 18.24632740020752  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27294921875 GB
    Memory Allocated: 0.49355459213256836  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27490234375 GB
    Memory Allocated: 18.276278018951416  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.27490234375 GB
    Memory Allocated: 18.278791904449463  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27490234375 GB
    Memory Allocated: 0.5014839172363281  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27490234375 GB
    Memory Allocated: 18.25724744796753  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.27490234375 GB
    Memory Allocated: 18.259777069091797  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27490234375 GB
    Memory Allocated: 0.5129203796386719  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24365234375 GB
    Memory Allocated: 18.346944332122803  GigaBytes
Max Memory Allocated: 18.671444416046143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24365234375 GB
    Memory Allocated: 18.34947967529297  GigaBytes
Max Memory Allocated: 18.671444416046143  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24365234375 GB
    Memory Allocated: 0.5196552276611328  GigaBytes
Max Memory Allocated: 18.671444416046143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24365234375 GB
    Memory Allocated: 18.28424644470215  GigaBytes
Max Memory Allocated: 18.671444416046143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24365234375 GB
    Memory Allocated: 18.286731719970703  GigaBytes
Max Memory Allocated: 18.671444416046143  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24365234375 GB
    Memory Allocated: 0.5327816009521484  GigaBytes
Max Memory Allocated: 18.671444416046143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24365234375 GB
    Memory Allocated: 18.34956407546997  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24365234375 GB
    Memory Allocated: 18.352041244506836  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24365234375 GB
    Memory Allocated: 0.5395112037658691  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.239304065704346  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.24178123474121  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

number of input  13873784
----------------------------------------after optimizer
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.5691003799438477  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.208089351654053
pure train time :  4.907374620437622
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.03512215614318848
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011269807815551758
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.036949872970581055
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.5232672691345215
self.buckets_partition() spend  sec:  0.04825735092163086
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.42407703399658203  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.228991508483887  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.221689224243164  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.42671632766723633  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.240402221679688  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.242966651916504  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.4372286796569824  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.237730026245117  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.24038076400757  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.44603490829467773  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.26461124420166  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.267263412475586  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.45755577087402344  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.227797031402588  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.230449199676514  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.46631860733032227  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.276954650878906  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.279459953308105  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.47550058364868164  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.232412338256836  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.234878540039062  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.4834585189819336  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.24082040786743  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.243589878082275  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.494417667388916  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.27067804336548  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.273229122161865  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.5047154426574707  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.21240234375 GB
    Memory Allocated: 18.313820362091064  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.21240234375 GB
    Memory Allocated: 18.31633949279785  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.21240234375 GB
    Memory Allocated: 0.5122079849243164  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.21240234375 GB
    Memory Allocated: 18.29694700241089  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.21240234375 GB
    Memory Allocated: 18.299437046051025  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.21240234375 GB
    Memory Allocated: 0.5231175422668457  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.17919921875 GB
    Memory Allocated: 18.3459210395813  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.17919921875 GB
    Memory Allocated: 18.348415851593018  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.17919921875 GB
    Memory Allocated: 0.533238410949707  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18115234375 GB
    Memory Allocated: 18.307571411132812  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18115234375 GB
    Memory Allocated: 18.31006622314453  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.5410051345825195  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.26231288909912  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.264925479888916  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

number of input  13867578
----------------------------------------after optimizer
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.5683236122131348  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.4797205924987793
pure train time :  3.5767295360565186
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.04043412208557129
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013843774795532227
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.042440176010131836
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.668471097946167
self.buckets_partition() spend  sec:  0.056339263916015625
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.4229612350463867  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.186296463012695  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.178646564483643  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.4249587059020996  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.20531415939331  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.207773208618164  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.43505430221557617  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.228468894958496  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.23112392425537  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.44467735290527344  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.20902681350708  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.211780548095703  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.45349884033203125  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.22235107421875  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.225082874298096  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.4628591537475586  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.28550100326538  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.288187503814697  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.4721698760986328  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.236156940460205  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.238903522491455  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.48196887969970703  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.277193546295166  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.279781341552734  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.48987674713134766  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.192116260528564  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.194704055786133  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.5019621849060059  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.30029296875 GB
    Memory Allocated: 18.344173908233643  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.30029296875 GB
    Memory Allocated: 18.34694766998291  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.30029296875 GB
    Memory Allocated: 0.5092263221740723  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.30029296875 GB
    Memory Allocated: 18.299346446990967  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.30029296875 GB
    Memory Allocated: 18.30189847946167  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.30029296875 GB
    Memory Allocated: 0.5192551612854004  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.347434520721436  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.349972248077393  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.5306625366210938  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.31844186782837  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.320979595184326  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.5415430068969727  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.314938068389893  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.317396640777588  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

number of input  13863975
----------------------------------------after optimizer
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.5684313774108887  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7306463718414307
pure train time :  3.6739120483398438
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.03872990608215332
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013001203536987305
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04062485694885254
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.566287040710449
self.buckets_partition() spend  sec:  0.05368661880493164
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.4239010810852051  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.262868404388428  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.255162239074707  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.4249763488769531  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.229529857635498  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.232152938842773  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.4334444999694824  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.149617195129395  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.15229320526123  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.44582319259643555  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.274137020111084  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.27666425704956  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.45764589309692383  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.26068115234375  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.263583183288574  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.46704673767089844  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.271358013153076  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.273999214172363  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.47705888748168945  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.29854440689087  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.301424980163574  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.4886474609375  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.264834880828857  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.267405033111572  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.4964771270751953  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.23679256439209  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.2392897605896  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.5081229209899902  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.3136248588562  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.3162260055542  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.5171904563903809  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.333036422729492  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.335586547851562  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.530491828918457  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.398768424987793  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.401248931884766  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.5375728607177734  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.26134443283081  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.26393222808838  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 0.5464291572570801  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 18.290803909301758  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 18.29328155517578  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

number of input  13867187
----------------------------------------after optimizer
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 0.5733952522277832  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.233269691467285
pure train time :  3.512744665145874
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.037508249282836914
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014134407043457031
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03971672058105469
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.5953478813171387
self.buckets_partition() spend  sec:  0.05392885208129883
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 0.42271852493286133  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 18.232574462890625  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 18.226479053497314  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 0.424102783203125  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 18.2085862159729  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 18.21113109588623  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.4369339942932129  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.29846715927124  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.301138401031494  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.4453258514404297  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.23733949661255  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.239834308624268  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.4555082321166992  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.188815593719482  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.191855907440186  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.46483755111694336  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.18372106552124  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.186755657196045  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.47569942474365234  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.236644744873047  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.239561080932617  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.48470592498779297  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.181085109710693  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.183544158935547  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.4954681396484375  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.2526593208313  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.25514793395996  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.5035743713378906  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.2715163230896  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.27407217025757  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.5166640281677246  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.31917905807495  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.321681022644043  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.5252881050109863  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.324213981628418  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.32716131210327  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.5376396179199219  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.387465953826904  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.389925003051758  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.545313835144043  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.32664155960083  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.329147338867188  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

number of input  13860238
----------------------------------------after optimizer
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.5737648010253906  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7780675888061523
pure train time :  3.464804172515869
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.041623830795288086
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013397216796875
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04325366020202637
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.808222770690918
self.buckets_partition() spend  sec:  0.05670595169067383
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.4210691452026367  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.11963701248169  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.112370491027832  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.42558908462524414  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.195889472961426  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.198845863342285  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.43491220474243164  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.215476989746094  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.218156337738037  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.44430017471313477  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.246670246124268  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.249395847320557  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.45504283905029297  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.27401065826416  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.276535987854004  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.4632754325866699  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.24714183807373  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.250319957733154  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.4720115661621094  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.288561820983887  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.2916522026062  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.4830756187438965  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.32650852203369  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.329150199890137  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.4911007881164551  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.25578498840332  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.25829792022705  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.5022940635681152  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.34334707260132  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.345848083496094  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.5114469528198242  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.34093713760376  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.34343385696411  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.5204305648803711  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.289780139923096  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.29225206375122  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.5288805961608887  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.270616054534912  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.273272037506104  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.5408182144165039  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.352877140045166  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.355384349822998  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

number of input  13864460
----------------------------------------after optimizer
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.5669794082641602  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5501919984817505
pure train time :  3.462707281112671
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.039069175720214844
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01639270782470703
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04064321517944336
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.799999475479126
self.buckets_partition() spend  sec:  0.05707597732543945
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.421633243560791  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.135334014892578  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.127872943878174  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.4250798225402832  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.23249626159668  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.234957218170166  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.43462324142456055  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.279395580291748  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.2818546295166  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.44477128982543945  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.235910892486572  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.238369941711426  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.4552769660949707  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.28500509262085  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.287464141845703  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.4660196304321289  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.219557762145996  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.222233772277832  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.47458839416503906  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.247846126556396  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.250351905822754  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.48395586013793945  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.27571678161621  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.27817964553833  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.49346017837524414  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.273633003234863  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.276782512664795  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.5033135414123535  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.285693168640137  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.288252353668213  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.5115385055541992  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.307437419891357  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.309950351715088  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.5232391357421875  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.33242654800415  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.334892749786377  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.5327391624450684  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.354053020477295  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.356515884399414  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.5448799133300781  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.341272354125977  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.343782901763916  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

number of input  13869474
----------------------------------------after optimizer
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.5711803436279297  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.392423391342163
pure train time :  3.490605592727661
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.041654348373413086
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011661291122436523
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04317212104797363
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.8944146633148193
self.buckets_partition() spend  sec:  0.05486583709716797
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.42261743545532227  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.221373081207275  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.215132236480713  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.4264063835144043  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.22784948348999  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.23053216934204  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.435455322265625  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.18588638305664  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.188737869262695  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.44560861587524414  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.229794025421143  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.232391834259033  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.45606470108032227  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.281203746795654  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.283798694610596  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.46555185317993164  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.26765775680542  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.27013635635376  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.4760141372680664  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.263216495513916  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.265695095062256  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.48513174057006836  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.253396034240723  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.255903720855713  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.4934053421020508  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.25261926651001  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.255457878112793  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.5045366287231445  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.306561946868896  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 18.309099674224854  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.62646484375 GB
    Memory Allocated: 0.5130038261413574  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.283370971679688  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.286007404327393  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.5223379135131836  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.287250518798828  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.289756298065186  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.5310821533203125  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.29231882095337  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.294875621795654  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.5432305335998535  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.391444206237793  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.39390516281128  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

number of input  13866639
----------------------------------------after optimizer
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.5707530975341797  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2704598903656006
pure train time :  3.5101444721221924
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.03949475288391113
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011247396469116211
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04103970527648926
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.754382371902466
self.buckets_partition() spend  sec:  0.0523226261138916
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.4239835739135742  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.196836948394775  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.190396308898926  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.42301034927368164  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.177232265472412  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.180453777313232  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.43457794189453125  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.20520544052124  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.207743644714355  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.4444284439086914  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.240414142608643  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.24323272705078  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.45467519760131836  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.314699172973633  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.31748867034912  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.46248674392700195  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.194968223571777  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.197683811187744  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.4736166000366211  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.246302604675293  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.24883794784546  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.48230934143066406  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.29837656021118  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.30090045928955  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.4910717010498047  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.239670753479004  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.242198944091797  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.5023236274719238  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.313900470733643  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.316367149353027  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.5104260444641113  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.271307945251465  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.273834705352783  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.519709587097168  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.275655269622803  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.278836250305176  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.5309276580810547  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.287649631500244  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.29030132293701  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.5400452613830566  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.32062578201294  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.32323455810547  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

number of input  13863393
----------------------------------------after optimizer
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.5676131248474121  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.174406886100769
pure train time :  3.5064430236816406
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.03846597671508789
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011992216110229492
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04000973701477051
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.749664306640625
self.buckets_partition() spend  sec:  0.05203509330749512
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.4206967353820801  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.11585521697998  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.108488082885742  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.4230217933654785  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.19054079055786  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.19376516342163  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.433042049407959  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.212514400482178  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.21521759033203  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.4459991455078125  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.25160551071167  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 18.254099369049072  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.63232421875 GB
    Memory Allocated: 0.45771360397338867  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.36695384979248  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.369455814361572  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.46573305130004883  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.275837421417236  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.278328895568848  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.47515344619750977  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.240583896636963  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.243244171142578  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.4852333068847656  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.275347232818604  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.277932167053223  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.4952230453491211  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.273390769958496  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.276036739349365  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5042686462402344  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.286077976226807  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.28865957260132  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5138907432556152  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.352381706237793  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.354877471923828  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5233979225158691  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.25850200653076  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.260997772216797  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5350947380065918  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.348474979400635  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.351410388946533  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5447978973388672  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.315357208251953  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.318249225616455  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

number of input  13863584
----------------------------------------after optimizer
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5712337493896484  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0810120105743408
pure train time :  3.47922945022583
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.039763689041137695
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010144948959350586
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04131197929382324
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.792539119720459
self.buckets_partition() spend  sec:  0.051490068435668945
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.42099809646606445  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.170251846313477  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.163430213928223  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.4239659309387207  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.189696311950684  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.192938327789307  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.43289756774902344  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.188357830047607  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.190919876098633  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.4449653625488281  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.234473705291748  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.2372145652771  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.45370912551879883  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.24620532989502  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.248767375946045  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.46332454681396484  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.25221586227417  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.254749298095703  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.4732370376586914  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.27661371231079  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.27918291091919  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.4825773239135742  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.268549919128418  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.271040439605713  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.4914665222167969  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.243757724761963  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.246729373931885  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5023131370544434  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.330737113952637  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.33319616317749  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5116777420043945  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.30258083343506  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.305156230926514  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5214376449584961  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.270379543304443  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.273142337799072  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5316290855407715  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.365652084350586  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.36862325668335  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5405211448669434  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.29020881652832  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.292786121368408  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

number of input  13870267
----------------------------------------after optimizer
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5673513412475586  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0022846460342407
pure train time :  3.461456775665283
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.040518760681152344
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009823799133300781
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.04210472106933594
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.074991941452026
self.buckets_partition() spend  sec:  0.05196213722229004
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.42383384704589844  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.21868324279785  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.21107292175293  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.4234151840209961  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.172622680664062  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.175199031829834  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.43573760986328125  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.230154991149902  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.23300790786743  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.44623422622680664  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.236155033111572  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.239240169525146  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.45585107803344727  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.22127628326416  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.22394561767578  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.46540117263793945  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.224404335021973  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.226987838745117  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.4751138687133789  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.299232482910156  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.30183744430542  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.4862833023071289  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.29106044769287  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.29358673095703  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.4962759017944336  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.295804500579834  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.29830837249756  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5050482749938965  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.297088623046875  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.29954957962036  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5142130851745605  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.269450664520264  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.272127151489258  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5242600440979004  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.320334434509277  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.32286787033081  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5339798927307129  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.32517147064209  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.327675342559814  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5450730323791504  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.367345333099365  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.369848251342773  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

number of input  13870411
----------------------------------------after optimizer
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5744147300720215  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9616603851318359
pure train time :  3.4594125747680664
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.036695003509521484
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009313344955444336
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03823232650756836
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.93044376373291
self.buckets_partition() spend  sec:  0.047657012939453125
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.42642927169799805  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.23504638671875  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.224931240081787  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.4250946044921875  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.188138484954834  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.190855503082275  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.4362144470214844  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.217809677124023  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.220518112182617  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.44438648223876953  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.171398639678955  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.17482089996338  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.4552640914916992  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.18892812728882  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.191577434539795  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.46586084365844727  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.229945182800293  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.232510566711426  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.47438621520996094  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.277616024017334  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.280115127563477  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.48269176483154297  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.238563060760498  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.24177598953247  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.4936342239379883  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.272067070007324  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.274999141693115  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5050487518310547  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.348249912261963  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.350708961486816  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5144529342651367  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.343273639678955  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.345786571502686  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5249900817871094  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.336349487304688  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.33885431289673  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5343551635742188  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.330989837646484  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.333526611328125  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5449934005737305  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.325286865234375  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 18.327961921691895  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

number of input  13862305
----------------------------------------after optimizer
 Nvidia-smi: 23.62060546875 GB
    Memory Allocated: 0.5720582008361816  GigaBytes
Max Memory Allocated: 18.72354745864868  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9127953052520752
pure train time :  3.7214231491088867
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.03891134262084961
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009587287902832031
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.040439605712890625
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.800682783126831
self.buckets_partition() spend  sec:  0.05006146430969238
