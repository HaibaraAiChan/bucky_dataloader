main start at this time 1713200854.768298
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.031525373458862305
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008983850479125977
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03304886817932129
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.5209877490997314
self.buckets_partition() spend  sec:  0.04206418991088867
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.91357421875 GB
    Memory Allocated: 0.39168214797973633  GigaBytes
Max Memory Allocated: 0.39168214797973633  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.12646484375 GB
    Memory Allocated: 18.167943000793457  GigaBytes
Max Memory Allocated: 18.490230083465576  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.12646484375 GB
    Memory Allocated: 18.17040252685547  GigaBytes
Max Memory Allocated: 18.490230083465576  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.13427734375 GB
    Memory Allocated: 0.42299842834472656  GigaBytes
Max Memory Allocated: 18.490230083465576  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.23388671875 GB
    Memory Allocated: 18.258054733276367  GigaBytes
Max Memory Allocated: 18.584031105041504  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.23388671875 GB
    Memory Allocated: 18.26051378250122  GigaBytes
Max Memory Allocated: 18.584031105041504  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.23388671875 GB
    Memory Allocated: 0.4341850280761719  GigaBytes
Max Memory Allocated: 18.584031105041504  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.20654296875 GB
    Memory Allocated: 18.257393836975098  GigaBytes
Max Memory Allocated: 18.584031105041504  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.20654296875 GB
    Memory Allocated: 18.260023593902588  GigaBytes
Max Memory Allocated: 18.584031105041504  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.20849609375 GB
    Memory Allocated: 0.44678497314453125  GigaBytes
Max Memory Allocated: 18.584031105041504  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 18.31798505783081  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 18.321094512939453  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.45403385162353516  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30419921875 GB
    Memory Allocated: 18.217316150665283  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30419921875 GB
    Memory Allocated: 18.22017478942871  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30419921875 GB
    Memory Allocated: 0.46660280227661133  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27294921875 GB
    Memory Allocated: 18.318297863006592  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.27294921875 GB
    Memory Allocated: 18.32081890106201  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27294921875 GB
    Memory Allocated: 0.47380638122558594  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27294921875 GB
    Memory Allocated: 18.268746376037598  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.27294921875 GB
    Memory Allocated: 18.271475791931152  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27294921875 GB
    Memory Allocated: 0.48424196243286133  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27294921875 GB
    Memory Allocated: 18.243813514709473  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.27294921875 GB
    Memory Allocated: 18.24632740020752  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27294921875 GB
    Memory Allocated: 0.49355459213256836  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27490234375 GB
    Memory Allocated: 18.276278018951416  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.27490234375 GB
    Memory Allocated: 18.278791904449463  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27490234375 GB
    Memory Allocated: 0.5014839172363281  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27490234375 GB
    Memory Allocated: 18.25724744796753  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.27490234375 GB
    Memory Allocated: 18.259777069091797  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.27490234375 GB
    Memory Allocated: 0.5129203796386719  GigaBytes
Max Memory Allocated: 18.643741130828857  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24365234375 GB
    Memory Allocated: 18.346944332122803  GigaBytes
Max Memory Allocated: 18.671444416046143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24365234375 GB
    Memory Allocated: 18.34947967529297  GigaBytes
Max Memory Allocated: 18.671444416046143  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24365234375 GB
    Memory Allocated: 0.5196552276611328  GigaBytes
Max Memory Allocated: 18.671444416046143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24365234375 GB
    Memory Allocated: 18.28424644470215  GigaBytes
Max Memory Allocated: 18.671444416046143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24365234375 GB
    Memory Allocated: 18.286731719970703  GigaBytes
Max Memory Allocated: 18.671444416046143  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24365234375 GB
    Memory Allocated: 0.5327816009521484  GigaBytes
Max Memory Allocated: 18.671444416046143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24365234375 GB
    Memory Allocated: 18.34956407546997  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24365234375 GB
    Memory Allocated: 18.352041244506836  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24365234375 GB
    Memory Allocated: 0.5395112037658691  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.239304065704346  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.24178123474121  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

number of input  13873784
----------------------------------------after optimizer
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.5691003799438477  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.207536220550537
pure train time :  4.954664468765259
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.03193235397338867
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008860349655151367
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03345179557800293
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.541731834411621
self.buckets_partition() spend  sec:  0.0423431396484375
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.42407703399658203  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.228991508483887  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.221689224243164  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.42671632766723633  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.240402221679688  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.242966651916504  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.4372286796569824  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.237730026245117  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.24038076400757  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.44603490829467773  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.26461124420166  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.267263412475586  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.45755577087402344  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.227797031402588  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.230449199676514  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.46631860733032227  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.276954650878906  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.279459953308105  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.47550058364868164  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.232412338256836  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.234878540039062  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.4834585189819336  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.24082040786743  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.243589878082275  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.494417667388916  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.27067804336548  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 18.273229122161865  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.24560546875 GB
    Memory Allocated: 0.5047154426574707  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.21240234375 GB
    Memory Allocated: 18.313820362091064  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.21240234375 GB
    Memory Allocated: 18.31633949279785  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.21240234375 GB
    Memory Allocated: 0.5122079849243164  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.21240234375 GB
    Memory Allocated: 18.29694700241089  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.21240234375 GB
    Memory Allocated: 18.299437046051025  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.21240234375 GB
    Memory Allocated: 0.5231175422668457  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.17919921875 GB
    Memory Allocated: 18.3459210395813  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.17919921875 GB
    Memory Allocated: 18.348415851593018  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.17919921875 GB
    Memory Allocated: 0.533238410949707  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18115234375 GB
    Memory Allocated: 18.307571411132812  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18115234375 GB
    Memory Allocated: 18.31006622314453  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.5410051345825195  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.26231288909912  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.264925479888916  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

number of input  13867578
----------------------------------------after optimizer
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.5683236122131348  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.4785492420196533
pure train time :  3.30029296875
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.03525686264038086
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010996341705322266
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03686642646789551
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.566560745239258
self.buckets_partition() spend  sec:  0.04789447784423828
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.4229612350463867  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.186296463012695  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.178646564483643  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.4249587059020996  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.20531415939331  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.207773208618164  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.43505430221557617  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.228468894958496  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.23112392425537  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.44467735290527344  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.20902681350708  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.211780548095703  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.45349884033203125  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.22235107421875  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.225082874298096  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.4628591537475586  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.28550100326538  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.288187503814697  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.4721698760986328  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.236156940460205  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.238903522491455  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.48196887969970703  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.277193546295166  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.279781341552734  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.48987674713134766  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.192116260528564  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 18.194704055786133  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.18310546875 GB
    Memory Allocated: 0.5019621849060059  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.30029296875 GB
    Memory Allocated: 18.344173908233643  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.30029296875 GB
    Memory Allocated: 18.34694766998291  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.30029296875 GB
    Memory Allocated: 0.5092263221740723  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.30029296875 GB
    Memory Allocated: 18.299346446990967  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.30029296875 GB
    Memory Allocated: 18.30189847946167  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.30029296875 GB
    Memory Allocated: 0.5193500518798828  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.347092628479004  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.349626541137695  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.5297942161560059  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.31534767150879  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.31838083267212  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.5420594215393066  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.314188957214355  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.316683769226074  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

number of input  13863975
----------------------------------------after optimizer
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.5683307647705078  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.730635166168213
pure train time :  3.466315507888794
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.035199880599975586
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009759187698364258
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03674483299255371
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.54876446723938
self.buckets_partition() spend  sec:  0.046544551849365234
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.4246978759765625  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.2634916305542  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.254964351654053  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.425048828125  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.228302478790283  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.23092555999756  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.43263816833496094  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.149744510650635  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.15236759185791  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.44422483444213867  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.270931243896484  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.273390293121338  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.4557051658630371  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.256625652313232  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.259084701538086  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.46602964401245117  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.26846742630005  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.271084785461426  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.4751429557800293  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.295925617218018  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.298495769500732  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.48592472076416016  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.263065338134766  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.26563549041748  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.4948110580444336  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.234829425811768  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.23728847503662  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.5063486099243164  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.310755729675293  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.313214778900146  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.5153608322143555  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.329039096832275  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.331527709960938  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.527397632598877  GigaBytes
Max Memory Allocated: 18.674581050872803  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.39886236190796  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.401321411132812  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 0.5354428291320801  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.261977195739746  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65380859375 GB
    Memory Allocated: 18.2647762298584  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 0.5450515747070312  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 18.29142189025879  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 18.293899536132812  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

number of input  13867187
----------------------------------------after optimizer
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 0.571159839630127  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.232455253601074
pure train time :  3.2795300483703613
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.03550267219543457
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011215686798095703
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03706836700439453
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.5187623500823975
self.buckets_partition() spend  sec:  0.04831981658935547
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 0.42198753356933594  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 18.23227024078369  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 18.226165294647217  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 0.42366600036621094  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 18.20906686782837  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65576171875 GB
    Memory Allocated: 18.21196460723877  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.43666601181030273  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.299145221710205  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.301697731018066  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.44487810134887695  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.23610258102417  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.238773822784424  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.4543466567993164  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.188395977020264  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.191436290740967  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.4636235237121582  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.180561065673828  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.183319091796875  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.47483110427856445  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.235957145690918  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.239218711853027  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.4837942123413086  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.180647373199463  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.183110237121582  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.4942054748535156  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.24943733215332  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.251925945281982  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.5035080909729004  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.274434566497803  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.27696657180786  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.5165963172912598  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.319430351257324  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.32194757461548  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.524726390838623  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.32397985458374  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 18.326497077941895  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.65771484375 GB
    Memory Allocated: 0.5358424186706543  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.387409210205078  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.389955043792725  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.5440468788146973  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.328927993774414  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.33140993118286  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

number of input  13860238
----------------------------------------after optimizer
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.5712413787841797  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.777056097984314
pure train time :  3.491908073425293
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.036475419998168945
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010163068771362305
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03802990913391113
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.5386788845062256
self.buckets_partition() spend  sec:  0.04822969436645508
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.42052364349365234  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.12056589126587  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.11405372619629  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.42566967010498047  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.197782039642334  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.20026731491089  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.43548107147216797  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.21773338317871  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.22043752670288  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.4449143409729004  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.245781898498535  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.248507499694824  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.4567742347717285  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.280603885650635  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.28312921524048  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.4680209159851074  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.25021505355835  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.252811431884766  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.4772191047668457  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.292263984680176  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.295077800750732  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.48891162872314453  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.333930492401123  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.33664894104004  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.49727725982666016  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.262115478515625  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.26483392715454  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.5080451965332031  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.35170555114746  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.354356288909912  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.5175309181213379  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.34781837463379  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.350290298461914  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.5270447731018066  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.294641494750977  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.2971134185791  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.5352258682250977  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.27795934677124  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.280784606933594  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.5462822914123535  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.35852861404419  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.361021995544434  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

number of input  13864460
----------------------------------------after optimizer
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.5730185508728027  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5523446798324585
pure train time :  3.504791259765625
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.034677743911743164
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010556936264038086
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03625607490539551
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.5632147789001465
self.buckets_partition() spend  sec:  0.04684710502624512
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.42095136642456055  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.134162425994873  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.127827644348145  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.4244999885559082  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.233961582183838  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.236422538757324  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.43512392044067383  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.27718210220337  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.279641151428223  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.4452390670776367  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.237182140350342  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.24007511138916  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.4549102783203125  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.28416633605957  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.286985397338867  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.46553850173950195  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.222182273864746  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.224858283996582  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.47495365142822266  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.25001287460327  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.252614974975586  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.4843287467956543  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.27670669555664  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.27916955947876  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.49352073669433594  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.278162002563477  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.281311511993408  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.5040817260742188  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.287814617156982  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.29037380218506  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.5127425193786621  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.31136703491211  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.31387996673584  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.5249547958374023  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.33387565612793  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.336341857910156  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.5348148345947266  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.353779792785645  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.35624599456787  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.5466852188110352  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.34675168991089  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.349263191223145  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

number of input  13869474
----------------------------------------after optimizer
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.5743727684020996  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3914661407470703
pure train time :  3.487201452255249
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.03619503974914551
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01121377944946289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03780317306518555
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.554180145263672
self.buckets_partition() spend  sec:  0.04905128479003906
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.4240584373474121  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.223546981811523  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.214864253997803  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.42565298080444336  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.226772785186768  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.22945547103882  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.43304967880249023  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.183254718780518  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.186437129974365  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.44334983825683594  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.227188110351562  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.230108737945557  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.45340585708618164  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.284021854400635  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.286616802215576  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.46413421630859375  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.26505756378174  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.267536163330078  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.47490692138671875  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.262253284454346  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.264731884002686  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.483978271484375  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.250950813293457  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.253496170043945  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.4922142028808594  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.248809337615967  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.251755237579346  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.5035152435302734  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.3048152923584  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 18.307353019714355  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.01513671875 GB
    Memory Allocated: 0.5120553970336914  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.285364627838135  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.288038730621338  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.5224428176879883  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.288472175598145  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.29108190536499  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.5317568778991699  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.291865825653076  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.29442262649536  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.5443878173828125  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.391056060791016  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.39396619796753  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

number of input  13866639
----------------------------------------after optimizer
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.571474552154541  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2709810733795166
pure train time :  3.5352776050567627
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.035173892974853516
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011055231094360352
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03671693801879883
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.557919502258301
self.buckets_partition() spend  sec:  0.047808170318603516
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.4231233596801758  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.195279121398926  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.188960552215576  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.42314767837524414  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.177958488464355  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.181180000305176  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.4343709945678711  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.201664924621582  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.204233169555664  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.4440441131591797  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.240907192230225  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.243394374847412  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.455047607421875  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.313426971435547  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.316237926483154  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.4628109931945801  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.195534706115723  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.19821310043335  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.47322797775268555  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.24817943572998  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.25109100341797  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.4837002754211426  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.30076026916504  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.303219318389893  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.4918999671936035  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.239478588104248  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.24200677871704  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.5027623176574707  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.312705516815186  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.31517219543457  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.5105962753295898  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.276540756225586  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.27900743484497  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.519585132598877  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.278654098510742  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.281879901885986  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.5302138328552246  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.286445140838623  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.28894567489624  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.5401735305786133  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.321632862091064  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.324103832244873  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

number of input  13863393
----------------------------------------after optimizer
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.5671749114990234  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1747292280197144
pure train time :  3.4892473220825195
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.035101890563964844
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010307073593139648
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03671526908874512
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.5825982093811035
self.buckets_partition() spend  sec:  0.04705548286437988
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.42174243927001953  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.11556911468506  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.107543468475342  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.42342185974121094  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.19094705581665  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.19428825378418  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.43327999114990234  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.214256763458252  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.216959953308105  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.44533348083496094  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.253243446350098  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 18.2557373046875  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.02099609375 GB
    Memory Allocated: 0.4571967124938965  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.39599609375 GB
    Memory Allocated: 18.36278486251831  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.39599609375 GB
    Memory Allocated: 18.36582326889038  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.39599609375 GB
    Memory Allocated: 0.46466636657714844  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.39599609375 GB
    Memory Allocated: 18.272528648376465  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.39599609375 GB
    Memory Allocated: 18.275020122528076  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.39599609375 GB
    Memory Allocated: 0.4742703437805176  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.39599609375 GB
    Memory Allocated: 18.239601612091064  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.39599609375 GB
    Memory Allocated: 18.24226188659668  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.39599609375 GB
    Memory Allocated: 0.4851374626159668  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.39794921875 GB
    Memory Allocated: 18.275041103363037  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.39794921875 GB
    Memory Allocated: 18.277626037597656  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.39794921875 GB
    Memory Allocated: 0.49489307403564453  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.39794921875 GB
    Memory Allocated: 18.271350860595703  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.39794921875 GB
    Memory Allocated: 18.274024486541748  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.39794921875 GB
    Memory Allocated: 0.5043215751647949  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.39794921875 GB
    Memory Allocated: 18.286632537841797  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.39794921875 GB
    Memory Allocated: 18.28921413421631  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.39794921875 GB
    Memory Allocated: 0.5150485038757324  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.36669921875 GB
    Memory Allocated: 18.35307264328003  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.36669921875 GB
    Memory Allocated: 18.35561466217041  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.36669921875 GB
    Memory Allocated: 0.5239520072937012  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.36669921875 GB
    Memory Allocated: 18.257933139801025  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.36669921875 GB
    Memory Allocated: 18.260517597198486  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.36669921875 GB
    Memory Allocated: 0.5338397026062012  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.348273277282715  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.351667881011963  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 0.5429673194885254  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.313354969024658  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.315980434417725  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

number of input  13863584
----------------------------------------after optimizer
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 0.568753719329834  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.081026554107666
pure train time :  3.784977436065674
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.03679084777832031
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009795665740966797
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.038375139236450195
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.554412841796875
self.buckets_partition() spend  sec:  0.04821610450744629
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 0.42069482803344727  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.167880535125732  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.162513732910156  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 0.42382287979125977  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.191060543060303  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.193708896636963  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 0.4341135025024414  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.189874172210693  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.192636489868164  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 0.4451560974121094  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.238276481628418  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.24101734161377  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 0.45404720306396484  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.240355014801025  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.24295711517334  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 0.4641447067260742  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.25421142578125  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.256744861602783  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 0.4732232093811035  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.277686595916748  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.280230045318604  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 0.48381662368774414  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.267187118530273  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.26967763900757  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 0.49317502975463867  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.24631357192993  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 18.248772621154785  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.33349609375 GB
    Memory Allocated: 0.504673957824707  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 18.333538055419922  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 18.336355209350586  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 0.514350414276123  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 18.307681560516357  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 18.310443878173828  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 0.5238862037658691  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 18.27464199066162  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 18.277242183685303  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 0.5360593795776367  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 18.372741222381592  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 18.37538480758667  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 0.5437026023864746  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 18.29430103302002  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 18.296878337860107  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

number of input  13870267
----------------------------------------after optimizer
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 0.5710844993591309  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0034093856811523
pure train time :  3.5331156253814697
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.03563690185546875
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01033329963684082
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03724837303161621
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.5566484928131104
self.buckets_partition() spend  sec:  0.04761815071105957
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 0.42301464080810547  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 18.2160906791687  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 18.208251953125  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 0.42377138137817383  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 18.17117404937744  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 18.174331665039062  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 0.43579721450805664  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 18.23062229156494  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 18.233216285705566  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 0.44510650634765625  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 18.234731197357178  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 18.237409591674805  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30029296875 GB
    Memory Allocated: 0.45580577850341797  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30224609375 GB
    Memory Allocated: 18.221500396728516  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.30224609375 GB
    Memory Allocated: 18.224169731140137  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30224609375 GB
    Memory Allocated: 0.46639490127563477  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30224609375 GB
    Memory Allocated: 18.22769069671631  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.30224609375 GB
    Memory Allocated: 18.230259895324707  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.30224609375 GB
    Memory Allocated: 0.47718000411987305  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.301053524017334  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.303622722625732  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.48795604705810547  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.28815984725952  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.290765285491943  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.49800634384155273  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.294987678527832  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.297595977783203  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.5064730644226074  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.29780912399292  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.30041742324829  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.515803337097168  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.27068853378296  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.27319860458374  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.5278816223144531  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.324379920959473  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.326860427856445  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.5377817153930664  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.328433513641357  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.33124828338623  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.5468616485595703  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.368703365325928  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.3713436126709  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

number of input  13870411
----------------------------------------after optimizer
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.5753602981567383  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9620338082313538
pure train time :  3.51155161857605
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.03586101531982422
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009143590927124023
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.037453413009643555
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.543760061264038
self.buckets_partition() spend  sec:  0.046630859375
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.4247570037841797  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.229219436645508  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.220726490020752  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.4237809181213379  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.1860408782959  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.188499927520752  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.43538522720336914  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.21654462814331  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.219038486480713  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.44497060775756836  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.167848110198975  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.170307159423828  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.4545097351074219  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.186347484588623  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.189058780670166  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.4652223587036133  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.227838039398193  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.230299949645996  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.4768843650817871  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.27506446838379  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.277660846710205  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.48507213592529297  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.239505767822266  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.24210214614868  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.49568939208984375  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.27698040008545  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.279939651489258  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.5081624984741211  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.35063648223877  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.353459358215332  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.5168037414550781  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.34833812713623  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.350932121276855  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.527616024017334  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.340424060821533  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.342946529388428  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.5364851951599121  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.33429527282715  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 18.336817741394043  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.28662109375 GB
    Memory Allocated: 0.5482139587402344  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.331373691558838  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.33391046524048  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

number of input  13862305
----------------------------------------after optimizer
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.575871467590332  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9131242632865906
pure train time :  3.4723050594329834
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.03714418411254883
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011458873748779297
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.039144277572631836
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.582859516143799
self.buckets_partition() spend  sec:  0.05064272880554199
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4246973991394043  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.195043563842773  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.186011791229248  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.42499685287475586  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.207454681396484  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.210086345672607  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.43586158752441406  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.220855236053467  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.223401069641113  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4458141326904297  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.257346630096436  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.259828090667725  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.45682287216186523  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.288103103637695  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.29057741165161  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.46731042861938477  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.226794719696045  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.229590892791748  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.47831010818481445  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.256744861602783  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.260056495666504  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4880547523498535  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.256584644317627  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.25910186767578  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.49861907958984375  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.25384283065796  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.256662368774414  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5073637962341309  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.296266078948975  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.298754692077637  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5182342529296875  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.29543447494507  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.29844903945923  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5319576263427734  GigaBytes
Max Memory Allocated: 18.723771572113037  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.404085159301758  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.40654420852661  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5417084693908691  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.305835723876953  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.308416843414307  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5521693229675293  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.29204559326172  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.2946195602417  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

number of input  13864411
----------------------------------------after optimizer
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.579594612121582  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8799900412559509
pure train time :  3.6694393157958984
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.0359041690826416
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011291265487670898
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03789639472961426
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.572014331817627
self.buckets_partition() spend  sec:  0.0492253303527832
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4229874610900879  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.174034595489502  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.166805744171143  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.42583560943603516  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.206119060516357  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.20925807952881  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4348316192626953  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.217209815979004  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.219892024993896  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4467315673828125  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.27107572555542  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.273808002471924  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.455716609954834  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.245439052581787  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.248092651367188  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4659099578857422  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.25831413269043  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.26078176498413  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.47440195083618164  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.268514156341553  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.271096229553223  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.48319435119628906  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.227168083190918  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.230452060699463  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.49699926376342773  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.278700351715088  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.281511306762695  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5072021484375  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.301702976226807  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.304327964782715  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.517024040222168  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.2840838432312  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.286633014678955  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5276069641113281  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.33627700805664  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.338801860809326  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.536078929901123  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.301260948181152  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.303719997406006  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5469517707824707  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.32240343093872  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.324862003326416  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

number of input  13863061
----------------------------------------after optimizer
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5758295059204102  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8352983593940735
pure train time :  3.5168166160583496
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.03557324409484863
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009687662124633789
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03716564178466797
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.5752243995666504
self.buckets_partition() spend  sec:  0.04688835144042969
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4251236915588379  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.219501495361328  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.211466312408447  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.426572322845459  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.283511638641357  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.286617279052734  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.43361425399780273  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.18691873550415  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.189528465270996  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.44400835037231445  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.235507011413574  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.238155364990234  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.45516109466552734  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.287724494934082  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.290550708770752  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4632439613342285  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.216668128967285  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.219878673553467  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4734034538269043  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.287917613983154  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.290376663208008  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.48568153381347656  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.268887996673584  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.27163553237915  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.49584436416625977  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.30283546447754  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.305424690246582  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.504033088684082  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.263981342315674  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.266440391540527  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5180873870849609  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.28914499282837  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.291823387145996  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5277514457702637  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.288573741912842  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.291156768798828  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5375709533691406  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.359457969665527  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.362040996551514  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5461673736572266  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.267096996307373  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.27018404006958  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

number of input  13864683
----------------------------------------after optimizer
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5730686187744141  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7954040765762329
pure train time :  3.4688916206359863
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.035103559494018555
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010754585266113281
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03676629066467285
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.5435268878936768
self.buckets_partition() spend  sec:  0.047556161880493164
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.42265796661376953  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.200915813446045  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.193882942199707  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4228229522705078  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.174806594848633  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.177507400512695  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.43376588821411133  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.16696262359619  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.1700439453125  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.44629955291748047  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.28965473175049  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.292244911193848  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4540681838989258  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.232240676879883  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.235479831695557  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4679903984069824  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.28421449661255  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.286850929260254  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4775981903076172  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.256146907806396  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.258769035339355  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4887824058532715  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.28596544265747  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.288560390472412  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.49979543685913086  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.319337844848633  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.321932792663574  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.511345386505127  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.30814266204834  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.310640811920166  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5188384056091309  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.2885479927063  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.291046142578125  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5312972068786621  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.34913730621338  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.351723670959473  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5406360626220703  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.328636169433594  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.33175563812256  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5507373809814453  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.303670406341553  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.306789875030518  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

number of input  13869084
----------------------------------------after optimizer
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5775437355041504  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7638300657272339
pure train time :  3.4715874195098877
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.035262346267700195
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010308265686035156
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03685641288757324
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.5581889152526855
self.buckets_partition() spend  sec:  0.04720282554626465
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4232778549194336  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.196658611297607  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.19070863723755  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4243607521057129  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.187395572662354  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.190661907196045  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.43561363220214844  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.23306894302368  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.235616207122803  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4436054229736328  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.20878028869629  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.211239337921143  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4535236358642578  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.2409725189209  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.243618488311768  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4643988609313965  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.22577476501465  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.228358268737793  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.47502660751342773  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.286492347717285  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.288981914520264  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.48374223709106445  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.241265773773193  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.243724822998047  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.49083995819091797  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.198341369628906  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.200870037078857  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5013298988342285  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.245920658111572  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.248379707336426  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.512082576751709  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.321151733398438  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.32361078262329  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5205774307250977  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.25638484954834  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.2590970993042  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5323576927185059  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.313602447509766  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.31632375717163  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5423898696899414  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.343275547027588  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.34581422805786  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

number of input  13862014
----------------------------------------after optimizer
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5692315101623535  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7331950068473816
pure train time :  3.4927921295166016
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.03283119201660156
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009427309036254883
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.034432411193847656
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.570143699645996
self.buckets_partition() spend  sec:  0.04389333724975586
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4233684539794922  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.24784517288208  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.23999261856079  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.42347240447998047  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.17738676071167  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.18055248260498  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.43423986434936523  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.22874355316162  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.231462001800537  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4434022903442383  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.212067127227783  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.214890003204346  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.45435094833374023  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.25620937347412  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.258727550506592  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.46265506744384766  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.24875020980835  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.251315593719482  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4735703468322754  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.278236389160156  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.280755519866943  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4821162223815918  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.263598918914795  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.266118049621582  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.49553442001342773  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.305434226989746  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.308181285858154  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5041236877441406  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.250951766967773  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.253410816192627  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5152754783630371  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.312585830688477  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.31512451171875  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5262460708618164  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.33594799041748  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.338420391082764  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5345587730407715  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.31079339981079  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.313252449035645  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5471649169921875  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.31590223312378  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.3185133934021  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

number of input  13868938
----------------------------------------after optimizer
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5738801956176758  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6999432444572449
pure train time :  3.522042751312256
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
range partition time  0.03420829772949219
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009758949279785156
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.03583860397338867
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.58793568611145
self.buckets_partition() spend  sec:  0.04563140869140625
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.42409563064575195  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.180357933044434  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.17283296585083  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4268307685852051  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.213510036468506  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.216059684753418  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.43539857864379883  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.233970165252686  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.23650026321411  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.44612550735473633  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.287418365478516  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.289913654327393  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.4527573585510254  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.184001922607422  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.18673324584961  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.463986873626709  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.182374954223633  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.184834003448486  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.47314023971557617  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.215384483337402  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.217843532562256  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.48387813568115234  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.242430210113525  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.245705604553223  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.49836301803588867  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.32559633255005  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.328101634979248  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5080547332763672  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.298550128936768  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.301153659820557  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5185117721557617  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.360139846801758  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.36259889602661  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.527069091796875  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.317288398742676  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.319902420043945  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5383057594299316  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.3861985206604  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.389099597930908  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.547976016998291  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.312042713165283  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 18.314748764038086  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

number of input  13863390
----------------------------------------after optimizer
 Nvidia-smi: 23.29052734375 GB
    Memory Allocated: 0.5754833221435547  GigaBytes
Max Memory Allocated: 18.729602813720703  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6741669178009033
pure train time :  3.5547873973846436
epoch_time_list  [24.68155837059021, 22.115602731704712, 21.53984308242798, 21.75953984260559, 20.992793321609497, 22.28936195373535, 22.328994035720825, 21.157273769378662, 21.963066339492798, 21.761157512664795, 22.29654598236084, 20.988494873046875, 21.598692178726196, 20.81183958053589, 20.729608297348022, 20.99980854988098, 21.82666325569153, 21.58529496192932, 20.438351154327393, 20.818326711654663]

loading_time list   [0.5696382522583008, 0.596611499786377, 0.5321445465087891, 0.4427676200866699, 0.4285144805908203, 0.42418885231018066, 0.4830150604248047, 0.4070143699645996, 0.4121081829071045, 0.3849923610687256, 0.35056614875793457, 0.38503241539001465, 0.4581887722015381, 0.396777868270874, 0.27522826194763184, 0.3481760025024414, 0.38704633712768555, 0.3997044563293457, 0.24251866340637207, 0.3517599105834961]

 data loader gen time  13.650554895401001
	---backpack schedule time  [2.6051299571990967, 2.6133735179901123, 2.6386020183563232, 2.616442918777466, 2.581446886062622, 2.603801727294922, 2.644278049468994, 2.6284890174865723, 2.620880365371704, 2.635467767715454, 2.637033224105835, 2.618612289428711, 2.5920441150665283, 2.648012638092041, 2.635777473449707, 2.642836570739746, 2.5999557971954346, 2.6140003204345703, 2.6299471855163574, 2.6493029594421387]
	---connection_check_time_list  [7.569817066192627, 6.70160984992981, 6.196294069290161, 6.866955518722534, 6.294708967208862, 6.870542049407959, 7.4342262744903564, 6.205700159072876, 6.826390981674194, 6.336541652679443, 6.971781969070435, 6.101817846298218, 6.7690651416778564, 6.0961503982543945, 6.150968551635742, 6.25494909286499, 6.720695495605469, 6.603031396865845, 6.064481019973755, 6.160359621047974]
	---block_gen_time_list  [5.163455009460449, 4.795905113220215, 4.762909173965454, 4.528330326080322, 4.388951063156128, 4.875307559967041, 4.297269105911255, 4.53102445602417, 4.637167692184448, 4.71389627456665, 4.833216428756714, 4.398495435714722, 4.394439458847046, 4.203656911849976, 4.333269119262695, 4.458860397338867, 4.829380512237549, 4.6180713176727295, 4.154329061508179, 4.251202583312988]
training time  [8.162105321884155, 6.765614986419678, 6.789733171463013, 6.712531566619873, 6.687191486358643, 6.898858547210693, 6.841058969497681, 6.783093214035034, 6.860485315322876, 7.073176860809326, 6.902518272399902, 6.886702299118042, 6.765766143798828, 6.87701153755188, 6.730242967605591, 6.707552433013916, 6.688569068908691, 6.761898517608643, 6.7644362449646, 6.798141956329346]
---feature block loading time  [3.19368314743042, 3.350806474685669, 3.207761287689209, 3.3176350593566895, 3.092071056365967, 3.288090944290161, 3.2450644969940186, 3.141923189163208, 3.267204999923706, 3.1824324131011963, 3.2655866146087646, 3.2685015201568604, 3.1895346641540527, 3.1022021770477295, 3.1076011657714844, 3.132740020751953, 3.1069884300231934, 3.16395902633667, 3.14084529876709, 3.1386005878448486]


epoch_time avg   21.411642029881477
loading_time avg   0.3834270089864731
 data loader gen time avg 14.196323856711388
	---backpack schedule time avg 2.6238678991794586
	---connection_check_time avg  6.491338163614273
	---block_gen_time avg  4.494908586144447
training time  6.814168989658356
---feature block loading time  3.1770841628313065
pure train time per /epoch  [4.954664468765259, 3.30029296875, 3.466315507888794, 3.2795300483703613, 3.491908073425293, 3.504791259765625, 3.487201452255249, 3.5352776050567627, 3.4892473220825195, 3.784977436065674, 3.5331156253814697, 3.51155161857605, 3.4723050594329834, 3.6694393157958984, 3.5168166160583496, 3.4688916206359863, 3.4715874195098877, 3.4927921295166016, 3.522042751312256, 3.5547873973846436]
pure train time average  3.516838985330918
num_input list  [13873784, 13867578, 13863975, 13867187, 13860238, 13864460, 13869474, 13866639, 13863393, 13863584, 13870267, 13870411, 13862305, 13864411, 13863061, 13864683, 13869084, 13862014, 13868938, 13863390]
num_input  average  13865943.8
