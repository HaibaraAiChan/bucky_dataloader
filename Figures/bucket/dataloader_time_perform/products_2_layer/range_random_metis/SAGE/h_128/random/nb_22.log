main start at this time 1713139058.4085512
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012960195541381836
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004590272903442383
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.9981822967529297
self.buckets_partition() spend  sec:  0.01756882667541504
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.72412109375 GB
    Memory Allocated: 0.1918644905090332  GigaBytes
Max Memory Allocated: 0.1918644905090332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.38818359375 GB
    Memory Allocated: 7.69417142868042  GigaBytes
Max Memory Allocated: 7.791210174560547  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.38818359375 GB
    Memory Allocated: 7.6964826583862305  GigaBytes
Max Memory Allocated: 7.791210174560547  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.56787109375 GB
    Memory Allocated: 0.34253406524658203  GigaBytes
Max Memory Allocated: 7.791210174560547  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.20654296875 GB
    Memory Allocated: 12.60575819015503  GigaBytes
Max Memory Allocated: 12.819124698638916  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.20654296875 GB
    Memory Allocated: 12.607306957244873  GigaBytes
Max Memory Allocated: 12.819124698638916  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.20654296875 GB
    Memory Allocated: 0.34683895111083984  GigaBytes
Max Memory Allocated: 12.819124698638916  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.20654296875 GB
    Memory Allocated: 12.60119104385376  GigaBytes
Max Memory Allocated: 12.819124698638916  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.20654296875 GB
    Memory Allocated: 12.602739810943604  GigaBytes
Max Memory Allocated: 12.819124698638916  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.20654296875 GB
    Memory Allocated: 0.35315799713134766  GigaBytes
Max Memory Allocated: 12.819124698638916  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.20654296875 GB
    Memory Allocated: 12.61721420288086  GigaBytes
Max Memory Allocated: 12.82982587814331  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.20654296875 GB
    Memory Allocated: 12.619005680084229  GigaBytes
Max Memory Allocated: 12.82982587814331  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.20654296875 GB
    Memory Allocated: 0.35871076583862305  GigaBytes
Max Memory Allocated: 12.82982587814331  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.88232421875 GB
    Memory Allocated: 12.618264198303223  GigaBytes
Max Memory Allocated: 12.830962657928467  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.88232421875 GB
    Memory Allocated: 12.619961738586426  GigaBytes
Max Memory Allocated: 12.830962657928467  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.88232421875 GB
    Memory Allocated: 0.3657045364379883  GigaBytes
Max Memory Allocated: 12.830962657928467  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.56982421875 GB
    Memory Allocated: 12.65597152709961  GigaBytes
Max Memory Allocated: 12.868559837341309  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.56982421875 GB
    Memory Allocated: 12.657685279846191  GigaBytes
Max Memory Allocated: 12.868559837341309  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.56982421875 GB
    Memory Allocated: 0.37241220474243164  GigaBytes
Max Memory Allocated: 12.868559837341309  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.693010807037354  GigaBytes
Max Memory Allocated: 12.905702590942383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.694839477539062  GigaBytes
Max Memory Allocated: 12.905702590942383  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 0.37686586380004883  GigaBytes
Max Memory Allocated: 12.905702590942383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.706354141235352  GigaBytes
Max Memory Allocated: 12.918985366821289  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.707883834838867  GigaBytes
Max Memory Allocated: 12.918985366821289  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 0.3823370933532715  GigaBytes
Max Memory Allocated: 12.918985366821289  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.70664119720459  GigaBytes
Max Memory Allocated: 12.919275760650635  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.708170890808105  GigaBytes
Max Memory Allocated: 12.919275760650635  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 0.3876528739929199  GigaBytes
Max Memory Allocated: 12.919275760650635  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.650407314300537  GigaBytes
Max Memory Allocated: 12.919275760650635  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.651977062225342  GigaBytes
Max Memory Allocated: 12.919275760650635  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 0.39267683029174805  GigaBytes
Max Memory Allocated: 12.919275760650635  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.641449928283691  GigaBytes
Max Memory Allocated: 12.919275760650635  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.643218994140625  GigaBytes
Max Memory Allocated: 12.919275760650635  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 0.3999171257019043  GigaBytes
Max Memory Allocated: 12.919275760650635  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.677515506744385  GigaBytes
Max Memory Allocated: 12.919275760650635  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.6790452003479  GigaBytes
Max Memory Allocated: 12.919275760650635  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 0.4032731056213379  GigaBytes
Max Memory Allocated: 12.919275760650635  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.6618070602417  GigaBytes
Max Memory Allocated: 12.919275760650635  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.66356611251831  GigaBytes
Max Memory Allocated: 12.919275760650635  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 0.4106416702270508  GigaBytes
Max Memory Allocated: 12.919275760650635  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.736261367797852  GigaBytes
Max Memory Allocated: 12.948989391326904  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.7378830909729  GigaBytes
Max Memory Allocated: 12.948989391326904  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 0.41633129119873047  GigaBytes
Max Memory Allocated: 12.948989391326904  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.704990863800049  GigaBytes
Max Memory Allocated: 12.948989391326904  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.706612586975098  GigaBytes
Max Memory Allocated: 12.948989391326904  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 0.42243051528930664  GigaBytes
Max Memory Allocated: 12.948989391326904  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.748063087463379  GigaBytes
Max Memory Allocated: 12.960705280303955  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.749592781066895  GigaBytes
Max Memory Allocated: 12.960705280303955  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 0.4262399673461914  GigaBytes
Max Memory Allocated: 12.960705280303955  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.708932399749756  GigaBytes
Max Memory Allocated: 12.960705280303955  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.710462093353271  GigaBytes
Max Memory Allocated: 12.960705280303955  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 0.43372678756713867  GigaBytes
Max Memory Allocated: 12.960705280303955  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.76181173324585  GigaBytes
Max Memory Allocated: 12.97458028793335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.763346672058105  GigaBytes
Max Memory Allocated: 12.97458028793335  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 0.43697023391723633  GigaBytes
Max Memory Allocated: 12.97458028793335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.702910423278809  GigaBytes
Max Memory Allocated: 12.97458028793335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.704445362091064  GigaBytes
Max Memory Allocated: 12.97458028793335  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 0.4442014694213867  GigaBytes
Max Memory Allocated: 12.97458028793335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.72938871383667  GigaBytes
Max Memory Allocated: 12.97458028793335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.73111343383789  GigaBytes
Max Memory Allocated: 12.97458028793335  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 0.44921875  GigaBytes
Max Memory Allocated: 12.97458028793335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.773067951202393  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.774675369262695  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 0.4536290168762207  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.700031757354736  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 12.701639175415039  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

number of input  17592022
----------------------------------------after optimizer
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 0.47328710556030273  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.2103495597839355
pure train time :  3.6924500465393066
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011931180953979492
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004756927490234375
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.9591071605682373
self.buckets_partition() spend  sec:  0.016707658767700195
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.24755859375 GB
    Memory Allocated: 0.21719646453857422  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 7.717767238616943  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 7.714483261108398  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.3459138870239258  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.669302463531494  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.670910835266113  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.34864330291748047  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.607212543487549  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.608820915222168  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.3561420440673828  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.639071941375732  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.640601634979248  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.36171865463256836  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.686142921447754  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.68767261505127  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.367983341217041  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.656954288482666  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.658582210540771  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.37310266494750977  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.653483867645264  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.655203342437744  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.3773818016052246  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.639817237854004  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.641467571258545  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.3834996223449707  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.660029888153076  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.661805629730225  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.3898177146911621  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.671680927276611  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.673346042633057  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.3955717086791992  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.679516315460205  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.681145668029785  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.39978647232055664  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.662775993347168  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.664505004882812  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.40696287155151367  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.735457420349121  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.737033367156982  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.41086816787719727  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.687396049499512  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.688971996307373  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.41774797439575195  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.702648162841797  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.704194068908691  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.42125558853149414  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.668406009674072  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.670027256011963  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.4293785095214844  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.717151165008545  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.71888256072998  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.43490028381347656  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.759254455566406  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.76089096069336  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.44005632400512695  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.727604389190674  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.729240894317627  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.4453864097595215  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.731228351593018  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.732929706573486  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.45011329650878906  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.720826625823975  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.722364902496338  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.45618581771850586  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.77253532409668  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.774209022521973  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

number of input  17585909
----------------------------------------after optimizer
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.47377729415893555  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.480919361114502
pure train time :  2.583454132080078
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011754751205444336
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.00516510009765625
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.0075461864471436
self.buckets_partition() spend  sec:  0.01694035530090332
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.2168736457824707  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 7.718094825744629  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 7.714808464050293  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.3461422920227051  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.66990613937378  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.671516418457031  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.35042285919189453  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.63548755645752  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.637097835540771  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.35559988021850586  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.60788106918335  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.609611988067627  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.3612494468688965  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.633848667144775  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.6354079246521  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.3683967590332031  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.694265842437744  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.695878028869629  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.371978759765625  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.665221691131592  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 12.666833877563477  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.25537109375 GB
    Memory Allocated: 0.37941789627075195  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.710781574249268  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.712311267852783  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.38533973693847656  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.706801414489746  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.708444118499756  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.3891124725341797  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.645514965057373  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.647157669067383  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.39487123489379883  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.673720836639404  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.675470352172852  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.39960193634033203  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.684865951538086  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.68657398223877  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.405332088470459  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.673318862915039  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.674944877624512  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.4117612838745117  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.698328971862793  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.700016975402832  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.417417049407959  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.663128852844238  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.664816856384277  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.42279624938964844  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.705894947052002  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.707636833190918  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.4287419319152832  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.753180027008057  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.754767894744873  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.4338698387145996  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.70504903793335  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.706636905670166  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.43985843658447266  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.719666481018066  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.721268653869629  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.4445152282714844  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.724197387695312  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.725916862487793  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.45130062103271484  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.738383769989014  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.740034580230713  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.4568185806274414  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.73700475692749  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.738545894622803  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

number of input  17589649
----------------------------------------after optimizer
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.47406721115112305  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.729396104812622
pure train time :  2.411390542984009
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013536214828491211
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.006561994552612305
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.024944543838501
self.buckets_partition() spend  sec:  0.020121097564697266
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.21574115753173828  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 7.715997219085693  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 7.712710857391357  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.34467315673828125  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.623157024383545  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.624924659729004  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.349764347076416  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.61082935333252  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.612596988677979  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.35575342178344727  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.681639671325684  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.683383464813232  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.36123132705688477  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.68362283706665  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.685152530670166  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.3678779602050781  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.698484420776367  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.700868606567383  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.37052202224731445  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.623141288757324  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.624748706817627  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.37818193435668945  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.640845775604248  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.642704486846924  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.38290977478027344  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.653175830841064  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.654781341552734  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.3901824951171875  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.709998607635498  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.711638450622559  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.39559459686279297  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.672254085540771  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.673796653747559  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.40049028396606445  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.679214477539062  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.68099594116211  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.40622949600219727  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.688546657562256  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.690079689025879  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.41261768341064453  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.734332084655762  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.735874652862549  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.41753053665161133  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.740846633911133  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.74238920211792  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.4234647750854492  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.749839305877686  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.751368999481201  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.4276595115661621  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.674501419067383  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.676043033599854  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.4342799186706543  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.715023517608643  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.717403411865234  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.44054412841796875  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.72701644897461  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.728639125823975  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.44654273986816406  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.766571521759033  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.76816987991333  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.45131635665893555  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.707616329193115  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.709262371063232  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.4581031799316406  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.746945858001709  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 12.749269485473633  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

number of input  17593443
----------------------------------------after optimizer
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.4752993583679199  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.2367961406707764
pure train time :  2.5948984622955322
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012769222259521484
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0060536861419677734
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.00426721572876
self.buckets_partition() spend  sec:  0.018846511840820312
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94482421875 GB
    Memory Allocated: 0.2168889045715332  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 7.718080520629883  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 7.714793682098389  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.34578943252563477  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.662839889526367  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.664487361907959  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.34986400604248047  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.63683271408081  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.638480186462402  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.35587358474731445  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.68662977218628  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.688234806060791  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.3602609634399414  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.634879112243652  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.636484146118164  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.3677940368652344  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.664735317230225  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.66626501083374  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.37342262268066406  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.696269989013672  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.697799682617188  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.37926292419433594  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.704841136932373  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.706370830535889  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.38396167755126953  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.657981872558594  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.659553050994873  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.39049816131591797  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.718887329101562  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.720460891723633  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.39314937591552734  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.622146129608154  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.623719692230225  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.40126705169677734  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.72443437576294  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.725964069366455  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.4058384895324707  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.664861679077148  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.666442394256592  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.41162586212158203  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.687138557434082  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.688673973083496  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.4184756278991699  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.697120666503906  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.698854923248291  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.4239773750305176  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.74347448348999  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.74509572982788  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.42809247970581055  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.695243835449219  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.69686508178711  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.4330716133117676  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.710864543914795  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.712642669677734  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.43994665145874023  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.696488380432129  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.698260307312012  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.4460320472717285  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.733101844787598  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.734765529632568  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.4512057304382324  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.743717193603516  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.74533224105835  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.45580005645751953  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.706448078155518  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.708402633666992  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

number of input  17591374
----------------------------------------after optimizer
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.4735383987426758  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7788233757019043
pure train time :  2.574824094772339
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010141372680664062
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005965232849121094
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.01633095741272
self.buckets_partition() spend  sec:  0.016127586364746094
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.21715259552001953  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 7.7178120613098145  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 7.714527606964111  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.3457202911376953  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.622721195220947  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.624473571777344  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.35067176818847656  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.676398277282715  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.678000450134277  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.3551445007324219  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.618848323822021  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.620450496673584  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.3611764907836914  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.615723133087158  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.617452144622803  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.36767101287841797  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.69342851638794  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.694958209991455  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.3729848861694336  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.646233558654785  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.64786672592163  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.37769174575805664  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.6571683883667  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.658698081970215  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.3844141960144043  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.704488277435303  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.706776142120361  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.38942384719848633  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.689332485198975  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.690967082977295  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.3944563865661621  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.663951873779297  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.665611267089844  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.3997988700866699  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.674973487854004  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.676752090454102  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.4052457809448242  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.674500942230225  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.676208972930908  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.4113030433654785  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.689137935638428  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.690907001495361  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.4165334701538086  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.66358232498169  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.665351390838623  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.4229245185852051  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.740914821624756  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.742491722106934  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.42857933044433594  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.7150297164917  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.716649055480957  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.4349226951599121  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.728732585906982  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.730432033538818  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.4400296211242676  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.761410236358643  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.763041973114014  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.4455447196960449  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.767527103424072  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.769056797027588  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.45052671432495117  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.736232280731201  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.7378568649292  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.4561896324157715  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.699055671691895  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.700756072998047  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

number of input  17581194
----------------------------------------after optimizer
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.47383785247802734  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5532819032669067
pure train time :  2.6387274265289307
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013602733612060547
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005269289016723633
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.035461664199829
self.buckets_partition() spend  sec:  0.018892765045166016
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.2171492576599121  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 7.717813491821289  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 7.714529991149902  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.3440589904785156  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.607521057128906  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.609271049499512  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.3498392105102539  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.644944667816162  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.646657466888428  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.35460805892944336  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.623333930969238  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.62511682510376  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.3619217872619629  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.689883708953857  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.691413402557373  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.366058349609375  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.629323482513428  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.630853176116943  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.37403440475463867  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.661894798278809  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.66358995437622  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.37815427780151367  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.667759895324707  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 12.66938066482544  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.94677734375 GB
    Memory Allocated: 0.38599157333374023  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.59521484375 GB
    Memory Allocated: 12.728103160858154  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.59521484375 GB
    Memory Allocated: 12.729719638824463  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.59521484375 GB
    Memory Allocated: 0.38968563079833984  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.59912109375 GB
    Memory Allocated: 12.695764541625977  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.59912109375 GB
    Memory Allocated: 12.697393894195557  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.59912109375 GB
    Memory Allocated: 0.39456796646118164  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.60888671875 GB
    Memory Allocated: 12.681009292602539  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.60888671875 GB
    Memory Allocated: 12.682788848876953  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.60888671875 GB
    Memory Allocated: 0.4011869430541992  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.61083984375 GB
    Memory Allocated: 12.691381454467773  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.61083984375 GB
    Memory Allocated: 12.693130016326904  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.61083984375 GB
    Memory Allocated: 0.4058995246887207  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.61279296875 GB
    Memory Allocated: 12.700024127960205  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.61279296875 GB
    Memory Allocated: 12.701627254486084  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.61279296875 GB
    Memory Allocated: 0.41309642791748047  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.62451171875 GB
    Memory Allocated: 12.726400375366211  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.62451171875 GB
    Memory Allocated: 12.727965354919434  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.62451171875 GB
    Memory Allocated: 0.4169740676879883  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.64990234375 GB
    Memory Allocated: 12.714214324951172  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.64990234375 GB
    Memory Allocated: 12.715776920318604  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.64990234375 GB
    Memory Allocated: 0.42227888107299805  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.64990234375 GB
    Memory Allocated: 12.664463996887207  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.64990234375 GB
    Memory Allocated: 12.666104793548584  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.64990234375 GB
    Memory Allocated: 0.42948055267333984  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.64990234375 GB
    Memory Allocated: 12.70661449432373  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.64990234375 GB
    Memory Allocated: 12.708414554595947  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.64990234375 GB
    Memory Allocated: 0.43369483947753906  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.64990234375 GB
    Memory Allocated: 12.704023838043213  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.64990234375 GB
    Memory Allocated: 12.70587682723999  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.64990234375 GB
    Memory Allocated: 0.44257545471191406  GigaBytes
Max Memory Allocated: 12.985724925994873  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.65771484375 GB
    Memory Allocated: 12.779228687286377  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.65771484375 GB
    Memory Allocated: 12.781225204467773  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.65771484375 GB
    Memory Allocated: 0.4466557502746582  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.67919921875 GB
    Memory Allocated: 12.748433589935303  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.67919921875 GB
    Memory Allocated: 12.750056266784668  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.67919921875 GB
    Memory Allocated: 0.45072364807128906  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.68701171875 GB
    Memory Allocated: 12.725265502929688  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.68701171875 GB
    Memory Allocated: 12.726806640625  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.68701171875 GB
    Memory Allocated: 0.4568595886230469  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.69287109375 GB
    Memory Allocated: 12.71088695526123  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.69287109375 GB
    Memory Allocated: 12.712831497192383  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

number of input  17595786
----------------------------------------after optimizer
 Nvidia-smi: 13.69287109375 GB
    Memory Allocated: 0.4740328788757324  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3928591012954712
pure train time :  2.890537738800049
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010901212692260742
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005760908126831055
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.006348133087158
self.buckets_partition() spend  sec:  0.016682147979736328
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.69287109375 GB
    Memory Allocated: 0.21571779251098633  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.80810546875 GB
    Memory Allocated: 7.6778154373168945  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.80810546875 GB
    Memory Allocated: 7.67453145980835  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.80810546875 GB
    Memory Allocated: 0.345761775970459  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.654864311218262  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.656481266021729  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.3496694564819336  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.626657485961914  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.628419399261475  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.3549833297729492  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.633808135986328  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.635360717773438  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.36104583740234375  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.6482253074646  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.649881362915039  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.3669137954711914  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.644888401031494  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.646487712860107  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.37351226806640625  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.67030668258667  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.67185926437378  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.37789201736450195  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.700659275054932  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.702352523803711  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.38372278213500977  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.68260145187378  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.684141635894775  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.3921027183532715  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.724931240081787  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.7270188331604  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.3958396911621094  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.688708782196045  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.690472602844238  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.4001188278198242  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.658122062683105  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.659885883331299  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.40561580657958984  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.674499988555908  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.676672458648682  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.41164064407348633  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.699851036071777  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.70182180404663  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.41762638092041016  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.73286247253418  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.73471975326538  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.42308950424194336  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.712937831878662  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.714510917663574  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.4277071952819824  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.710266590118408  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.711796283721924  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.4320049285888672  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.683807373046875  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.685539722442627  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.44004249572753906  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.724374294281006  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.726140022277832  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.44588565826416016  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.735888004302979  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.737507820129395  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.45343494415283203  GigaBytes
Max Memory Allocated: 12.991519927978516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.784344673156738  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.78644847869873  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.4561018943786621  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.716271877288818  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 12.718183994293213  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

number of input  17584308
----------------------------------------after optimizer
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.47320127487182617  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2703514099121094
pure train time :  2.606668710708618
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01191568374633789
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005575418472290039
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.027802228927612
self.buckets_partition() spend  sec:  0.017510652542114258
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48583984375 GB
    Memory Allocated: 0.2160663604736328  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 7.6801228523254395  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 7.6768388748168945  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 0.34481239318847656  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 12.618581295013428  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 12.62045669555664  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 0.3499736785888672  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 12.635435104370117  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 12.63716173171997  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 0.3544583320617676  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 12.605457305908203  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 12.607428550720215  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 0.36307382583618164  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 12.664259910583496  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 12.666463375091553  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 0.36659717559814453  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 12.652946949005127  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 12.654589176177979  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 0.3725447654724121  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 12.692397117614746  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 12.69473648071289  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.48779296875 GB
    Memory Allocated: 0.3814816474914551  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.734141826629639  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.73569917678833  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3833131790161133  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.660604476928711  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.662161827087402  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3889284133911133  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.67723274230957  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.679445266723633  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3936166763305664  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.65000295639038  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.651737213134766  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4000425338745117  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.69101333618164  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.693415641784668  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.40486717224121094  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.673155307769775  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.674903392791748  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4118490219116211  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.706683158874512  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.708397388458252  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4182281494140625  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.720685958862305  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.722357749938965  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.42333364486694336  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.70114803314209  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.702677726745605  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4285421371459961  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.73762845993042  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.739211082458496  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.43479299545288086  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.73640489578247  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.737987518310547  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4401073455810547  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.756534099578857  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.758114337921143  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4454679489135742  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.719992637634277  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.721572875976562  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.45210886001586914  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.753574848175049  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.755852699279785  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.45642757415771484  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.731400966644287  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.733057975769043  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

number of input  17587308
----------------------------------------after optimizer
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.47403430938720703  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1768386363983154
pure train time :  2.564636468887329
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010712623596191406
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005461215972900391
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.0224387645721436
self.buckets_partition() spend  sec:  0.01625800132751465
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.2162337303161621  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.680080413818359  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.676795482635498  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.34412288665771484  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.62875509262085  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.630504608154297  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3494715690612793  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.632625102996826  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.634251594543457  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3553624153137207  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.65609884262085  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.657793998718262  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3607497215270996  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.636020183563232  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.637649536132812  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3675374984741211  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.653489589691162  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.655019283294678  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.37335872650146484  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.663169860839844  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.664896488189697  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3770933151245117  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.632864952087402  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.634606838226318  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.384002685546875  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.703016757965088  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.704695701599121  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.38959836959838867  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.651804447174072  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.653350353240967  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3962888717651367  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.712026596069336  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.713932037353516  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4007730484008789  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.694529056549072  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.696111679077148  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4071159362792969  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.709654808044434  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.71132516860962  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4120793342590332  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.701188087463379  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.702858448028564  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4181952476501465  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.73305892944336  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.734661102294922  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4236764907836914  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.724356174468994  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.72593879699707  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.42779541015625  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.685892105102539  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.687547206878662  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4337458610534668  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.694790840148926  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.697099208831787  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.44080209732055664  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.739248752593994  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.740912914276123  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.44605207443237305  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.738544940948486  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.74029016494751  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4507622718811035  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.749022483825684  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.750595092773438  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.45652103424072266  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.726553916931152  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.72812032699585  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

number of input  17591326
----------------------------------------after optimizer
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4739370346069336  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0850826501846313
pure train time :  2.597424030303955
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009228706359863281
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005418300628662109
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.006623983383179
self.buckets_partition() spend  sec:  0.014684438705444336
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.21590328216552734  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.681818962097168  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.678534030914307  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.34577369689941406  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.631085872650146  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.632880210876465  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.35068702697753906  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.634835720062256  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.63661813735962  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.35486602783203125  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.638548851013184  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.640215873718262  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.36268043518066406  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.681204795837402  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.682794570922852  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3659219741821289  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.620298862457275  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.621888637542725  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3727130889892578  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.671350479125977  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.672922134399414  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3779301643371582  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.673040390014648  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.674738883972168  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3850283622741699  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.701484203338623  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.703033924102783  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3884696960449219  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.702552318572998  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.704102039337158  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3945193290710449  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.673362255096436  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.674959659576416  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4010777473449707  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.698791980743408  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.700505256652832  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.40581512451171875  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.689560890197754  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.691274166107178  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.41069746017456055  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.65877389907837  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.660356998443604  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4178466796875  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.705501079559326  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.70732593536377  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4222745895385742  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.685550689697266  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.687350749969482  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4287548065185547  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.74884843826294  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.750470638275146  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4330635070800781  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.732850074768066  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.73439645767212  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4402785301208496  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.720382690429688  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.722127914428711  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4446678161621094  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.69548225402832  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.697439193725586  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4516458511352539  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.775869369506836  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.777566909790039  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4576706886291504  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.72864055633545  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.73020315170288  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

number of input  17586473
----------------------------------------after optimizer
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.475252628326416  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0031472444534302
pure train time :  2.585735559463501
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01872849464416504
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.006357669830322266
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.070231676101685
self.buckets_partition() spend  sec:  0.025107383728027344
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.2159595489501953  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.679455280303955  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.676170349121094  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.34456586837768555  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.61491584777832  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.616535186767578  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3503541946411133  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.63298225402832  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.634600162506104  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.356109619140625  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.675364971160889  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.677197933197021  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3621349334716797  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.68159008026123  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.68340015411377  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.36766672134399414  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.661383152008057  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.662946701049805  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3730044364929199  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.67467975616455  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.676304340362549  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3788795471191406  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.700441360473633  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.702186584472656  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.38344383239746094  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.690117359161377  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.691668033599854  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3898749351501465  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.679661273956299  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.681268215179443  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.39568471908569336  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.704777240753174  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.706863403320312  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4010920524597168  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.7030668258667  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.704837322235107  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.40641164779663086  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.702908515930176  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.704512596130371  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.41091060638427734  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.70077133178711  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.702474594116211  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.41767120361328125  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.694353580474854  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.696072101593018  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.42304086685180664  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.715498447418213  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.717249870300293  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4293060302734375  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.71373462677002  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.715477466583252  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.43462562561035156  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.740217208862305  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.74241304397583  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.43907880783081055  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.700872898101807  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.702513694763184  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.44489002227783203  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.72839069366455  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.730068683624268  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.45170116424560547  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.7401123046875  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.742573738098145  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4561467170715332  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.706755638122559  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.708494663238525  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

number of input  17596417
----------------------------------------after optimizer
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4737429618835449  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.953117311000824
pure train time :  2.561501979827881
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011221647262573242
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005345344543457031
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.080582618713379
self.buckets_partition() spend  sec:  0.016588926315307617
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.2162003517150879  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.678955554962158  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.675671577453613  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.34458160400390625  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.639214992523193  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.6409273147583  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.34817934036254883  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.59831953048706  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.599882125854492  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3558797836303711  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.657411575317383  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.659026145935059  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.36188268661499023  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.663670063018799  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.665284633636475  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3670535087585449  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.678174495697021  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.680349826812744  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3736143112182617  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.689216613769531  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.690937519073486  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3781290054321289  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.679153442382812  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.680699348449707  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3840312957763672  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.678995609283447  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.680525779724121  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3887810707092285  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.641649723052979  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.643360137939453  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.39449024200439453  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.652154922485352  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.6544828414917  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.40084123611450195  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.711676597595215  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.713318347930908  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4051785469055176  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.706136226654053  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.707687377929688  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4122753143310547  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.700633525848389  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.702319145202637  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4173312187194824  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.701266288757324  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.702996730804443  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.42293882369995117  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.701714038848877  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.703343391418457  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.42738819122314453  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.66536808013916  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.667096614837646  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4345574378967285  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.731385707855225  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.732923984527588  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4410405158996582  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.728734970092773  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.730441093444824  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.44524478912353516  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.735275268554688  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.736989974975586  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.45074462890625  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.740095138549805  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.741846561431885  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4584784507751465  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.769711017608643  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.771437644958496  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

number of input  17587255
----------------------------------------after optimizer
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.47583532333374023  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.910736083984375
pure train time :  2.5398266315460205
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012896537780761719
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005648136138916016
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.004140377044678
self.buckets_partition() spend  sec:  0.018565654754638672
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.21608209609985352  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.680293083190918  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.677005290985107  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3461003303527832  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.638579845428467  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.640345573425293  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.349428653717041  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.634476661682129  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.636242389678955  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.35576772689819336  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.644550323486328  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.646115779876709  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3596372604370117  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.61361837387085  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.615548133850098  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3671269416809082  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.64726972579956  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.648898601531982  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.37297868728637695  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.69686222076416  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.698400974273682  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.37900304794311523  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.690775394439697  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.69236421585083  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.38245630264282227  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.630218505859375  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.631825923919678  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3892631530761719  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.676313400268555  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.677898406982422  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3950309753417969  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.696015357971191  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.69768762588501  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.39980077743530273  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.682744979858398  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.684417247772217  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4072089195251465  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.718359470367432  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.719953536987305  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4123497009277344  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.720833778381348  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.722767353057861  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4201517105102539  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.75254201889038  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.7545804977417  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.42160892486572266  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.68481731414795  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.686649322509766  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.42851686477661133  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.72011661529541  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.721826553344727  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.43448352813720703  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.71887731552124  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.720566272735596  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.43985700607299805  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.73392915725708  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.735654354095459  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4452199935913086  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.738062858581543  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.739725112915039  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.45137643814086914  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.735750198364258  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.737481594085693  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.45736074447631836  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.756404399871826  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.758111953735352  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

number of input  17589332
----------------------------------------after optimizer
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.47473859786987305  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8758432269096375
pure train time :  2.5294365882873535
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010258913040161133
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005286693572998047
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.004727363586426
self.buckets_partition() spend  sec:  0.015563011169433594
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.2160930633544922  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.6802239418029785  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.676937103271484  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.34523582458496094  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.645359516143799  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.647003650665283  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3517794609069824  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.675617218017578  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.677164077758789  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3555779457092285  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.644392490386963  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.645939350128174  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.36148595809936523  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.660358428955078  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.662001132965088  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3657646179199219  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.625494956970215  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.627402305603027  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.37239503860473633  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.643563270568848  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.645544052124023  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3797926902770996  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.683347702026367  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.685539722442627  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3836073875427246  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.65669870376587  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.65833854675293  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.39021873474121094  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.714268684387207  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.71597957611084  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3960990905761719  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.695432186126709  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.697107315063477  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.40029287338256836  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.700047016143799  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.701961994171143  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4067249298095703  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.697299003601074  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.698954105377197  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4122180938720703  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.70095157623291  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.702715873718262  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.41734933853149414  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.68514347076416  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.686903953552246  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.42253541946411133  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.680269718170166  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.682191371917725  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.42822790145874023  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.699894428253174  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.701886177062988  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.433321475982666  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.673288345336914  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.675154685974121  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.43969202041625977  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.708756446838379  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.71082592010498  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4469766616821289  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.757514476776123  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.75969934463501  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.45017433166503906  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.733639240264893  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.735277652740479  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4554715156555176  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.702420234680176  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.704175472259521  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

number of input  17589132
----------------------------------------after optimizer
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.47310733795166016  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8331106901168823
pure train time :  2.557812213897705
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010285377502441406
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005076169967651367
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.9912843704223633
self.buckets_partition() spend  sec:  0.01538228988647461
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.2163248062133789  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.679934978485107  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.6766510009765625  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.34566593170166016  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.648343563079834  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.649994373321533  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.34824466705322266  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.627906322479248  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.629557132720947  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.35570573806762695  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.633062362670898  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.63478946685791  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.36121606826782227  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.632731437683105  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.634464263916016  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3655529022216797  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.659228324890137  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.660953521728516  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.372530460357666  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.656930923461914  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.658719062805176  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3792128562927246  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.689047813415527  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.690650939941406  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.38442277908325195  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.713696956634521  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.715834617614746  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.38887596130371094  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.68018102645874  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.68190336227417  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.39609766006469727  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.701776504516602  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.703946590423584  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.39957523345947266  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.690742492675781  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.692378044128418  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.40441417694091797  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.642927169799805  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.644670009613037  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.41106510162353516  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.675073623657227  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.676619529724121  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.41840171813964844  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.729400157928467  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.731517791748047  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.42284297943115234  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.707131385803223  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.708756446838379  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.42922353744506836  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.752935409545898  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.75449514389038  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.43421220779418945  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.716652393341064  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.718293190002441  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.43977832794189453  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.741569519042969  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.743255615234375  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4456667900085449  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.7267484664917  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.728532314300537  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4500250816345215  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.700390338897705  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.702070236206055  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.45665407180786133  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.75040864944458  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.752191066741943  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

number of input  17578950
----------------------------------------after optimizer
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.47411203384399414  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7957923412322998
pure train time :  2.577059030532837
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012665748596191406
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0057239532470703125
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.04587459564209
self.buckets_partition() spend  sec:  0.018410921096801758
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.21584463119506836  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.677797794342041  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.674511432647705  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.34557580947875977  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.629473686218262  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.631251335144043  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3493680953979492  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.632503509521484  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.634087562561035  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3566617965698242  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.6773099899292  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.67890453338623  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.36054563522338867  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.650337219238281  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.651931762695312  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3674001693725586  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.683499336242676  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.685052394866943  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.37189197540283203  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.626415729522705  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.627968788146973  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.37915706634521484  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.687446594238281  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.689125537872314  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.38352203369140625  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.652542114257812  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.654221057891846  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.389401912689209  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.681314468383789  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.683067798614502  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3948245048522949  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.712513446807861  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.714106559753418  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.400362491607666  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.690139293670654  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.691732406616211  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.405517578125  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.678810119628906  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.680524826049805  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4103975296020508  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.660403728485107  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.662245750427246  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.41771984100341797  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.690447330474854  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.692074298858643  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.42325878143310547  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.729815006256104  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.731449604034424  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.42831897735595703  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.704497814178467  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.706132411956787  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.43488216400146484  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.733479499816895  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.73585319519043  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4411020278930664  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.758096694946289  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.759955883026123  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4453549385070801  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.721922874450684  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.723496437072754  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4517989158630371  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.739471435546875  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.741211414337158  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4559493064880371  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.73616075515747  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.737900733947754  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

number of input  17587700
----------------------------------------after optimizer
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.473233699798584  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7629973292350769
pure train time :  2.7831034660339355
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011893510818481445
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005594730377197266
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.4146692752838135
self.buckets_partition() spend  sec:  0.017512798309326172
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.21586084365844727  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.6803297996521  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.67704439163208  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3464646339416504  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.664145469665527  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.665695667266846  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.35015010833740234  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.666957378387451  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.66852331161499  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.35607147216796875  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.642857551574707  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.644412994384766  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.360687255859375  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.619873523712158  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.621609210968018  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3666543960571289  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.649030208587646  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.650837898254395  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3730030059814453  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.667869567871094  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.66987657546997  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.37700414657592773  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.649444580078125  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.651115894317627  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3832435607910156  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.675251483917236  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.67696237564087  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.38994359970092773  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.674510478973389  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.676192283630371  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3953104019165039  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.699443817138672  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.7017240524292  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4010801315307617  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.687201023101807  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.688902378082275  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.40978240966796875  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.754172325134277  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.75577163696289  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4109654426574707  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.680805206298828  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.682382106781006  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.41699886322021484  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.711795330047607  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.713341236114502  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4229888916015625  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.69927978515625  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.700918197631836  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.428555965423584  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.717355728149414  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.719119548797607  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4342947006225586  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.720336437225342  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.722107410430908  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4378476142883301  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.680605411529541  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.682569026947021  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4459514617919922  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.745876789093018  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.747406482696533  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.45124340057373047  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.737493515014648  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.739213466644287  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4567141532897949  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.712286472320557  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.71403694152832  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

number of input  17589195
----------------------------------------after optimizer
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4740309715270996  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7264647483825684
pure train time :  2.788923740386963
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011196613311767578
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.006048440933227539
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.076506853103638
self.buckets_partition() spend  sec:  0.01727771759033203
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.21592950820922852  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.677689552307129  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.674405097961426  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3449363708496094  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.646951675415039  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.6486496925354  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3516545295715332  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.663653373718262  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.665547370910645  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.35446929931640625  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.628772258758545  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.63035249710083  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3624000549316406  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.680574417114258  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.682125568389893  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3656802177429199  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.619945526123047  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.621496677398682  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3724203109741211  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.661970615386963  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.663719177246094  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3769416809082031  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.633835792541504  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.635584354400635  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.38434267044067383  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.690011978149414  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.69200849533081  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3902163505554199  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.701512813568115  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.703431606292725  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.39367151260375977  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.662272930145264  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.663858413696289  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3999814987182617  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.671147346496582  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.672751903533936  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4051694869995117  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.682308197021484  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.683838367462158  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.41242361068725586  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.706756591796875  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.70914602279663  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.41750049591064453  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.738110065460205  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.739677906036377  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4230489730834961  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.718690872192383  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.720221519470215  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.42835521697998047  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.72066354751587  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.722373962402344  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.43402862548828125  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.70620584487915  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.70783519744873  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.44167137145996094  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.77206563949585  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.773660659790039  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4458341598510742  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.748091697692871  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.749749183654785  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4525275230407715  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.769617080688477  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.771358489990234  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.45618581771850586  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.71854305267334  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.7200927734375  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

number of input  17586202
----------------------------------------after optimizer
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.47397613525390625  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7012854814529419
pure train time :  2.7802114486694336
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
weights_list  [0.06711569865341276, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.04442669569773771, 0.044350387391832974]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014747858047485352
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0063076019287109375
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.301881790161133
self.buckets_partition() spend  sec:  0.021075963973999023
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.21637392044067383  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.679991722106934  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 7.676706790924072  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3471240997314453  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.69064712524414  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.692358493804932  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.34964466094970703  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.630180835723877  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.631758213043213  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.35762596130371094  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.689059257507324  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.691318035125732  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.36287355422973633  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.615884780883789  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.61782455444336  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3655357360839844  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.627528667449951  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.629429340362549  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3734464645385742  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.689810752868652  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.69165849685669  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3778343200683594  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.643126010894775  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.644697189331055  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3835625648498535  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.678636074066162  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.68035364151001  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.38799285888671875  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.664723873138428  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.666441440582275  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.3944206237792969  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.644491195678711  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.646068096160889  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4009418487548828  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.699097156524658  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.70078182220459  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.40639686584472656  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.725764274597168  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.72733211517334  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.41103458404541016  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.683296203613281  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.684864044189453  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4173154830932617  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.719151496887207  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.720837116241455  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4235391616821289  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.73093318939209  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.732566356658936  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4280385971069336  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.721640586853027  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.723273754119873  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.433013916015625  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.680276870727539  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.681972026824951  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.43989992141723633  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.72159719467163  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.723422050476074  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.44649410247802734  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.75080919265747  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.75309419631958  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.45174407958984375  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.771483898162842  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.773463726043701  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.4576444625854492  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.745983600616455  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 12.747581005096436  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

number of input  17586970
----------------------------------------after optimizer
 Nvidia-smi: 15.17919921875 GB
    Memory Allocated: 0.47519969940185547  GigaBytes
Max Memory Allocated: 12.99655294418335  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6714750528335571
pure train time :  2.884617805480957
epoch_time_list  [24.402934551239014, 22.127780437469482, 23.226471424102783, 23.333223581314087, 23.58107829093933, 22.926475763320923, 23.45569372177124, 23.534980058670044, 22.971458435058594, 23.15821075439453, 22.951961994171143, 22.758862495422363, 23.913613319396973, 22.461400508880615, 22.631513833999634, 22.265411853790283, 22.18010973930359, 26.66183042526245, 26.087146282196045, 26.588033437728882]

loading_time list   [0.5456547737121582, 0.5840671062469482, 0.5558207035064697, 0.5542783737182617, 0.531745433807373, 0.5218355655670166, 0.5167224407196045, 0.5189800262451172, 0.5227963924407959, 0.5678272247314453, 0.5629961490631104, 0.48308372497558594, 0.5906565189361572, 0.573645830154419, 0.5607993602752686, 0.5463664531707764, 0.5263876914978027, 0.6353533267974854, 0.6190226078033447, 0.6708621978759766]

 data loader gen time  19.621528387069702
	---backpack schedule time  [4.066799640655518, 4.027068614959717, 4.089884042739868, 4.096667528152466, 4.083112716674805, 4.075247526168823, 4.116733551025391, 4.0872650146484375, 4.099666595458984, 4.1011643409729, 4.096027612686157, 4.14915132522583, 4.162222623825073, 4.063517093658447, 4.062192916870117, 4.047330856323242, 4.10985541343689, 4.483044862747192, 4.1361401081085205, 4.366200685501099]
	---connection_check_time_list  [7.259979963302612, 6.257092714309692, 6.855281352996826, 6.794136047363281, 7.112678050994873, 6.841068267822266, 6.614696025848389, 7.150753736495972, 6.432807922363281, 6.53035831451416, 6.854631185531616, 6.421255826950073, 7.182488441467285, 6.251005172729492, 6.503583669662476, 6.496654748916626, 6.311282634735107, 9.801255464553833, 9.400631427764893, 9.702411890029907]
	---block_gen_time_list  [4.0922746658325195, 4.089301824569702, 4.3993024826049805, 4.504058361053467, 4.520235538482666, 4.157037258148193, 4.746662616729736, 4.591128349304199, 4.599276542663574, 4.7390758991241455, 4.2791712284088135, 4.474874019622803, 4.700512647628784, 4.193385362625122, 4.261694431304932, 3.996381998062134, 4.378382444381714, 4.834155321121216, 4.913308620452881, 4.879710674285889]
training time  [7.814053058624268, 6.551037073135376, 6.714702367782593, 6.750172853469849, 6.71307110786438, 6.707641839981079, 6.8448615074157715, 6.5717949867248535, 6.703068256378174, 6.602332353591919, 6.547068119049072, 6.608832836151123, 6.652185916900635, 6.752538681030273, 6.628605365753174, 6.565767765045166, 6.22824239730835, 6.229154825210571, 6.349886655807495, 6.284165620803833]
---feature block loading time  [4.1056764125823975, 3.8774850368499756, 4.20674467086792, 4.0635504722595215, 3.8825595378875732, 3.986438274383545, 3.8671324253082275, 3.8762881755828857, 4.041247844696045, 3.922928810119629, 3.880601167678833, 3.9576478004455566, 4.019710540771484, 4.130714654922485, 3.981333017349243, 3.9039366245269775, 3.357262372970581, 3.3505303859710693, 3.4760820865631104, 3.311690330505371]


epoch_time avg   23.632986307144165
loading_time avg   0.55931755900383
 data loader gen time avg 16.503268212080002
	---backpack schedule time avg 4.139929577708244
	---connection_check_time avg  7.225472673773766
	---block_gen_time avg  4.516562059521675
training time  6.561826139688492
---feature block loading time  3.8091315031051636
pure train time per /epoch  [3.6924500465393066, 2.583454132080078, 2.411390542984009, 2.5948984622955322, 2.574824094772339, 2.6387274265289307, 2.890537738800049, 2.606668710708618, 2.564636468887329, 2.597424030303955, 2.585735559463501, 2.561501979827881, 2.5398266315460205, 2.5294365882873535, 2.557812213897705, 2.577059030532837, 2.7831034660339355, 2.788923740386963, 2.7802114486694336, 2.884617805480957]
pure train time average  2.650349729201373
num_input list  [17592022, 17585909, 17589649, 17593443, 17591374, 17581194, 17595786, 17584308, 17587308, 17591326, 17586473, 17596417, 17587255, 17589332, 17589132, 17578950, 17587700, 17589195, 17586202, 17586970]
num_input  average  17588497.25
