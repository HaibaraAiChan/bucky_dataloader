main start at this time 1713208905.1163092
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.004520416259765625
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009184122085571289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0046117305755615234
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.9130685329437256
self.buckets_partition() spend  sec:  0.013815164566040039
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.84716796875 GB
    Memory Allocated: 0.3195810317993164  GigaBytes
Max Memory Allocated: 0.3195810317993164  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.38232421875 GB
    Memory Allocated: 12.51544189453125  GigaBytes
Max Memory Allocated: 12.720524787902832  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.38232421875 GB
    Memory Allocated: 12.51714038848877  GigaBytes
Max Memory Allocated: 12.720524787902832  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.39013671875 GB
    Memory Allocated: 0.34307384490966797  GigaBytes
Max Memory Allocated: 12.720524787902832  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.74951171875 GB
    Memory Allocated: 12.539758682250977  GigaBytes
Max Memory Allocated: 12.74714708328247  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.74951171875 GB
    Memory Allocated: 12.541359424591064  GigaBytes
Max Memory Allocated: 12.74714708328247  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.74951171875 GB
    Memory Allocated: 0.34867382049560547  GigaBytes
Max Memory Allocated: 12.74714708328247  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.76123046875 GB
    Memory Allocated: 12.531687259674072  GigaBytes
Max Memory Allocated: 12.74714708328247  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.76123046875 GB
    Memory Allocated: 12.533275127410889  GigaBytes
Max Memory Allocated: 12.74714708328247  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.76123046875 GB
    Memory Allocated: 0.3535346984863281  GigaBytes
Max Memory Allocated: 12.74714708328247  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.76513671875 GB
    Memory Allocated: 12.491841793060303  GigaBytes
Max Memory Allocated: 12.74714708328247  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.76513671875 GB
    Memory Allocated: 12.49342966079712  GigaBytes
Max Memory Allocated: 12.74714708328247  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.76513671875 GB
    Memory Allocated: 0.3600039482116699  GigaBytes
Max Memory Allocated: 12.74714708328247  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.76904296875 GB
    Memory Allocated: 12.55419111251831  GigaBytes
Max Memory Allocated: 12.761219501495361  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.76904296875 GB
    Memory Allocated: 12.555826187133789  GigaBytes
Max Memory Allocated: 12.761219501495361  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.76904296875 GB
    Memory Allocated: 0.36293506622314453  GigaBytes
Max Memory Allocated: 12.761219501495361  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.78076171875 GB
    Memory Allocated: 12.450845718383789  GigaBytes
Max Memory Allocated: 12.761219501495361  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.78076171875 GB
    Memory Allocated: 12.452480792999268  GigaBytes
Max Memory Allocated: 12.761219501495361  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.78076171875 GB
    Memory Allocated: 0.3697490692138672  GigaBytes
Max Memory Allocated: 12.761219501495361  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.78076171875 GB
    Memory Allocated: 12.55111026763916  GigaBytes
Max Memory Allocated: 12.761219501495361  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.78076171875 GB
    Memory Allocated: 12.552747249603271  GigaBytes
Max Memory Allocated: 12.761219501495361  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.78076171875 GB
    Memory Allocated: 0.3768916130065918  GigaBytes
Max Memory Allocated: 12.761219501495361  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.79052734375 GB
    Memory Allocated: 12.558050632476807  GigaBytes
Max Memory Allocated: 12.764251232147217  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.79052734375 GB
    Memory Allocated: 12.559653282165527  GigaBytes
Max Memory Allocated: 12.764251232147217  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.79052734375 GB
    Memory Allocated: 0.3811483383178711  GigaBytes
Max Memory Allocated: 12.764251232147217  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.79052734375 GB
    Memory Allocated: 12.495086669921875  GigaBytes
Max Memory Allocated: 12.764251232147217  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.79052734375 GB
    Memory Allocated: 12.496689319610596  GigaBytes
Max Memory Allocated: 12.764251232147217  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.79052734375 GB
    Memory Allocated: 0.38741064071655273  GigaBytes
Max Memory Allocated: 12.764251232147217  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.79052734375 GB
    Memory Allocated: 12.569306373596191  GigaBytes
Max Memory Allocated: 12.775813579559326  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.79052734375 GB
    Memory Allocated: 12.570947647094727  GigaBytes
Max Memory Allocated: 12.775813579559326  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.79052734375 GB
    Memory Allocated: 0.39275360107421875  GigaBytes
Max Memory Allocated: 12.775813579559326  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.79052734375 GB
    Memory Allocated: 12.567942142486572  GigaBytes
Max Memory Allocated: 12.775813579559326  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.79052734375 GB
    Memory Allocated: 12.56956672668457  GigaBytes
Max Memory Allocated: 12.775813579559326  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.79052734375 GB
    Memory Allocated: 0.3994712829589844  GigaBytes
Max Memory Allocated: 12.775813579559326  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.81201171875 GB
    Memory Allocated: 12.582104682922363  GigaBytes
Max Memory Allocated: 12.788441181182861  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.81201171875 GB
    Memory Allocated: 12.583816051483154  GigaBytes
Max Memory Allocated: 12.788441181182861  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.81201171875 GB
    Memory Allocated: 0.4031386375427246  GigaBytes
Max Memory Allocated: 12.788441181182861  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.81201171875 GB
    Memory Allocated: 12.58015489578247  GigaBytes
Max Memory Allocated: 12.788441181182861  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.81201171875 GB
    Memory Allocated: 12.581812858581543  GigaBytes
Max Memory Allocated: 12.788441181182861  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.81201171875 GB
    Memory Allocated: 0.409757137298584  GigaBytes
Max Memory Allocated: 12.788441181182861  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.81201171875 GB
    Memory Allocated: 12.61885690689087  GigaBytes
Max Memory Allocated: 12.825930118560791  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.81201171875 GB
    Memory Allocated: 12.620458126068115  GigaBytes
Max Memory Allocated: 12.825930118560791  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.81201171875 GB
    Memory Allocated: 0.41573476791381836  GigaBytes
Max Memory Allocated: 12.825930118560791  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.81201171875 GB
    Memory Allocated: 12.600295543670654  GigaBytes
Max Memory Allocated: 12.825930118560791  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.81201171875 GB
    Memory Allocated: 12.602001190185547  GigaBytes
Max Memory Allocated: 12.825930118560791  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.81201171875 GB
    Memory Allocated: 0.42093706130981445  GigaBytes
Max Memory Allocated: 12.825930118560791  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.82958984375 GB
    Memory Allocated: 12.567186832427979  GigaBytes
Max Memory Allocated: 12.825930118560791  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.82958984375 GB
    Memory Allocated: 12.568816184997559  GigaBytes
Max Memory Allocated: 12.825930118560791  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.82958984375 GB
    Memory Allocated: 0.4283156394958496  GigaBytes
Max Memory Allocated: 12.825930118560791  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.83740234375 GB
    Memory Allocated: 12.626542091369629  GigaBytes
Max Memory Allocated: 12.833647727966309  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.83740234375 GB
    Memory Allocated: 12.628169536590576  GigaBytes
Max Memory Allocated: 12.833647727966309  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.83740234375 GB
    Memory Allocated: 0.43265485763549805  GigaBytes
Max Memory Allocated: 12.833647727966309  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.84716796875 GB
    Memory Allocated: 12.615637302398682  GigaBytes
Max Memory Allocated: 12.833647727966309  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.84716796875 GB
    Memory Allocated: 12.617264747619629  GigaBytes
Max Memory Allocated: 12.833647727966309  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.84716796875 GB
    Memory Allocated: 0.43669748306274414  GigaBytes
Max Memory Allocated: 12.833647727966309  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.84716796875 GB
    Memory Allocated: 12.613300800323486  GigaBytes
Max Memory Allocated: 12.833647727966309  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.84716796875 GB
    Memory Allocated: 12.614933967590332  GigaBytes
Max Memory Allocated: 12.833647727966309  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.84716796875 GB
    Memory Allocated: 0.44266414642333984  GigaBytes
Max Memory Allocated: 12.833647727966309  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.85888671875 GB
    Memory Allocated: 12.554518222808838  GigaBytes
Max Memory Allocated: 12.833647727966309  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.85888671875 GB
    Memory Allocated: 12.556151390075684  GigaBytes
Max Memory Allocated: 12.833647727966309  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.85888671875 GB
    Memory Allocated: 0.4485630989074707  GigaBytes
Max Memory Allocated: 12.833647727966309  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86083984375 GB
    Memory Allocated: 12.649146556854248  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86083984375 GB
    Memory Allocated: 12.650717735290527  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86083984375 GB
    Memory Allocated: 0.4540367126464844  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.62021017074585  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.621781349182129  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

number of input  17875391
----------------------------------------after optimizer
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.47336816787719727  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.203467845916748
pure train time :  6.887251138687134
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.004694461822509766
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012931346893310547
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0048503875732421875
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.9065535068511963
self.buckets_partition() spend  sec:  0.017804622650146484
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.34205055236816406  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.456125736236572  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.452274799346924  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.3426699638366699  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.450836658477783  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.452489376068115  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.3498973846435547  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.536251068115234  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.537903308868408  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.3541884422302246  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.496775150299072  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.49841022491455  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.36194467544555664  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.545953273773193  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.547588348388672  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.3656163215637207  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.501312255859375  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.502975940704346  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.37224721908569336  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.564589500427246  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.566218852996826  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.37862443923950195  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.571630001068115  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.573259353637695  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.3841686248779297  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.56050443649292  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.562098026275635  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.3894987106323242  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.575157642364502  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.576823234558105  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.39517879486083984  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.53080129623413  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.532394886016846  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.4008049964904785  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.584265232086182  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.585847854614258  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.4054875373840332  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.587703227996826  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.589285850524902  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.4099407196044922  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.550821781158447  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.552462577819824  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.4168086051940918  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.602289199829102  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.603929996490479  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.4230360984802246  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.604361057281494  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.605940341949463  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.427553653717041  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.56782341003418  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.569455623626709  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.4333181381225586  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.608222961425781  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.609809398651123  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.4394040107727051  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.634676456451416  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.63631534576416  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.44414615631103516  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.626425743103027  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.628052711486816  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.44988346099853516  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.633283138275146  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 12.634864330291748  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86474609375 GB
    Memory Allocated: 0.4564700126647949  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 12.59448528289795  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 12.59618616104126  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

number of input  17854812
----------------------------------------after optimizer
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 0.4738006591796875  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.4726765155792236
pure train time :  4.159015655517578
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.005730152130126953
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014119386672973633
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005856990814208984
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.9701035022735596
self.buckets_partition() spend  sec:  0.0200045108795166
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 0.34136962890625  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 12.422179222106934  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 12.418359756469727  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 0.3453636169433594  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 12.535655975341797  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 12.537306308746338  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 0.3523240089416504  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 12.536277770996094  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 12.537889957427979  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 0.3555159568786621  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 12.488292217254639  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 12.489904403686523  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 0.3620033264160156  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 12.55152702331543  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 12.553153991699219  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 0.36769866943359375  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 12.553260326385498  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 12.55485725402832  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.87060546875 GB
    Memory Allocated: 0.37243175506591797  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.59012508392334  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.591716289520264  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.37954092025756836  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.570759296417236  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.57235050201416  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.3827838897705078  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.565584659576416  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.567219734191895  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.38839054107666016  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.539648056030273  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.541340351104736  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.39545297622680664  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.574041366577148  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.57564926147461  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.4004020690917969  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.584834575653076  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.586490631103516  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.40360546112060547  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.520754337310791  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.52233600616455  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.4102182388305664  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.552282333374023  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.553930759429932  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.41692495346069336  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.557104587554932  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.558676719665527  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.4233555793762207  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.607605457305908  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.609260082244873  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.4276089668273926  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.61395788192749  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.615585327148438  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.43187522888183594  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.561383247375488  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.563010692596436  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.43891286849975586  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.58063268661499  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.582279205322266  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.44551610946655273  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.644392967224121  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.646039485931396  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.44966745376586914  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.574623107910156  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.576245307922363  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.45543384552001953  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.573540687561035  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.57515573501587  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

number of input  17860349
----------------------------------------after optimizer
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.4725608825683594  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7357704639434814
pure train time :  4.206070184707642
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.005013942718505859
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014189004898071289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005172252655029297
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.003998041152954
self.buckets_partition() spend  sec:  0.019392967224121094
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.3446946144104004  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.528554916381836  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.524640083312988  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.34464597702026367  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.524267673492432  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.525877952575684  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.352292537689209  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.539865970611572  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.541449546813965  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.3547935485839844  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.539049625396729  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.540633201599121  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.3610725402832031  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.543002128601074  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 12.544607639312744  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.54248046875 GB
    Memory Allocated: 0.3693046569824219  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.625688552856445  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.62732744216919  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3729867935180664  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.559208393096924  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.560847282409668  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3773021697998047  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.56639289855957  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.567993640899658  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3825874328613281  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.49476432800293  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.496365070343018  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.38932132720947266  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.57059621810913  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.572202682495117  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3968358039855957  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.60473108291626  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.606337547302246  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4006657600402832  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.583477020263672  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.58510446548462  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.40671777725219727  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.584578514099121  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.586205959320068  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4104170799255371  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.588178634643555  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.589806079864502  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.41657018661499023  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.551339626312256  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.552918910980225  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.420778751373291  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.533690452575684  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.535391330718994  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4284076690673828  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.615161895751953  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.616882801055908  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.43417882919311523  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.637172222137451  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.638843536376953  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.43827152252197266  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.577245712280273  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.578917026519775  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4442915916442871  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.61876392364502  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.620388984680176  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4503798484802246  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.585948944091797  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.587574005126953  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4539651870727539  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.559791564941406  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.561428546905518  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

number of input  17869228
----------------------------------------after optimizer
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4712843894958496  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.23077654838562
pure train time :  4.173313140869141
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.004952907562255859
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012342214584350586
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005061149597167969
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.980362892150879
self.buckets_partition() spend  sec:  0.017441511154174805
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.34368896484375  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.528353214263916  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.524382591247559  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3452873229980469  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.531469821929932  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.533120155334473  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3495659828186035  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.526045799255371  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.527620315551758  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.35530853271484375  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.534778118133545  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.536441802978516  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.36040830612182617  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.478899955749512  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.480507850646973  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3669438362121582  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.54189682006836  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.54358720779419  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.373136043548584  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.563363075256348  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.565009593963623  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3774681091308594  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.50908374786377  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.510730266571045  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.38453054428100586  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.594529151916504  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.59616231918335  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3884391784667969  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.510322093963623  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.511894226074219  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.39487743377685547  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.594305038452148  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.595978260040283  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.40087366104125977  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.609598636627197  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.611178398132324  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.40340280532836914  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.501524925231934  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.50310468673706  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4109349250793457  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.56052827835083  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.562129020690918  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.41640424728393555  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.540941715240479  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.542542457580566  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.423067569732666  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.562208652496338  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.563937187194824  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.42792844772338867  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.609833717346191  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.611533641815186  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4336991310119629  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.61092233657837  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.612590312957764  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4387645721435547  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.623748302459717  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.625387191772461  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4443850517272949  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.625281810760498  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.626890182495117  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.45072126388549805  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.58282995223999  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.58443832397461  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.45560455322265625  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.597346305847168  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.599036693572998  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

number of input  17860919
----------------------------------------after optimizer
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4728364944458008  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7760926485061646
pure train time :  4.20099663734436
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.0044689178466796875
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011833429336547852
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0045545101165771484
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.9274518489837646
self.buckets_partition() spend  sec:  0.01641106605529785
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.34296226501464844  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.530401706695557  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.52647590637207  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.34513187408447266  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.549097537994385  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.550662994384766  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.35042572021484375  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.527400970458984  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.529046058654785  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3557758331298828  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.53039264678955  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.532013893127441  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3605356216430664  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.50116491317749  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.50278615951538  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.36742305755615234  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.553908348083496  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.555543422698975  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.37344980239868164  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.553462982177734  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.555098056793213  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3781108856201172  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.497712135314941  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.499329566955566  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3835582733154297  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.519753456115723  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.521432876586914  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3902549743652344  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.573562145233154  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.575156211853027  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.39314746856689453  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.518393516540527  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.519970417022705  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.39942502975463867  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.585795402526855  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.587398052215576  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.40393543243408203  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.531286716461182  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.532877922058105  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.413877010345459  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.6332106590271  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.634803771972656  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.41649341583251953  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.598495960235596  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.600089073181152  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4216585159301758  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.598567962646484  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.60018539428711  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.42760515213012695  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.574716091156006  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.576390743255615  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.43297910690307617  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.622751712799072  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.62437915802002  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.43988943099975586  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.61621618270874  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.617834091186523  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4436073303222656  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.631546974182129  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.633164882659912  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.44910573959350586  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.622386455535889  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.623953819274902  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.45447349548339844  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.56167221069336  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.563310623168945  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

number of input  17855113
----------------------------------------after optimizer
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.47188615798950195  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5516071319580078
pure train time :  4.238248586654663
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.0040073394775390625
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014441728591918945
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004094362258911133
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.9904229640960693
self.buckets_partition() spend  sec:  0.01856207847595215
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.34481334686279297  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.573599815368652  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.569671154022217  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3438096046447754  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.47572374343872  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.477334022521973  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.35101795196533203  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.542879581451416  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.544504165649414  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.35532283782958984  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.486802101135254  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.488505840301514  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.36078786849975586  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.545925617218018  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.547546863555908  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.36772966384887695  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.551927089691162  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.553617477416992  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.37462806701660156  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.60477590560913  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.606424331665039  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3771371841430664  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.563811302185059  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.56540060043335  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3841242790222168  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.568543910980225  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.570117473602295  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3892383575439453  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.517436504364014  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.519010066986084  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.39369916915893555  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.523053646087646  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.524698257446289  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3988804817199707  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.505283832550049  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.506928443908691  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.40697288513183594  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.599746227264404  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.601402282714844  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4115114212036133  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.59088945388794  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.5924711227417  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4168872833251953  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.553823947906494  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.555510520935059  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.42248058319091797  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.602288722991943  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.60390853881836  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4290914535522461  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.645855903625488  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.647471904754639  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.43303537368774414  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.580646514892578  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.582262516021729  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.438077449798584  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.517111778259277  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.518695831298828  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4464850425720215  GigaBytes
Max Memory Allocated: 12.855750560760498  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.658315181732178  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.659988403320312  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4507894515991211  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.627670288085938  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.629253387451172  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.45675039291381836  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.60153579711914  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.603118896484375  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

number of input  17880127
----------------------------------------after optimizer
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4741854667663574  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3900039196014404
pure train time :  4.344714879989624
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.005124568939208984
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012476444244384766
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0052032470703125
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.9830708503723145
self.buckets_partition() spend  sec:  0.017704486846923828
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3424983024597168  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.47277307510376  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.468918323516846  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3450322151184082  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.525940418243408  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.527570247650146  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.34998512268066406  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.492408752441406  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.494038581848145  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3566093444824219  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.543315887451172  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.544970035552979  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3607797622680664  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.550766944885254  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.55242109298706  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.36727142333984375  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.555171012878418  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.556867122650146  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3718123435974121  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.56008768081665  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.56172800064087  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3771176338195801  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.485310077667236  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.486950397491455  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3844871520996094  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.559669494628906  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.561392307281494  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.38934803009033203  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.575212001800537  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.576849937438965  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.39553308486938477  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.585302829742432  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.586974143981934  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.39882946014404297  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.5276780128479  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.529278755187988  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.40530824661254883  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.545153617858887  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.546834468841553  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.41245031356811523  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.603596687316895  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.605250835418701  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.41731834411621094  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.600219249725342  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.601860046386719  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4232826232910156  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.606472492218018  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.608113288879395  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.43019819259643555  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.62037992477417  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.622032165527344  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4347391128540039  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.612593173980713  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.61417007446289  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4392862319946289  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.619030952453613  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.62062120437622  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4458580017089844  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.646772384643555  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.648370742797852  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4489784240722656  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.573349475860596  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.574921131134033  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.45412492752075195  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.585057258605957  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.58677625656128  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

number of input  17872386
----------------------------------------after optimizer
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4715723991394043  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2723805904388428
pure train time :  4.220452547073364
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.005215167999267578
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012234210968017578
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005300045013427734
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.9796252250671387
self.buckets_partition() spend  sec:  0.017556190490722656
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.34212493896484375  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.4570894241333  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.453200817108154  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.345489501953125  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.526389598846436  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.528048515319824  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.35230255126953125  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.554980754852295  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.556632995605469  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3552703857421875  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.527243614196777  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.528895854949951  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.35961389541625977  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.47101879119873  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.472636222839355  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.36675214767456055  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.558443546295166  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.560384273529053  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3724241256713867  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.558063983917236  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.559731483459473  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.37799978256225586  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.560516834259033  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.56215763092041  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3831963539123535  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.519273281097412  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.520914077758789  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.38867807388305664  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.520933628082275  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.522591590881348  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3951387405395508  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.607460975646973  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.60910177230835  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4001145362854004  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.525892734527588  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.527533531188965  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4067573547363281  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.592326641082764  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.593914031982422  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.41065311431884766  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.53667402267456  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.538261413574219  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4180631637573242  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.622765064239502  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.624407768249512  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4213876724243164  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.537926197052002  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.539559841156006  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.42813634872436523  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.61471176147461  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.616294860839844  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.43411779403686523  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.603986263275146  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.605594158172607  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.43848466873168945  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.62050724029541  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.622149467468262  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4449944496154785  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.629981517791748  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.631553649902344  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4503755569458008  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.636287212371826  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.637954711914062  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4559497833251953  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.585422992706299  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.587018966674805  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

number of input  17864675
----------------------------------------after optimizer
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.47344112396240234  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1745917797088623
pure train time :  4.148698329925537
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.0046558380126953125
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012813091278076172
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004724264144897461
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.948829412460327
self.buckets_partition() spend  sec:  0.017559289932250977
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3432621955871582  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.468865394592285  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.465059280395508  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3431730270385742  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.523478984832764  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.525064468383789  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3494377136230469  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.528986930847168  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.530572414398193  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.356503963470459  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.549484729766846  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.551104545593262  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.36179494857788086  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.543704509735107  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.545324325561523  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3667874336242676  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.515227794647217  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.516862869262695  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.37230634689331055  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.564057350158691  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.565675258636475  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3779010772705078  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.527354717254639  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.528972625732422  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3842434883117676  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.57275915145874  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.574397087097168  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3881955146789551  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.509432315826416  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.511002540588379  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.39412355422973633  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.521347522735596  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.522917747497559  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.40001869201660156  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.58296251296997  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.584571838378906  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.40555238723754883  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.557247161865234  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.55885648727417  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.41200685501098633  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.609337329864502  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.610944747924805  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.41674184799194336  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.600602149963379  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.602238655090332  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4242587089538574  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.618354797363281  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.619965553283691  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4287257194519043  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.612772941589355  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.614415645599365  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.43334150314331055  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.610416889190674  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.612059593200684  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.439547061920166  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.616712093353271  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.61839485168457  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4453415870666504  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.621052265167236  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.622710704803467  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.45022058486938477  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.631928443908691  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.633572101593018  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4555931091308594  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.633690357208252  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.63535213470459  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

number of input  17869716
----------------------------------------after optimizer
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4729890823364258  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0806434154510498
pure train time :  4.207437038421631
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.004489421844482422
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012205362319946289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0045757293701171875
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.9905030727386475
self.buckets_partition() spend  sec:  0.016804933547973633
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.34585142135620117  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.529912948608398  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.525990962982178  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3441953659057617  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.522099018096924  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.523729801177979  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3500852584838867  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.48681354522705  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.48841667175293  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.35469770431518555  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.504303455352783  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.506009101867676  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3610038757324219  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.49479341506958  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.496487617492676  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3676614761352539  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.554771900177002  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.556458473205566  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.371060848236084  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.549962997436523  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.551584720611572  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3779902458190918  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.564101696014404  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.565723419189453  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3827381134033203  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.53154182434082  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.533198833465576  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3899226188659668  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.602649688720703  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.604231357574463  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.394406795501709  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.578349113464355  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.579930782318115  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.39993715286254883  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.537420272827148  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.539023399353027  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4066762924194336  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.602807521820068  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.604459762573242  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4101133346557617  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.534091472625732  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.535667896270752  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.41678762435913086  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.546597480773926  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.548173904418945  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4209327697753906  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.54757022857666  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.54926061630249  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.42679500579833984  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.52042818069458  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.522052764892578  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.43460893630981445  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.637407302856445  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.639023303985596  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4382667541503906  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.568476676940918  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.570186138153076  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.44527578353881836  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.625309467315674  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.626971244812012  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4513578414916992  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.635998249053955  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.637654304504395  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.455869197845459  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.632298469543457  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.633880138397217  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

number of input  17862723
----------------------------------------after optimizer
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.47324609756469727  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0002293586730957
pure train time :  4.171071529388428
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.004579067230224609
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013817548751831055
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0046460628509521484
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.9428772926330566
self.buckets_partition() spend  sec:  0.018488407135009766
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.34348440170288086  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.485804557800293  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.481836795806885  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.34352874755859375  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.464016437530518  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.465716361999512  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.34902143478393555  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.521882057189941  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.523498058319092  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.35632848739624023  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.536837100982666  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.538543701171875  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3623080253601074  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.550655841827393  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.55231761932373  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3672299385070801  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.545728206634521  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.547377586364746  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3722081184387207  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.574288845062256  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.575948715209961  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3790855407714844  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.56412649154663  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.565774917602539  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.38225746154785156  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.552122116088867  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.553694248199463  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.38878440856933594  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.566503524780273  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.568102836608887  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3951401710510254  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.577888011932373  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.579478740692139  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3997025489807129  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.539551258087158  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.541130542755127  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.40523290634155273  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.54370641708374  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.545413970947266  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.41104984283447266  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.602215766906738  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.603868007659912  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4177379608154297  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.610538959503174  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.612168312072754  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.42176389694213867  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.591525554656982  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.593154907226562  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.43018436431884766  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.630129337310791  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.631815910339355  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.43289709091186523  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.573186874389648  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.574835300445557  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.43884992599487305  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.621881484985352  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.623537540435791  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4440188407897949  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.583980083465576  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.585561752319336  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.45014476776123047  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.587501049041748  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.589166641235352  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4557933807373047  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.587151527404785  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.5887451171875  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

number of input  17865092
----------------------------------------after optimizer
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.47324323654174805  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.95669025182724
pure train time :  4.17136549949646
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.0044019222259521484
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01179957389831543
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004490852355957031
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.950730562210083
self.buckets_partition() spend  sec:  0.016312837600708008
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.34392261505126953  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.537659168243408  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.533694744110107  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.343902587890625  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.523438453674316  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.525025844573975  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.35048341751098633  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.538389682769775  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.540045738220215  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3551468849182129  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.493477821350098  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.495059490203857  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3619389533996582  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.54996395111084  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.551599025726318  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3661985397338867  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.549451351165771  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.55108642578125  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3734626770019531  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.560232162475586  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.561859130859375  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3802165985107422  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.563744068145752  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.565443992614746  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.38327550888061523  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.52613878250122  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.52779483795166  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.38957929611206055  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.572296142578125  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.573877334594727  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.39539241790771484  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.547589302062988  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.54917049407959  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4011497497558594  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.580801010131836  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.582389831542969  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.40385866165161133  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.507462978363037  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.50905179977417  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.41072607040405273  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.594703197479248  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.596393585205078  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.41594648361206055  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.558085918426514  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.559736728668213  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.42157840728759766  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.538023948669434  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.53966999053955  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.42696189880371094  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.554535388946533  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.55626392364502  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4337778091430664  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.618136882781982  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.619766235351562  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4388270378112793  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.619850635528564  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.621479988098145  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4434981346130371  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.561607837677002  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.563249111175537  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.45126962661743164  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.644310474395752  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.645968437194824  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4539356231689453  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.574400901794434  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.576047420501709  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

number of input  17859343
----------------------------------------after optimizer
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4712972640991211  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.91377192735672
pure train time :  4.170290946960449
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.004437446594238281
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01071619987487793
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004506349563598633
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.9354169368743896
self.buckets_partition() spend  sec:  0.015258550643920898
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.34581422805786133  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.55712604522705  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.553230285644531  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.34430360794067383  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.529594898223877  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.53123950958252  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3494582176208496  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.495222091674805  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.496866703033447  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.35455751419067383  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.494552612304688  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.496241092681885  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.3610978126525879  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.54036808013916  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.542013168334961  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.36641407012939453  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.553693294525146  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.555294036865234  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.37031030654907227  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.471835136413574  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.473519802093506  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.37794017791748047  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.520113468170166  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.521790504455566  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.38305234909057617  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.516725540161133  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.518377780914307  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.38803958892822266  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.532432079315186  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.534008979797363  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.39417171478271484  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.536142826080322  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.537749290466309  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4011650085449219  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.585859298706055  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.587465763092041  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4058208465576172  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.589276790618896  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.590850830078125  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.40990304946899414  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.522619724273682  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.52419376373291  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4167957305908203  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.598800659179688  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.600422859191895  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.42329883575439453  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.602180004119873  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.603845596313477  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4281949996948242  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.581905841827393  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.583499431610107  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.43422842025756836  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.620570182800293  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.622137546539307  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4388136863708496  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.619925022125244  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.621492385864258  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.44655799865722656  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.634262561798096  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.635844230651855  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4525480270385742  GigaBytes
Max Memory Allocated: 12.865086078643799  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.659855365753174  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 12.66148853302002  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22607421875 GB
    Memory Allocated: 0.4560408592224121  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.624754905700684  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.62638807296753  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

number of input  17867914
----------------------------------------after optimizer
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.47335147857666016  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8717314004898071
pure train time :  4.249232769012451
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.004498720169067383
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010189533233642578
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004586458206176758
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.9415879249572754
self.buckets_partition() spend  sec:  0.01480245590209961
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.34313154220581055  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.531518936157227  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.527571201324463  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.34462833404541016  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.51773738861084  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.519334316253662  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3495473861694336  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.488233089447021  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.489888191223145  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3556694984436035  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.499651908874512  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.501257419586182  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.36170244216918945  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.546985626220703  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.548655033111572  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3668031692504883  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.554534435272217  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.556142330169678  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3731675148010254  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.558603286743164  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.56032419204712  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.37889719009399414  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.556789875030518  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.558470249176025  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3829784393310547  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.570497512817383  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.572163105010986  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.38956117630004883  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.500463962554932  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.502057552337646  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3930950164794922  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.527952671051025  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.529629707336426  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4029064178466797  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.65672492980957  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.658335208892822  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4055495262145996  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.587297439575195  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.588907718658447  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4107041358947754  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.5939359664917  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.595563411712646  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.41698789596557617  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.604191780090332  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.60582685470581  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.42265987396240234  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.60076093673706  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.60236406326294  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4285011291503906  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.572755336761475  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.574385643005371  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.43198394775390625  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.566736221313477  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.5683274269104  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4383230209350586  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.54248857498169  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.544079780578613  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4443063735961914  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.57666540145874  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.578299522399902  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.44969606399536133  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.590101718902588  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.59171438217163  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4553532600402832  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.552145004272461  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.553906917572021  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

number of input  17862764
----------------------------------------after optimizer
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4728212356567383  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8327299952507019
pure train time :  4.178162336349487
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.004472494125366211
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012740135192871094
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004551410675048828
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.913687229156494
self.buckets_partition() spend  sec:  0.01731395721435547
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.34587812423706055  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.535861015319824  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.531948566436768  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.34519481658935547  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.574186325073242  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.575792789459229  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.35005664825439453  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.529832363128662  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.531438827514648  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.35591936111450195  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.544062614440918  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.545684337615967  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.36119890213012695  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.54055643081665  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.5421781539917  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.36629390716552734  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.494012355804443  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.495600700378418  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.37156057357788086  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.505381107330322  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.507098197937012  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.37848949432373047  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.579684734344482  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.581257820129395  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.38400936126708984  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.581517696380615  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.583135604858398  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.38797569274902344  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.530538558959961  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.532156467437744  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3946719169616699  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.575669288635254  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.577281951904297  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.40038537979125977  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.578084468841553  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.579732418060303  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4041604995727539  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.52992582321167  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.531559944152832  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.41112422943115234  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.596063137054443  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.597753524780273  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.41683053970336914  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.55312728881836  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.554808139801025  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4215860366821289  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.595170497894287  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.596813678741455  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4262857437133789  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.539605617523193  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.541242122650146  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4345841407775879  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.623934745788574  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.62554121017456  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.43929100036621094  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.630160808563232  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.631746292114258  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4461493492126465  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.625460624694824  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.627097606658936  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.45032835006713867  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.579091548919678  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.580728530883789  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.45599365234375  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.641135692596436  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.642721176147461  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

number of input  17864781
----------------------------------------after optimizer
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.47325849533081055  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7963824272155762
pure train time :  4.253673553466797
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.004433155059814453
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010146617889404297
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004510164260864258
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.929208755493164
self.buckets_partition() spend  sec:  0.014679431915283203
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.34341907501220703  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.48134994506836  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.477369785308838  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.34378480911254883  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.483065605163574  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.484677791595459  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.34999847412109375  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.501076698303223  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.502767086029053  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.35483407974243164  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.526795387268066  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.528464794158936  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.36161136627197266  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.547642230987549  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.549240589141846  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.36530303955078125  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.541874408721924  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.543543815612793  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.37462663650512695  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.59846019744873  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.600146770477295  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3776669502258301  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.517201900482178  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.518900394439697  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.38295793533325195  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.52540636062622  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.527125358581543  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.38959550857543945  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.574768543243408  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.576441764831543  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.39502573013305664  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.573553562164307  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.575226783752441  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.40164804458618164  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.596975803375244  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.598618507385254  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.40508270263671875  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.587176322937012  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.5887451171875  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.41242456436157227  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.599262237548828  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.600831031799316  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.41651248931884766  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.604818344116211  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.606457233428955  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.42220401763916016  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.602820873260498  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.604459762573242  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.42903709411621094  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.608807563781738  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.610408306121826  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.43302297592163086  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.561264038085938  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.56293535232544  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4397892951965332  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.61311388015747  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.61474084854126  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4459385871887207  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.631373882293701  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.63298225402832  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4496879577636719  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.598719596862793  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.600327968597412  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.45693302154541016  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.642385482788086  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.644012928009033  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

number of input  17874075
----------------------------------------after optimizer
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.47434377670288086  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7599538564682007
pure train time :  4.19633674621582
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.0063304901123046875
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011803150177001953
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.006417751312255859
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.9665632247924805
self.buckets_partition() spend  sec:  0.01825690269470215
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3443307876586914  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.537076473236084  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.533148765563965  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3441915512084961  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.486620426177979  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.488223552703857  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.35056638717651367  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.537221431732178  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.538881301879883  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3574395179748535  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.542726039886475  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.544312477111816  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3611016273498535  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.473944187164307  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.475581645965576  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.36746835708618164  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.559476375579834  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.561113834381104  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.37320804595947266  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.560644149780273  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.562221050262451  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.37827539443969727  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.554882526397705  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.556459426879883  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3826179504394531  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.506864070892334  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.508441925048828  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.38817596435546875  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.586761474609375  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.588379383087158  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.39336442947387695  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.527982711791992  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.529600620269775  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.40172767639160156  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.588229656219482  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.589862823486328  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4040546417236328  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.525349140167236  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.526946067810059  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4112992286682129  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.598637580871582  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.6002516746521  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.41698217391967773  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.599858283996582  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.6014723777771  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4221839904785156  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.601983547210693  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.603643417358398  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4271984100341797  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.611652851104736  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.613282203674316  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4333786964416504  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.567480087280273  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.569109439849854  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4375338554382324  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.577138423919678  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.578836441040039  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.44423866271972656  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.581206321716309  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.582821369171143  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4505467414855957  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.638644695281982  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.640300750732422  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4543461799621582  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.56776237487793  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.56941843032837  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

number of input  17857847
----------------------------------------after optimizer
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4716963768005371  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.727260172367096
pure train time :  4.649718999862671
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.0045130252838134766
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011767864227294922
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004629373550415039
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  4.257178544998169
self.buckets_partition() spend  sec:  0.016423463821411133
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3433871269226074  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.534571647644043  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.530622482299805  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3446030616760254  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.491608142852783  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.493206977844238  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3523120880126953  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.542888164520264  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.544491291046143  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3572521209716797  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.559640884399414  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.561291217803955  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3620476722717285  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.539140701293945  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.540746688842773  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.36654138565063477  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.55019235610962  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.551798343658447  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3709440231323242  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.509252071380615  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.51086711883545  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.376190185546875  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.494876861572266  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.496476173400879  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.38279151916503906  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.525820255279541  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.527438163757324  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.38897180557250977  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.567438125610352  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.569056034088135  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.39379405975341797  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.520415782928467  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.521999835968018  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.39907073974609375  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.581502437591553  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.583173751831055  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4058995246887207  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.5932035446167  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.594848155975342  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4118232727050781  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.59192419052124  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.593489646911621  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4174771308898926  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.605623722076416  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.607189178466797  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4228701591491699  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.556840896606445  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.558429718017578  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4275813102722168  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.565985202789307  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.567688941955566  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.433290958404541  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.577390670776367  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.579014301300049  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.43840932846069336  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.558703422546387  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.560327053070068  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4444160461425781  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.633246898651123  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.634819984436035  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4523601531982422  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.643964290618896  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.645652770996094  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.45455503463745117  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.572060108184814  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.573682308197021  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

number of input  17860267
----------------------------------------after optimizer
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.47187232971191406  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7006508111953735
pure train time :  4.749700307846069
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
random partition time  0.004595041275024414
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013598918914794922
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004711627960205078
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.326251268386841
self.buckets_partition() spend  sec:  0.018349647521972656
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.34474658966064453  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.55421781539917  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.550281524658203  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.34378862380981445  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.47296953201294  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.474575996398926  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.34931516647338867  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.45939826965332  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.461044311523438  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3552088737487793  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.498714923858643  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.500395774841309  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3600635528564453  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.5453519821167  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.547016620635986  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3655996322631836  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.482769012451172  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.484433650970459  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.37081432342529297  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.484035015106201  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.485610485076904  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3770771026611328  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.504483222961426  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.506112575531006  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3839268684387207  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.585026264190674  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.586655616760254  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3884577751159668  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.571444034576416  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.573098182678223  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.39444732666015625  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.516997814178467  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.518606662750244  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.3994932174682617  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.576627731323242  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.578253269195557  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4064517021179199  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.589603424072266  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.59122896194458  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.41211414337158203  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.600411415100098  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.60209608078003  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4165029525756836  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.54708480834961  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.548769474029541  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.42290735244750977  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.610862731933594  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.612545490264893  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.42752933502197266  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.611698150634766  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.613380908966064  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.43492889404296875  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.634976863861084  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.63659143447876  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4412565231323242  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.643879413604736  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.64548397064209  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.4456925392150879  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.636082172393799  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.637694358825684  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.44900989532470703  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.636717319488525  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.638314723968506  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.45639753341674805  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.636327743530273  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 12.638020038604736  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

number of input  17861717
----------------------------------------after optimizer
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 0.47379541397094727  GigaBytes
Max Memory Allocated: 12.86713695526123  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6710577011108398
pure train time :  4.377118349075317
epoch_time_list  [28.035096883773804, 25.36553120613098, 28.49361538887024, 27.47821068763733, 25.090137481689453, 24.523598670959473, 25.637914180755615, 24.668643712997437, 25.058950901031494, 24.056477069854736, 24.647820234298706, 24.651095628738403, 23.763671398162842, 23.92118525505066, 23.848776817321777, 23.558530569076538, 23.757906198501587, 24.65373158454895, 27.34982967376709, 31.28562307357788]

loading_time list   [0.5719594955444336, 0.6009876728057861, 0.5317862033843994, 0.6130826473236084, 0.4808380603790283, 0.5233314037322998, 0.517338752746582, 0.48368406295776367, 0.4501628875732422, 0.4506666660308838, 0.48384857177734375, 0.5032169818878174, 0.4150688648223877, 0.5270423889160156, 0.5077505111694336, 0.4516572952270508, 0.5491390228271484, 0.4863114356994629, 0.5405802726745605, 0.7239069938659668]

 data loader gen time  22.24913716316223
	---backpack schedule time  [3.998202323913574, 3.993515729904175, 4.050043106079102, 4.078201055526733, 4.046966552734375, 4.007498025894165, 4.0577192306518555, 4.06692099571228, 4.053534269332886, 4.012386798858643, 4.068688631057739, 4.0182225704193115, 4.011235237121582, 3.999704360961914, 4.009209394454956, 3.99125599861145, 4.001848459243774, 4.049882650375366, 4.322774171829224, 6.412557125091553]
	---connection_check_time_list  [7.49504017829895, 7.480490207672119, 9.810602188110352, 9.482424020767212, 7.139846563339233, 6.980980396270752, 7.226503133773804, 7.013041257858276, 7.0630292892456055, 6.612110376358032, 6.574951648712158, 6.974595546722412, 6.339637041091919, 6.504406452178955, 6.500936985015869, 6.181760311126709, 6.313243389129639, 6.7063798904418945, 8.848485946655273, 10.129209041595459]
	---block_gen_time_list  [4.439362049102783, 4.633599758148193, 4.931195974349976, 4.439462423324585, 4.395076274871826, 4.120771646499634, 4.6618874073028564, 4.19605827331543, 4.827081203460693, 4.245028972625732, 4.817207336425781, 4.376589298248291, 4.266900539398193, 4.117501974105835, 4.128808259963989, 4.060941457748413, 4.146061420440674, 4.813574314117432, 4.710500478744507, 5.005542993545532]
training time  [10.912155151367188, 8.015027523040771, 8.492985963821411, 8.228806257247925, 8.38603925704956, 8.254124164581299, 8.542134523391724, 8.265321969985962, 8.04848599433899, 8.117897272109985, 8.075063705444336, 8.146353483200073, 8.094746828079224, 8.135968923568726, 8.078851222991943, 8.252350091934204, 8.111006259918213, 7.9602766036987305, 8.220391035079956, 8.267191648483276]
---feature block loading time  [4.001371622085571, 3.7715373039245605, 4.200340509414673, 3.971400737762451, 4.099558591842651, 3.9323339462280273, 4.109384536743164, 3.9618139266967773, 3.815608024597168, 3.824157476425171, 3.8157994747161865, 3.890519142150879, 3.837311029434204, 3.7998452186584473, 3.8146207332611084, 3.9118785858154297, 3.829568862915039, 3.2099111080169678, 3.371997833251953, 3.802952527999878]


epoch_time avg   25.02961827814579
loading_time avg   0.5059090107679367
 data loader gen time avg 16.308371663093567
	---backpack schedule time avg 4.195650279521942
	---connection_check_time avg  7.0693198293447495
	---block_gen_time avg  4.430595740675926
training time  8.184762686491013
---feature block loading time  3.8142038136720657
pure train time per /epoch  [6.887251138687134, 4.159015655517578, 4.206070184707642, 4.173313140869141, 4.20099663734436, 4.238248586654663, 4.344714879989624, 4.220452547073364, 4.148698329925537, 4.207437038421631, 4.171071529388428, 4.17136549949646, 4.170290946960449, 4.249232769012451, 4.178162336349487, 4.253673553466797, 4.19633674621582, 4.649718999862671, 4.749700307846069, 4.377118349075317]
pure train time average  4.276501893997192
num_input list  [17875391, 17854812, 17860349, 17869228, 17860919, 17855113, 17880127, 17872386, 17864675, 17869716, 17862723, 17865092, 17859343, 17867914, 17862764, 17864781, 17874075, 17857847, 17860267, 17861717]
num_input  average  17864961.95
