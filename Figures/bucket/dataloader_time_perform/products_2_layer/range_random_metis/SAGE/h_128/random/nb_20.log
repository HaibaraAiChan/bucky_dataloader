main start at this time 1713138525.1178687
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0093231201171875
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005789518356323242
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.553866147994995
self.buckets_partition() spend  sec:  0.015127420425415039
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.72412109375 GB
    Memory Allocated: 0.1918644905090332  GigaBytes
Max Memory Allocated: 0.1918644905090332  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.38818359375 GB
    Memory Allocated: 7.69417142868042  GigaBytes
Max Memory Allocated: 7.791210174560547  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 8.38818359375 GB
    Memory Allocated: 7.6964826583862305  GigaBytes
Max Memory Allocated: 7.791210174560547  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 8.56787109375 GB
    Memory Allocated: 0.3586249351501465  GigaBytes
Max Memory Allocated: 7.791210174560547  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.03857421875 GB
    Memory Allocated: 13.721377849578857  GigaBytes
Max Memory Allocated: 13.95693588256836  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.03857421875 GB
    Memory Allocated: 13.723068714141846  GigaBytes
Max Memory Allocated: 13.95693588256836  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.03857421875 GB
    Memory Allocated: 0.36365604400634766  GigaBytes
Max Memory Allocated: 13.95693588256836  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.03857421875 GB
    Memory Allocated: 13.719497203826904  GigaBytes
Max Memory Allocated: 13.95693588256836  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.03857421875 GB
    Memory Allocated: 13.721226692199707  GigaBytes
Max Memory Allocated: 13.95693588256836  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.03857421875 GB
    Memory Allocated: 0.37109851837158203  GigaBytes
Max Memory Allocated: 13.95693588256836  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.03857421875 GB
    Memory Allocated: 13.744205951690674  GigaBytes
Max Memory Allocated: 13.979216575622559  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.03857421875 GB
    Memory Allocated: 13.745896816253662  GigaBytes
Max Memory Allocated: 13.979216575622559  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.03857421875 GB
    Memory Allocated: 0.3768124580383301  GigaBytes
Max Memory Allocated: 13.979216575622559  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.78466796875 GB
    Memory Allocated: 13.752552509307861  GigaBytes
Max Memory Allocated: 13.98742961883545  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.78466796875 GB
    Memory Allocated: 13.75424337387085  GigaBytes
Max Memory Allocated: 13.98742961883545  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.78466796875 GB
    Memory Allocated: 0.384462833404541  GigaBytes
Max Memory Allocated: 13.98742961883545  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.78466796875 GB
    Memory Allocated: 13.762011051177979  GigaBytes
Max Memory Allocated: 13.997412204742432  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.78466796875 GB
    Memory Allocated: 13.763701915740967  GigaBytes
Max Memory Allocated: 13.997412204742432  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.78466796875 GB
    Memory Allocated: 0.39153194427490234  GigaBytes
Max Memory Allocated: 13.997412204742432  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.830722332000732  GigaBytes
Max Memory Allocated: 14.065564632415771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.83241319656372  GigaBytes
Max Memory Allocated: 14.065564632415771  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 0.39681053161621094  GigaBytes
Max Memory Allocated: 14.065564632415771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.823959350585938  GigaBytes
Max Memory Allocated: 14.065564632415771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.825650215148926  GigaBytes
Max Memory Allocated: 14.065564632415771  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 0.40224313735961914  GigaBytes
Max Memory Allocated: 14.065564632415771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.77340841293335  GigaBytes
Max Memory Allocated: 14.065564632415771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.77512788772583  GigaBytes
Max Memory Allocated: 14.065564632415771  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 0.40853214263916016  GigaBytes
Max Memory Allocated: 14.065564632415771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.767268180847168  GigaBytes
Max Memory Allocated: 14.065564632415771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.768959045410156  GigaBytes
Max Memory Allocated: 14.065564632415771  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 0.41532373428344727  GigaBytes
Max Memory Allocated: 14.065564632415771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.795951843261719  GigaBytes
Max Memory Allocated: 14.065564632415771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.797642707824707  GigaBytes
Max Memory Allocated: 14.065564632415771  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 0.4206876754760742  GigaBytes
Max Memory Allocated: 14.065564632415771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.811378002166748  GigaBytes
Max Memory Allocated: 14.065564632415771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.813068866729736  GigaBytes
Max Memory Allocated: 14.065564632415771  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 0.4275684356689453  GigaBytes
Max Memory Allocated: 14.065564632415771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.863493919372559  GigaBytes
Max Memory Allocated: 14.09821605682373  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.865184783935547  GigaBytes
Max Memory Allocated: 14.09821605682373  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 0.4340972900390625  GigaBytes
Max Memory Allocated: 14.09821605682373  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.82711124420166  GigaBytes
Max Memory Allocated: 14.09821605682373  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.828802108764648  GigaBytes
Max Memory Allocated: 14.09821605682373  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 0.44101762771606445  GigaBytes
Max Memory Allocated: 14.09821605682373  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.868350982666016  GigaBytes
Max Memory Allocated: 14.103617668151855  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.870041847229004  GigaBytes
Max Memory Allocated: 14.103617668151855  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 0.44615602493286133  GigaBytes
Max Memory Allocated: 14.103617668151855  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.873615741729736  GigaBytes
Max Memory Allocated: 14.10869312286377  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.875306606292725  GigaBytes
Max Memory Allocated: 14.10869312286377  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 0.4515848159790039  GigaBytes
Max Memory Allocated: 14.10869312286377  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.80875539779663  GigaBytes
Max Memory Allocated: 14.10869312286377  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.81079387664795  GigaBytes
Max Memory Allocated: 14.10869312286377  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 0.45856428146362305  GigaBytes
Max Memory Allocated: 14.10869312286377  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.843875408172607  GigaBytes
Max Memory Allocated: 14.10869312286377  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.845566272735596  GigaBytes
Max Memory Allocated: 14.10869312286377  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 0.4643416404724121  GigaBytes
Max Memory Allocated: 14.10869312286377  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.897228717803955  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.898923397064209  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 0.46944332122802734  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.825836658477783  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 13.827782154083252  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

number of input  16699620
----------------------------------------after optimizer
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 0.4901294708251953  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.20517110824585
pure train time :  3.840719699859619
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012773513793945312
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005059480667114258
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.5933594703674316
self.buckets_partition() spend  sec:  0.017854928970336914
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.53466796875 GB
    Memory Allocated: 0.2174854278564453  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 7.718371391296387  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 7.714505672454834  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.3618316650390625  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.78667688369751  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.788367748260498  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.3666706085205078  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.740646362304688  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.742361545562744  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.3746047019958496  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.804155826568604  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.805846691131592  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.379638671875  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.750944137573242  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.752667903900146  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.38612890243530273  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.808727264404297  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.810418128967285  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.39220237731933594  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.758027076721191  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.759965419769287  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.39748239517211914  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.784656524658203  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.786347389221191  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.40470457077026367  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.789180755615234  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.790871620178223  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4114832878112793  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.81064224243164  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.812333106994629  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.41536855697631836  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.78125810623169  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.783040046691895  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4232449531555176  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.85619306564331  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.857883930206299  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4294743537902832  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.813707828521729  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.815653324127197  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4350752830505371  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.818756580352783  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.820569515228271  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.43991518020629883  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.80615234375  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.807867050170898  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4479207992553711  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.842692375183105  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.844383239746094  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4542365074157715  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.88375997543335  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.885450839996338  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.460416316986084  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.845049858093262  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.846885204315186  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4648737907409668  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.842633724212646  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.844324588775635  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4723696708679199  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.895351886749268  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.897040843963623  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

number of input  16697812
----------------------------------------after optimizer
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4910621643066406  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.4709582328796387
pure train time :  2.464259147644043
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011261701583862305
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005137205123901367
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.5719573497772217
self.buckets_partition() spend  sec:  0.016421079635620117
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.21747446060180664  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 7.718388080596924  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 7.714519500732422  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.3622736930847168  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.789169311523438  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.790860176086426  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.3682284355163574  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.799797534942627  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.802281856536865  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.3730611801147461  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.724164009094238  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.726109504699707  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.3805251121520996  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.761280059814453  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.762970924377441  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.38527870178222656  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.783687591552734  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.78575849533081  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.39284229278564453  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.822804927825928  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.824495792388916  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.39992380142211914  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.834203243255615  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.83650827407837  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.40390586853027344  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.768505096435547  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.77043628692627  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.40961456298828125  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.778919219970703  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.780644416809082  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.41562366485595703  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.805094242095947  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.806785106658936  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.42206811904907227  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.810349464416504  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.812040328979492  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4286785125732422  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.789947986602783  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.791810512542725  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.43475341796875  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.79755973815918  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.799338817596436  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4417595863342285  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.835469722747803  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.837160587310791  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4477405548095703  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.88158369064331  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.88336706161499  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4536471366882324  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.823552131652832  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.825258255004883  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.45939016342163086  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.856242656707764  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.857933521270752  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.46599578857421875  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.893236637115479  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.894990921020508  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4725208282470703  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.848902225494385  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.850635051727295  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

number of input  16699546
----------------------------------------after optimizer
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4913911819458008  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7317421436309814
pure train time :  2.474825143814087
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012831926345825195
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0056226253509521484
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.5848326683044434
self.buckets_partition() spend  sec:  0.018477439880371094
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.21651363372802734  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 7.716447353363037  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 7.71258020401001  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.36101198196411133  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.751768589019775  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.753459453582764  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.366455078125  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.743505954742432  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.74519681930542  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.3735842704772949  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.805140972137451  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.80683183670044  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.37912416458129883  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.807870388031006  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.809815883636475  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.38598012924194336  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.781325340270996  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.783016204833984  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.3905949592590332  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.748636245727539  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.750621318817139  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.3984222412109375  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.784698009490967  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.786388874053955  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.404904842376709  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.83412790298462  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.836181163787842  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4111294746398926  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.791004180908203  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.792695045471191  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.41666460037231445  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.805115222930908  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.806806087493896  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.42324304580688477  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.849853992462158  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.851599216461182  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.42966556549072266  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.858055114746094  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.859745979309082  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4349637031555176  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.857389450073242  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.859334945678711  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.44158315658569336  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.839839458465576  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.841530323028564  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.44681549072265625  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.82008695602417  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.82178258895874  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4543890953063965  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.849201202392578  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.850892066955566  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.46211719512939453  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.895792007446289  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.897482872009277  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4657626152038574  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.826251029968262  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.82819652557373  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4733152389526367  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.896870613098145  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.898572444915771  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

number of input  16708103
----------------------------------------after optimizer
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.4926743507385254  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.2313425540924072
pure train time :  2.5034968852996826
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013987302780151367
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0051271915435791016
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.577542781829834
self.buckets_partition() spend  sec:  0.0191342830657959
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.2177290916442871  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 7.718132495880127  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 7.714264392852783  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.36214494705200195  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.782201290130615  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.783892154693604  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.3672618865966797  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.793930053710938  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.795620918273926  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.37234020233154297  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.750805854797363  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.75252103805542  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.37943124771118164  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.761187076568604  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.762943744659424  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.38673925399780273  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.820970058441162  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 13.82266092300415  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.54443359375 GB
    Memory Allocated: 0.39350414276123047  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.02294921875 GB
    Memory Allocated: 13.84455156326294  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.02294921875 GB
    Memory Allocated: 13.847062587738037  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.02294921875 GB
    Memory Allocated: 0.398709774017334  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.02294921875 GB
    Memory Allocated: 13.80131196975708  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.02294921875 GB
    Memory Allocated: 13.80324125289917  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.02294921875 GB
    Memory Allocated: 0.4052906036376953  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.04052734375 GB
    Memory Allocated: 13.830626487731934  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.04052734375 GB
    Memory Allocated: 13.832470417022705  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.04052734375 GB
    Memory Allocated: 0.4088773727416992  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.04248046875 GB
    Memory Allocated: 13.738479614257812  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.04248046875 GB
    Memory Allocated: 13.74026870727539  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.04248046875 GB
    Memory Allocated: 0.4168686866760254  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.05029296875 GB
    Memory Allocated: 13.822662830352783  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.05029296875 GB
    Memory Allocated: 13.824353694915771  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.05029296875 GB
    Memory Allocated: 0.42281532287597656  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.05615234375 GB
    Memory Allocated: 13.79908800125122  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.05615234375 GB
    Memory Allocated: 13.800778865814209  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.05615234375 GB
    Memory Allocated: 0.42906951904296875  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.05615234375 GB
    Memory Allocated: 13.81135082244873  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.05615234375 GB
    Memory Allocated: 13.813041687011719  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.05615234375 GB
    Memory Allocated: 0.4365534782409668  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.06982421875 GB
    Memory Allocated: 13.839215755462646  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.06982421875 GB
    Memory Allocated: 13.841827392578125  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.06982421875 GB
    Memory Allocated: 0.4435267448425293  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.07958984375 GB
    Memory Allocated: 13.844619274139404  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.07958984375 GB
    Memory Allocated: 13.847229957580566  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.07958984375 GB
    Memory Allocated: 0.44649267196655273  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.07958984375 GB
    Memory Allocated: 13.830995082855225  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.07958984375 GB
    Memory Allocated: 13.832685947418213  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.07958984375 GB
    Memory Allocated: 0.4539146423339844  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.08740234375 GB
    Memory Allocated: 13.820481300354004  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.08740234375 GB
    Memory Allocated: 13.822983264923096  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.08740234375 GB
    Memory Allocated: 0.46016359329223633  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.08740234375 GB
    Memory Allocated: 13.847000122070312  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.08740234375 GB
    Memory Allocated: 13.8486909866333  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.08740234375 GB
    Memory Allocated: 0.4667696952819824  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.10498046875 GB
    Memory Allocated: 13.870080471038818  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.10498046875 GB
    Memory Allocated: 13.872668266296387  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.10498046875 GB
    Memory Allocated: 0.4717850685119629  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.11279296875 GB
    Memory Allocated: 13.838660717010498  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.11279296875 GB
    Memory Allocated: 13.84044361114502  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

number of input  16706294
----------------------------------------after optimizer
 Nvidia-smi: 15.11279296875 GB
    Memory Allocated: 0.49029541015625  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7799291610717773
pure train time :  2.7418715953826904
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010791301727294922
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005190849304199219
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.5511608123779297
self.buckets_partition() spend  sec:  0.01600337028503418
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.11279296875 GB
    Memory Allocated: 0.21660184860229492  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.24169921875 GB
    Memory Allocated: 7.680580139160156  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.24169921875 GB
    Memory Allocated: 7.676713466644287  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.24169921875 GB
    Memory Allocated: 0.36241960525512695  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.7489013671875  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.751212120056152  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.36669301986694336  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.757190227508545  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.758881092071533  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.37421512603759766  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.765080451965332  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.767076969146729  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.37986278533935547  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.768741130828857  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.770516872406006  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.38549327850341797  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.758023262023926  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.759714126586914  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3928794860839844  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.800763130187988  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.803430080413818  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3978729248046875  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.76305627822876  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.764747142791748  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.40528106689453125  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.835307121276855  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.837605953216553  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4103870391845703  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.791813373565674  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.793512344360352  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.41533517837524414  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.787627220153809  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.789371490478516  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.422701358795166  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.817206859588623  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.819700717926025  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4281463623046875  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.809384822845459  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.811075687408447  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.43509674072265625  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.824945449829102  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.82663631439209  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.44157934188842773  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.834070682525635  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.835761547088623  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.44787025451660156  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.833386898040771  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.83547592163086  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.455594539642334  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.871119022369385  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.873657703399658  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4593825340270996  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.838522911071777  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.84022045135498  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.46555423736572266  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.849619388580322  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.851747512817383  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4719052314758301  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.835898876190186  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.837596416473389  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

number of input  16695616
----------------------------------------after optimizer
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4910011291503906  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.554726481437683
pure train time :  2.523261547088623
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012007951736450195
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004875898361206055
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.6699063777923584
self.buckets_partition() spend  sec:  0.01690363883972168
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.21674299240112305  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.680366039276123  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.67650032043457  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.36051225662231445  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.734029293060303  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.736340045928955  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3666720390319824  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.779941082000732  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.78183126449585  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3727073669433594  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.754202842712402  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.756007671356201  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.37995433807373047  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.803059577941895  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.804750442504883  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.38632678985595703  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.77698040008545  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.77933120727539  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.39257097244262695  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.784854888916016  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.786545753479004  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3992424011230469  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.833549976348877  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.835240840911865  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.404787540435791  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.829781532287598  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.831685543060303  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4107851982116699  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.802212715148926  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.804451942443848  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.41811704635620117  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.815988063812256  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.817678928375244  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.42362308502197266  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.832131385803223  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.834527492523193  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.43048095703125  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.837552547454834  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.840134143829346  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4350733757019043  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.806650161743164  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.808823108673096  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.44316577911376953  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.845889568328857  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.847580432891846  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4468369483947754  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.79297399520874  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.795399188995361  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4549074172973633  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.860682010650635  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.862550735473633  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4610443115234375  GigaBytes
Max Memory Allocated: 14.131954669952393  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.904083728790283  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.90588665008545  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.46642208099365234  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.839479923248291  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.84117078781128  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.47242021560668945  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.838573932647705  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.840277194976807  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

number of input  16713335
----------------------------------------after optimizer
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.49153900146484375  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3970060348510742
pure train time :  2.578908681869507
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009906291961669922
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004937648773193359
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.6015126705169678
self.buckets_partition() spend  sec:  0.014866352081298828
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.21651077270507812  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.680515289306641  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.67664909362793  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3619418144226074  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.765170574188232  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.767096996307373  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3665957450866699  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.739217281341553  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.740931510925293  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3727583885192871  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.76592206954956  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.767612934112549  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3807229995727539  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.77364206314087  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.775332927703857  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3867049217224121  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.769301891326904  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.770992755889893  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3934812545776367  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.837821006774902  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.839720249176025  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.39864444732666016  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.823033332824707  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.82493257522583  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.40590429306030273  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.83165979385376  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.833798885345459  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4123854637145996  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.807506561279297  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.809870719909668  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.41602230072021484  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.757877349853516  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.75976037979126  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4217958450317383  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.790808200836182  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.792572021484375  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4292869567871094  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.823264598846436  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.825656414031982  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.43466901779174805  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.8229341506958  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.825165748596191  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4415311813354492  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.840864181518555  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.842965126037598  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.44736814498901367  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.84838581085205  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.850076675415039  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.45243215560913086  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.83228063583374  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.833971500396729  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4605894088745117  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.851961135864258  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.853652000427246  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.46828365325927734  GigaBytes
Max Memory Allocated: 14.138805389404297  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.908390998840332  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.91010570526123  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.47121334075927734  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.83611536026001  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.837804317474365  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

number of input  16705685
----------------------------------------after optimizer
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.49030494689941406  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.273160457611084
pure train time :  2.473963737487793
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016015052795410156
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004992485046386719
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.6061110496520996
self.buckets_partition() spend  sec:  0.021027088165283203
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.21658086776733398  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.681602954864502  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.677737236022949  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3607754707336426  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.725694179534912  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.727742195129395  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.36733150482177734  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.759196758270264  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.760887622833252  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.373382568359375  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.755667686462402  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.757818698883057  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.38033103942871094  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.790170192718506  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.792688369750977  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.38634157180786133  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.783464431762695  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.785574436187744  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3937406539916992  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.838596820831299  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.841219425201416  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.39946651458740234  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.81658124923706  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.818896293640137  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4045853614807129  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.794923305511475  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.797347068786621  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.409304141998291  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.754080295562744  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.756593704223633  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4162273406982422  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.806353092193604  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.808298587799072  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4214496612548828  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.79728078842163  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.798976421356201  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.42862844467163086  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.818703174591064  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.82072925567627  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4356212615966797  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.835079193115234  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.836770057678223  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.44205570220947266  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.82329273223877  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.824983596801758  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4484128952026367  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.862491130828857  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.864959716796875  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4551987648010254  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.885615348815918  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.887763500213623  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4592857360839844  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.808603763580322  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.810751914978027  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.46730899810791016  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.87873125076294  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.881353378295898  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.47303199768066406  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.853838443756104  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.856460571289062  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

number of input  16700717
----------------------------------------after optimizer
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.49118566513061523  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1715272665023804
pure train time :  2.4617397785186768
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010440826416015625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004943132400512695
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.5793538093566895
self.buckets_partition() spend  sec:  0.01540374755859375
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.21665573120117188  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.681978702545166  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.678111553192139  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.36023473739624023  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.737741947174072  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.740112781524658  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.366300106048584  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.74611520767212  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.747806072235107  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.37285852432250977  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.758347988128662  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.76003885269165  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.38032102584838867  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.790507316589355  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.793139934539795  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3864431381225586  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.735149383544922  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.737379550933838  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3913726806640625  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.751224517822266  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.752925872802734  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3974285125732422  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.789539337158203  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.791230201721191  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4040207862854004  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.773585796356201  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.775374412536621  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4115018844604492  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.82404613494873  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.825736999511719  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4163494110107422  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.800626277923584  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.802317142486572  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.42372941970825195  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.831433296203613  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.833124160766602  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4293055534362793  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.838955879211426  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.841559886932373  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4365215301513672  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.859296798706055  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.861698150634766  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.44231128692626953  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.840842247009277  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.842533111572266  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4471879005432129  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.800634860992432  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.802693843841553  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.45367431640625  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.825145244598389  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.826888084411621  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4599285125732422  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.83835744857788  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.840612888336182  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4658083915710449  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.857307434082031  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.85899829864502  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4727940559387207  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.858758449554443  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.860776901245117  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

number of input  16696870
----------------------------------------after optimizer
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4915618896484375  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.079056739807129
pure train time :  2.5279946327209473
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.00966024398803711
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.011138439178466797
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.5678954124450684
self.buckets_partition() spend  sec:  0.020823001861572266
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.21660232543945312  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.679781913757324  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.675914287567139  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.36201000213623047  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.746508121490479  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.748198986053467  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.36845874786376953  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.761700630187988  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.764007568359375  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.37229299545288086  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.746245384216309  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.747944355010986  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.38038206100463867  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.790266036987305  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.791956901550293  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.38504600524902344  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.765775680541992  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.76746654510498  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.39118003845214844  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.781054019927979  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.782764911651611  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.39916324615478516  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.812204360961914  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.814731121063232  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.40486717224121094  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.833169937133789  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.83544921875  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.41033363342285156  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.79989242553711  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.801583290100098  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.41741275787353516  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.820881843566895  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.822572708129883  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4230833053588867  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.810046672821045  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.811737537384033  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4287405014038086  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.795564651489258  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.797336101531982  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.43450403213500977  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.781171798706055  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.783658981323242  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4404773712158203  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.810742855072021  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.81243371963501  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4465179443359375  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.865262031555176  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.867681503295898  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4550971984863281  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.845858573913574  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.847549438476562  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4597029685974121  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.82293701171875  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.824627876281738  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.46598005294799805  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.874264240264893  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.87595510482788  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.47353267669677734  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.861035823822021  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.862724781036377  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

number of input  16697496
----------------------------------------after optimizer
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.49357032775878906  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0003163814544678
pure train time :  2.5825016498565674
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011683940887451172
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.00504612922668457
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.5743649005889893
self.buckets_partition() spend  sec:  0.016760587692260742
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.2174386978149414  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.682112693786621  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.6782450675964355  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.36089086532592773  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.729387760162354  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.731698513031006  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.36768007278442383  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.764759540557861  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.766686916351318  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.37329721450805664  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.784938335418701  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.787400245666504  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.38020849227905273  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.775236129760742  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.776931285858154  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.38626813888549805  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.798821926116943  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.800512790679932  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3944258689880371  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.832552909851074  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.834409236907959  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3980722427368164  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.811293125152588  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.813149452209473  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.40433168411254883  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.785523414611816  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.787214279174805  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.41174745559692383  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.828120231628418  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.830694675445557  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4176626205444336  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.811381340026855  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.813955783843994  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4229273796081543  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.811978340148926  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.813669204711914  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4289827346801758  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.811029434204102  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.813058853149414  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4348464012145996  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.82203722000122  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.823728084564209  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.44168710708618164  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.812686920166016  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.814377784729004  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4481773376464844  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.853254795074463  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.855878353118896  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4541306495666504  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.804183959960938  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.806023120880127  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4596672058105469  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.842557907104492  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.84424877166748  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.46602678298950195  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.847386837005615  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.849132061004639  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.47324228286743164  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.85757827758789  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.859753131866455  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

number of input  16708510
----------------------------------------after optimizer
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4918527603149414  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9569237232208252
pure train time :  2.5871129035949707
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011640310287475586
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.0052607059478759766
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.572481155395508
self.buckets_partition() spend  sec:  0.0169222354888916
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.21653509140014648  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.679781913757324  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.675914287567139  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3605952262878418  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.748233795166016  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.750541687011719  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.36576414108276367  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.734004020690918  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.735756397247314  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.37360334396362305  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.772629261016846  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.774540424346924  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3808913230895996  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.80675458908081  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.808506965637207  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3864569664001465  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.801918029785156  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.804277896881104  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3926701545715332  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.786025047302246  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.788447380065918  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3994450569152832  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.811009407043457  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.81354808807373  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4043302536010742  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.765313148498535  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.767004013061523  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4092569351196289  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.751588821411133  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.753705501556396  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.41658878326416016  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.837717533111572  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.83947229385376  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4230208396911621  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.826989650726318  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.828855514526367  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4278392791748047  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.779847621917725  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.782315731048584  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.43511390686035156  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.821545600891113  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.823236465454102  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.44119977951049805  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.788279056549072  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.78996992111206  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.44776296615600586  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.84194803237915  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.843842506408691  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.45580339431762695  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.87567138671875  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.877424716949463  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4594440460205078  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.801146507263184  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.803682327270508  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4654245376586914  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.854197025299072  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.85588788986206  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4743518829345703  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.893864154815674  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.896275997161865  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

number of input  16698333
----------------------------------------after optimizer
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4936389923095703  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9122735857963562
pure train time :  2.58594012260437
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011044740676879883
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004901409149169922
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.5741634368896484
self.buckets_partition() spend  sec:  0.015967369079589844
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.21719980239868164  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.681056499481201  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.677186489105225  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3626065254211426  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.7590970993042  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.761407852172852  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.36672258377075195  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.74876356124878  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.750454425811768  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3724555969238281  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.742572784423828  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.744263648986816  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.37828588485717773  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.744586944580078  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.746277809143066  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3867788314819336  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.801924228668213  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.804489612579346  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3938331604003906  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.828742027282715  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.830575942993164  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.39600276947021484  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.719707489013672  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.721541404724121  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4039154052734375  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.784118175506592  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.785837650299072  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.41035032272338867  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.816390991210938  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.818278312683105  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4160728454589844  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.807043075561523  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.808733940124512  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.42438220977783203  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.824055194854736  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.825746059417725  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4295988082885742  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.829094886779785  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.831746578216553  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.43764209747314453  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.871775150299072  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.873705863952637  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4406108856201172  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.825589179992676  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.827280044555664  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.44760704040527344  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.826422691345215  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.828570365905762  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.45432424545288086  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.870095252990723  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.871786117553711  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.45929670333862305  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.836035251617432  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.83772611618042  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.46577930450439453  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.832773685455322  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.834538459777832  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4729137420654297  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.87230110168457  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.874542236328125  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

number of input  16700529
----------------------------------------after optimizer
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.49210691452026367  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8724644780158997
pure train time :  2.5202577114105225
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009427547454833984
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004910945892333984
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.5746493339538574
self.buckets_partition() spend  sec:  0.0143585205078125
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.21673202514648438  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.68157958984375  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.677711009979248  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.36134815216064453  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.764735221862793  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.766426086425781  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3686184883117676  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.768177032470703  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.769867897033691  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3737812042236328  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.773019313812256  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.774980545043945  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.37962818145751953  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.783311367034912  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.785055160522461  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3853940963745117  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.772296905517578  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.774421691894531  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3914680480957031  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.772005081176758  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.773797512054443  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.39952802658081055  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.798476219177246  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.800167083740234  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4049367904663086  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.815631866455078  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.818242073059082  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.41169309616088867  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.805486679077148  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.808096885681152  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4177103042602539  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.8374924659729  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.83983564376831  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4247126579284668  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.829775333404541  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.832118511199951  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.429232120513916  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.797239303588867  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.798930168151855  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.43453502655029297  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.799099445343018  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.800869941711426  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4404420852661133  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.798427104949951  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.80011796951294  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.44818782806396484  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.83691120147705  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.838602066040039  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.45456981658935547  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.836024761199951  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.838048458099365  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.46004533767700195  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.864638805389404  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.866329669952393  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.46611547470092773  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.857254028320312  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.859357833862305  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.47165346145629883  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.843295574188232  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.844984531402588  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

number of input  16707380
----------------------------------------after optimizer
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4902935028076172  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8311658501625061
pure train time :  2.502192974090576
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010415315628051758
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.00496983528137207
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.56598162651062
self.buckets_partition() spend  sec:  0.01541757583618164
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.2166757583618164  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.681580543518066  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.677713871002197  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3617849349975586  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.765549659729004  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.767314910888672  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3646993637084961  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.727063179016113  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.728754997253418  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.37351131439208984  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.753519535064697  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.755210399627686  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.37898921966552734  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.749610424041748  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.7513427734375  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.38501548767089844  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.781790256500244  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.784308433532715  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3921060562133789  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.772603034973145  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.774293899536133  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.39903831481933594  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.828831672668457  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.831048488616943  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4044923782348633  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.791303157806396  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.792994022369385  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.41182613372802734  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.833871364593506  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.836219310760498  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4164152145385742  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.811678886413574  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.814026832580566  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.42087507247924805  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.746882915496826  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.748786926269531  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.42975568771362305  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.82165813446045  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.823348999023438  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4352726936340332  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.812971591949463  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.814662456512451  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4420604705810547  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.86851167678833  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.870686531066895  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4481773376464844  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.85243034362793  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.854605197906494  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.45238447189331055  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.818915843963623  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.820625305175781  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.45954036712646484  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.812955379486084  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.814646244049072  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.46605348587036133  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.84934949874878  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.851040363311768  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.47243261337280273  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.868528366088867  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.870217323303223  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

number of input  16689496
----------------------------------------after optimizer
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.49230480194091797  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7926579117774963
pure train time :  2.483092784881592
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009613275527954102
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.00491786003112793
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.54874849319458
self.buckets_partition() spend  sec:  0.01454925537109375
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.21733570098876953  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.6821136474609375  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.6782450675964355  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3618302345275879  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.742110252380371  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.744421005249023  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3674435615539551  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.763364791870117  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.765055656433105  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3748664855957031  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.802262306213379  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.804658889770508  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.37862586975097656  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.744178771972656  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.746599197387695  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3861536979675293  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.788720607757568  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.790411472320557  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.39258384704589844  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.790878295898438  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.792569160461426  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.39851999282836914  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.782743453979492  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.784853458404541  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4041471481323242  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.775895118713379  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.777585983276367  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4101715087890625  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.827181339263916  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.82980489730835  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4171929359436035  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.800453662872314  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.803077220916748  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.42212533950805664  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.793517112731934  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.795207977294922  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.42871761322021484  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.79383897781372  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.795529842376709  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.43503236770629883  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.847776889801025  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.850419998168945  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4420185089111328  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.812183380126953  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.813910484313965  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.44692373275756836  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.81526231765747  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.81722116470337  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4557991027832031  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.884825229644775  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.88654375076294  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.46010732650756836  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.831795692443848  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.833534240722656  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4667172431945801  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.85743761062622  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.85946798324585  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4719376564025879  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.868036270141602  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.869725227355957  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

number of input  16700325
----------------------------------------after optimizer
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4914417266845703  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7599946856498718
pure train time :  2.453933000564575
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011797904968261719
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005087614059448242
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.6050076484680176
self.buckets_partition() spend  sec:  0.0169064998626709
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.21697330474853516  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.682113170623779  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.6782450675964355  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.36261749267578125  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.77509593963623  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.777406692504883  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3675227165222168  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.760700225830078  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.763323783874512  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3741326332092285  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.751675605773926  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.753366470336914  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.37915468215942383  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.769285678863525  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.770976543426514  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3865480422973633  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.780384063720703  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.782074928283691  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.39175987243652344  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.770544052124023  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.772718906402588  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.39676475524902344  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.783793926239014  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.785484790802002  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.40476322174072266  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.78388261795044  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.785945415496826  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4102783203125  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.808911800384521  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.81060266494751  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4179048538208008  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.807533264160156  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.809565544128418  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.42452192306518555  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.85557746887207  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.857688426971436  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.42812633514404297  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.78866720199585  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.790420532226562  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4362211227416992  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.849999904632568  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.85196304321289  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4416022300720215  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.819129467010498  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.820820331573486  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4472956657409668  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.819079875946045  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.820775508880615  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.45258617401123047  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.815207958221436  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.81692361831665  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4592304229736328  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.853819370269775  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.855510234832764  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4662899971008301  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.856204509735107  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.858116149902344  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.473207950592041  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.846810817718506  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.848499774932861  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

number of input  16698796
----------------------------------------after optimizer
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.49141359329223633  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7318155765533447
pure train time :  2.491809368133545
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010827064514160156
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.005143165588378906
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.559566020965576
self.buckets_partition() spend  sec:  0.015990734100341797
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.21660900115966797  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.681576251983643  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.677709579467773  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.36159706115722656  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.770705223083496  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.772396087646484  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3678107261657715  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.759626388549805  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.761317253112793  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3734893798828125  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.760737419128418  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.762709140777588  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3798666000366211  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.787515640258789  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.789206504821777  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3856959342956543  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.777455806732178  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.779146671295166  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3899550437927246  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.746698379516602  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.749147891998291  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.398165225982666  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.783079624176025  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.784770488739014  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4052891731262207  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.819622993469238  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.822158813476562  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4104175567626953  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.784027099609375  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.7865629196167  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.41560840606689453  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.78309965133667  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.784884452819824  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4221792221069336  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.798539638519287  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.800230503082275  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.42870235443115234  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.819744110107422  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.82143497467041  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.43653297424316406  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.866507053375244  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.868673324584961  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4422788619995117  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.849850177764893  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.85201644897461  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.44631385803222656  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.81682014465332  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.818511009216309  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.45436954498291016  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.8807954788208  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.882973670959473  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4613966941833496  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.879517078399658  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.88169527053833  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4674105644226074  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.871227264404297  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.873076438903809  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.47252893447875977  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.846210956573486  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.847899913787842  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

number of input  16698886
----------------------------------------after optimizer
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4916377067565918  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7028754353523254
pure train time :  2.4775407314300537
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
weights_list  [0.06711569865341276, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010595083236694336
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.004970073699951172
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  3.586987018585205
self.buckets_partition() spend  sec:  0.015585184097290039
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.21677398681640625  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.682817459106445  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 7.678950309753418  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.36205482482910156  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.796905040740967  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.79880142211914  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3676323890686035  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.781449794769287  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.783346176147461  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3744630813598633  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.75997543334961  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.761666297912598  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.37968921661376953  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.749648571014404  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.751339435577393  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.38594865798950195  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.785452842712402  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.78714370727539  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.39133501052856445  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.759613513946533  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.761304378509521  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.3990459442138672  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.795629501342773  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.797320365905762  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4033169746398926  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.78230619430542  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.783997058868408  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.410311222076416  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.787121295928955  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.788877487182617  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4165635108947754  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.806758880615234  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.809216499328613  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4223041534423828  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.811723709106445  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.813414573669434  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4288969039916992  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.81842565536499  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.820412635803223  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4346895217895508  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.81947660446167  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.821167469024658  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.441317081451416  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.840446949005127  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.842137813568115  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4469914436340332  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.831510543823242  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.833636283874512  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.45334291458129883  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.826426982879639  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.828117847442627  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.4606046676635742  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.887160301208496  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.889427661895752  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.46698760986328125  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.890903949737549  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.89329481124878  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.47351980209350586  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.853442192077637  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 13.855131149291992  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

number of input  16700019
----------------------------------------after optimizer
 Nvidia-smi: 15.97607421875 GB
    Memory Allocated: 0.49219846725463867  GigaBytes
Max Memory Allocated: 14.144169807434082  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6727292537689209
pure train time :  2.4669041633605957
epoch_time_list  [24.880586862564087, 23.43759846687317, 21.756690979003906, 21.936054229736328, 22.584434986114502, 22.02021884918213, 22.334757089614868, 22.049972534179688, 21.16307234764099, 21.808091402053833, 22.083346843719482, 21.61945867538452, 22.003957509994507, 21.85149621963501, 21.90046453475952, 21.948386669158936, 20.948779106140137, 21.309146881103516, 22.02439594268799, 22.12052083015442]

loading_time list   [0.566502571105957, 0.5906672477722168, 0.503868579864502, 0.47060084342956543, 0.47645068168640137, 0.4095892906188965, 0.45572447776794434, 0.4073972702026367, 0.4559509754180908, 0.4260883331298828, 0.43480992317199707, 0.39456653594970703, 0.4523355960845947, 0.47321009635925293, 0.4241602420806885, 0.38701653480529785, 0.3639214038848877, 0.37610602378845215, 0.44257426261901855, 0.44103455543518066]

 data loader gen time  15.203148365020752
	---backpack schedule time  [3.636363983154297, 3.661418914794922, 3.6494877338409424, 3.6551198959350586, 3.642564535140991, 3.6239876747131348, 3.731466770172119, 3.6823782920837402, 3.691066265106201, 3.647740602493286, 3.6466188430786133, 3.6465401649475098, 3.648468255996704, 3.6574997901916504, 3.637650966644287, 3.6316773891448975, 3.6182522773742676, 3.690190315246582, 3.634120225906372, 3.6479732990264893]
	---connection_check_time_list  [7.633435964584351, 7.8254334926605225, 6.550289869308472, 7.011965036392212, 6.82434344291687, 6.798681735992432, 6.831355333328247, 6.718921422958374, 6.189817905426025, 6.7961106300354, 6.65037202835083, 6.407062292098999, 6.495281457901001, 6.433591604232788, 6.833667039871216, 6.726780414581299, 6.2273547649383545, 6.262688636779785, 6.519607305526733, 6.773582696914673]
	---block_gen_time_list  [4.34524393081665, 4.228799104690552, 3.9793150424957275, 3.758441925048828, 4.311593294143677, 4.089750528335571, 4.2407546043396, 4.1798224449157715, 3.8337998390197754, 3.9640610218048096, 4.123874664306641, 4.159363031387329, 4.343979835510254, 4.26359486579895, 3.9958231449127197, 4.151077747344971, 3.6717824935913086, 3.909041166305542, 4.3170130252838135, 4.2004475593566895]
training time  [8.088311910629272, 6.50934624671936, 6.448340177536011, 6.444764614105225, 6.722203969955444, 6.5115416049957275, 6.470788955688477, 6.470107078552246, 6.403970241546631, 6.37668776512146, 6.629676342010498, 6.424179553985596, 6.468623399734497, 6.410379886627197, 6.415130376815796, 6.462851047515869, 6.488142490386963, 6.479487895965576, 6.515913009643555, 6.469213247299194]
---feature block loading time  [4.231811285018921, 3.9458537101745605, 3.875227689743042, 3.8441336154937744, 3.8878350257873535, 3.890587568283081, 3.791848659515381, 3.8983452320098877, 3.841773509979248, 3.756847858428955, 3.7804036140441895, 3.7437407970428467, 3.791552782058716, 3.799975633621216, 3.812191963195801, 3.8770627975463867, 3.934758424758911, 3.889486074447632, 3.9362378120422363, 3.903991937637329]


epoch_time avg   21.860656276345253
loading_time avg   0.4263085126876831
 data loader gen time avg 14.944890290498734
	---backpack schedule time avg 3.654887229204178
	---connection_check_time avg  6.593076169490814
	---block_gen_time avg  4.109736204147339
training time  6.482431054115295
---feature block loading time  3.846039980649948
pure train time per /epoch  [3.840719699859619, 2.464259147644043, 2.474825143814087, 2.5034968852996826, 2.7418715953826904, 2.523261547088623, 2.578908681869507, 2.473963737487793, 2.4617397785186768, 2.5279946327209473, 2.5825016498565674, 2.5871129035949707, 2.58594012260437, 2.5202577114105225, 2.502192974090576, 2.483092784881592, 2.453933000564575, 2.491809368133545, 2.4775407314300537, 2.4669041633605957]
pure train time average  2.527207192252664
num_input list  [16699620, 16697812, 16699546, 16708103, 16706294, 16695616, 16713335, 16705685, 16700717, 16696870, 16697496, 16708510, 16698333, 16700529, 16707380, 16689496, 16700325, 16698796, 16698886, 16700019]
num_input  average  16701168.4
