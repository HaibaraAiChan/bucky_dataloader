main start at this time 1713152602.7995758
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 1.263 seconds, peak memory: 19.343 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 19.343 GB
Metis partitioning: 2.038 seconds, peak memory: 19.586 GB
Split the graph: 0.710 seconds
Construct subgraphs: 0.025 seconds
metis partition ---------------pure dgl.metis_partition spent  4.047067403793335
10614
10079
10612
10426
10214
10551
10516
10065
10124
10536
10147
10127
10193
10189
10164
10221
10613
10587
10593
metis partition time  4.0519280433654785
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009227752685546875
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.068626880645752
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.439130544662476
self.buckets_partition() spend  sec:  4.077892541885376
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.87060546875 GB
    Memory Allocated: 0.34673500061035156  GigaBytes
Max Memory Allocated: 0.34673500061035156  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.32958984375 GB
    Memory Allocated: 14.480916023254395  GigaBytes
Max Memory Allocated: 14.725891590118408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.32958984375 GB
    Memory Allocated: 14.483219146728516  GigaBytes
Max Memory Allocated: 14.725891590118408  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.33740234375 GB
    Memory Allocated: 0.3631124496459961  GigaBytes
Max Memory Allocated: 14.725891590118408  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.09521484375 GB
    Memory Allocated: 13.871716022491455  GigaBytes
Max Memory Allocated: 14.725891590118408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.09521484375 GB
    Memory Allocated: 13.873481273651123  GigaBytes
Max Memory Allocated: 14.725891590118408  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.09521484375 GB
    Memory Allocated: 0.376922607421875  GigaBytes
Max Memory Allocated: 14.725891590118408  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.09716796875 GB
    Memory Allocated: 14.44304084777832  GigaBytes
Max Memory Allocated: 14.725891590118408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.09716796875 GB
    Memory Allocated: 14.445136070251465  GigaBytes
Max Memory Allocated: 14.725891590118408  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.09716796875 GB
    Memory Allocated: 0.3818087577819824  GigaBytes
Max Memory Allocated: 14.725891590118408  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.10107421875 GB
    Memory Allocated: 14.30058479309082  GigaBytes
Max Memory Allocated: 14.725891590118408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.10107421875 GB
    Memory Allocated: 14.30278730392456  GigaBytes
Max Memory Allocated: 14.725891590118408  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.10107421875 GB
    Memory Allocated: 0.3844609260559082  GigaBytes
Max Memory Allocated: 14.725891590118408  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.10498046875 GB
    Memory Allocated: 14.059738159179688  GigaBytes
Max Memory Allocated: 14.725891590118408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.10498046875 GB
    Memory Allocated: 14.062129020690918  GigaBytes
Max Memory Allocated: 14.725891590118408  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.10498046875 GB
    Memory Allocated: 0.3983898162841797  GigaBytes
Max Memory Allocated: 14.725891590118408  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.12841796875 GB
    Memory Allocated: 14.515595436096191  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.12841796875 GB
    Memory Allocated: 14.51764726638794  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.12841796875 GB
    Memory Allocated: 0.4023604393005371  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.13818359375 GB
    Memory Allocated: 14.408053874969482  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.13818359375 GB
    Memory Allocated: 14.410167694091797  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.13818359375 GB
    Memory Allocated: 0.40232324600219727  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.13818359375 GB
    Memory Allocated: 13.922595500946045  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.13818359375 GB
    Memory Allocated: 13.924629211425781  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.13818359375 GB
    Memory Allocated: 0.4096651077270508  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.13818359375 GB
    Memory Allocated: 13.903174877166748  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.13818359375 GB
    Memory Allocated: 13.905304431915283  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.13818359375 GB
    Memory Allocated: 0.4216022491455078  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.14990234375 GB
    Memory Allocated: 14.401927947998047  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.14990234375 GB
    Memory Allocated: 14.403773307800293  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.14990234375 GB
    Memory Allocated: 0.422152042388916  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.15576171875 GB
    Memory Allocated: 13.98210620880127  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.15576171875 GB
    Memory Allocated: 13.983951568603516  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.15576171875 GB
    Memory Allocated: 0.42758703231811523  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.16357421875 GB
    Memory Allocated: 13.970563888549805  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.16357421875 GB
    Memory Allocated: 13.972922801971436  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.16357421875 GB
    Memory Allocated: 0.43915271759033203  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.16552734375 GB
    Memory Allocated: 14.109829425811768  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.16552734375 GB
    Memory Allocated: 14.112471580505371  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.16552734375 GB
    Memory Allocated: 0.440645694732666  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.17724609375 GB
    Memory Allocated: 13.973905563354492  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.17724609375 GB
    Memory Allocated: 13.976439952850342  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.17724609375 GB
    Memory Allocated: 0.44815969467163086  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.17724609375 GB
    Memory Allocated: 14.022936344146729  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.17724609375 GB
    Memory Allocated: 14.025086879730225  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.17724609375 GB
    Memory Allocated: 0.45444726943969727  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.18701171875 GB
    Memory Allocated: 14.084737777709961  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.18701171875 GB
    Memory Allocated: 14.086528301239014  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.18701171875 GB
    Memory Allocated: 0.4689602851867676  GigaBytes
Max Memory Allocated: 14.759398460388184  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.51318359375 GB
    Memory Allocated: 14.61820125579834  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.51318359375 GB
    Memory Allocated: 14.62012767791748  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.51318359375 GB
    Memory Allocated: 0.47417163848876953  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.52490234375 GB
    Memory Allocated: 14.486033916473389  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.52490234375 GB
    Memory Allocated: 14.488715171813965  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.52490234375 GB
    Memory Allocated: 0.4797072410583496  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.528979778289795  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.53124189376831  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

number of input  16523630
----------------------------------------after optimizer
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.5016436576843262  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.213376045227051
pure train time :  5.433808326721191
the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 0.552 seconds, peak memory: 45.350 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.350 GB
Metis partitioning: 2.067 seconds, peak memory: 45.350 GB
Split the graph: 0.661 seconds
Construct subgraphs: 0.040 seconds
metis partition ---------------pure dgl.metis_partition spent  3.329897165298462
10081
10579
10608
10581
10290
10163
10451
10316
10639
10393
10101
10129
10099
10576
10531
10168
10492
10072
10302
metis partition time  3.334810733795166
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01189565658569336
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.3508331775665283
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.750294923782349
self.buckets_partition() spend  sec:  3.3628058433532715
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.3634772300720215  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.831406593322754  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.826966285705566  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.371917724609375  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.434317111968994  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.436756134033203  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.37984704971313477  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.43677043914795  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.438864707946777  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.38727283477783203  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.429332733154297  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.431713104248047  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.3887825012207031  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.094507694244385  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.0968017578125  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.39201784133911133  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.971294403076172  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.973074436187744  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.40547895431518555  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.39091444015503  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.392953395843506  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.40619611740112305  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.135109424591064  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.136916160583496  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4177079200744629  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.512855529785156  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.515236377716064  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4219489097595215  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.295520782470703  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.297780990600586  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4233427047729492  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.94858980178833  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.950614929199219  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.430727481842041  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.977914333343506  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.980547428131104  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.43538713455200195  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.917257308959961  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.919274806976318  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4506516456604004  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.538947582244873  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.540832996368408  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.45586490631103516  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.452189445495605  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.454306602478027  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4561653137207031  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.027897357940674  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.029858589172363  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.46755409240722656  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.451188087463379  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.453027248382568  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.46853208541870117  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.934667587280273  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.93673849105835  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.47711610794067383  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.19658088684082  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.198553085327148  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

number of input  16513391
----------------------------------------after optimizer
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.49689483642578125  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.4797000885009766
pure train time :  4.2054924964904785
the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 0.547 seconds, peak memory: 45.350 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.350 GB
Metis partitioning: 2.068 seconds, peak memory: 45.350 GB
Split the graph: 0.568 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  3.23262095451355
10081
10579
10608
10581
10290
10163
10451
10316
10639
10393
10101
10129
10099
10576
10531
10168
10492
10072
10302
metis partition time  3.2369766235351562
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010128498077392578
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.2551629543304443
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.052256345748901
self.buckets_partition() spend  sec:  3.265352487564087
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.364717960357666  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.852221488952637  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.847729682922363  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.3713655471801758  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.396326541900635  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.398226261138916  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.37951231002807617  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.456269264221191  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.458999633789062  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.3862624168395996  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.448421001434326  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.450900554656982  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.3883481025695801  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.148706912994385  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.150705337524414  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.39191770553588867  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.95291805267334  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.954863548278809  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.40409088134765625  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.31787919998169  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.319945335388184  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4055180549621582  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.119882583618164  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.122056484222412  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.419644832611084  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.529269218444824  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.53165578842163  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.421175479888916  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.289345741271973  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.291377544403076  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4233403205871582  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.898884773254395  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.900905132293701  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4307112693786621  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.973062992095947  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.974837303161621  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4358086585998535  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.944684982299805  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.946454048156738  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4505906105041504  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.495690822601318  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.497577667236328  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4565262794494629  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.48375940322876  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.486217498779297  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4569664001464844  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.056385040283203  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.058166027069092  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4692540168762207  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.45325517654419  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.455131530761719  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4670548439025879  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.917628765106201  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.919535160064697  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.477022647857666  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.201391220092773  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.203195571899414  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

number of input  16514841
----------------------------------------after optimizer
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.49694061279296875  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7293601036071777
pure train time :  4.087001800537109
the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 0.442 seconds, peak memory: 45.350 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.350 GB
Metis partitioning: 2.027 seconds, peak memory: 45.350 GB
Split the graph: 0.571 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  3.078667640686035
10621
10092
10654
10566
10498
10583
10471
10128
10296
10562
10591
10404
10071
10091
10084
10115
10098
10547
10099
metis partition time  3.083292245864868
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015365362167358398
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1116864681243896
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  8.503178596496582
self.buckets_partition() spend  sec:  3.127208948135376
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.373105525970459  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.524059772491455  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.520035743713379  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.36617469787597656  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.884680271148682  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.886701107025146  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.38014984130859375  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.488797187805176  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.491071224212646  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.38611602783203125  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.427064895629883  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.429127216339111  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.3919849395751953  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.434123992919922  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.436138153076172  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.39900732040405273  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.442607402801514  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.444697380065918  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.40500831604003906  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.386487007141113  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.388548374176025  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.40410280227661133  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.931507110595703  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.933427333831787  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.41512107849121094  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.17928171157837  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.181230068206787  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.42319536209106445  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.443700790405273  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.445559978485107  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.43352556228637695  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.515277862548828  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.517132759094238  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4364504814147949  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.280728340148926  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.282930850982666  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4377861022949219  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.954241752624512  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.956005573272705  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4423222541809082  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.895199298858643  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.897229671478271  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.44818925857543945  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.945218086242676  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.94698429107666  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4563131332397461  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.967473030090332  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.970164775848389  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4613075256347656  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.914264678955078  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.916916370391846  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4747142791748047  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.429291725158691  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.431275844573975  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4748396873474121  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.012599468231201  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.014583587646484  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

number of input  16525327
----------------------------------------after optimizer
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.494290828704834  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.234405755996704
pure train time :  4.2100067138671875
the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 0.578 seconds, peak memory: 45.350 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.350 GB
Metis partitioning: 2.399 seconds, peak memory: 45.350 GB
Split the graph: 1.307 seconds
Construct subgraphs: 0.040 seconds
metis partition ---------------pure dgl.metis_partition spent  4.3249406814575195
10081
10579
10608
10581
10290
10163
10451
10316
10639
10393
10101
10129
10099
10576
10531
10168
10492
10072
10302
metis partition time  4.3304150104522705
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011835813522338867
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.3504698276519775
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  8.091533899307251
self.buckets_partition() spend  sec:  4.362364053726196
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.3643956184387207  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.876741886138916  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.872600078582764  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.37250757217407227  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.419949054718018  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.422352313995361  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.3793473243713379  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.472767353057861  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.475235939025879  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.3863253593444824  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.437653064727783  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.439677238464355  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.3885493278503418  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.110262393951416  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.112273693084717  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.3928985595703125  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.991654396057129  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.993464946746826  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.40224218368530273  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.280766487121582  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.283144474029541  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.40836668014526367  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.180787086486816  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.183165073394775  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.41782331466674805  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.534441947937012  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.536462783813477  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.42279672622680664  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.296732425689697  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.298972606658936  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.42231225967407227  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.875423908233643  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.877285957336426  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.43005943298339844  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.945769786834717  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.947828769683838  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4368767738342285  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.933484077453613  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.935734748840332  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.45145750045776367  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.506107330322266  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.508900165557861  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.45632028579711914  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.463436603546143  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.466084480285645  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.45637035369873047  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.053616523742676  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.055397510528564  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4687166213989258  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.425728797912598  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.42764663696289  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4683513641357422  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.938926219940186  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.941190242767334  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.4770698547363281  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.226480484008789  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.228571891784668  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

number of input  16520723
----------------------------------------after optimizer
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.49715232849121094  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7752293348312378
pure train time :  4.1340532302856445
the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 0.455 seconds, peak memory: 45.350 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.350 GB
Metis partitioning: 2.148 seconds, peak memory: 45.350 GB
Split the graph: 1.218 seconds
Construct subgraphs: 0.061 seconds
metis partition ---------------pure dgl.metis_partition spent  3.8850605487823486
10621
10092
10654
10566
10498
10583
10471
10128
10296
10562
10591
10404
10071
10091
10084
10115
10098
10547
10099
metis partition time  3.890594244003296
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011909961700439453
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.9120283126831055
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.675302743911743
self.buckets_partition() spend  sec:  3.924017906188965
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.37276506423950195  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.488475799560547  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 14.484339237213135  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.36425304412841797  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.821113586425781  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 13.823292255401611  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.53662109375 GB
    Memory Allocated: 0.38056230545043945  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.54886531829834  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.55090618133545  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.38712501525878906  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.455326080322266  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.457653522491455  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.39204883575439453  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.391251564025879  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.39309024810791  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.4002718925476074  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.456270217895508  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.4586820602417  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.40470170974731445  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.351833820343018  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.353751182556152  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.40545082092285156  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 13.984699249267578  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 13.986616611480713  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.41361379623413086  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.09406042098999  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.096149444580078  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.4239325523376465  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.47034502029419  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.473031520843506  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.4315509796142578  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.522850513458252  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.524705410003662  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.43552207946777344  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.25801706314087  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.26064920425415  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.43696117401123047  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 13.948987007141113  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 13.951619148254395  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.4438896179199219  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 13.96557331085205  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 13.967741966247559  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.4486050605773926  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 13.888091087341309  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 13.890711307525635  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.4562721252441406  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.00254201889038  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.004657745361328  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.4605121612548828  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 13.91145944595337  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 13.913390159606934  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.47467565536499023  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.483625411987305  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.48572301864624  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.4759030342102051  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.01187515258789  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.01390027999878  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

number of input  16519239
----------------------------------------after optimizer
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.49547433853149414  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5465388298034668
pure train time :  4.290437459945679
the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 0.675 seconds, peak memory: 45.350 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.350 GB
Metis partitioning: 2.423 seconds, peak memory: 45.350 GB
Split the graph: 0.619 seconds
Construct subgraphs: 0.046 seconds
metis partition ---------------pure dgl.metis_partition spent  3.765138626098633
10081
10579
10608
10581
10290
10163
10451
10316
10639
10393
10101
10129
10099
10576
10531
10168
10492
10072
10302
metis partition time  3.7702605724334717
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012544870376586914
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.7877559661865234
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.436790704727173
self.buckets_partition() spend  sec:  3.8003768920898438
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.36460018157958984  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 13.849330425262451  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 13.844825744628906  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.3734321594238281  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.522685527801514  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.525157928466797  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.38068056106567383  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.475810050964355  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.478372573852539  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.38466691970825195  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.412035942077637  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.414140701293945  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.3866443634033203  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.023661136627197  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.02572774887085  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.3918952941894531  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 13.961637496948242  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 13.963608264923096  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.402677059173584  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.328491687774658  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.330564975738525  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.4079580307006836  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.186156749725342  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 14.188163757324219  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.32373046875 GB
    Memory Allocated: 0.41952943801879883  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.600211143493652  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.602420806884766  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.42099809646606445  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.265700340270996  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.268142223358154  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.42391157150268555  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.971729278564453  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.973669528961182  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4328584671020508  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.026259422302246  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.028536319732666  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.43399763107299805  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.911282062530518  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.913056373596191  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.44941043853759766  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.488462448120117  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.490444660186768  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.45631933212280273  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.459537506103516  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.461381912231445  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4571218490600586  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.020506858825684  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.022803783416748  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.46944618225097656  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.451945304870605  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.453820705413818  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4672679901123047  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.928986549377441  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.931548595428467  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4776120185852051  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.182137966156006  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.184436321258545  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

number of input  16523174
----------------------------------------after optimizer
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.49729442596435547  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3943649530410767
pure train time :  3.880516529083252
the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 0.490 seconds, peak memory: 45.350 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.350 GB
Metis partitioning: 2.137 seconds, peak memory: 45.350 GB
Split the graph: 1.051 seconds
Construct subgraphs: 0.054 seconds
metis partition ---------------pure dgl.metis_partition spent  3.7329864501953125
10081
10579
10608
10581
10290
10163
10451
10316
10639
10393
10101
10129
10099
10576
10531
10168
10492
10072
10302
metis partition time  3.7379648685455322
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015461206436157227
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.755434036254883
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.397683382034302
self.buckets_partition() spend  sec:  3.7709455490112305
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.36594533920288086  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.903663635253906  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.899033546447754  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.37129688262939453  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.378194332122803  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.380777359008789  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.38166093826293945  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.539512634277344  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.54195261001587  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.387082576751709  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.456465244293213  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.458318710327148  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.38768768310546875  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.122020721435547  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.12397289276123  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.39339208602905273  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.98427963256836  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.986448764801025  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.40315818786621094  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.294222354888916  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.296311378479004  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.40911436080932617  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.230091094970703  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.23211145401001  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4169907569885254  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.523327350616455  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.525513648986816  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.42229700088500977  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.262684345245361  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.265151023864746  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.42392969131469727  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.925824165344238  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.92801809310913  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4310312271118164  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.990185260772705  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.992735862731934  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4358639717102051  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.932295322418213  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.934086799621582  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4476046562194824  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.446179866790771  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.44803237915039  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4546222686767578  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.415092468261719  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.417042255401611  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.45824098587036133  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.05040168762207  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.052351474761963  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4679718017578125  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.471288204193115  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.473656177520752  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.46732091903686523  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.937241077423096  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.939261436462402  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.47751522064208984  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.230700969696045  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.23309326171875  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

number of input  16523918
----------------------------------------after optimizer
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4972705841064453  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2723731994628906
pure train time :  4.123027086257935
the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 0.500 seconds, peak memory: 45.350 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.350 GB
Metis partitioning: 2.130 seconds, peak memory: 45.350 GB
Split the graph: 0.587 seconds
Construct subgraphs: 0.041 seconds
metis partition ---------------pure dgl.metis_partition spent  3.259614944458008
10081
10579
10608
10581
10290
10163
10451
10316
10639
10393
10101
10129
10099
10576
10531
10168
10492
10072
10302
metis partition time  3.264676570892334
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011418342590332031
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.283810615539551
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.025748014450073
self.buckets_partition() spend  sec:  3.2953763008117676
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.36486339569091797  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.86124324798584  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.856914520263672  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3710198402404785  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.38381814956665  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.385906219482422  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.380617618560791  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.534150123596191  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.53653860092163  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.38576841354370117  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.424356937408447  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.426472187042236  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3877830505371094  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.102534294128418  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.104336738586426  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.39333152770996094  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.959362030029297  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.96189832687378  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4037008285522461  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.330439567565918  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.332311153411865  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4060173034667969  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.127568244934082  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.13033390045166  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.42044973373413086  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.593318462371826  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.595181941986084  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.42269229888916016  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.263683795928955  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.266164302825928  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.42247867584228516  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.931156635284424  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.9329833984375  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4298849105834961  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.971339702606201  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.973213195800781  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4364619255065918  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.965030193328857  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.967148780822754  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.44908666610717773  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.485660076141357  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.487818717956543  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4550943374633789  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.395732879638672  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.39774751663208  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4560976028442383  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.020986080169678  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.023000717163086  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.46807336807250977  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.46116590499878  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.463273048400879  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.46881628036499023  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.934894561767578  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.937036037445068  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4774179458618164  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.232395648956299  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.234425067901611  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

number of input  16513882
----------------------------------------after optimizer
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.49710941314697266  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.174234390258789
pure train time :  4.098442316055298
the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 0.420 seconds, peak memory: 45.350 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.350 GB
Metis partitioning: 2.001 seconds, peak memory: 45.350 GB
Split the graph: 0.544 seconds
Construct subgraphs: 0.032 seconds
metis partition ---------------pure dgl.metis_partition spent  2.9983294010162354
10081
10579
10608
10581
10290
10163
10451
10316
10639
10393
10101
10129
10099
10576
10531
10168
10492
10072
10302
metis partition time  3.0035457611083984
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01995992660522461
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.020545244216919
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.402392625808716
self.buckets_partition() spend  sec:  3.0405566692352295
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3644533157348633  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.847538948059082  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.843106269836426  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3707418441772461  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.376134395599365  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.378933906555176  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.38045358657836914  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.458565711975098  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.460849285125732  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3871622085571289  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.532793998718262  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.535380840301514  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3882942199707031  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.112199306488037  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.114233493804932  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3921236991882324  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.952301025390625  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.954325675964355  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4028334617614746  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.294342994689941  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.296623229980469  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4093055725097656  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.197990894317627  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.20014762878418  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4185628890991211  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.49941873550415  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.502190113067627  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.42328882217407227  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.303671836853027  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.305732250213623  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.42233896255493164  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.892215728759766  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.894248008728027  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.42977428436279297  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.955759048461914  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.95762825012207  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.43677520751953125  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.981303691864014  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.983422756195068  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.45035552978515625  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.517385959625244  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.52011775970459  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4551734924316406  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.41008186340332  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.412034034729004  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.45693206787109375  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.085258483886719  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.087210655212402  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.46846961975097656  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.449719905853271  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.451571941375732  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4682292938232422  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.94817066192627  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.950225353240967  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4757556915283203  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.16325044631958  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.165152549743652  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

number of input  16520916
----------------------------------------after optimizer
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4952840805053711  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.087272047996521
pure train time :  4.239774465560913
the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 0.500 seconds, peak memory: 45.350 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.350 GB
Metis partitioning: 2.024 seconds, peak memory: 45.350 GB
Split the graph: 0.601 seconds
Construct subgraphs: 0.059 seconds
metis partition ---------------pure dgl.metis_partition spent  3.1906142234802246
10081
10579
10608
10581
10290
10163
10451
10316
10639
10393
10101
10129
10099
10576
10531
10168
10492
10072
10302
metis partition time  3.1958298683166504
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.00991201400756836
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.2165164947509766
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.6625025272369385
self.buckets_partition() spend  sec:  3.226625442504883
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.36417579650878906  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.83411169052124  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.829602241516113  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3717775344848633  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.425796031951904  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.427820205688477  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3794231414794922  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.449521541595459  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.45234489440918  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3862485885620117  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.44040060043335  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.442420482635498  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.38559722900390625  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.072748184204102  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.074601650238037  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.39194393157958984  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.9628324508667  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.96532678604126  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4033818244934082  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.351513385772705  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.353465557098389  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4075641632080078  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.189966201782227  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.19191837310791  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4185795783996582  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.501908779144287  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.503772258758545  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4224390983581543  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.246044635772705  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.248044967651367  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4228019714355469  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.929770946502686  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.93154001235962  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.42991209030151367  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.982606410980225  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.984480381011963  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4363574981689453  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.961629390716553  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.963828563690186  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.45096302032470703  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.536645889282227  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.538824558258057  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4562807083129883  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.445656299591064  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.447500705718994  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4576144218444824  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.065524578094482  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.067305564880371  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.46715784072875977  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.36690902709961  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.368984699249268  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.46869802474975586  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.952109336853027  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.954047203063965  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4780125617980957  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.176046371459961  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.177947521209717  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

number of input  16513978
----------------------------------------after optimizer
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.49756288528442383  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0041747093200684
pure train time :  4.067731142044067
the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 0.445 seconds, peak memory: 45.350 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.350 GB
Metis partitioning: 2.080 seconds, peak memory: 45.350 GB
Split the graph: 0.720 seconds
Construct subgraphs: 0.042 seconds
metis partition ---------------pure dgl.metis_partition spent  3.287696599960327
10081
10579
10608
10581
10290
10163
10451
10316
10639
10393
10101
10129
10099
10576
10531
10168
10492
10072
10302
metis partition time  3.2933506965637207
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010534524917602539
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.3146116733551025
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.148303985595703
self.buckets_partition() spend  sec:  3.3252055644989014
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.36267709732055664  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.78902292251587  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.784826278686523  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3717927932739258  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.42538833618164  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.427695274353027  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.37784528732299805  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.397231578826904  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.399245262145996  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3856678009033203  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.430448532104492  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.43295955657959  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.38860559463500977  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.151954650878906  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.154159545898438  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3928971290588379  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.999529361724854  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.001714706420898  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.40305328369140625  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.322569370269775  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.324620246887207  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4084000587463379  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.169764041900635  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.171760559082031  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4204220771789551  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.599438667297363  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.601651668548584  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.42214107513427734  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.2720046043396  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.27392053604126  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.42502927780151367  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.965572357177734  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.967687129974365  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.42986536026000977  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.945950031280518  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.948009014129639  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4356808662414551  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.93520212173462  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.937132835388184  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4494352340698242  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.502126693725586  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.504364013671875  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.456451416015625  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.499485492706299  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.50157356262207  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.45718860626220703  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.05899953842163  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.06094217300415  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4682626724243164  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.466543674468994  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 14.468912601470947  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4687466621398926  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.907846450805664  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.90983772277832  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4769282341003418  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.198787689208984  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.201467037200928  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

number of input  16525188
----------------------------------------after optimizer
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.49676084518432617  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9612692594528198
pure train time :  3.8412578105926514
the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 0.518 seconds, peak memory: 45.350 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.350 GB
Metis partitioning: 1.984 seconds, peak memory: 45.350 GB
Split the graph: 0.925 seconds
Construct subgraphs: 0.040 seconds
metis partition ---------------pure dgl.metis_partition spent  3.474015712738037
10081
10579
10608
10581
10290
10163
10451
10316
10639
10393
10101
10129
10099
10576
10531
10168
10492
10072
10302
metis partition time  3.478975772857666
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010410547256469727
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.499943971633911
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.887526035308838
self.buckets_partition() spend  sec:  3.510418176651001
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.3647756576538086  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.835427284240723  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.83095932006836  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.37276315689086914  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.46787977218628  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.470309734344482  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.3811936378479004  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.488954544067383  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.491323471069336  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.3863949775695801  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.426941871643066  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.42908239364624  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.38825082778930664  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.13996934890747  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.141962051391602  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.3922286033630371  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.991790771484375  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.993603229522705  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.40297603607177734  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.32088565826416  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.322805404663086  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4073009490966797  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.168267250061035  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.170073986053467  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4197382926940918  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.578597068786621  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.580848217010498  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.42178964614868164  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.250860691070557  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.253396034240723  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4236922264099121  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.917136192321777  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.918936252593994  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4299931526184082  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.95442819595337  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.956474304199219  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4356069564819336  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.935277938842773  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.937047004699707  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.45065784454345703  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.517946720123291  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.519832134246826  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4550786018371582  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.475451469421387  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.47779655456543  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.45755958557128906  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.064566612243652  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.066423416137695  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4669914245605469  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.377702236175537  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.37968635559082  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4689154624938965  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.943246841430664  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.94513463973999  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.47657060623168945  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.18125295639038  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.183575630187988  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

number of input  16522502
----------------------------------------after optimizer
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4964118003845215  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9154698252677917
pure train time :  4.101478576660156
the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 0.531 seconds, peak memory: 45.350 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.350 GB
Metis partitioning: 2.337 seconds, peak memory: 45.350 GB
Split the graph: 0.532 seconds
Construct subgraphs: 0.031 seconds
metis partition ---------------pure dgl.metis_partition spent  3.4327926635742188
10081
10579
10608
10581
10290
10163
10451
10316
10639
10393
10101
10129
10099
10576
10531
10168
10492
10072
10302
metis partition time  3.4379935264587402
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012923240661621094
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.456549644470215
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.091785907745361
self.buckets_partition() spend  sec:  3.4695370197296143
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.36368322372436523  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.821692943572998  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.817333221435547  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.3736457824707031  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.444016933441162  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.4462308883667  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.37968873977661133  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.468323230743408  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.470181465148926  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.38692808151245117  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.508502006530762  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.510490894317627  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.38724660873413086  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.082598686218262  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.084450244903564  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.3925819396972656  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.977760791778564  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.979612350463867  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4029865264892578  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.307484149932861  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.309512615203857  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.40730762481689453  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.171664714813232  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.174099445343018  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.41888952255249023  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.542508602142334  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.544543743133545  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.42104387283325195  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.254390239715576  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.256892681121826  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.424072265625  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.916211605072021  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.9180908203125  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.428926944732666  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.9552903175354  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.957064628601074  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.43606138229370117  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.926180839538574  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.927955150604248  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.44976043701171875  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.474306106567383  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.47622299194336  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.455841064453125  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.454525470733643  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.456557273864746  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.45689868927001953  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.022107601165771  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.02388858795166  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.46892881393432617  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.466607570648193  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.469318389892578  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4686446189880371  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.952345371246338  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.954403400421143  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.47838830947875977  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.191453456878662  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.19365644454956  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

number of input  16521440
----------------------------------------after optimizer
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.49808502197265625  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8760595917701721
pure train time :  3.8805484771728516
the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 0.430 seconds, peak memory: 45.350 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.350 GB
Metis partitioning: 2.097 seconds, peak memory: 45.350 GB
Split the graph: 0.618 seconds
Construct subgraphs: 0.031 seconds
metis partition ---------------pure dgl.metis_partition spent  3.1773407459259033
10081
10579
10608
10581
10290
10163
10451
10316
10639
10393
10101
10129
10099
10576
10531
10168
10492
10072
10302
metis partition time  3.1826939582824707
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009629011154174805
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.200148105621338
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.616995334625244
self.buckets_partition() spend  sec:  3.2098257541656494
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.36282968521118164  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.82981252670288  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.82557201385498  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.37372875213623047  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.468656539916992  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.471248626708984  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.3807101249694824  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.492398262023926  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.494770050048828  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.38664913177490234  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.442944526672363  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.444862365722656  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.3898286819458008  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.163981914520264  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.166548252105713  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.3918933868408203  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.958376407623291  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.960360050201416  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4036288261413574  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.317572116851807  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.319647789001465  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4067649841308594  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.122700214385986  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.124936580657959  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.41815996170043945  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.482304096221924  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.485081672668457  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4219846725463867  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.267000675201416  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.269155025482178  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4242739677429199  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.94502592086792  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.947251796722412  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4307370185852051  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.978224754333496  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.9803466796875  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.43819522857666016  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.953104019165039  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.955717086791992  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.44808483123779297  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.459074020385742  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.461681842803955  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.45607709884643555  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.47926950454712  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.481148719787598  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.45702409744262695  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.076313018798828  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.078175067901611  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.46796607971191406  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.452831268310547  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.45472240447998  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.46657562255859375  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.907636642456055  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.909562110900879  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.47785329818725586  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.239593505859375  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.242250442504883  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

number of input  16521636
----------------------------------------after optimizer
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4976925849914551  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8349049687385559
pure train time :  3.9274535179138184
the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 0.487 seconds, peak memory: 45.350 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.350 GB
Metis partitioning: 2.128 seconds, peak memory: 45.350 GB
Split the graph: 0.995 seconds
Construct subgraphs: 0.044 seconds
metis partition ---------------pure dgl.metis_partition spent  3.6619889736175537
10621
10092
10654
10566
10498
10583
10471
10128
10296
10562
10591
10404
10071
10091
10084
10115
10098
10547
10099
metis partition time  3.6671833992004395
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009729146957397461
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.688020706176758
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.161652088165283
self.buckets_partition() spend  sec:  3.697885751724243
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.37282848358154297  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.518498420715332  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.514023303985596  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.36634111404418945  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.91445541381836  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.916223049163818  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.37938976287841797  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.472126483917236  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.47473955154419  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.38596630096435547  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.42460584640503  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.426948547363281  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.3923673629760742  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.386717319488525  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.388556003570557  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.40066051483154297  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.470099449157715  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.47195291519165  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.40401554107666016  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.344427108764648  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.346423149108887  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.40584564208984375  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.963235855102539  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.965152263641357  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.41370105743408203  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.142447471618652  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.144299030303955  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4230213165283203  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.429214477539062  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.43106460571289  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.43225717544555664  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.499989986419678  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.502218246459961  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4346451759338379  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.27203369140625  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.274515628814697  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4351992607116699  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.865207195281982  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.867933750152588  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4430088996887207  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.965933799743652  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.968111038208008  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4501786231994629  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.916477680206299  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.918657779693604  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4545865058898926  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.948935985565186  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.950844764709473  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.46266746520996094  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.978550910949707  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.98032283782959  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4748234748840332  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.505034923553467  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.506882190704346  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4728736877441406  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.970750331878662  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.973428726196289  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

number of input  16511051
----------------------------------------after optimizer
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4926285743713379  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7949932217597961
pure train time :  4.105435848236084
the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 0.546 seconds, peak memory: 45.350 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.350 GB
Metis partitioning: 2.093 seconds, peak memory: 45.350 GB
Split the graph: 0.606 seconds
Construct subgraphs: 0.028 seconds
metis partition ---------------pure dgl.metis_partition spent  3.2806284427642822
10081
10579
10608
10581
10290
10163
10451
10316
10639
10393
10101
10129
10099
10576
10531
10168
10492
10072
10302
metis partition time  3.28582501411438
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014407873153686523
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.3040709495544434
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.756478548049927
self.buckets_partition() spend  sec:  3.318540096282959
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.3647289276123047  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.819753170013428  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.815794944763184  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.37405872344970703  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.46050214767456  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.46294355392456  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.3807549476623535  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.449620723724365  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.452367782592773  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.3854341506958008  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.44526481628418  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.447343349456787  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.3887147903442383  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.146014213562012  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.147916793823242  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.3917388916015625  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.959043025970459  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 13.961304664611816  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.40396928787231445  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.338643074035645  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.340641498565674  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4086036682128906  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.180295944213867  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 14.182294368743896  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.10107421875 GB
    Memory Allocated: 0.4214515686035156  GigaBytes
Max Memory Allocated: 14.863447666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.623406410217285  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.625269889831543  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4218153953552246  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.237647533416748  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.239826679229736  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.42209911346435547  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.91952133178711  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.921290397644043  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.43012142181396484  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.948971271514893  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.950745582580566  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4373016357421875  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.991935729980469  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.993884086608887  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4486355781555176  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.472144603729248  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.474154472351074  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4557619094848633  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.466916561126709  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.468760967254639  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.45586538314819336  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.029085636138916  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.030866622924805  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4678030014038086  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.458972454071045  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.461689949035645  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4663691520690918  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.887744903564453  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.889928817749023  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.47708749771118164  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.176410675048828  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.178244590759277  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

number of input  16523144
----------------------------------------after optimizer
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.49652671813964844  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7648611068725586
pure train time :  3.8547780513763428
the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 0.493 seconds, peak memory: 45.350 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.350 GB
Metis partitioning: 2.065 seconds, peak memory: 45.350 GB
Split the graph: 0.540 seconds
Construct subgraphs: 0.034 seconds
metis partition ---------------pure dgl.metis_partition spent  3.1386892795562744
10081
10579
10608
10581
10290
10163
10451
10316
10639
10393
10101
10129
10099
10576
10531
10168
10492
10072
10302
metis partition time  3.1437370777130127
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01208806037902832
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.162550926208496
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.57613468170166
self.buckets_partition() spend  sec:  3.17476224899292
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.36484718322753906  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.857355117797852  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.852742195129395  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.3740983009338379  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.47411060333252  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.476295471191406  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.38017702102661133  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.442498207092285  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.444512844085693  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.3848757743835449  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.425363540649414  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.42743444442749  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.3879575729370117  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.100749015808105  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.102551460266113  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.39266538619995117  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.976637840270996  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.978417873382568  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4030156135559082  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.285950660705566  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.28801441192627  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4082198143005371  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.170334815979004  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.17227554321289  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.41876840591430664  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.538882732391357  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.540896892547607  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4216156005859375  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.273460388183594  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.275474548339844  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4236884117126465  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.93735933303833  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.93932056427002  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.43188905715942383  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.008473873138428  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.010955810546875  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.43488025665283203  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.91807746887207  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.919958114624023  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4500446319580078  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.476497173309326  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.47837781906128  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4563260078430176  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.45560598373413  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.45745038986206  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.45563459396362305  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.013539791107178  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.015559673309326  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4684319496154785  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.461062908172607  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.46297025680542  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4680633544921875  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.9169340133667  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.919259548187256  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.47728443145751953  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.190757751464844  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.192970752716064  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

number of input  16519075
----------------------------------------after optimizer
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.49674510955810547  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7330030798912048
pure train time :  4.19961953163147
the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 0.380 seconds, peak memory: 45.350 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.350 GB
Metis partitioning: 1.996 seconds, peak memory: 45.350 GB
Split the graph: 0.882 seconds
Construct subgraphs: 0.027 seconds
metis partition ---------------pure dgl.metis_partition spent  3.287034034729004
10081
10579
10608
10581
10290
10163
10451
10316
10639
10393
10101
10129
10099
10576
10531
10168
10492
10072
10302
metis partition time  3.2920196056365967
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01396489143371582
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.3080716133117676
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.682994365692139
self.buckets_partition() spend  sec:  3.322082757949829
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.36545228958129883  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.861063957214355  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.856424808502197  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.37412071228027344  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.4544677734375  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.456577777862549  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.37878990173339844  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.432199001312256  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.434691429138184  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.38519287109375  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.396197319030762  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.3985276222229  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.38699960708618164  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.074192523956299  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.076310157775879  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.392275333404541  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.9566330909729  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.958413124084473  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.40252065658569336  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.313568115234375  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.315638542175293  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4077639579772949  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.17129898071289  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.173490524291992  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4188957214355469  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.575222492218018  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.577702522277832  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4224081039428711  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.292203903198242  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.294400691986084  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.42481136322021484  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.905084609985352  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.907203197479248  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4297189712524414  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.980445861816406  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.98222017288208  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4367842674255371  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.950302600860596  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.952565670013428  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.44857263565063477  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.51173734664917  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.513595581054688  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4548654556274414  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.440330505371094  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.442181587219238  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.45622777938842773  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.0502610206604  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.052112102508545  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4679841995239258  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.449790954589844  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.451630592346191  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.46587657928466797  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.906404495239258  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.908959865570068  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4776902198791504  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.232158660888672  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.23422908782959  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

number of input  16512104
----------------------------------------after optimizer
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4975409507751465  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7020031809806824
pure train time :  4.220118999481201
the output layer 
self.num_batch (get_in_degree_bucketing) 19
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  19
Convert a graph into a bidirected graph: 0.448 seconds, peak memory: 45.350 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.350 GB
Metis partitioning: 1.996 seconds, peak memory: 45.350 GB
Split the graph: 0.598 seconds
Construct subgraphs: 0.037 seconds
metis partition ---------------pure dgl.metis_partition spent  3.085603952407837
10081
10579
10608
10581
10290
10163
10451
10316
10639
10393
10101
10129
10099
10576
10531
10168
10492
10072
10302
metis partition time  3.091041088104248
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009568929672241211
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1070072650909424
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.504971265792847
self.buckets_partition() spend  sec:  3.1166179180145264
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.36304283142089844  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.798423767089844  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.794017314910889  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.3714141845703125  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.376964092254639  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.378860473632812  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.37987565994262695  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.450422286987305  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.45242166519165  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.38503313064575195  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.402821063995361  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.405323505401611  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.38605499267578125  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.078560829162598  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.080580234527588  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.3918919563293457  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.986698627471924  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.988478660583496  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4021878242492676  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.314135551452637  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.316236019134521  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4082317352294922  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.206753253936768  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.209240436553955  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4194607734680176  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.527429103851318  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.529979705810547  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4223504066467285  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.234748363494873  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.236905097961426  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4240870475769043  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.977302551269531  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.979071617126465  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.43198299407958984  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.000704765319824  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.002479076385498  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4371371269226074  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.946676254272461  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.948445320129395  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4499669075012207  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.484211921691895  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.48673677444458  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4567570686340332  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.5098237991333  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.51176118850708  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.45716142654418945  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.041984558105469  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.04421091079712  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4680490493774414  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.412805080413818  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.414798259735107  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.46842098236083984  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.958868026733398  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 13.960859775543213  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.4778561592102051  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.237129211425781  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 14.239741802215576  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

number of input  16517189
----------------------------------------after optimizer
 Nvidia-smi: 17.89013671875 GB
    Memory Allocated: 0.49747323989868164  GigaBytes
Max Memory Allocated: 14.870375156402588  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6755853891372681
pure train time :  4.495250463485718
epoch_time_list  [28.18519163131714, 26.90796685218811, 30.079628944396973, 31.38205885887146, 30.250341176986694, 31.493054628372192, 29.507630348205566, 28.74440288543701, 27.158638954162598, 25.91754674911499, 26.505985021591187, 27.570922374725342, 27.968428134918213, 30.353373050689697, 26.951550483703613, 28.08874750137329, 26.325438499450684, 27.09549903869629, 26.175323486328125, 26.178309202194214]

loading_time list   [0.5373654365539551, 0.5997333526611328, 0.5774283409118652, 0.46768832206726074, 0.6172003746032715, 0.5860013961791992, 0.4373612403869629, 0.47283363342285156, 0.6049120426177979, 0.46477389335632324, 0.43744730949401855, 0.46997857093811035, 0.43987298011779785, 0.7073731422424316, 0.44504308700561523, 0.5198760032653809, 0.4459054470062256, 0.5864102840423584, 0.41401004791259766, 0.5308980941772461]

 data loader gen time  18.071576356887817
	---backpack schedule time  [7.516648292541504, 6.815582036972046, 7.128066301345825, 8.575455665588379, 8.169995784759521, 7.747130393981934, 7.506506681442261, 7.451183080673218, 7.09482479095459, 6.4668214321136475, 6.736191272735596, 7.225029230117798, 6.9632792472839355, 7.158072471618652, 6.6838953495025635, 7.229743957519531, 6.819734811782837, 6.634571075439453, 6.752443313598633, 6.558490991592407]
	---connection_check_time_list  [6.647244930267334, 7.308161735534668, 9.630409955978394, 9.915562391281128, 7.999428987503052, 10.153175830841064, 8.690149068832397, 7.672789096832275, 6.9891486167907715, 6.432056427001953, 6.807878255844116, 7.123725414276123, 8.21684217453003, 9.853580474853516, 7.7714011669158936, 7.65192174911499, 6.898055076599121, 7.121957540512085, 6.400488376617432, 6.535125970840454]
	---block_gen_time_list  [3.846827507019043, 3.7360517978668213, 4.181685924530029, 4.264300584793091, 4.455267667770386, 4.469999313354492, 4.611884832382202, 4.452584266662598, 3.887726068496704, 3.9228317737579346, 3.894702672958374, 4.474273920059204, 4.174066543579102, 4.231649875640869, 3.7997329235076904, 4.138515949249268, 3.897301197052002, 4.233073472976685, 4.144894123077393, 4.371171474456787]
training time  [9.021814107894897, 7.828835725784302, 7.905659198760986, 7.489013910293579, 8.09510350227356, 7.869596719741821, 7.63564920425415, 8.07144808769226, 7.9329681396484375, 8.003661155700684, 8.002207517623901, 7.665076017379761, 7.521042585372925, 7.672583103179932, 7.629881143569946, 7.929324388504028, 7.641251802444458, 7.8803393840789795, 7.849148511886597, 7.5517308712005615]
---feature block loading time  [3.5667426586151123, 3.5364880561828613, 3.7251856327056885, 3.177328586578369, 3.87241530418396, 3.4824366569519043, 3.658384084701538, 3.8500587940216064, 3.739283800125122, 3.6697545051574707, 3.8356220722198486, 3.7297139167785645, 3.316879987716675, 3.700582265853882, 3.6107053756713867, 3.7294163703918457, 3.694488525390625, 3.5934624671936035, 3.543072462081909, 2.954996347427368]


epoch_time avg   27.892824470996857
loading_time avg   0.5112435966730118
 data loader gen time avg 19.54272611439228
	---backpack schedule time avg 7.074869617819786
	---connection_check_time avg  7.64485776424408
	---block_gen_time avg  4.197479754686356
training time  7.8094382584095
---feature block loading time  3.623829558491707
pure train time per /epoch  [5.433808326721191, 4.2054924964904785, 4.087001800537109, 4.2100067138671875, 4.1340532302856445, 4.290437459945679, 3.880516529083252, 4.123027086257935, 4.098442316055298, 4.239774465560913, 4.067731142044067, 3.8412578105926514, 4.101478576660156, 3.8805484771728516, 3.9274535179138184, 4.105435848236084, 3.8547780513763428, 4.19961953163147, 4.220118999481201, 4.495250463485718]
pure train time average  4.098231189391193
num_input list  [16523630, 16513391, 16514841, 16525327, 16520723, 16519239, 16523174, 16523918, 16513882, 16520916, 16513978, 16525188, 16522502, 16521440, 16521636, 16511051, 16523144, 16519075, 16512104, 16517189]
num_input  average  16519317.4
