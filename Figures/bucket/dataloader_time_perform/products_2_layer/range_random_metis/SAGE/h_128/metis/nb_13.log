main start at this time 1713148837.5740893
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 1.289 seconds, peak memory: 19.342 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 19.342 GB
Metis partitioning: 2.002 seconds, peak memory: 19.622 GB
Split the graph: 1.345 seconds
Construct subgraphs: 0.033 seconds
metis partition ---------------pure dgl.metis_partition spent  4.679797172546387
15182
14771
14770
15375
15426
14787
15446
15170
14815
15228
14746
15286
15569
metis partition time  4.684980630874634
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010561943054199219
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.698920488357544
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.004798889160156
self.buckets_partition() spend  sec:  4.709515810012817
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.94482421875 GB
    Memory Allocated: 0.4041290283203125  GigaBytes
Max Memory Allocated: 0.4041290283203125  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.42333984375 GB
    Memory Allocated: 19.379518032073975  GigaBytes
Max Memory Allocated: 19.727579593658447  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.42333984375 GB
    Memory Allocated: 19.382177352905273  GigaBytes
Max Memory Allocated: 19.727579593658447  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.43115234375 GB
    Memory Allocated: 0.42985010147094727  GigaBytes
Max Memory Allocated: 19.727579593658447  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.43505859375 GB
    Memory Allocated: 18.949517250061035  GigaBytes
Max Memory Allocated: 19.727579593658447  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.43505859375 GB
    Memory Allocated: 18.952141761779785  GigaBytes
Max Memory Allocated: 19.727579593658447  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.43505859375 GB
    Memory Allocated: 0.44086217880249023  GigaBytes
Max Memory Allocated: 19.727579593658447  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.43505859375 GB
    Memory Allocated: 18.901512622833252  GigaBytes
Max Memory Allocated: 19.727579593658447  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.43505859375 GB
    Memory Allocated: 18.904099464416504  GigaBytes
Max Memory Allocated: 19.727579593658447  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.43505859375 GB
    Memory Allocated: 0.4581260681152344  GigaBytes
Max Memory Allocated: 19.727579593658447  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.61669921875 GB
    Memory Allocated: 19.59756851196289  GigaBytes
Max Memory Allocated: 19.95367956161499  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.61669921875 GB
    Memory Allocated: 19.600692749023438  GigaBytes
Max Memory Allocated: 19.95367956161499  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.61669921875 GB
    Memory Allocated: 0.4685397148132324  GigaBytes
Max Memory Allocated: 19.95367956161499  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.72412109375 GB
    Memory Allocated: 19.688153743743896  GigaBytes
Max Memory Allocated: 20.044811725616455  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.72412109375 GB
    Memory Allocated: 19.690860748291016  GigaBytes
Max Memory Allocated: 20.044811725616455  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.72607421875 GB
    Memory Allocated: 0.4736208915710449  GigaBytes
Max Memory Allocated: 20.044811725616455  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.72802734375 GB
    Memory Allocated: 19.023290634155273  GigaBytes
Max Memory Allocated: 20.044811725616455  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.72802734375 GB
    Memory Allocated: 19.026363849639893  GigaBytes
Max Memory Allocated: 20.044811725616455  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.72802734375 GB
    Memory Allocated: 0.49149322509765625  GigaBytes
Max Memory Allocated: 20.044811725616455  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.11279296875 GB
    Memory Allocated: 19.755077838897705  GigaBytes
Max Memory Allocated: 20.11254358291626  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.11279296875 GB
    Memory Allocated: 19.758569717407227  GigaBytes
Max Memory Allocated: 20.11254358291626  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.11279296875 GB
    Memory Allocated: 0.49672460556030273  GigaBytes
Max Memory Allocated: 20.11254358291626  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.11279296875 GB
    Memory Allocated: 19.384617805480957  GigaBytes
Max Memory Allocated: 20.11254358291626  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.11279296875 GB
    Memory Allocated: 19.387550354003906  GigaBytes
Max Memory Allocated: 20.11254358291626  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.11279296875 GB
    Memory Allocated: 0.5082993507385254  GigaBytes
Max Memory Allocated: 20.11254358291626  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.11279296875 GB
    Memory Allocated: 19.14464807510376  GigaBytes
Max Memory Allocated: 20.11254358291626  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.11279296875 GB
    Memory Allocated: 19.147482872009277  GigaBytes
Max Memory Allocated: 20.11254358291626  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.11279296875 GB
    Memory Allocated: 0.5195083618164062  GigaBytes
Max Memory Allocated: 20.11254358291626  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.11279296875 GB
    Memory Allocated: 19.577826976776123  GigaBytes
Max Memory Allocated: 20.11254358291626  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.11279296875 GB
    Memory Allocated: 19.580493927001953  GigaBytes
Max Memory Allocated: 20.11254358291626  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.11279296875 GB
    Memory Allocated: 0.5237798690795898  GigaBytes
Max Memory Allocated: 20.11254358291626  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.11279296875 GB
    Memory Allocated: 19.053935527801514  GigaBytes
Max Memory Allocated: 20.11254358291626  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.11279296875 GB
    Memory Allocated: 19.056602478027344  GigaBytes
Max Memory Allocated: 20.11254358291626  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.11279296875 GB
    Memory Allocated: 0.5412888526916504  GigaBytes
Max Memory Allocated: 20.11254358291626  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.11279296875 GB
    Memory Allocated: 19.603161334991455  GigaBytes
Max Memory Allocated: 20.11254358291626  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.11279296875 GB
    Memory Allocated: 19.605838298797607  GigaBytes
Max Memory Allocated: 20.11254358291626  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.11279296875 GB
    Memory Allocated: 0.5548820495605469  GigaBytes
Max Memory Allocated: 20.11254358291626  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 19.898247718811035  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22802734375 GB
    Memory Allocated: 19.901305198669434  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

number of input  13260303
----------------------------------------after optimizer
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.5858821868896484  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.195501804351807
pure train time :  6.390790939331055
the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 0.530 seconds, peak memory: 48.016 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.016 GB
Metis partitioning: 1.988 seconds, peak memory: 48.016 GB
Split the graph: 0.771 seconds
Construct subgraphs: 0.030 seconds
metis partition ---------------pure dgl.metis_partition spent  3.3300812244415283
15038
14716
14709
15495
15499
15455
15477
14743
15299
15135
14679
15000
15326
metis partition time  3.3347086906433105
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010730504989624023
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.3491854667663574
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.656794309616089
self.buckets_partition() spend  sec:  3.3599603176116943
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.4369196891784668  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.299683570861816  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.292141437530518  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.4331188201904297  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 18.90450429916382  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 18.90768051147461  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.44338083267211914  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 18.92440176010132  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 18.926995277404785  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.4620060920715332  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.742814540863037  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.746016025543213  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.4718441963195801  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.71777868270874  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.72049331665039  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.481689453125  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.726081371307373  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.728787899017334  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.4914112091064453  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.760713577270508  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.763423919677734  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.49423933029174805  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 18.964866161346436  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 18.967973709106445  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.5088376998901367  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.55323362350464  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.556092739105225  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.5179009437561035  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.42564582824707  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.428715705871582  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.5240321159362793  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 18.946552753448486  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 18.94981861114502  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.5395646095275879  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.305577278137207  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.308204174041748  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.5516257286071777  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.671565532684326  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.674386978149414  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

number of input  13256727
----------------------------------------after optimizer
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.5803399085998535  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.484236001968384
pure train time :  3.204252004623413
the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 0.431 seconds, peak memory: 49.546 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 49.546 GB
Metis partitioning: 1.864 seconds, peak memory: 49.546 GB
Split the graph: 0.797 seconds
Construct subgraphs: 0.034 seconds
metis partition ---------------pure dgl.metis_partition spent  3.128279685974121
15038
14716
14709
15495
15499
15455
15477
14743
15299
15135
14679
15000
15326
metis partition time  3.132964849472046
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011422872543334961
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1499900817871094
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.4650914669036865
self.buckets_partition() spend  sec:  3.1615090370178223
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.43564462661743164  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.275070667266846  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.26783514022827  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.43372392654418945  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 18.929670810699463  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 18.932738304138184  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.44487905502319336  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 18.929908752441406  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 18.933062076568604  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.46299028396606445  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.716754913330078  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.720279693603516  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 0.473203182220459  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.697920322418213  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.22998046875 GB
    Memory Allocated: 19.701602458953857  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.48245906829833984  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.690449714660645  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.69337797164917  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.49260997772216797  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.711873531341553  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.714797496795654  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.4982280731201172  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.0414080619812  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.044332027435303  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.5144553184509277  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.600954055786133  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.604013442993164  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.5223813056945801  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.414363861083984  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.41717529296875  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.5277671813964844  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 18.970382690429688  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 18.973105430603027  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.5447359085083008  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.35758686065674  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.360735416412354  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.5581145286560059  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.684494018554688  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.687178134918213  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

number of input  13262434
----------------------------------------after optimizer
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.587193489074707  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.729904890060425
pure train time :  3.2125916481018066
the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 0.494 seconds, peak memory: 49.824 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 49.824 GB
Metis partitioning: 1.865 seconds, peak memory: 49.824 GB
Split the graph: 0.799 seconds
Construct subgraphs: 0.028 seconds
metis partition ---------------pure dgl.metis_partition spent  3.186739921569824
15182
14771
14770
15375
15426
14787
15446
15170
14815
15228
14746
15286
15569
metis partition time  3.1911702156066895
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011753559112548828
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.206921100616455
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.519740104675293
self.buckets_partition() spend  sec:  3.218721866607666
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.4373741149902344  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.38406801223755  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.376651287078857  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.43469810485839844  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.027759552001953  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.030585765838623  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.44343042373657227  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 18.934357166290283  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 18.937183380126953  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.46152353286743164  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.605775833129883  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.608468532562256  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.47072601318359375  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.6568284034729  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.660274028778076  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.47544288635253906  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 18.952166080474854  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 18.95540475845337  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.4945836067199707  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.774459838867188  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.77719020843506  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.5036001205444336  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.49873638153076  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.50154972076416  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.5075931549072266  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.07259225845337  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.075405597686768  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.5242714881896973  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.605523586273193  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.608190536499023  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.5284481048583984  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.037379264831543  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.040242671966553  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.5441336631774902  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.619218826293945  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.621895790100098  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.5585331916809082  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.857619285583496  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.860665321350098  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

number of input  13256136
----------------------------------------after optimizer
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.5874161720275879  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.2416317462921143
pure train time :  3.2162232398986816
the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 0.458 seconds, peak memory: 49.932 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 49.932 GB
Metis partitioning: 1.904 seconds, peak memory: 49.932 GB
Split the graph: 0.761 seconds
Construct subgraphs: 0.034 seconds
metis partition ---------------pure dgl.metis_partition spent  3.15786075592041
15182
14771
14770
15375
15426
14787
15446
15170
14815
15228
14746
15286
15569
metis partition time  3.1623761653900146
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010822296142578125
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1795263290405273
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.512526512145996
self.buckets_partition() spend  sec:  3.190425157546997
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.4378671646118164  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.358359813690186  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.350943088531494  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.43308591842651367  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 18.969279289245605  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 18.972442150115967  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.4431920051574707  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 18.961711883544922  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 18.96471643447876  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.46032238006591797  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.645867347717285  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.649080276489258  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.47129154205322266  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.66712236404419  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.67026710510254  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.47601747512817383  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.101789951324463  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.104633331298828  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 0.49207258224487305  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.72978401184082  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23193359375 GB
    Memory Allocated: 19.732489109039307  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23388671875 GB
    Memory Allocated: 0.5000152587890625  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23388671875 GB
    Memory Allocated: 19.385234832763672  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23388671875 GB
    Memory Allocated: 19.387995719909668  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23388671875 GB
    Memory Allocated: 0.503870964050293  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23388671875 GB
    Memory Allocated: 19.054157733917236  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23388671875 GB
    Memory Allocated: 19.056870937347412  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23388671875 GB
    Memory Allocated: 0.5202174186706543  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23388671875 GB
    Memory Allocated: 19.537323474884033  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23388671875 GB
    Memory Allocated: 19.5409517288208  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23388671875 GB
    Memory Allocated: 0.525916576385498  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23388671875 GB
    Memory Allocated: 19.041775703430176  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23388671875 GB
    Memory Allocated: 19.04522466659546  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23388671875 GB
    Memory Allocated: 0.5428171157836914  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23388671875 GB
    Memory Allocated: 19.629915237426758  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.23388671875 GB
    Memory Allocated: 19.632944583892822  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.23388671875 GB
    Memory Allocated: 0.5566234588623047  GigaBytes
Max Memory Allocated: 20.257657051086426  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.919286727905273  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.922563076019287  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

number of input  13256707
----------------------------------------after optimizer
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 0.5852622985839844  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.781978726387024
pure train time :  3.3644444942474365
the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 0.485 seconds, peak memory: 50.730 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.730 GB
Metis partitioning: 1.884 seconds, peak memory: 50.730 GB
Split the graph: 0.756 seconds
Construct subgraphs: 0.048 seconds
metis partition ---------------pure dgl.metis_partition spent  3.1739158630371094
15182
14771
14770
15375
15426
14787
15446
15170
14815
15228
14746
15286
15569
metis partition time  3.178406000137329
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010576248168945312
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1943585872650146
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.513518571853638
self.buckets_partition() spend  sec:  3.2049882411956787
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 0.43705177307128906  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.362784385681152  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.355036735534668  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 0.4345717430114746  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 18.97860813140869  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 18.981786251068115  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 0.4445977210998535  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.000218868255615  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.003129959106445  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 0.46146678924560547  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.669578075408936  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.673205375671387  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 0.47062110900878906  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.67776918411255  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.681074619293213  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 0.4737086296081543  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 18.950725555419922  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 18.953704833984375  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 0.49307918548583984  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.72747230529785  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.730473041534424  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 0.4983711242675781  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.37247943878174  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.37601089477539  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 0.5087432861328125  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.164026260375977  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.166883945465088  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 0.5208296775817871  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.56163787841797  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.56432867050171  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 0.5255508422851562  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.02099895477295  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.02391815185547  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 0.5423359870910645  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.6391544342041  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 19.641831398010254  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.07958984375 GB
    Memory Allocated: 0.5549230575561523  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.18896484375 GB
    Memory Allocated: 19.897154808044434  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.18896484375 GB
    Memory Allocated: 19.900249004364014  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

number of input  13253151
----------------------------------------after optimizer
 Nvidia-smi: 22.18896484375 GB
    Memory Allocated: 0.584104061126709  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.552171230316162
pure train time :  3.2455191612243652
the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 0.465 seconds, peak memory: 50.730 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.730 GB
Metis partitioning: 1.890 seconds, peak memory: 50.730 GB
Split the graph: 1.362 seconds
Construct subgraphs: 0.035 seconds
metis partition ---------------pure dgl.metis_partition spent  3.7533891201019287
15038
14716
14709
15495
15499
15455
15477
14743
15299
15135
14679
15000
15326
metis partition time  3.757956027984619
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011496782302856445
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.7745449542999268
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.10778021812439
self.buckets_partition() spend  sec:  3.786151647567749
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.18896484375 GB
    Memory Allocated: 0.4366774559020996  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.18896484375 GB
    Memory Allocated: 19.272807121276855  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.18896484375 GB
    Memory Allocated: 19.264601707458496  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.18896484375 GB
    Memory Allocated: 0.43230247497558594  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.18896484375 GB
    Memory Allocated: 18.92294931411743  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.18896484375 GB
    Memory Allocated: 18.92629051208496  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.18896484375 GB
    Memory Allocated: 0.4414668083190918  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.18896484375 GB
    Memory Allocated: 18.82264995574951  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.18896484375 GB
    Memory Allocated: 18.82534122467041  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.18896484375 GB
    Memory Allocated: 0.46365928649902344  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 19.830174922943115  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 19.833498001098633  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 0.4743623733520508  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 19.73224687576294  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 19.73496150970459  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 0.48305606842041016  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 19.723236560821533  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 19.725951194763184  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 0.4939608573913574  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 19.7957181930542  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 19.798635959625244  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 0.49656105041503906  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 19.02503204345703  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 19.027949810028076  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 0.5122261047363281  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 19.596603870391846  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 19.599562644958496  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 0.5208353996276855  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 19.424582481384277  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 19.42728853225708  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 0.5252947807312012  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 18.941601276397705  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 18.944171905517578  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 0.540316104888916  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 19.289286136627197  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 19.29204511642456  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 0.554412841796875  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 19.65638542175293  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25537109375 GB
    Memory Allocated: 19.659481048583984  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

number of input  13260421
----------------------------------------after optimizer
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5852398872375488  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3945680856704712
pure train time :  3.233297824859619
the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 0.424 seconds, peak memory: 50.730 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.730 GB
Metis partitioning: 1.931 seconds, peak memory: 50.730 GB
Split the graph: 0.783 seconds
Construct subgraphs: 0.025 seconds
metis partition ---------------pure dgl.metis_partition spent  3.1646616458892822
15038
14716
14709
15495
15499
15455
15477
14743
15299
15135
14679
15000
15326
metis partition time  3.169335126876831
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012407779693603516
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1857268810272217
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.516065835952759
self.buckets_partition() spend  sec:  3.1981842517852783
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4364304542541504  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.27097511291504  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.261825561523438  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4343595504760742  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.950400352478027  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.953529834747314  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.44291210174560547  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.947333335876465  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.950336933135986  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.46263933181762695  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.763667583465576  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.766560077667236  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.47268199920654297  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.767508506774902  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.77028465270996  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.48314714431762695  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.694976806640625  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.697842121124268  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4938340187072754  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.756129264831543  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.759765148162842  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.49702978134155273  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.054651737213135  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.057628631591797  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5121364593505859  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.570480346679688  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.573837757110596  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5208368301391602  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.38846731185913  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.391891479492188  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5253391265869141  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.89871883392334  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.901548862457275  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5398979187011719  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.27678394317627  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.279592990875244  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5546627044677734  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.65920877456665  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.662537574768066  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

number of input  13253718
----------------------------------------after optimizer
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5860443115234375  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2720937728881836
pure train time :  3.2215559482574463
the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 0.428 seconds, peak memory: 50.730 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.730 GB
Metis partitioning: 2.009 seconds, peak memory: 50.730 GB
Split the graph: 0.784 seconds
Construct subgraphs: 0.025 seconds
metis partition ---------------pure dgl.metis_partition spent  3.247609853744507
15038
14716
14709
15495
15499
15455
15477
14743
15299
15135
14679
15000
15326
metis partition time  3.2521238327026367
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013344526290893555
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.2685747146606445
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.620232343673706
self.buckets_partition() spend  sec:  3.2819666862487793
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.43737268447875977  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.260958671569824  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.251783847808838  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4337038993835449  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.920947074890137  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.923524379730225  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.44295406341552734  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.86842679977417  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.871002674102783  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4631667137145996  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.732924938201904  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.735686779022217  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.47373104095458984  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.754291534423828  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.75763702392578  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4813523292541504  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.67028522491455  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.67350196838379  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.49281740188598633  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.669588565826416  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.672298908233643  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.49628686904907227  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.985243797302246  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.988494396209717  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5154919624328613  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.654839992523193  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.657591819763184  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5249156951904297  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.44780158996582  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.45076608657837  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5295066833496094  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.032968997955322  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.03574848175049  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5423731803894043  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.279194355010986  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.282071113586426  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5577187538146973  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.649142742156982  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.652639389038086  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

number of input  13256973
----------------------------------------after optimizer
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5873351097106934  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.171715259552002
pure train time :  3.2089030742645264
the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 0.410 seconds, peak memory: 50.730 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.730 GB
Metis partitioning: 1.919 seconds, peak memory: 50.730 GB
Split the graph: 0.790 seconds
Construct subgraphs: 0.035 seconds
metis partition ---------------pure dgl.metis_partition spent  3.1562392711639404
15038
14716
14709
15495
15499
15455
15477
14743
15299
15135
14679
15000
15326
metis partition time  3.1607861518859863
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009856939315795898
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1765191555023193
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.513005018234253
self.buckets_partition() spend  sec:  3.186429023742676
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.43505430221557617  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.253615379333496  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.246402740478516  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.433868408203125  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.915064811706543  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.91782283782959  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.44440603256225586  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.90536594390869  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.908666610717773  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.46411561965942383  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.81551218032837  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.818629264831543  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4733586311340332  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.76380681991577  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.766988277435303  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4828763008117676  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.675848960876465  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.67909049987793  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4971604347229004  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.80583953857422  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.808549880981445  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.497861385345459  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.981438159942627  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.984722137451172  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5131497383117676  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.58072328567505  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.58363151550293  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5212645530700684  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.363029956817627  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.365680694580078  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5286979675292969  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.005035400390625  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.00786256790161  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5429201126098633  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.31780433654785  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.32051658630371  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.557767391204834  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.627768516540527  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.631217002868652  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

number of input  13257404
----------------------------------------after optimizer
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5862083435058594  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0804263353347778
pure train time :  3.2127010822296143
the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 0.471 seconds, peak memory: 50.730 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.730 GB
Metis partitioning: 1.910 seconds, peak memory: 50.730 GB
Split the graph: 0.728 seconds
Construct subgraphs: 0.026 seconds
metis partition ---------------pure dgl.metis_partition spent  3.136413097381592
15038
14716
14709
15495
15499
15455
15477
14743
15299
15135
14679
15000
15326
metis partition time  3.140897512435913
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01174616813659668
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1573870182037354
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.5132200717926025
self.buckets_partition() spend  sec:  3.1691830158233643
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4347233772277832  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.22415065765381  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.215993404388428  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4333019256591797  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.94801139831543  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.951209545135498  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.44254016876220703  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.887317657470703  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.890065670013428  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.46193504333496094  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.72365379333496  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.726622104644775  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4711799621582031  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.729334354400635  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.732067584991455  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4803194999694824  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.678799629211426  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.681657314300537  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.49242115020751953  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.73677682876587  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.740270614624023  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4957594871520996  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.048232555389404  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.051337718963623  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5116491317749023  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.5784592628479  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.58178472518921  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5210514068603516  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.41087055206299  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.414220333099365  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5267524719238281  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.998287200927734  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.001471519470215  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5378270149230957  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.221431255340576  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.224117279052734  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5536098480224609  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.708579540252686  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.7119402885437  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

number of input  13254890
----------------------------------------after optimizer
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5833663940429688  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0030832290649414
pure train time :  3.21329665184021
the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 0.419 seconds, peak memory: 50.730 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.730 GB
Metis partitioning: 1.878 seconds, peak memory: 50.730 GB
Split the graph: 0.738 seconds
Construct subgraphs: 0.024 seconds
metis partition ---------------pure dgl.metis_partition spent  3.0597779750823975
15038
14716
14709
15495
15499
15455
15477
14743
15299
15135
14679
15000
15326
metis partition time  3.064239501953125
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012891769409179688
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.080595016479492
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.4149274826049805
self.buckets_partition() spend  sec:  3.093534469604492
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4349246025085449  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.229321002960205  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.221704959869385  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.43350791931152344  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.920079231262207  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.923105239868164  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.44359588623046875  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.936840057373047  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.939948558807373  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4611372947692871  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.73786497116089  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.74127435684204  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.47162437438964844  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.702056407928467  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.705016136169434  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4808788299560547  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.63853406906128  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.641435623168945  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4945030212402344  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.78982448577881  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.792641639709473  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4965343475341797  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.002359867095947  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.005149364471436  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5134544372558594  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.6223464012146  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.62543773651123  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5213360786437988  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.41141414642334  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.41477632522583  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5259718894958496  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.96030616760254  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.96331787109375  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5411434173583984  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.35121250152588  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.354033946990967  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5560131072998047  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.671517848968506  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.674513816833496  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

number of input  13260396
----------------------------------------after optimizer
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5856027603149414  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9565402269363403
pure train time :  3.212308168411255
the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 0.396 seconds, peak memory: 50.730 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.730 GB
Metis partitioning: 1.897 seconds, peak memory: 50.730 GB
Split the graph: 1.858 seconds
Construct subgraphs: 0.031 seconds
metis partition ---------------pure dgl.metis_partition spent  4.183640003204346
15038
14716
14709
15495
15499
15455
15477
14743
15299
15135
14679
15000
15326
metis partition time  4.188379287719727
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011442184448242188
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.205025911331177
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.53561544418335
self.buckets_partition() spend  sec:  4.216583728790283
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4365963935852051  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.26364278793335  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.25562334060669  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.433168888092041  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.935822010040283  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.93892765045166  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4440603256225586  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.941551208496094  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.944730281829834  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4632844924926758  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.7468523979187  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.750085830688477  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4762763977050781  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.76161241531372  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.764748573303223  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.48642873764038086  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.715430736541748  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.71813726425171  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4964280128479004  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.770339012145996  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.773788452148438  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5015897750854492  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.0447940826416  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.047874450683594  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.515601634979248  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.605104446411133  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.608606815338135  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5239272117614746  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.376545429229736  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.37941551208496  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5289392471313477  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.93745994567871  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.940030574798584  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5438961982727051  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.255000114440918  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.25762701034546  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5583276748657227  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.66800832748413  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.671488285064697  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

number of input  13259526
----------------------------------------after optimizer
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5886750221252441  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.91081702709198
pure train time :  3.19958233833313
the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 0.454 seconds, peak memory: 50.730 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.730 GB
Metis partitioning: 1.870 seconds, peak memory: 50.730 GB
Split the graph: 1.141 seconds
Construct subgraphs: 0.031 seconds
metis partition ---------------pure dgl.metis_partition spent  3.4956583976745605
15038
14716
14709
15495
15499
15455
15477
14743
15299
15135
14679
15000
15326
metis partition time  3.5000433921813965
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010772705078125
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.5200035572052
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.845562934875488
self.buckets_partition() spend  sec:  3.5308268070220947
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4364461898803711  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.243489742279053  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.23580503463745  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.43205690383911133  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.911235332489014  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.91439723968506  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4440927505493164  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.920251846313477  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.92282772064209  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4631681442260742  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.746225833892822  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.749192714691162  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.47275352478027344  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.743984699249268  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.747407913208008  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.48339080810546875  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.753882884979248  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.756847381591797  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4949355125427246  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.784539222717285  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.787620544433594  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.49608469009399414  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.990668773651123  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.993707180023193  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5135149955749512  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.606082439422607  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.609529495239258  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5206336975097656  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.36157464981079  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.364769458770752  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5258522033691406  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.980032920837402  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.98296022415161  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5393142700195312  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.29185390472412  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.294585704803467  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.55291748046875  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.632888317108154  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.635934352874756  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

number of input  13257046
----------------------------------------after optimizer
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5818276405334473  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8711144924163818
pure train time :  3.20198655128479
the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 0.384 seconds, peak memory: 50.730 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.730 GB
Metis partitioning: 1.852 seconds, peak memory: 50.730 GB
Split the graph: 0.788 seconds
Construct subgraphs: 0.030 seconds
metis partition ---------------pure dgl.metis_partition spent  3.055933713912964
15182
14771
14770
15375
15426
14787
15446
15170
14815
15228
14746
15286
15569
metis partition time  3.0604774951934814
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011742353439331055
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.0763447284698486
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.407354354858398
self.buckets_partition() spend  sec:  3.088139533996582
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4376974105834961  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.407944202423096  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.400099277496338  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4325423240661621  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.92365026473999  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.927006244659424  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.44433164596557617  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.018563747406006  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.021430492401123  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4626021385192871  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.610980987548828  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.613879203796387  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.47420692443847656  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.68632411956787  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.689481735229492  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.47692060470581055  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.02263879776001  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.02582311630249  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4955563545227051  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.7500958442688  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.752800941467285  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5027956962585449  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.44388771057129  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.446914196014404  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5080385208129883  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.05330991744995  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.056489944458008  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5215978622436523  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.493130683898926  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.496059894561768  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5288209915161133  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.07426166534424  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.077420234680176  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5432734489440918  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.598397254943848  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.60107421875  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5571746826171875  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.878009796142578  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.881322383880615  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

number of input  13256131
----------------------------------------after optimizer
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5856914520263672  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.836785614490509
pure train time :  3.3724029064178467
the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 0.367 seconds, peak memory: 50.730 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.730 GB
Metis partitioning: 1.862 seconds, peak memory: 50.730 GB
Split the graph: 0.712 seconds
Construct subgraphs: 0.029 seconds
metis partition ---------------pure dgl.metis_partition spent  2.9714272022247314
15038
14716
14709
15495
15499
15455
15477
14743
15299
15135
14679
15000
15326
metis partition time  2.9761977195739746
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010858774185180664
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.992142677307129
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.318576812744141
self.buckets_partition() spend  sec:  3.0030581951141357
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.43551206588745117  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.24169635772705  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.233331203460693  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4326596260070801  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.939841270446777  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.94288969039917  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.44156789779663086  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.868759632110596  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.87133550643921  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.46326112747192383  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.767608642578125  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.77032232284546  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.47237110137939453  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.725243091583252  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.727957725524902  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4806184768676758  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.675739765167236  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.678446292877197  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4918527603149414  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.7103853225708  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.71324634552002  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4955897331237793  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.981823921203613  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.985336780548096  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5148773193359375  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.61266803741455  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.615869998931885  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.525975227355957  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.474318981170654  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.477315425872803  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5297455787658691  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.98712396621704  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.989839553833008  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5441298484802246  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.338690280914307  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.341432571411133  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5555939674377441  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.579203128814697  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.581945419311523  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

number of input  13247568
----------------------------------------after optimizer
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5839924812316895  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.796419620513916
pure train time :  3.4010167121887207
the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 0.706 seconds, peak memory: 50.730 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.730 GB
Metis partitioning: 2.054 seconds, peak memory: 50.730 GB
Split the graph: 0.752 seconds
Construct subgraphs: 0.051 seconds
metis partition ---------------pure dgl.metis_partition spent  3.565523386001587
15038
14716
14709
15495
15499
15455
15477
14743
15299
15135
14679
15000
15326
metis partition time  3.5702011585235596
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011211156845092773
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.587043046951294
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.903420925140381
self.buckets_partition() spend  sec:  3.5983662605285645
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.43629932403564453  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.27763605117798  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.270577430725098  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.43410396575927734  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.942171096801758  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.94546890258789  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4431285858154297  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.932596683502197  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.93564748764038  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.46074962615966797  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.721832752227783  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.724546432495117  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4729790687561035  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.778598308563232  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.781336307525635  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4810218811035156  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.712224006652832  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.715176105499268  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.49213171005249023  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.758443355560303  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.762067317962646  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.49725961685180664  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.017309188842773  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.02036476135254  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5135903358459473  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.617514610290527  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.620701789855957  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5227560997009277  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.34998083114624  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.353193759918213  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5269455909729004  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.951764583587646  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.95433521270752  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5411434173583984  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.340725898742676  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.34371566772461  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5551457405090332  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.62877607345581  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.63180637359619  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

number of input  13261250
----------------------------------------after optimizer
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5847806930541992  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7637946605682373
pure train time :  3.4991095066070557
the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 0.460 seconds, peak memory: 50.730 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.730 GB
Metis partitioning: 1.981 seconds, peak memory: 50.730 GB
Split the graph: 0.764 seconds
Construct subgraphs: 0.044 seconds
metis partition ---------------pure dgl.metis_partition spent  3.2502055168151855
15182
14771
14770
15375
15426
14787
15446
15170
14815
15228
14746
15286
15569
metis partition time  3.254835367202759
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0106048583984375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.2712080478668213
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.627285718917847
self.buckets_partition() spend  sec:  3.2818710803985596
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.43669795989990234  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.40336275100708  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.39611005783081  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.43361711502075195  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.924389839172363  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.92773675918579  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4450035095214844  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.000328063964844  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.003045558929443  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.46061038970947266  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.605717658996582  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.60843515396118  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.47146034240722656  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.66288709640503  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.666211128234863  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4758644104003906  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.04780626296997  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.05064821243286  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4924459457397461  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.717098236083984  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.720214366912842  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.49905824661254883  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.446933269500732  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.449986934661865  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5042815208435059  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.056830883026123  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.05943012237549  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5206303596496582  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.506017208099365  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.50892686843872  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5252232551574707  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.01194429397583  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.014946937561035  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5423603057861328  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.645670413970947  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.648609161376953  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.555816650390625  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.878456115722656  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.881471633911133  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

number of input  13257892
----------------------------------------after optimizer
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.584376335144043  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7311423420906067
pure train time :  3.44736647605896
the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 0.536 seconds, peak memory: 50.730 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.730 GB
Metis partitioning: 2.063 seconds, peak memory: 50.730 GB
Split the graph: 0.744 seconds
Construct subgraphs: 0.031 seconds
metis partition ---------------pure dgl.metis_partition spent  3.375920057296753
15038
14716
14709
15495
15499
15455
15477
14743
15299
15135
14679
15000
15326
metis partition time  3.3808465003967285
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014978885650634766
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.397874355316162
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.737371921539307
self.buckets_partition() spend  sec:  3.412914276123047
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.43593788146972656  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.252252101898193  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.246231079101562  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4323158264160156  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.84628677368164  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.84886407852173  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.44373559951782227  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.90911626815796  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.91249132156372  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4642372131347656  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.7441725730896  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.747413635253906  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.47353410720825195  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.72557020187378  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.728341102600098  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.48435306549072266  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.719255924224854  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.721962451934814  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4935922622680664  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.771641731262207  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.774995803833008  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4956817626953125  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.930365562438965  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.933719635009766  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5150141716003418  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.672285556793213  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.675594329833984  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5252275466918945  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.505233764648438  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.508061408996582  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5288677215576172  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.937527179718018  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.940966606140137  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5429444313049316  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.27632713317871  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.278979301452637  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5581774711608887  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.688122272491455  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.691444873809814  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

number of input  13250979
----------------------------------------after optimizer
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5877523422241211  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.700800895690918
pure train time :  3.2811412811279297
the output layer 
self.num_batch (get_in_degree_bucketing) 13
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  13
Convert a graph into a bidirected graph: 0.507 seconds, peak memory: 50.730 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.730 GB
Metis partitioning: 2.116 seconds, peak memory: 50.730 GB
Split the graph: 0.802 seconds
Construct subgraphs: 0.052 seconds
metis partition ---------------pure dgl.metis_partition spent  3.478245735168457
15038
14716
14709
15495
15499
15455
15477
14743
15299
15135
14679
15000
15326
metis partition time  3.482997179031372
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009255409240722656
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.4997799396514893
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.803584337234497
self.buckets_partition() spend  sec:  3.509087562561035
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4356966018676758  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.254722118377686  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.245877265930176  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4333343505859375  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.94389533996582  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.946650505065918  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4429945945739746  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.909963130950928  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 18.912970542907715  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.46383237838745117  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.75296688079834  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.756136417388916  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.47254133224487305  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.680602550506592  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.684219360351562  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4839138984680176  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.690764904022217  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.693968296051025  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4961128234863281  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.769070148468018  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.772228240966797  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.4988079071044922  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.03152561187744  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.03493881225586  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5160894393920898  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.62553834915161  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.628393173217773  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5245270729064941  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.438535690307617  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.441382884979248  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5311565399169922  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.044157028198242  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.046896934509277  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5441446304321289  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.315551280975342  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.318178176879883  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5590581893920898  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.659770965576172  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 19.663074016571045  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

number of input  13256564
----------------------------------------after optimizer
 Nvidia-smi: 23.25732421875 GB
    Memory Allocated: 0.5886931419372559  GigaBytes
Max Memory Allocated: 20.278814792633057  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6732932925224304
pure train time :  3.290099859237671
epoch_time_list  [29.28920578956604, 24.60427188873291, 23.35979962348938, 23.70312237739563, 23.587634086608887, 23.763912439346313, 24.163736581802368, 23.674545288085938, 24.020806789398193, 23.247047662734985, 23.966001987457275, 23.04997968673706, 24.487748622894287, 23.823758363723755, 23.04613161087036, 23.820857048034668, 28.307066440582275, 26.69786262512207, 26.498143196105957, 25.161099433898926]

loading_time list   [0.5323688983917236, 0.586916446685791, 0.4749879837036133, 0.4545896053314209, 0.4638180732727051, 0.35570287704467773, 0.36580991744995117, 0.36129212379455566, 0.44004082679748535, 0.3032362461090088, 0.4485206604003906, 0.3102850914001465, 0.39603590965270996, 0.4546854496002197, 0.23664450645446777, 0.2930138111114502, 0.5683639049530029, 0.4380791187286377, 0.4207768440246582, 0.42815279960632324]

 data loader gen time  18.064852237701416
	---backpack schedule time  [7.076014995574951, 5.729569673538208, 5.545222282409668, 5.584164619445801, 5.5821332931518555, 5.579493999481201, 6.184968948364258, 5.585618495941162, 5.684866905212402, 5.571758270263672, 5.575395345687866, 5.482439756393433, 6.599208831787109, 5.904673337936401, 5.471822023391724, 5.372469663619995, 6.012476682662964, 5.6990368366241455, 5.807098150253296, 5.875895738601685]
	---connection_check_time_list  [6.654745101928711, 6.8053858280181885, 6.255763292312622, 6.516772270202637, 6.25751519203186, 6.680204391479492, 6.36055326461792, 6.418499708175659, 6.590296983718872, 6.10393214225769, 6.647493362426758, 6.011420726776123, 6.314035654067993, 6.337849855422974, 5.98771595954895, 6.286841869354248, 9.924959659576416, 8.90564775466919, 8.892168998718262, 7.590748071670532]
	---block_gen_time_list  [4.527227878570557, 4.3546528816223145, 4.010603904724121, 3.9842026233673096, 4.078588008880615, 4.008185625076294, 4.105970859527588, 4.135125398635864, 4.123384237289429, 4.051957130432129, 4.163502931594849, 4.075861930847168, 4.094792366027832, 3.990959882736206, 4.0601160526275635, 4.704609632492065, 4.2862708568573, 4.453962087631226, 4.147233486175537, 4.023096561431885]
training time  [9.882018089294434, 6.49107813835144, 6.46010422706604, 6.538865804672241, 6.60595703125, 6.53442120552063, 6.545802116394043, 6.5728771686553955, 6.588605880737305, 6.620447874069214, 6.541573524475098, 6.577069282531738, 6.486274003982544, 6.5188984870910645, 6.699329614639282, 6.553374290466309, 6.879411458969116, 6.552530527114868, 6.551245212554932, 6.6509082317352295]
---feature block loading time  [3.477947235107422, 3.1629369258880615, 3.1234097480773926, 3.1966776847839355, 3.1156165599823, 3.1627037525177, 3.188643217086792, 3.2274622917175293, 3.2552483081817627, 3.2842063903808594, 3.2010250091552734, 3.240417242050171, 3.163832902908325, 3.1933610439300537, 3.20088267326355, 3.0214383602142334, 3.25814151763916, 2.979454278945923, 3.1426267623901367, 3.23865008354187]


epoch_time avg   24.457270741462708
loading_time avg   0.3927786350250244
 data loader gen time avg 17.453497514128685
	---backpack schedule time avg 5.749334767460823
	---connection_check_time avg  6.956867724657059
	---block_gen_time avg  4.156476065516472
training time  6.592420369386673
---feature block loading time  3.1796068996191025
pure train time per /epoch  [6.390790939331055, 3.204252004623413, 3.2125916481018066, 3.2162232398986816, 3.3644444942474365, 3.2455191612243652, 3.233297824859619, 3.2215559482574463, 3.2089030742645264, 3.2127010822296143, 3.21329665184021, 3.212308168411255, 3.19958233833313, 3.20198655128479, 3.3724029064178467, 3.4010167121887207, 3.4991095066070557, 3.44736647605896, 3.2811412811279297, 3.290099859237671]
pure train time average  3.2835856044993683
num_input list  [13260303, 13256727, 13262434, 13256136, 13256707, 13253151, 13260421, 13253718, 13256973, 13257404, 13254890, 13260396, 13259526, 13257046, 13256131, 13247568, 13261250, 13257892, 13250979, 13256564]
num_input  average  13256810.8
