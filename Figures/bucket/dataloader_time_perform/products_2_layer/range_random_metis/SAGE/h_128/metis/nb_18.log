main start at this time 1713151953.0732799
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 1.286 seconds, peak memory: 19.342 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 19.342 GB
Metis partitioning: 2.052 seconds, peak memory: 19.659 GB
Split the graph: 0.636 seconds
Construct subgraphs: 0.024 seconds
metis partition ---------------pure dgl.metis_partition spent  4.00922417640686
10630
10641
11239
10602
11167
11195
10632
10828
10940
11141
10779
10677
11092
11125
10830
11173
10641
11239
metis partition time  4.013972997665405
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011878490447998047
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.027768850326538
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.295120716094971
self.buckets_partition() spend  sec:  4.03968358039856
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.87060546875 GB
    Memory Allocated: 0.3466963768005371  GigaBytes
Max Memory Allocated: 0.3466963768005371  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.32568359375 GB
    Memory Allocated: 14.47652292251587  GigaBytes
Max Memory Allocated: 14.720614910125732  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.32568359375 GB
    Memory Allocated: 14.478750705718994  GigaBytes
Max Memory Allocated: 14.720614910125732  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.33349609375 GB
    Memory Allocated: 0.3714118003845215  GigaBytes
Max Memory Allocated: 14.720614910125732  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.89794921875 GB
    Memory Allocated: 14.491191864013672  GigaBytes
Max Memory Allocated: 14.737174987792969  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.89794921875 GB
    Memory Allocated: 14.493237018585205  GigaBytes
Max Memory Allocated: 14.737174987792969  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.89794921875 GB
    Memory Allocated: 0.38843536376953125  GigaBytes
Max Memory Allocated: 14.737174987792969  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.02099609375 GB
    Memory Allocated: 15.139958381652832  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.02099609375 GB
    Memory Allocated: 15.142173767089844  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.02099609375 GB
    Memory Allocated: 0.3892831802368164  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.02099609375 GB
    Memory Allocated: 14.4912748336792  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.02099609375 GB
    Memory Allocated: 14.493131637573242  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.02099609375 GB
    Memory Allocated: 0.40442371368408203  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.04248046875 GB
    Memory Allocated: 15.117461681365967  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.04248046875 GB
    Memory Allocated: 15.11961555480957  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.04248046875 GB
    Memory Allocated: 0.4098339080810547  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.17138671875 GB
    Memory Allocated: 15.125967502593994  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.17138671875 GB
    Memory Allocated: 15.128517627716064  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.17138671875 GB
    Memory Allocated: 0.40825510025024414  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.18310546875 GB
    Memory Allocated: 14.459877967834473  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.18310546875 GB
    Memory Allocated: 14.461843967437744  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.18310546875 GB
    Memory Allocated: 0.4184284210205078  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.18310546875 GB
    Memory Allocated: 14.727452754974365  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.18310546875 GB
    Memory Allocated: 14.730056762695312  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.18310546875 GB
    Memory Allocated: 0.43135738372802734  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.18310546875 GB
    Memory Allocated: 14.906989574432373  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.18310546875 GB
    Memory Allocated: 14.908977508544922  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.18310546875 GB
    Memory Allocated: 0.43915843963623047  GigaBytes
Max Memory Allocated: 15.399830341339111  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.63232421875 GB
    Memory Allocated: 15.146687030792236  GigaBytes
Max Memory Allocated: 15.40470027923584  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.63232421875 GB
    Memory Allocated: 15.148641109466553  GigaBytes
Max Memory Allocated: 15.40470027923584  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.63232421875 GB
    Memory Allocated: 0.44210338592529297  GigaBytes
Max Memory Allocated: 15.40470027923584  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.63232421875 GB
    Memory Allocated: 14.752519130706787  GigaBytes
Max Memory Allocated: 15.40470027923584  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.63232421875 GB
    Memory Allocated: 14.754406929016113  GigaBytes
Max Memory Allocated: 15.40470027923584  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.63232421875 GB
    Memory Allocated: 0.4468655586242676  GigaBytes
Max Memory Allocated: 15.40470027923584  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.64404296875 GB
    Memory Allocated: 14.627136707305908  GigaBytes
Max Memory Allocated: 15.40470027923584  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.64404296875 GB
    Memory Allocated: 14.629794120788574  GigaBytes
Max Memory Allocated: 15.40470027923584  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.64404296875 GB
    Memory Allocated: 0.4588298797607422  GigaBytes
Max Memory Allocated: 15.40470027923584  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.64404296875 GB
    Memory Allocated: 15.108349800109863  GigaBytes
Max Memory Allocated: 15.40470027923584  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.64404296875 GB
    Memory Allocated: 15.110292911529541  GigaBytes
Max Memory Allocated: 15.40470027923584  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.64404296875 GB
    Memory Allocated: 0.4677572250366211  GigaBytes
Max Memory Allocated: 15.40470027923584  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.64599609375 GB
    Memory Allocated: 15.161171913146973  GigaBytes
Max Memory Allocated: 15.418083667755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.64599609375 GB
    Memory Allocated: 15.163227081298828  GigaBytes
Max Memory Allocated: 15.418083667755127  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.64599609375 GB
    Memory Allocated: 0.4714484214782715  GigaBytes
Max Memory Allocated: 15.418083667755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.64599609375 GB
    Memory Allocated: 14.79826307296753  GigaBytes
Max Memory Allocated: 15.418083667755127  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.64599609375 GB
    Memory Allocated: 14.800278186798096  GigaBytes
Max Memory Allocated: 15.418083667755127  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.64599609375 GB
    Memory Allocated: 0.4848794937133789  GigaBytes
Max Memory Allocated: 15.418083667755127  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.62646484375 GB
    Memory Allocated: 15.247169017791748  GigaBytes
Max Memory Allocated: 15.506542205810547  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.62646484375 GB
    Memory Allocated: 15.249260902404785  GigaBytes
Max Memory Allocated: 15.506542205810547  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.62646484375 GB
    Memory Allocated: 0.48526954650878906  GigaBytes
Max Memory Allocated: 15.506542205810547  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.62841796875 GB
    Memory Allocated: 14.582004070281982  GigaBytes
Max Memory Allocated: 15.506542205810547  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.62841796875 GB
    Memory Allocated: 14.583983898162842  GigaBytes
Max Memory Allocated: 15.506542205810547  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.62841796875 GB
    Memory Allocated: 0.5012288093566895  GigaBytes
Max Memory Allocated: 15.506542205810547  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.64013671875 GB
    Memory Allocated: 15.27143669128418  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.64013671875 GB
    Memory Allocated: 15.273419380187988  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

number of input  16039647
----------------------------------------after optimizer
 Nvidia-smi: 19.64013671875 GB
    Memory Allocated: 0.5252971649169922  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.201774597167969
pure train time :  4.971186637878418
the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 0.552 seconds, peak memory: 46.012 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.012 GB
Metis partitioning: 2.022 seconds, peak memory: 46.012 GB
Split the graph: 0.617 seconds
Construct subgraphs: 0.035 seconds
metis partition ---------------pure dgl.metis_partition spent  3.2377047538757324
10630
10641
11239
10602
11167
11195
10632
10828
10940
11141
10779
10677
11092
11125
10830
11173
10641
11239
metis partition time  3.242526054382324
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012109518051147461
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.2574586868286133
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.5187671184539795
self.buckets_partition() spend  sec:  3.269611358642578
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.64013671875 GB
    Memory Allocated: 0.37503957748413086  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.64013671875 GB
    Memory Allocated: 14.467310428619385  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.64013671875 GB
    Memory Allocated: 14.460765838623047  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.64013671875 GB
    Memory Allocated: 0.37410974502563477  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.64013671875 GB
    Memory Allocated: 14.51552677154541  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.64013671875 GB
    Memory Allocated: 14.517390727996826  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.64013671875 GB
    Memory Allocated: 0.3895277976989746  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 15.189847469329834  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 15.192492961883545  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 0.38962221145629883  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 14.505342960357666  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 14.507257461547852  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 0.40206193923950195  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 15.055438041687012  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 15.057521343231201  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 0.4122915267944336  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 15.132261276245117  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 15.134251117706299  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 0.40902090072631836  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 14.46935510635376  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 14.471296310424805  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 0.4206814765930176  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 14.793437004089355  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 14.795523643493652  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 0.4276247024536133  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 14.84300184249878  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 14.845015048980713  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 0.4410219192504883  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 15.155484199523926  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 15.157764911651611  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 0.4422163963317871  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 14.72244930267334  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 14.724593162536621  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 0.4483060836791992  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 14.603232383728027  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 14.605913639068604  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 0.46146059036254883  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 15.08841323852539  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 15.090599536895752  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 0.46826934814453125  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 15.09756088256836  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 15.09974718093872  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 0.47280359268188477  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 14.821744918823242  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 14.824541568756104  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46240234375 GB
    Memory Allocated: 0.4861326217651367  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46435546875 GB
    Memory Allocated: 15.188579082489014  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.46435546875 GB
    Memory Allocated: 15.190574645996094  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46435546875 GB
    Memory Allocated: 0.485506534576416  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46435546875 GB
    Memory Allocated: 14.58172607421875  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.46435546875 GB
    Memory Allocated: 14.584067344665527  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.46435546875 GB
    Memory Allocated: 0.5002942085266113  GigaBytes
Max Memory Allocated: 15.530609130859375  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 15.323011875152588  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 15.32498025894165  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

number of input  16031602
----------------------------------------after optimizer
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 0.5233101844787598  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.478424072265625
pure train time :  3.7787575721740723
the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 0.558 seconds, peak memory: 46.884 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.884 GB
Metis partitioning: 2.145 seconds, peak memory: 46.884 GB
Split the graph: 0.580 seconds
Construct subgraphs: 0.033 seconds
metis partition ---------------pure dgl.metis_partition spent  3.3285534381866455
10630
10641
11239
10602
11167
11195
10632
10828
10940
11141
10779
10677
11092
11125
10830
11173
10641
11239
metis partition time  3.333444118499756
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013702630996704102
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.3522825241088867
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.650405168533325
self.buckets_partition() spend  sec:  3.3660330772399902
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 0.37593698501586914  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.501490592956543  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.495590686798096  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 0.3740854263305664  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.483596801757812  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.485524654388428  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 0.3891010284423828  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 15.1327543258667  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 15.135128498077393  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 0.3913555145263672  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.478178024291992  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.480404376983643  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 0.4053459167480469  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 15.071629047393799  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 15.073660850524902  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 0.41373300552368164  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 15.175966739654541  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 15.177978515625  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 0.4140591621398926  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.513248443603516  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.515286445617676  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 0.422029972076416  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.718116283416748  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.720154285430908  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 0.43307924270629883  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.880162715911865  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.882345199584961  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 0.4427919387817383  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 15.13445234298706  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 15.136403560638428  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 0.44683218002319336  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.738172054290771  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.740453720092773  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 0.45088815689086914  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.594080448150635  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.596811294555664  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 0.46375608444213867  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 15.067785263061523  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 15.069727897644043  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 0.4721965789794922  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 15.124626636505127  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 15.126758575439453  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 0.4776496887207031  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.84868335723877  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.850824356079102  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 0.49043941497802734  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 15.194075107574463  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 15.196297645568848  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 0.4915180206298828  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.647894859313965  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 14.650063514709473  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.92138671875 GB
    Memory Allocated: 0.507143497467041  GigaBytes
Max Memory Allocated: 15.583065509796143  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.33928108215332  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.341249465942383  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

number of input  16037554
----------------------------------------after optimizer
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.5302762985229492  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7338879108428955
pure train time :  3.7196593284606934
the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 0.467 seconds, peak memory: 47.699 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.699 GB
Metis partitioning: 2.011 seconds, peak memory: 47.745 GB
Split the graph: 0.536 seconds
Construct subgraphs: 0.052 seconds
metis partition ---------------pure dgl.metis_partition spent  3.0674734115600586
10630
10641
11239
10602
11167
11195
10632
10828
10940
11141
10779
10677
11092
11125
10830
11173
10641
11239
metis partition time  3.072422504425049
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011861562728881836
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.0894482135772705
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.3516271114349365
self.buckets_partition() spend  sec:  3.101360321044922
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.3762216567993164  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.50963544845581  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.503541946411133  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.3741331100463867  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.450796127319336  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.45311450958252  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.38978052139282227  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.155503273010254  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.157567024230957  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.3893895149230957  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.443142414093018  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.445136070251465  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.403564453125  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.104466915130615  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.107186794281006  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4130101203918457  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.134725093841553  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.1370210647583  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.41554784774780273  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.535037517547607  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.537754535675049  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4236636161804199  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.767118453979492  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.76938247680664  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4320225715637207  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.861409187316895  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.863550662994385  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.44359874725341797  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.145929336547852  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.148219108581543  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.44729137420654297  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.824771881103516  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.826804637908936  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.45034122467041016  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.603230953216553  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.605241298675537  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4637150764465332  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.087478160858154  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.08962345123291  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.47147655487060547  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.114335536956787  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.117059230804443  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.47667598724365234  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.85825490951538  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.860575199127197  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4871077537536621  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.159801483154297  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.162070751190186  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.48989105224609375  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.658153533935547  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.660422801971436  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.5038571357727051  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.2787446975708  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.280713081359863  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

number of input  16037387
----------------------------------------after optimizer
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.528378963470459  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.2289836406707764
pure train time :  3.716606855392456
the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 0.488 seconds, peak memory: 48.273 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.273 GB
Metis partitioning: 2.025 seconds, peak memory: 48.318 GB
Split the graph: 0.495 seconds
Construct subgraphs: 0.028 seconds
metis partition ---------------pure dgl.metis_partition spent  3.0381884574890137
10630
10641
11239
10602
11167
11195
10632
10828
10940
11141
10779
10677
11092
11125
10830
11173
10641
11239
metis partition time  3.043088912963867
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014122486114501953
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.063917875289917
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.3644139766693115
self.buckets_partition() spend  sec:  3.0781569480895996
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.37610340118408203  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.473978519439697  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.466456413269043  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.3745427131652832  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.523056507110596  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.524920463562012  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.38988590240478516  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.169039726257324  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.171720504760742  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.38950443267822266  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.444430828094482  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.446735858917236  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4043288230895996  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.189253807067871  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.191399097442627  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4103889465332031  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.10343885421753  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.10567855834961  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.41275739669799805  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.530785083770752  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.533193588256836  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4218888282775879  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.761529922485352  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.763761520385742  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.42928361892700195  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.881027698516846  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.883047103881836  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.44166135787963867  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.128647327423096  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.130782127380371  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.44401121139526367  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.68903923034668  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.691449165344238  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4489932060241699  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.62227725982666  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.62424898147583  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.46120595932006836  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.075201988220215  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.077391147613525  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.46944427490234375  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.138901233673096  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.140913009643555  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.470797061920166  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.760969638824463  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.762937545776367  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.48635149002075195  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.232831001281738  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.235100746154785  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.48815298080444336  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.607697010040283  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.610386848449707  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.5026202201843262  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.280961990356445  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.283713340759277  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

number of input  16036500
----------------------------------------after optimizer
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.5249137878417969  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7772293090820312
pure train time :  4.093135356903076
the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 0.502 seconds, peak memory: 48.318 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.318 GB
Metis partitioning: 2.128 seconds, peak memory: 48.318 GB
Split the graph: 0.841 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  3.51011323928833
10653
11004
10671
10659
10870
10602
11165
11144
11136
11197
10941
11145
11205
10935
10616
10667
10782
11179
metis partition time  3.515159845352173
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013752222061157227
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.5356128215789795
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.832127094268799
self.buckets_partition() spend  sec:  3.5494301319122314
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.37568187713623047  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.528728008270264  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.522427558898926  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.3802919387817383  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.913147449493408  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.915153503417969  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.3833017349243164  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.496153354644775  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.498022556304932  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.39046525955200195  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.508195877075195  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.51006269454956  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.40123510360717773  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.822787761688232  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.824837684631348  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.40486621856689453  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.532052040100098  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.53390884399414  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.41728830337524414  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.10365343093872  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.105624198913574  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.42589902877807617  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.11318302154541  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.115171909332275  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4341292381286621  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.054505825042725  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.056740283966064  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4440498352050781  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.197410583496094  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.199645042419434  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.44855451583862305  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.909974098205566  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.91208028793335  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.45963382720947266  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.125022888183594  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.127072811126709  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.46793174743652344  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.235605716705322  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.237791538238525  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.47193241119384766  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.901726245880127  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.903880596160889  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4741477966308594  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.551002979278564  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.553115844726562  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.48033952713012695  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.612527847290039  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.614724159240723  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4905109405517578  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.8133544921875  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.816131114959717  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.5022749900817871  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.241222381591797  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.243704319000244  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

number of input  16035147
----------------------------------------after optimizer
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.5255312919616699  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.546486496925354
pure train time :  3.9056501388549805
the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 0.492 seconds, peak memory: 48.458 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.458 GB
Metis partitioning: 2.108 seconds, peak memory: 48.461 GB
Split the graph: 0.785 seconds
Construct subgraphs: 0.030 seconds
metis partition ---------------pure dgl.metis_partition spent  3.4158754348754883
10630
10641
11239
10602
11167
11195
10632
10828
10940
11141
10779
10677
11092
11125
10830
11173
10641
11239
metis partition time  3.4207799434661865
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013897895812988281
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.4436864852905273
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.724834203720093
self.buckets_partition() spend  sec:  3.4576470851898193
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.3741927146911621  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.419864177703857  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.412707805633545  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.37296533584594727  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.470587253570557  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.472545146942139  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.39125871658325195  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.225440979003906  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.227928161621094  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.3895144462585449  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.488691806793213  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.491405963897705  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.40381813049316406  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.09765100479126  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.099606990814209  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4109954833984375  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.138962745666504  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.141453266143799  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4114055633544922  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.525172233581543  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.527034282684326  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4207029342651367  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.765042781829834  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.767101287841797  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4291520118713379  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.92634630203247  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.928840637207031  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4393301010131836  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.166372299194336  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.169232845306396  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4449601173400879  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.769413471221924  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.771484851837158  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.4465923309326172  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.574860095977783  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.576730251312256  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.46365976333618164  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.115926742553711  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.118458271026611  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.46983861923217773  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.15082311630249  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.15303659439087  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.47371768951416016  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.791899681091309  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 14.794333934783936  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.48567771911621094  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.22696590423584  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 15.229166507720947  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74560546875 GB
    Memory Allocated: 0.48630475997924805  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.605281352996826  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.6072998046875  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4998197555541992  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.22581958770752  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.227886199951172  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

number of input  16038097
----------------------------------------after optimizer
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.5216236114501953  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.390708088874817
pure train time :  4.0450029373168945
the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 0.567 seconds, peak memory: 48.461 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.461 GB
Metis partitioning: 2.294 seconds, peak memory: 48.461 GB
Split the graph: 1.190 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  4.0904552936553955
10653
11004
10671
10659
10870
10602
11165
11144
11136
11197
10941
11145
11205
10935
10616
10667
10782
11179
metis partition time  4.095625638961792
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010998725891113281
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.11716365814209
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.7031261920928955
self.buckets_partition() spend  sec:  4.128239393234253
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.3764491081237793  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.580448150634766  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.574159622192383  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.37925148010253906  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.89089298248291  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.893359661102295  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.3851442337036133  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.547411441802979  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.55000638961792  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.39029359817504883  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.518062114715576  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.520207405090332  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.40125465393066406  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.81744909286499  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.819806098937988  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4026765823364258  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.455193996429443  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.457315444946289  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.41814184188842773  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.051879405975342  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.054076671600342  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.42711925506591797  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.120751857757568  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.122949123382568  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4358062744140625  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.181554794311523  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.1838059425354  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4437227249145508  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.201048374176025  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.20322036743164  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.44643259048461914  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.85182237625122  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.854559421539307  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.45958995819091797  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.207104206085205  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.209507465362549  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4654574394226074  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.169421672821045  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.17172908782959  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4699058532714844  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.872905254364014  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.874870300292969  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4740777015686035  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.568268775939941  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.570192813873291  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.48113393783569336  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.672021865844727  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.674077033996582  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4887075424194336  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.776152610778809  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.778651237487793  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.5016980171203613  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.182799816131592  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.18481969833374  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

number of input  16034535
----------------------------------------after optimizer
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.5244832038879395  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2702840566635132
pure train time :  4.09218955039978
the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 0.610 seconds, peak memory: 48.461 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.461 GB
Metis partitioning: 2.260 seconds, peak memory: 48.461 GB
Split the graph: 0.559 seconds
Construct subgraphs: 0.039 seconds
metis partition ---------------pure dgl.metis_partition spent  3.469736099243164
10630
10641
11239
10602
11167
11195
10632
10828
10940
11141
10779
10677
11092
11125
10830
11173
10641
11239
metis partition time  3.474717617034912
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011363506317138672
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.4930756092071533
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.07759690284729
self.buckets_partition() spend  sec:  3.5044989585876465
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.37647294998168945  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.486880779266357  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.479332447052002  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.37464237213134766  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.47416353225708  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.476333618164062  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.38879823684692383  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.133016586303711  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.135185241699219  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.3899064064025879  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.470633506774902  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.47283411026001  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.405789852142334  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.137964725494385  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.140713214874268  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4136819839477539  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.112315654754639  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.114731788635254  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4159107208251953  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.589478969573975  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.591466903686523  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.42172861099243164  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.708491802215576  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.710930824279785  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.43367576599121094  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.896131992340088  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.898353576660156  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.44365882873535156  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.112889766693115  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.114883422851562  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.44647789001464844  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.674381256103516  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.676325798034668  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4522414207458496  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.602735996246338  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.60460615158081  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.46509885787963867  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.075312614440918  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.078052997589111  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4747805595397949  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.139292240142822  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.141338348388672  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.47907066345214844  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.870162010192871  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.872453212738037  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.48885679244995117  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.174790859222412  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.177262306213379  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.49338769912719727  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.616479396820068  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.618536472320557  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.5069580078125  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.286512851715088  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.288498401641846  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

number of input  16027227
----------------------------------------after optimizer
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.5305647850036621  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1703592538833618
pure train time :  3.7378416061401367
the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 0.434 seconds, peak memory: 48.461 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.461 GB
Metis partitioning: 2.071 seconds, peak memory: 48.461 GB
Split the graph: 0.891 seconds
Construct subgraphs: 0.039 seconds
metis partition ---------------pure dgl.metis_partition spent  3.435595989227295
10630
10641
11239
10602
11167
11195
10632
10828
10940
11141
10779
10677
11092
11125
10830
11173
10641
11239
metis partition time  3.4406940937042236
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01014566421508789
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.457825183868408
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.747372627258301
self.buckets_partition() spend  sec:  3.4680275917053223
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.37424707412719727  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.471287250518799  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.464517593383789  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.37393999099731445  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.469947338104248  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.471907138824463  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.3889279365539551  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.129091262817383  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.131147384643555  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.3900794982910156  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.43844223022461  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.440587520599365  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4038691520690918  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.103854656219482  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.10627794265747  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.41291379928588867  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.176456928253174  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.178573608398438  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4137563705444336  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.54630422592163  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.548264503479004  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.42231082916259766  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.810164451599121  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.813035011291504  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4297618865966797  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.83410358428955  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.836172103881836  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.44374895095825195  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.1775484085083  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.180079460144043  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.447451114654541  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.706801891326904  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.709374904632568  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.45247602462768555  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.651329517364502  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.653733730316162  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4642167091369629  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.089673042297363  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.092077255249023  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.47285985946655273  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.120402812957764  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.122730255126953  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4765167236328125  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.782856941223145  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.78495168685913  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4893350601196289  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.209740161895752  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.211827278137207  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.488924503326416  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.598689556121826  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.600961208343506  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.5041117668151855  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.266394138336182  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.26845407485962  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

number of input  16034174
----------------------------------------after optimizer
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.5264139175415039  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0774561166763306
pure train time :  4.169209957122803
the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 0.532 seconds, peak memory: 48.569 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.569 GB
Metis partitioning: 2.090 seconds, peak memory: 48.569 GB
Split the graph: 0.548 seconds
Construct subgraphs: 0.036 seconds
metis partition ---------------pure dgl.metis_partition spent  3.2093217372894287
10653
11004
10671
10659
10870
10602
11165
11144
11136
11197
10941
11145
11205
10935
10616
10667
10782
11179
metis partition time  3.214708089828491
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012711763381958008
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.23498272895813
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.4690351486206055
self.buckets_partition() spend  sec:  3.2477593421936035
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.37549591064453125  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.531824111938477  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.525578022003174  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.3791975975036621  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.836339473724365  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.838385581970215  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.3841733932495117  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.552377223968506  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.554246425628662  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.38851118087768555  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.520463466644287  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.522332668304443  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.3988780975341797  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.755613327026367  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.757517337799072  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.40245676040649414  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.441603183746338  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.443519592285156  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4170036315917969  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.103463172912598  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.106057167053223  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4269375801086426  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.10038709640503  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.102363586425781  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.43473386764526367  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.096529006958008  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.09850549697876  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.44524526596069336  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.178218364715576  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.180629253387451  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4487781524658203  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.889204025268555  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.891162395477295  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4607868194580078  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.195869445800781  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.197827816009521  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4722476005554199  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.228026390075684  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.230282306671143  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.47660064697265625  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.931192398071289  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.933448314666748  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.47955799102783203  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.546333312988281  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.548399925231934  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.485748291015625  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.641829490661621  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.644353866577148  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.49530935287475586  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.743464469909668  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.74610424041748  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.5066814422607422  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.232167720794678  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.234661102294922  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

number of input  16029528
----------------------------------------after optimizer
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.5282511711120605  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9997217059135437
pure train time :  4.077567100524902
the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 0.579 seconds, peak memory: 48.590 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.590 GB
Metis partitioning: 2.368 seconds, peak memory: 48.590 GB
Split the graph: 0.728 seconds
Construct subgraphs: 0.040 seconds
metis partition ---------------pure dgl.metis_partition spent  3.7161014080047607
10653
11004
10671
10659
10870
10602
11165
11144
11136
11197
10941
11145
11205
10935
10616
10667
10782
11179
metis partition time  3.7210652828216553
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01425480842590332
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.743136405944824
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.35420560836792
self.buckets_partition() spend  sec:  3.757444143295288
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.3748745918273926  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.52488899230957  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.519038200378418  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.38215112686157227  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.945331573486328  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.947845935821533  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.38361406326293945  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.495782375335693  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.49828290939331  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.38980674743652344  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.561402320861816  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.563547611236572  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4000067710876465  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.79027271270752  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.792316436767578  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.40506601333618164  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.509063243865967  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.51092004776001  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.41817569732666016  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.088655471801758  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.09063196182251  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.42694520950317383  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.086071491241455  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.088047981262207  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.43385839462280273  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.078100681304932  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.08022928237915  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4442124366760254  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.195626735687256  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.197802066802979  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4481668472290039  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.925085544586182  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.92719554901123  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4595365524291992  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.110630512237549  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.113265037536621  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.468961238861084  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.210512638092041  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 15.21318244934082  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4728851318359375  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.886411190032959  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.888829231262207  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.47652626037597656  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.56648063659668  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.568520545959473  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.4830751419067383  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.656132698059082  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 14.658520698547363  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74755859375 GB
    Memory Allocated: 0.491696834564209  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.788522720336914  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.790581226348877  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.5047826766967773  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.216923236846924  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.218986988067627  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

number of input  16037165
----------------------------------------after optimizer
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.5262250900268555  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9549123644828796
pure train time :  3.993269443511963
the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 0.603 seconds, peak memory: 48.590 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.590 GB
Metis partitioning: 2.295 seconds, peak memory: 48.590 GB
Split the graph: 0.574 seconds
Construct subgraphs: 0.040 seconds
metis partition ---------------pure dgl.metis_partition spent  3.5137956142425537
10653
11004
10671
10659
10870
10602
11165
11144
11136
11197
10941
11145
11205
10935
10616
10667
10782
11179
metis partition time  3.5191152095794678
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013267040252685547
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.538797378540039
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.972177982330322
self.buckets_partition() spend  sec:  3.5521132946014404
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.37519025802612305  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.515105247497559  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.50838565826416  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.3805503845214844  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.923452377319336  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.926095485687256  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.3841691017150879  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.548723697662354  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.55059289932251  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.39063405990600586  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.515519618988037  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.517386436462402  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4007301330566406  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.800453186035156  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.802590370178223  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.40575361251831055  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.511034488677979  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.512891292572021  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.42066240310668945  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.16251802444458  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.164904594421387  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4290952682495117  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.102209091186523  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.10459566116333  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4394378662109375  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.102266788482666  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.104297637939453  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.44626712799072266  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.182095050811768  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.184125423431396  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4510459899902344  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.94455862045288  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.947304725646973  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4639439582824707  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.171955108642578  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.173998832702637  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.46942567825317383  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.161234855651855  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.163204669952393  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.47369384765625  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.889448165893555  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.891417980194092  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.47812938690185547  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.545743465423584  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.547825336456299  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4857034683227539  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.637341022491455  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.639933109283447  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.49369287490844727  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.736906051635742  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.739272117614746  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.5074052810668945  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.261565208435059  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.26379108428955  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

number of input  16037645
----------------------------------------after optimizer
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.5308852195739746  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9112743139266968
pure train time :  4.012834072113037
the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 0.534 seconds, peak memory: 48.626 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.626 GB
Metis partitioning: 2.050 seconds, peak memory: 48.626 GB
Split the graph: 0.579 seconds
Construct subgraphs: 0.058 seconds
metis partition ---------------pure dgl.metis_partition spent  3.2218732833862305
10630
10641
11239
10602
11167
11195
10632
10828
10940
11141
10779
10677
11092
11125
10830
11173
10641
11239
metis partition time  3.227064609527588
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013753175735473633
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.249408483505249
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.5565972328186035
self.buckets_partition() spend  sec:  3.263329267501831
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.37629127502441406  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.474687099456787  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.46755599975586  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.3744163513183594  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.501500606536865  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.503472805023193  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.3901686668395996  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.174413681030273  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.176596641540527  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.38980674743652344  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.466688632965088  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.469311237335205  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.40343809127807617  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.080236911773682  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.082817554473877  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.41471099853515625  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.233281135559082  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.235722064971924  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.41277408599853516  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.521199703216553  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.523061752319336  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4227590560913086  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.790688037872314  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.792766571044922  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4302353858947754  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.868751049041748  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.870812892913818  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4418497085571289  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.116580486297607  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.118532657623291  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4441823959350586  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.6925630569458  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.69486141204834  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4486856460571289  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.580354690551758  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.582639694213867  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.46256256103515625  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.117540836334229  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.119555950164795  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4701972007751465  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.125429630279541  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.127470970153809  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.47270679473876953  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.772261142730713  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.774775981903076  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4839906692504883  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.219337463378906  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.221502780914307  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4852023124694824  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.605611324310303  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.608313083648682  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.5006041526794434  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.248982906341553  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.251680850982666  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

number of input  16037065
----------------------------------------after optimizer
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.5223808288574219  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8727630376815796
pure train time :  4.000027656555176
the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 0.503 seconds, peak memory: 48.626 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.626 GB
Metis partitioning: 2.026 seconds, peak memory: 48.626 GB
Split the graph: 0.517 seconds
Construct subgraphs: 0.034 seconds
metis partition ---------------pure dgl.metis_partition spent  3.088653802871704
10630
10641
11239
10602
11167
11195
10632
10828
10940
11141
10779
10677
11092
11125
10830
11173
10641
11239
metis partition time  3.0937275886535645
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013666868209838867
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1135380268096924
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.4073357582092285
self.buckets_partition() spend  sec:  3.127267360687256
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.3753037452697754  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.538023948669434  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.53232192993164  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.373842716217041  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.471145629882812  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.473456859588623  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.3902468681335449  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.218481063842773  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.221285343170166  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.38991880416870117  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.465616703033447  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.468108177185059  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4028897285461426  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.11889123916626  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.120969772338867  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4124174118041992  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.165685653686523  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.16810941696167  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.41275644302368164  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.527647495269775  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.529936790466309  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.42089128494262695  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.703223705291748  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.70608901977539  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.42911767959594727  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.819852828979492  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.82208776473999  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4426741600036621  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.171401500701904  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.173805713653564  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4446682929992676  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.700217723846436  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.70219898223877  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4507884979248047  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.624693393707275  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.627161502838135  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.46203184127807617  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.120052814483643  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.122303009033203  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4701237678527832  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.15029764175415  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.152373790740967  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.47492456436157227  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.822518825531006  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.824771404266357  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4880032539367676  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.204735279083252  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 15.206791400909424  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.4874305725097656  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.579526424407959  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 14.581681251525879  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.74951171875 GB
    Memory Allocated: 0.501011848449707  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.256875991821289  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.259030818939209  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

number of input  16041560
----------------------------------------after optimizer
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.5242605209350586  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8312368392944336
pure train time :  4.102277040481567
the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 0.522 seconds, peak memory: 48.626 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.626 GB
Metis partitioning: 2.024 seconds, peak memory: 48.626 GB
Split the graph: 0.514 seconds
Construct subgraphs: 0.043 seconds
metis partition ---------------pure dgl.metis_partition spent  3.1096131801605225
10653
11004
10671
10659
10870
10602
11165
11144
11136
11197
10941
11145
11205
10935
10616
10667
10782
11179
metis partition time  3.1148252487182617
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012022256851196289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1342883110046387
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.413595199584961
self.buckets_partition() spend  sec:  3.146374464035034
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.37532997131347656  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.511284828186035  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.505515098571777  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.3798041343688965  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.880139827728271  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.882447242736816  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.3832125663757324  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.532124519348145  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.5339937210083  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.3900566101074219  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.516676902770996  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.518822193145752  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.39867496490478516  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.784483432769775  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.78733491897583  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4022369384765625  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.44459867477417  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.446529865264893  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.41673707962036133  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.10698127746582  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.108936786651611  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4251837730407715  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.095157146453857  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.097116470336914  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.43475818634033203  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.06753921508789  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.069498538970947  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4435386657714844  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.201848983764648  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.203962802886963  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.44843578338623047  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.922843933105469  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.925129413604736  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.45844411849975586  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.137023448944092  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.139008045196533  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.46822214126586914  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.260185718536377  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.262170314788818  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4705238342285156  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.886935234069824  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.888897895812988  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4749774932861328  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.612688064575195  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.61522102355957  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.48360633850097656  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.65129041671753  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.65315866470337  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.48917245864868164  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.753621101379395  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.756332874298096  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.501579761505127  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.161330699920654  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.163714408874512  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

number of input  16022526
----------------------------------------after optimizer
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.5225629806518555  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7956397533416748
pure train time :  4.05781364440918
the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 0.617 seconds, peak memory: 48.626 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.626 GB
Metis partitioning: 1.988 seconds, peak memory: 48.626 GB
Split the graph: 1.117 seconds
Construct subgraphs: 0.032 seconds
metis partition ---------------pure dgl.metis_partition spent  3.769674777984619
10630
10641
11239
10602
11167
11195
10632
10828
10940
11141
10779
10677
11092
11125
10830
11173
10641
11239
metis partition time  3.7750048637390137
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01143336296081543
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.7963156700134277
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.086218357086182
self.buckets_partition() spend  sec:  3.8078155517578125
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.37503910064697266  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.529448986053467  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.524518489837646  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.37459373474121094  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.489829063415527  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.492417335510254  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.3892378807067871  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.171091556549072  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.173319816589355  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.39044952392578125  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.495906829833984  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.497763633728027  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4045543670654297  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.099998950958252  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.102144241333008  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.41322898864746094  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.148036479949951  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.150143146514893  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4153289794921875  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.533831119537354  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.536381721496582  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.42422914505004883  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.740030288696289  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.741957664489746  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.43472909927368164  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.92182207107544  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.923749446868896  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4433555603027344  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.101428031921387  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.103765964508057  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4477658271789551  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.740352630615234  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.742584705352783  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4525132179260254  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.597903728485107  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.600056171417236  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4662642478942871  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.122903823852539  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.125052452087402  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.47347354888916016  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.111741065979004  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.113889694213867  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4764714241027832  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.778797149658203  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.781089305877686  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.48922157287597656  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.249007225036621  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.250981330871582  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4881467819213867  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.612350463867188  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.614214420318604  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.5027899742126465  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.260849475860596  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.263135433197021  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

number of input  16039479
----------------------------------------after optimizer
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.5259213447570801  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7606446146965027
pure train time :  3.7789318561553955
the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 0.542 seconds, peak memory: 48.634 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.634 GB
Metis partitioning: 2.036 seconds, peak memory: 48.634 GB
Split the graph: 0.523 seconds
Construct subgraphs: 0.032 seconds
metis partition ---------------pure dgl.metis_partition spent  3.139589309692383
10630
10641
11239
10602
11167
11195
10632
10828
10940
11141
10779
10677
11092
11125
10830
11173
10641
11239
metis partition time  3.1446645259857178
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011482954025268555
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.166799306869507
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.449653387069702
self.buckets_partition() spend  sec:  3.178415298461914
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.37453365325927734  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.496553421020508  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.490859985351562  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.3739471435546875  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.509751796722412  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.511615753173828  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.3911128044128418  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.221458911895752  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.224151134490967  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.39115238189697266  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.514993667602539  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.517138957977295  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4036440849304199  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.079720497131348  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.081751346588135  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.40970659255981445  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.127010822296143  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.128983497619629  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4109377861022949  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.51103401184082  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.513067245483398  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4206428527832031  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.669720649719238  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.672074794769287  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.43009519577026367  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.896919250488281  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.899130821228027  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4405684471130371  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.13164758682251  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.133598804473877  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.44386768341064453  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.69044017791748  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.69319772720337  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4483346939086914  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.584407329559326  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.586277484893799  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.461057186126709  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.133265495300293  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.13529634475708  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4688286781311035  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.0918288230896  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.094517230987549  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4735560417175293  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.763430118560791  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.76577091217041  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4878048896789551  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.226017475128174  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.228195190429688  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4875946044921875  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.616507053375244  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.618456840515137  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.5016145706176758  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.306360244750977  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.308684825897217  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

number of input  16032764
----------------------------------------after optimizer
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.5242266654968262  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7280008792877197
pure train time :  3.7576234340667725
the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 0.454 seconds, peak memory: 48.634 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.634 GB
Metis partitioning: 2.055 seconds, peak memory: 48.634 GB
Split the graph: 0.571 seconds
Construct subgraphs: 0.029 seconds
metis partition ---------------pure dgl.metis_partition spent  3.1157853603363037
10653
11004
10671
10659
10870
10602
11165
11144
11136
11197
10941
11145
11205
10935
10616
10667
10782
11179
metis partition time  3.120626449584961
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011837482452392578
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1379830837249756
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.3850953578948975
self.buckets_partition() spend  sec:  3.149876117706299
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.3746824264526367  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.53871202468872  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.533216953277588  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.38048505783081055  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.92569875717163  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.928115367889404  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.38393211364746094  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.509164333343506  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.511433124542236  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.39074039459228516  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.529683113098145  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.53154993057251  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.3997325897216797  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.772810459136963  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.775217056274414  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.40297555923461914  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.442724227905273  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.44472074508667  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.41979408264160156  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.161280155181885  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.163276672363281  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4273052215576172  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.060370445251465  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.062557220458984  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4366025924682617  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.116510391235352  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.118460655212402  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.44768333435058594  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.213722229003906  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.215844631195068  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.45147037506103516  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.91383981704712  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.916100978851318  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4613194465637207  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.12658405303955  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.12873125076294  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4725065231323242  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.253552913665771  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.25563383102417  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4754819869995117  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.896358013153076  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.898385524749756  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4777183532714844  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.564739227294922  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.56675910949707  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.48553037643432617  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.631485939025879  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.633354187011719  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4936695098876953  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.773367404937744  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.775990962982178  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.5069551467895508  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.21479082107544  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.217085838317871  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

number of input  16032119
----------------------------------------after optimizer
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.5303201675415039  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6994510293006897
pure train time :  4.12154746055603
the output layer 
self.num_batch (get_in_degree_bucketing) 18
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  18
Convert a graph into a bidirected graph: 0.568 seconds, peak memory: 48.643 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.643 GB
Metis partitioning: 2.301 seconds, peak memory: 48.643 GB
Split the graph: 1.234 seconds
Construct subgraphs: 0.046 seconds
metis partition ---------------pure dgl.metis_partition spent  4.157507419586182
10630
10641
11239
10602
11167
11195
10632
10828
10940
11141
10779
10677
11092
11125
10830
11173
10641
11239
metis partition time  4.162566423416138
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013719797134399414
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.183347463607788
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.852660894393921
self.buckets_partition() spend  sec:  4.197129487991333
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.37315845489501953  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.457332134246826  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.450897693634033  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.37422990798950195  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.524888515472412  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.526752471923828  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.3891420364379883  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.146262645721436  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.14830207824707  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.3895559310913086  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.498182773590088  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.50003957748413  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.40364789962768555  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.078544616699219  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.080715656280518  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4103708267211914  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.067363739013672  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.069371700286865  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4143352508544922  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.566871643066406  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.569324493408203  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4236288070678711  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.758042812347412  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.760464668273926  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.43289661407470703  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.884418487548828  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.886918067932129  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.44385480880737305  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.11565351486206  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.117650032043457  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4481673240661621  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.76413869857788  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.76607608795166  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.45224857330322266  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.604053497314453  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.605923652648926  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.46440744400024414  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.097285747528076  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.099228382110596  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4719052314758301  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.131921768188477  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.134341716766357  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4771885871887207  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.864954471588135  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.86719799041748  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.4886445999145508  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.19283390045166  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.195058345794678  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.48914003372192383  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.581326007843018  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 14.583362579345703  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.503903865814209  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.269506931304932  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 15.271562576293945  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

number of input  16030389
----------------------------------------after optimizer
 Nvidia-smi: 22.75146484375 GB
    Memory Allocated: 0.5264067649841309  GigaBytes
Max Memory Allocated: 15.597308158874512  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6708118319511414
pure train time :  3.7601826190948486
epoch_time_list  [28.89896321296692, 27.488022089004517, 27.029146671295166, 25.54990863800049, 27.770477771759033, 29.448891401290894, 27.90110206604004, 29.554993629455566, 27.664514780044556, 28.318026542663574, 29.100427627563477, 29.09124207496643, 28.07220697402954, 26.55616521835327, 25.590937852859497, 25.484742879867554, 26.88068437576294, 25.412702083587646, 26.932661533355713, 29.520512580871582]

loading_time list   [0.5292978286743164, 0.596743106842041, 0.547248363494873, 0.46451592445373535, 0.5094048976898193, 0.7375771999359131, 0.44428467750549316, 0.46210622787475586, 0.4608471393585205, 0.4170544147491455, 0.46566224098205566, 0.534912109375, 0.5133283138275146, 0.5691254138946533, 0.47085070610046387, 0.5167036056518555, 0.5027599334716797, 0.5739560127258301, 0.49383091926574707, 0.5936620235443115]

 data loader gen time  21.4228777885437
	---backpack schedule time  [7.374969720840454, 6.588700532913208, 6.725130558013916, 6.427761554718018, 6.439185380935669, 6.921040296554565, 6.796174049377441, 7.781518936157227, 7.146371364593506, 6.8173627853393555, 6.533421277999878, 7.435330390930176, 7.039063930511475, 6.619586229324341, 6.467578887939453, 6.473389387130737, 7.169656276702881, 6.50871205329895, 6.44402551651001, 7.91759467124939]
	---connection_check_time_list  [7.674111604690552, 7.571368217468262, 7.354712963104248, 6.818780899047852, 8.28467321395874, 9.309736728668213, 8.875028610229492, 8.845642805099487, 7.8714759349823, 8.594777345657349, 10.12824034690857, 9.028729915618896, 7.810293436050415, 7.254250526428223, 6.35207200050354, 6.813445806503296, 6.968624591827393, 6.771160840988159, 7.9902801513671875, 8.84191370010376]
	---block_gen_time_list  [3.806853771209717, 4.198223352432251, 4.075555324554443, 3.703369140625, 4.20307183265686, 4.116238594055176, 3.937661647796631, 4.418179035186768, 3.988248348236084, 3.947046995162964, 4.037852764129639, 4.078003883361816, 4.243300914764404, 3.6983702182769775, 3.737462282180786, 3.8233633041381836, 4.026576042175293, 3.521984815597534, 4.032918214797974, 3.9845027923583984]
training time  [8.865425109863281, 7.8812947273254395, 7.6468095779418945, 7.510291337966919, 7.64069390296936, 7.715439558029175, 7.180365085601807, 7.327011585235596, 7.493471622467041, 7.886460065841675, 7.274147987365723, 7.313148260116577, 7.7672812938690186, 7.763351678848267, 7.8859570026397705, 7.202557802200317, 7.521481275558472, 7.370692491531372, 7.2858288288116455, 7.4648377895355225]
---feature block loading time  [3.8751327991485596, 4.0025200843811035, 3.8294248580932617, 3.692793369293213, 3.4437670707702637, 3.707794427871704, 3.019442081451416, 3.1258115768432617, 3.6575803756713867, 3.6177492141723633, 3.0809240341186523, 3.213752508163452, 3.6485953330993652, 3.663471221923828, 3.68442440032959, 3.036787748336792, 3.643512487411499, 3.513902187347412, 3.056912660598755, 3.6082677841186523]


epoch_time avg   27.706268087029457
loading_time avg   0.5166291147470474
 data loader gen time avg 19.65312969684601
	---backpack schedule time avg 6.906875714659691
	---connection_check_time avg  8.108771622180939
	---block_gen_time avg  3.987173855304718
training time  7.505795389413834
---feature block loading time  3.4201684445142746
pure train time per /epoch  [4.971186637878418, 3.7787575721740723, 3.7196593284606934, 3.716606855392456, 4.093135356903076, 3.9056501388549805, 4.0450029373168945, 4.09218955039978, 3.7378416061401367, 4.169209957122803, 4.077567100524902, 3.993269443511963, 4.012834072113037, 4.000027656555176, 4.102277040481567, 4.05781364440918, 3.7789318561553955, 3.7576234340667725, 4.12154746055603, 3.7601826190948486]
pure train time average  3.9659829840940586
num_input list  [16039647, 16031602, 16037554, 16037387, 16036500, 16035147, 16038097, 16034535, 16027227, 16034174, 16029528, 16037165, 16037645, 16037065, 16041560, 16022526, 16039479, 16032764, 16032119, 16030389]
num_input  average  16034605.5
