main start at this time 1713151319.7833512
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 1.295 seconds, peak memory: 19.342 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 19.342 GB
Metis partitioning: 2.045 seconds, peak memory: 19.586 GB
Split the graph: 0.654 seconds
Construct subgraphs: 0.027 seconds
metis partition ---------------pure dgl.metis_partition spent  4.032020330429077
11831
11893
11828
11339
11265
11298
11269
11831
11857
11247
11267
11380
11851
11356
11864
11365
11830
metis partition time  4.036665916442871
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009452104568481445
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.0506017208099365
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.094439506530762
self.buckets_partition() spend  sec:  4.060086250305176
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.88623046875 GB
    Memory Allocated: 0.3662571907043457  GigaBytes
Max Memory Allocated: 0.3662571907043457  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.76904296875 GB
    Memory Allocated: 15.820737838745117  GigaBytes
Max Memory Allocated: 16.09345579147339  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.76904296875 GB
    Memory Allocated: 15.823511600494385  GigaBytes
Max Memory Allocated: 16.09345579147339  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.77685546875 GB
    Memory Allocated: 0.39215517044067383  GigaBytes
Max Memory Allocated: 16.09345579147339  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.48583984375 GB
    Memory Allocated: 15.894373416900635  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.48583984375 GB
    Memory Allocated: 15.896588325500488  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.48583984375 GB
    Memory Allocated: 0.4005308151245117  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49169921875 GB
    Memory Allocated: 15.785733699798584  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.49169921875 GB
    Memory Allocated: 15.787870407104492  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49365234375 GB
    Memory Allocated: 0.40379762649536133  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49365234375 GB
    Memory Allocated: 15.296858310699463  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.49365234375 GB
    Memory Allocated: 15.298995018005371  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49365234375 GB
    Memory Allocated: 0.40979671478271484  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49365234375 GB
    Memory Allocated: 15.242334842681885  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.49365234375 GB
    Memory Allocated: 15.244914531707764  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49365234375 GB
    Memory Allocated: 0.41887521743774414  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49365234375 GB
    Memory Allocated: 15.249101638793945  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.49365234375 GB
    Memory Allocated: 15.251140594482422  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49365234375 GB
    Memory Allocated: 0.42786645889282227  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49365234375 GB
    Memory Allocated: 15.232064723968506  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.49365234375 GB
    Memory Allocated: 15.234064102172852  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49365234375 GB
    Memory Allocated: 0.44679689407348633  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49365234375 GB
    Memory Allocated: 15.889070510864258  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.49365234375 GB
    Memory Allocated: 15.892098426818848  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49365234375 GB
    Memory Allocated: 0.4547910690307617  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49755859375 GB
    Memory Allocated: 15.892757892608643  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.49755859375 GB
    Memory Allocated: 15.894834518432617  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49951171875 GB
    Memory Allocated: 0.45551490783691406  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49951171875 GB
    Memory Allocated: 15.27089262008667  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.49951171875 GB
    Memory Allocated: 15.272862434387207  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49951171875 GB
    Memory Allocated: 0.46530580520629883  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49951171875 GB
    Memory Allocated: 15.284725189208984  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.49951171875 GB
    Memory Allocated: 15.287553787231445  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49951171875 GB
    Memory Allocated: 0.47407007217407227  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49951171875 GB
    Memory Allocated: 15.437388896942139  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.49951171875 GB
    Memory Allocated: 15.439382076263428  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.49951171875 GB
    Memory Allocated: 0.49056339263916016  GigaBytes
Max Memory Allocated: 16.16890859603882  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.94091796875 GB
    Memory Allocated: 15.986305236816406  GigaBytes
Max Memory Allocated: 16.261343955993652  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.94091796875 GB
    Memory Allocated: 15.988973617553711  GigaBytes
Max Memory Allocated: 16.261343955993652  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.94287109375 GB
    Memory Allocated: 0.4907522201538086  GigaBytes
Max Memory Allocated: 16.261343955993652  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.94677734375 GB
    Memory Allocated: 15.394466400146484  GigaBytes
Max Memory Allocated: 16.261343955993652  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.94677734375 GB
    Memory Allocated: 15.397159576416016  GigaBytes
Max Memory Allocated: 16.261343955993652  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.94677734375 GB
    Memory Allocated: 0.5081257820129395  GigaBytes
Max Memory Allocated: 16.261343955993652  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81591796875 GB
    Memory Allocated: 16.052156448364258  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.81591796875 GB
    Memory Allocated: 16.054234504699707  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81591796875 GB
    Memory Allocated: 0.5070466995239258  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81591796875 GB
    Memory Allocated: 15.418920993804932  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.81591796875 GB
    Memory Allocated: 15.421154975891113  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81591796875 GB
    Memory Allocated: 0.5226483345031738  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81591796875 GB
    Memory Allocated: 15.958128929138184  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.81591796875 GB
    Memory Allocated: 15.960518836975098  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

number of input  15533588
----------------------------------------after optimizer
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 0.547976016998291  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.203375816345215
pure train time :  6.171123504638672
the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 0.558 seconds, peak memory: 45.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.632 GB
Metis partitioning: 2.038 seconds, peak memory: 45.632 GB
Split the graph: 0.834 seconds
Construct subgraphs: 0.040 seconds
metis partition ---------------pure dgl.metis_partition spent  3.4814248085021973
11831
11893
11828
11339
11265
11298
11269
11831
11857
11247
11267
11380
11851
11356
11864
11365
11830
metis partition time  3.4862711429595947
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011621952056884766
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.5011165142059326
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.5456202030181885
self.buckets_partition() spend  sec:  3.5128073692321777
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 0.3934359550476074  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.795600414276123  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.789412498474121  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 0.39430904388427734  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.885584831237793  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.888039588928223  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 0.4029655456542969  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.859386920928955  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.86167573928833  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 0.404386043548584  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.301638126373291  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.304440975189209  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 0.4126558303833008  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.227703094482422  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.229878425598145  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 0.41896820068359375  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.276837348937988  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.279553413391113  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 0.4294276237487793  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.275986194610596  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.277982234954834  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 0.4420657157897949  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.809760570526123  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.811991214752197  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 0.4510316848754883  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.901726245880127  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.904732704162598  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 0.4534010887145996  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.268032550811768  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.270002365112305  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 0.46350955963134766  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.257461071014404  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 15.259491443634033  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.81787109375 GB
    Memory Allocated: 0.47141361236572266  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.440354824066162  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.442385196685791  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.4872922897338867  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.959269046783447  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.961955070495605  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.4886283874511719  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.394358158111572  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.39708423614502  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.5048446655273438  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.961747169494629  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.964109420776367  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.5067033767700195  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.441479206085205  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.443637371063232  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.5193452835083008  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.955556869506836  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.958096504211426  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

number of input  15526240
----------------------------------------after optimizer
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.5423202514648438  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.4778835773468018
pure train time :  3.6106815338134766
the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 0.551 seconds, peak memory: 45.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.632 GB
Metis partitioning: 2.044 seconds, peak memory: 45.632 GB
Split the graph: 0.656 seconds
Construct subgraphs: 0.028 seconds
metis partition ---------------pure dgl.metis_partition spent  3.2904953956604004
11831
11893
11828
11339
11265
11298
11269
11831
11857
11247
11267
11380
11851
11356
11864
11365
11830
metis partition time  3.2952494621276855
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010969877243041992
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.3113083839416504
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.347579717636108
self.buckets_partition() spend  sec:  3.32232403755188
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.39360618591308594  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.863283634185791  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.857515811920166  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.3938593864440918  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.881682872772217  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.884002685546875  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.4022245407104492  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.82047986984253  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.823048114776611  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.40325069427490234  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.27859878540039  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.280584812164307  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.4111647605895996  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.219066619873047  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.221039772033691  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.4187445640563965  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.274566173553467  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.276854515075684  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.4281325340270996  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.29553747177124  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.297922611236572  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.44272613525390625  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.81182336807251  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.81408405303955  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.4512805938720703  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.910356998443604  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.913325786590576  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.45486879348754883  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.272624492645264  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.2745943069458  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.46150779724121094  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.273401737213135  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.27627944946289  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.4744696617126465  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.411377906799316  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.413772583007812  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.4854288101196289  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.965174198150635  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.967886924743652  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.49076128005981445  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.44848346710205  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.451116561889648  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.5035262107849121  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.938639640808105  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.94100284576416  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.5074877738952637  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.491875648498535  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.494364261627197  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.5210971832275391  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.949435710906982  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.952020645141602  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

number of input  15529844
----------------------------------------after optimizer
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.5442728996276855  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7353289127349854
pure train time :  3.5785562992095947
the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 0.447 seconds, peak memory: 45.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.632 GB
Metis partitioning: 2.003 seconds, peak memory: 45.632 GB
Split the graph: 1.004 seconds
Construct subgraphs: 0.037 seconds
metis partition ---------------pure dgl.metis_partition spent  3.4920825958251953
11831
11893
11828
11339
11265
11298
11269
11831
11857
11247
11267
11380
11851
11356
11864
11365
11830
metis partition time  3.497154474258423
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011005163192749023
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.5140528678894043
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.578531503677368
self.buckets_partition() spend  sec:  3.5251052379608154
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.392486572265625  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.805391788482666  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.798963069915771  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.39420318603515625  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.860459327697754  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.863029956817627  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.40190696716308594  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.799556732177734  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.801674842834473  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.40224409103393555  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.2680344581604  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.270020484924316  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.4102654457092285  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.225844860076904  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.228578090667725  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.4206962585449219  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.302993774414062  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.305944442749023  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.42847108840942383  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.235814571380615  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.237854480743408  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.44351720809936523  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.88415002822876  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.886327266693115  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.45279550552368164  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.906537532806396  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.908884048461914  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.4519224166870117  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.261082649230957  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.263052463531494  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.4621090888977051  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.316802024841309  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.319114685058594  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.470670223236084  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.388135433197021  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 15.390170097351074  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.82177734375 GB
    Memory Allocated: 0.4876236915588379  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.99020767211914  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.992283344268799  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.49071645736694336  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.459190845489502  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.46174955368042  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.5041923522949219  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.973118782043457  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.975998401641846  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.5064749717712402  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.43896484375  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.441792488098145  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.5205807685852051  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 16.01254892349243  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 16.01468515396118  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

number of input  15532041
----------------------------------------after optimizer
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.5440888404846191  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.2270169258117676
pure train time :  3.5979764461517334
the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 0.464 seconds, peak memory: 45.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.632 GB
Metis partitioning: 1.991 seconds, peak memory: 45.632 GB
Split the graph: 0.595 seconds
Construct subgraphs: 0.028 seconds
metis partition ---------------pure dgl.metis_partition spent  3.0790278911590576
11812
11530
11225
11288
11750
11735
11828
11753
11259
11827
11277
11240
11276
11278
11823
11837
11833
metis partition time  3.083817481994629
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011057615280151367
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1023073196411133
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.136368036270142
self.buckets_partition() spend  sec:  3.1134135723114014
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.39124250411987305  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.811233520507812  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.80492877960205  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.3889737129211426  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.488129615783691  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.490325450897217  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.3919811248779297  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.165844440460205  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.168272972106934  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.40306520462036133  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.251570224761963  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.253654956817627  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.4200167655944824  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.830317974090576  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.832826614379883  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.425809383392334  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.71628999710083  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.718892574310303  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.43709468841552734  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.843201160430908  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.845336437225342  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.4465022087097168  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.829674243927002  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.831753730773926  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.4460024833679199  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.27805757522583  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.280117511749268  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.46411943435668945  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.877333641052246  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.87940502166748  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.4643545150756836  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.260035037994385  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.262177467346191  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.47303199768066406  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.246170043945312  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.24831247329712  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.4820723533630371  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.302825927734375  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.305240154266357  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.4896225929260254  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.310447216033936  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.312589168548584  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 0.506199836730957  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.929056167602539  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66748046875 GB
    Memory Allocated: 15.93119478225708  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.5154438018798828  GigaBytes
Max Memory Allocated: 16.32667827606201  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 16.070342540740967  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 16.072816848754883  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.5232405662536621  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.93123197555542  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.933349609375  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

number of input  15530631
----------------------------------------after optimizer
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.5471324920654297  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7769834995269775
pure train time :  3.883420705795288
the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 0.505 seconds, peak memory: 45.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.632 GB
Metis partitioning: 2.323 seconds, peak memory: 45.632 GB
Split the graph: 1.147 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  4.013983726501465
11831
11893
11828
11339
11265
11298
11269
11831
11857
11247
11267
11380
11851
11356
11864
11365
11830
metis partition time  4.019338130950928
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012876033782958984
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.041292428970337
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.417256593704224
self.buckets_partition() spend  sec:  4.054243803024292
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.39426136016845703  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.891830444335938  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.885087013244629  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.39552927017211914  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.965415954589844  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.967498779296875  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.40052080154418945  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.835063457489014  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.837562561035156  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.4025578498840332  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.262019157409668  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.264189720153809  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.41143131256103516  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.192535400390625  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.194704055786133  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.42022037506103516  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.249481678009033  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.252314567565918  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.42779111862182617  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.21451711654663  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.216817855834961  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.44208621978759766  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.872684001922607  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.875038623809814  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.45253419876098633  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.943949222564697  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.946128368377686  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.44981861114501953  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.19700574874878  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.199182510375977  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.4604306221008301  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.270846843719482  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.273727416992188  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.4701805114746094  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.426447868347168  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.428905963897705  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.48245716094970703  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.945128917694092  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.947787761688232  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.48599910736083984  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.429576396942139  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.431893825531006  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.5008077621459961  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 16.015004634857178  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 16.017115592956543  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.5018563270568848  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.426295280456543  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.42865800857544  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.5151982307434082  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.956289768218994  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.958601474761963  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

number of input  15524231
----------------------------------------after optimizer
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.5383028984069824  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5520607233047485
pure train time :  3.8490970134735107
the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 0.549 seconds, peak memory: 45.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.632 GB
Metis partitioning: 2.254 seconds, peak memory: 45.632 GB
Split the graph: 0.703 seconds
Construct subgraphs: 0.027 seconds
metis partition ---------------pure dgl.metis_partition spent  3.534852981567383
11812
11530
11225
11288
11750
11735
11828
11753
11259
11827
11277
11240
11276
11278
11823
11837
11833
metis partition time  3.539679527282715
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013717412948608398
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.5599849224090576
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.631891489028931
self.buckets_partition() spend  sec:  3.5738461017608643
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.39450883865356445  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.849291324615479  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.843077659606934  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.3895578384399414  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.49153184890747  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.493551254272461  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.3948945999145508  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.207017421722412  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.209270000457764  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.40033531188964844  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.22377634048462  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.226699829101562  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.4151148796081543  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.75556993484497  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.757983684539795  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.42498302459716797  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.781196117401123  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.783419132232666  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.4337158203125  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.821333885192871  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.823449611663818  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.44107913970947266  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.801308631896973  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.80342435836792  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.44283390045166016  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.299184799194336  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.301891326904297  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.4582047462463379  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.905204772949219  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.907276153564453  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.45850658416748047  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.318445205688477  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.32086992263794  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.4676828384399414  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.277909278869629  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.280112266540527  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.47715282440185547  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.337453365325928  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.340023040771484  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.48094940185546875  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.215792655944824  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.217900276184082  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.5003390312194824  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.97303581237793  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.975505828857422  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.508979320526123  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.945684432983398  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.948070526123047  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.5165958404541016  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.953794479370117  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.956046104431152  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

number of input  15533156
----------------------------------------after optimizer
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.5394992828369141  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3947795629501343
pure train time :  3.6609482765197754
the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 0.508 seconds, peak memory: 45.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.632 GB
Metis partitioning: 2.017 seconds, peak memory: 45.632 GB
Split the graph: 0.736 seconds
Construct subgraphs: 0.028 seconds
metis partition ---------------pure dgl.metis_partition spent  3.2898356914520264
11831
11893
11828
11339
11265
11298
11269
11831
11857
11247
11267
11380
11851
11356
11864
11365
11830
metis partition time  3.294997215270996
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012690067291259766
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.3160622119903564
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.368258714675903
self.buckets_partition() spend  sec:  3.3288748264312744
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.39440345764160156  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.877277374267578  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.871845722198486  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.39494848251342773  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.933135032653809  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.93521785736084  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.40195798873901367  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.820320129394531  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.822964191436768  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.40628480911254883  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.336079120635986  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.338510990142822  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.41249752044677734  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.210999488830566  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.213032245635986  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.4214930534362793  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.287107944488525  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.289091110229492  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.43053388595581055  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.251370429992676  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.253344058990479  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.4469733238220215  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.90345287322998  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.90585994720459  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.45546531677246094  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.880753993988037  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.882898807525635  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.4562211036682129  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.21429967880249  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.216554164886475  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.46462297439575195  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.290056705474854  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.292710781097412  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.47333621978759766  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.41121530532837  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.41391897201538  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.4887223243713379  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.957505226135254  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.960274696350098  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.49069690704345703  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.420902729034424  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 15.423571109771729  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.66943359375 GB
    Memory Allocated: 0.5082354545593262  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 16.00834608078003  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 16.010489463806152  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5096549987792969  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.449042320251465  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.4510817527771  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.523195743560791  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.930591106414795  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.933071613311768  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

number of input  15526308
----------------------------------------after optimizer
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5460472106933594  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2757521867752075
pure train time :  3.815999746322632
the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 0.442 seconds, peak memory: 45.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.632 GB
Metis partitioning: 2.025 seconds, peak memory: 45.632 GB
Split the graph: 0.644 seconds
Construct subgraphs: 0.031 seconds
metis partition ---------------pure dgl.metis_partition spent  3.1438939571380615
11831
11893
11828
11339
11265
11298
11269
11831
11857
11247
11267
11380
11851
11356
11864
11365
11830
metis partition time  3.1480631828308105
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011699676513671875
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.166011095046997
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.504776477813721
self.buckets_partition() spend  sec:  3.1777901649475098
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3936915397644043  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.82472562789917  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.818693161010742  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.39548254013061523  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.88211727142334  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.884618282318115  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.40064001083374023  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.788802146911621  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.790878295898438  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4037494659423828  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.30095624923706  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.303693294525146  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4129295349121094  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.287745952606201  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.289719104766846  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.41723012924194336  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.226691246032715  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.229397296905518  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.42658376693725586  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.264880180358887  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.267277240753174  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.44269847869873047  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.906188011169434  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.908582210540771  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4507594108581543  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.882261753082275  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.88433837890625  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4503445625305176  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.283403873443604  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.28630781173706  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4581022262573242  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.2701416015625  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.272346019744873  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4667692184448242  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.40193796157837  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.403974533081055  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.48247671127319336  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.923715114593506  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.925953388214111  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4852147102355957  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.373299598693848  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.375288486480713  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5004210472106934  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.940217018127441  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.942540645599365  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.503507137298584  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.421552181243896  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.42384672164917  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.519467830657959  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.975626945495605  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.978185653686523  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

number of input  15524662
----------------------------------------after optimizer
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.542518138885498  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1776405572891235
pure train time :  3.934034824371338
the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 0.522 seconds, peak memory: 45.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.632 GB
Metis partitioning: 1.988 seconds, peak memory: 45.632 GB
Split the graph: 0.658 seconds
Construct subgraphs: 0.035 seconds
metis partition ---------------pure dgl.metis_partition spent  3.204453706741333
11809
11603
11225
11256
11726
11808
11840
11703
11282
11777
11232
11275
11289
11710
11364
11889
11783
metis partition time  3.209406852722168
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013108253479003906
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.227834701538086
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.2601563930511475
self.buckets_partition() spend  sec:  3.2409963607788086
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3926668167114258  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.813904762268066  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.808298587799072  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3910694122314453  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.571044921875  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.573325634002686  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3946523666381836  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.180800437927246  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.183029651641846  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4041275978088379  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.224660396575928  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.226773262023926  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.42122507095336914  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.760391235351562  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.762550830841064  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4301571846008301  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.895155906677246  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.897297859191895  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4400062561035156  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.855835437774658  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.857912063598633  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4462251663208008  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.747585773468018  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.749662399291992  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4490480422973633  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.26691198348999  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.269428253173828  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.46605825424194336  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.827195644378662  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.829423904418945  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4663381576538086  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.252954483032227  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.255194664001465  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4745469093322754  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.345402240753174  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.347382068634033  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4854898452758789  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.32227611541748  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.324355602264404  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.49672746658325195  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.756391048431396  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.758532047271729  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5032515525817871  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.373555183410645  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.375949382781982  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.519284725189209  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 16.011184215545654  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 16.013408184051514  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.528902530670166  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 16.004525184631348  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 16.006749153137207  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

number of input  15532569
----------------------------------------after optimizer
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5519423484802246  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0778746604919434
pure train time :  3.608046054840088
the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 0.417 seconds, peak memory: 45.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.632 GB
Metis partitioning: 1.990 seconds, peak memory: 45.632 GB
Split the graph: 0.571 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  3.0165977478027344
11831
11893
11828
11339
11265
11298
11269
11831
11857
11247
11267
11380
11851
11356
11864
11365
11830
metis partition time  3.0213780403137207
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012181758880615234
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.0407893657684326
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.096514463424683
self.buckets_partition() spend  sec:  3.053018569946289
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.39269065856933594  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.802411079406738  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.796496391296387  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3931598663330078  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.879659175872803  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.88226318359375  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4009389877319336  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.81267786026001  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.814853191375732  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4040040969848633  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.243381023406982  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.245556354522705  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4133787155151367  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.248920917510986  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.250960350036621  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4186406135559082  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.256639957427979  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.258618831634521  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.42736053466796875  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.25227975845337  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.25459337234497  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.443115234375  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.835445880889893  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.837583065032959  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4534025192260742  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.949049472808838  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.95136547088623  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.45340776443481445  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.244121551513672  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.24613618850708  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4602217674255371  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.241217613220215  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.24349308013916  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4701261520385742  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.3977952003479  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.399826049804688  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4858055114746094  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.940091133117676  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.942166805267334  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.48708057403564453  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.403666019439697  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.40630578994751  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5024576187133789  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.97824239730835  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.980677604675293  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5031857490539551  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.434653282165527  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.436792373657227  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5178194046020508  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.96243667602539  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.964634418487549  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

number of input  15521141
----------------------------------------after optimizer
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5409812927246094  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0039223432540894
pure train time :  3.593518018722534
the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 0.350 seconds, peak memory: 45.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.632 GB
Metis partitioning: 1.906 seconds, peak memory: 45.632 GB
Split the graph: 0.608 seconds
Construct subgraphs: 0.036 seconds
metis partition ---------------pure dgl.metis_partition spent  2.9001691341400146
11812
11530
11225
11288
11750
11735
11828
11753
11259
11827
11277
11240
11276
11278
11823
11837
11833
metis partition time  2.9051079750061035
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012263774871826172
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.9229419231414795
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.9883058071136475
self.buckets_partition() spend  sec:  2.935260772705078
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.39375925064086914  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.832026958465576  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.826414108276367  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3892326354980469  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.49269437789917  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.495095252990723  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3932914733886719  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.139149188995361  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.141168594360352  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4023566246032715  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.248836517333984  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.25150728225708  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.41658592224121094  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.81986141204834  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.821963787078857  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4254279136657715  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.79477834701538  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.796880722045898  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.43337202072143555  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.82351541519165  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.825650691986084  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.44400501251220703  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.827112197875977  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.82921838760376  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4474301338195801  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.267665386199951  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.270588874816895  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.46361684799194336  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.901308536529541  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.904189109802246  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.46261119842529297  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.268555641174316  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.270548820495605  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4688835144042969  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.261989116668701  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.26447057723999  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4786386489868164  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.276802062988281  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.278915405273438  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4881010055541992  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.382061958312988  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.384801387786865  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5019779205322266  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.911265850067139  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.913514614105225  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5101170539855957  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.91597032546997  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.91813039779663  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.519355297088623  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.931169509887695  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.933279991149902  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

number of input  15531226
----------------------------------------after optimizer
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.545353889465332  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9595246315002441
pure train time :  3.7814056873321533
the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 0.376 seconds, peak memory: 45.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.632 GB
Metis partitioning: 1.947 seconds, peak memory: 45.632 GB
Split the graph: 0.581 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  2.9432308673858643
11831
11893
11828
11339
11265
11298
11269
11831
11857
11247
11267
11380
11851
11356
11864
11365
11830
metis partition time  2.9480783939361572
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012582540512084961
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.9696779251098633
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.017716884613037
self.buckets_partition() spend  sec:  2.982306957244873
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.39499521255493164  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.843576431274414  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.835450649261475  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3934178352355957  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.911760330200195  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.914113998413086  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.40087461471557617  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.823002338409424  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.825626850128174  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.40525341033935547  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.305684566497803  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.307806015014648  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.41301584243774414  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.254189491271973  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.256580352783203  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4207601547241211  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.24840497970581  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.250795841217041  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.42789745330810547  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.27864408493042  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.280877590179443  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4439668655395508  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.900777816772461  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.902994155883789  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.45340824127197266  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.97435474395752  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.976730823516846  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.45320796966552734  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.248663902282715  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.250709056854248  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.46199846267700195  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.238721370697021  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.240766525268555  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4689750671386719  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.388647079467773  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.390641689300537  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.48685216903686523  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.951661586761475  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.954539775848389  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4894585609436035  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.413949966430664  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.416452407836914  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5042643547058105  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.992010116577148  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.994384765625  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5058188438415527  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.46645975112915  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.468450546264648  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5191283226013184  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.914556980133057  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.916728019714355  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

number of input  15534185
----------------------------------------after optimizer
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5410490036010742  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9113848209381104
pure train time :  3.8283326625823975
the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 0.671 seconds, peak memory: 45.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.632 GB
Metis partitioning: 2.327 seconds, peak memory: 45.632 GB
Split the graph: 0.645 seconds
Construct subgraphs: 0.031 seconds
metis partition ---------------pure dgl.metis_partition spent  3.6753554344177246
11831
11893
11828
11339
11265
11298
11269
11831
11857
11247
11267
11380
11851
11356
11864
11365
11830
metis partition time  3.6804187297821045
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012166976928710938
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.6983532905578613
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.90684962272644
self.buckets_partition() spend  sec:  3.7105844020843506
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3926067352294922  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.796247959136963  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.7905855178833  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.39539241790771484  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.9182448387146  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.92032766342163  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.40323400497436523  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.851866722106934  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.854340553283691  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4044938087463379  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.320332050323486  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.32324504852295  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.41166162490844727  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.1919264793396  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.19457721710205  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.42104005813598633  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.299306392669678  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.301563262939453  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.42772722244262695  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.252925872802734  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.255440711975098  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4449434280395508  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.88409948348999  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.886331558227539  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.45285940170288086  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.867968559265137  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.870067596435547  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4541144371032715  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.217347621917725  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.2198166847229  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.46391820907592773  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.315877914428711  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.318040370941162  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4731464385986328  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.468931198120117  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.470951080322266  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.48709964752197266  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.93376350402832  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.93586540222168  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.48969459533691406  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.398031234741211  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.40098524093628  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5037841796875  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.969674587249756  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.972213745117188  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5069260597229004  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.47340202331543  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.47548246383667  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5177254676818848  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.873697280883789  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.87577199935913  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

number of input  15529109
----------------------------------------after optimizer
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5406570434570312  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8725463151931763
pure train time :  3.9106357097625732
the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 0.542 seconds, peak memory: 45.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.632 GB
Metis partitioning: 2.283 seconds, peak memory: 45.632 GB
Split the graph: 0.612 seconds
Construct subgraphs: 0.026 seconds
metis partition ---------------pure dgl.metis_partition spent  3.4649722576141357
11809
11603
11225
11256
11726
11808
11840
11703
11282
11777
11232
11275
11289
11710
11364
11889
11783
metis partition time  3.469041347503662
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012939929962158203
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.4884591102600098
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.868205547332764
self.buckets_partition() spend  sec:  3.5014493465423584
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3921995162963867  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.834993839263916  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.829742431640625  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3897528648376465  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.552636623382568  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.55477237701416  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3944888114929199  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.195026397705078  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.19699239730835  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4038529396057129  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.232048034667969  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.234019756317139  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4183235168457031  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.79747486114502  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.799578666687012  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4253201484680176  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.849092960357666  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.851592540740967  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.43634939193725586  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.884989261627197  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.887450695037842  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.44147491455078125  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.741846084594727  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.744168758392334  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.44651031494140625  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.28638505935669  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.288538932800293  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4604020118713379  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.841188907623291  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.843318462371826  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.462310791015625  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.233694553375244  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.235862731933594  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4714174270629883  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.261459350585938  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.263588428497314  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.479123592376709  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.287876605987549  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.28987455368042  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4929804801940918  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.72490644454956  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.727594375610352  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4962801933288574  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.425903797149658  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.428563117980957  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5126519203186035  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 16.00931167602539  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 16.011439323425293  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5209207534790039  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.938424587249756  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.940920352935791  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

number of input  15536622
----------------------------------------after optimizer
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5437178611755371  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8296991586685181
pure train time :  3.7409799098968506
the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 0.473 seconds, peak memory: 45.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.632 GB
Metis partitioning: 2.118 seconds, peak memory: 45.632 GB
Split the graph: 0.621 seconds
Construct subgraphs: 0.046 seconds
metis partition ---------------pure dgl.metis_partition spent  3.2599523067474365
11831
11893
11828
11339
11265
11298
11269
11831
11857
11247
11267
11380
11851
11356
11864
11365
11830
metis partition time  3.2646777629852295
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011376380920410156
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.2886133193969727
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.111462831497192
self.buckets_partition() spend  sec:  3.300041437149048
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3921017646789551  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.80335807800293  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.79772663116455  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3934330940246582  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.90003776550293  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.902120590209961  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3997631072998047  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.791723251342773  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.793814182281494  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.40097761154174805  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.227556228637695  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.229542255401611  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.40795087814331055  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.2158522605896  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.217886924743652  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.41922616958618164  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.329888343811035  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.332244396209717  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.42572975158691406  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.23313283920288  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.235455989837646  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.44478750228881836  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.884785175323486  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.887386322021484  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4500432014465332  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.822980403900146  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.825261116027832  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.45340728759765625  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.279318809509277  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.281599521636963  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4631977081298828  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.352010726928711  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.354396343231201  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4736037254333496  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.420191764831543  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.422856330871582  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4878835678100586  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.970097541809082  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.972604751586914  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4904294013977051  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.42592716217041  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.428008079528809  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.505648136138916  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.926975727081299  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.92942190170288  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5093827247619629  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.442785263061523  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.445144176483154  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5232062339782715  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.979379653930664  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.981568336486816  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

number of input  15518335
----------------------------------------after optimizer
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.547980785369873  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.796938955783844
pure train time :  3.973721981048584
the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 0.546 seconds, peak memory: 45.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.632 GB
Metis partitioning: 2.160 seconds, peak memory: 45.632 GB
Split the graph: 0.675 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  3.4263510704040527
11831
11893
11828
11339
11265
11298
11269
11831
11857
11247
11267
11380
11851
11356
11864
11365
11830
metis partition time  3.4314041137695312
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011393070220947266
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.448928117752075
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.733684778213501
self.buckets_partition() spend  sec:  3.4603753089904785
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3943042755126953  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.812211990356445  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.804335594177246  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.39458560943603516  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.896090507507324  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.898353099822998  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.40227222442626953  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.83041524887085  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.832487106323242  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.40351009368896484  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.28788709640503  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.289873123168945  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.41159772872924805  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.238377094268799  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.241074085235596  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.42039966583251953  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.293107986450195  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.295559883117676  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.42794179916381836  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.28324270248413  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.285221576690674  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4445948600769043  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.904111385345459  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.906714916229248  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.44986915588378906  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.86673879623413  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.868878364562988  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.45325374603271484  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.24812364578247  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.250117778778076  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4605226516723633  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.240667819976807  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.242661952972412  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4720907211303711  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.447145938873291  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.4494309425354  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.48522186279296875  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.91348123550415  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.915871143341064  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4884757995605469  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.462485790252686  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.4650239944458  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5028834342956543  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.971123695373535  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.973316192626953  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5063333511352539  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.437016010284424  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.439087867736816  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5206894874572754  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.912904262542725  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.914976119995117  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

number of input  15529822
----------------------------------------after optimizer
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5432977676391602  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7637673020362854
pure train time :  4.034008502960205
the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 0.509 seconds, peak memory: 45.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.632 GB
Metis partitioning: 2.208 seconds, peak memory: 45.632 GB
Split the graph: 0.580 seconds
Construct subgraphs: 0.033 seconds
metis partition ---------------pure dgl.metis_partition spent  3.3454647064208984
11855
11396
11225
11271
11698
11813
11834
11629
11314
11251
11347
11865
11283
11848
11889
11828
11225
metis partition time  3.3495328426361084
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012794733047485352
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.3676278591156006
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.3348729610443115
self.buckets_partition() spend  sec:  3.3805558681488037
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3916606903076172  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.838444709777832  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.832118511199951  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3875570297241211  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.325661659240723  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.327929496765137  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3937344551086426  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.145818710327148  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.147830486297607  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4029102325439453  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.209736824035645  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.212206363677979  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.41924428939819336  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.71663522720337  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.719244956970215  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4274730682373047  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.836260318756104  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.838428974151611  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4375319480895996  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.879410743713379  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.881563186645508  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4438657760620117  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.692025184631348  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.694790363311768  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4469733238220215  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.253774642944336  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.25578784942627  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4539470672607422  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.237837314605713  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.239850521087646  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.46302175521850586  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.366913318634033  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.36899471282959  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4788780212402344  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.956793308258057  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.959198951721191  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4798722267150879  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.335559368133545  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.33818006515503  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4957413673400879  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.96965503692627  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.972077369689941  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.506441593170166  GigaBytes
Max Memory Allocated: 16.345399379730225  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 16.08089542388916  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 16.083796501159668  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5121822357177734  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.936055183410645  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.938215732574463  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5140676498413086  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.277026653289795  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.279185771942139  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

number of input  15526908
----------------------------------------after optimizer
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.536811351776123  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7283517122268677
pure train time :  3.981046676635742
the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 0.514 seconds, peak memory: 45.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.632 GB
Metis partitioning: 2.229 seconds, peak memory: 45.632 GB
Split the graph: 0.655 seconds
Construct subgraphs: 0.046 seconds
metis partition ---------------pure dgl.metis_partition spent  3.4451839923858643
11831
11893
11828
11339
11265
11298
11269
11831
11857
11247
11267
11380
11851
11356
11864
11365
11830
metis partition time  3.4490602016448975
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009968757629394531
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.466973066329956
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.734274625778198
self.buckets_partition() spend  sec:  3.476990222930908
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3929767608642578  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.77491283416748  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.76749324798584  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3946232795715332  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.889989852905273  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.892093658447266  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4047698974609375  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.851405620574951  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.853477478027344  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.40470170974731445  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.30490493774414  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.306890964508057  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.41270017623901367  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.208913803100586  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.210899829864502  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.42235469818115234  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.240768432617188  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.242763042449951  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.42844343185424805  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.217519760131836  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.21959924697876  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.44620275497436523  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.92589521408081  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.92820405960083  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4558558464050293  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.930732727050781  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.9330415725708  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.45665788650512695  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.241621494293213  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.243842124938965  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.46390771865844727  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.282032489776611  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.284006118774414  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.47464561462402344  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.3609299659729  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.363003253936768  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.48822546005249023  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.962096214294434  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.964654445648193  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4919009208679199  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.403865814208984  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.406578063964844  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5060486793518066  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 16.005489826202393  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 16.00770616531372  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5087213516235352  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.427753448486328  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.430196285247803  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5248847007751465  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 16.008041858673096  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 16.010366916656494  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

number of input  15524993
----------------------------------------after optimizer
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5479626655578613  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7035607099533081
pure train time :  3.9710938930511475
the output layer 
self.num_batch (get_in_degree_bucketing) 17
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  17
Convert a graph into a bidirected graph: 0.517 seconds, peak memory: 45.632 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.632 GB
Metis partitioning: 2.177 seconds, peak memory: 45.632 GB
Split the graph: 1.136 seconds
Construct subgraphs: 0.037 seconds
metis partition ---------------pure dgl.metis_partition spent  3.8746213912963867
11831
11893
11828
11339
11265
11298
11269
11831
11857
11247
11267
11380
11851
11356
11864
11365
11830
metis partition time  3.8799071311950684
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01044917106628418
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.8979148864746094
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.247250556945801
self.buckets_partition() spend  sec:  3.908412456512451
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3928499221801758  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.805716514587402  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.799307823181152  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.3936500549316406  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.902678966522217  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.904903411865234  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.40161991119384766  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.820274829864502  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.822421550750732  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4044160842895508  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.232078552246094  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.234225273132324  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.4099283218383789  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.191188335418701  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.193375587463379  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.42136096954345703  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.298994541168213  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.301141262054443  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.42760705947875977  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.256541728973389  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.258515357971191  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.44371747970581055  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.88544511795044  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.88751745223999  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.45214128494262695  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.882224559783936  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.88430118560791  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.45386505126953125  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.263096332550049  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.265605926513672  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.46405649185180664  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.340525150299072  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.342498779296875  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.47141599655151367  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.368544101715088  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.370537281036377  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.48863840103149414  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.932491302490234  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.935380458831787  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.49286890029907227  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.484191417694092  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.486639976501465  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5045084953308105  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.962709903717041  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.96478796005249  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5054101943969727  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.430498123168945  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.43299674987793  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5204191207885742  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.952170848846436  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 15.954466819763184  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

number of input  15524700
----------------------------------------after optimizer
 Nvidia-smi: 20.51513671875 GB
    Memory Allocated: 0.5440878868103027  GigaBytes
Max Memory Allocated: 16.356103897094727  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.673346757888794
pure train time :  3.9048750400543213
epoch_time_list  [28.26011323928833, 25.7589213848114, 25.040550231933594, 25.35222339630127, 25.790733814239502, 30.880614757537842, 27.56667399406433, 25.287901639938354, 27.748944520950317, 26.356828451156616, 24.88771939277649, 24.577068567276, 23.98866367340088, 29.228111505508423, 28.95167851448059, 28.212717533111572, 27.092750787734985, 26.44176459312439, 27.34644341468811, 26.60877227783203]

loading_time list   [0.5446550846099854, 0.5984272956848145, 0.5759909152984619, 0.5142607688903809, 0.5577242374420166, 0.8893935680389404, 0.5354354381561279, 0.6425125598907471, 0.4207122325897217, 0.5501408576965332, 0.4798085689544678, 0.3740978240966797, 0.360776424407959, 0.5172288417816162, 0.8013732433319092, 0.4925041198730469, 0.5524520874023438, 0.5291333198547363, 0.5208346843719482, 0.6136345863342285]

 data loader gen time  19.026707410812378
	---backpack schedule time  [7.164106845855713, 6.611467361450195, 6.416759967803955, 6.649085521697998, 6.207204103469849, 7.501214504241943, 6.704097509384155, 6.43787956237793, 6.5685107707977295, 6.338329553604126, 6.158218622207642, 6.0565972328186035, 6.077469348907471, 6.99966025352478, 6.95167875289917, 7.17891526222229, 6.797483444213867, 7.406868934631348, 7.799492835998535, 7.302361726760864]
	---connection_check_time_list  [6.606919527053833, 7.027388095855713, 6.679213285446167, 6.805103540420532, 6.993301630020142, 10.486833095550537, 8.708424091339111, 6.733934164047241, 8.857669830322266, 7.814834117889404, 6.989356756210327, 6.642627954483032, 6.399409532546997, 9.339560747146606, 8.822571754455566, 8.792862176895142, 8.195477724075317, 6.978183031082153, 7.079120874404907, 7.083505392074585]
	---block_gen_time_list  [3.614708185195923, 3.601494550704956, 3.6112849712371826, 3.3639636039733887, 3.8724684715270996, 4.076949596405029, 3.531625986099243, 3.466902017593384, 4.2510058879852295, 3.6936073303222656, 3.4453415870666504, 3.5819664001464844, 3.6078221797943115, 4.219727993011475, 3.7230892181396484, 3.9308221340179443, 3.71811580657959, 3.720205307006836, 3.9654390811920166, 3.987884759902954]
training time  [9.713977336883545, 7.289272785186768, 7.129875659942627, 7.418140649795532, 7.522948741912842, 7.203271150588989, 7.46433162689209, 7.378352642059326, 7.005671739578247, 7.3156657218933105, 7.213398694992065, 7.326334238052368, 6.923298120498657, 7.441570520401001, 7.533295631408691, 7.13905668258667, 7.139486312866211, 7.10550594329834, 7.2783119678497314, 6.937516212463379]
---feature block loading time  [3.524261236190796, 3.5745644569396973, 3.446768283843994, 3.7255635261535645, 3.5291523933410645, 3.2434685230255127, 3.699303388595581, 3.4563722610473633, 2.9577972888946533, 3.6037755012512207, 3.5151455402374268, 3.4407012462615967, 2.98319673538208, 3.4208197593688965, 3.6888976097106934, 3.0560474395751953, 2.9994325637817383, 3.0169219970703125, 3.203186273574829, 2.915426731109619]


epoch_time avg   26.935461714863777
loading_time avg   0.5523601621389389
 data loader gen time avg 19.109419748187065
	---backpack schedule time avg 6.780373901128769
	---connection_check_time avg  7.869854554533958
	---block_gen_time avg  3.799560859799385
training time  7.24550099670887
---feature block loading time  3.2956028282642365
pure train time per /epoch  [6.171123504638672, 3.6106815338134766, 3.5785562992095947, 3.5979764461517334, 3.883420705795288, 3.8490970134735107, 3.6609482765197754, 3.815999746322632, 3.934034824371338, 3.608046054840088, 3.593518018722534, 3.7814056873321533, 3.8283326625823975, 3.9106357097625732, 3.7409799098968506, 3.973721981048584, 4.034008502960205, 3.981046676635742, 3.9710938930511475, 3.9048750400543213]
pure train time average  3.82759653820711
num_input list  [15533588, 15526240, 15529844, 15532041, 15530631, 15524231, 15533156, 15526308, 15524662, 15532569, 15521141, 15531226, 15534185, 15529109, 15536622, 15518335, 15529822, 15526908, 15524993, 15524700]
num_input  average  15528515.55
