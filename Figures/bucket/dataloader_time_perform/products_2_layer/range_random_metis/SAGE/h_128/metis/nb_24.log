main start at this time 1713154605.8394322
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 1.308 seconds, peak memory: 19.342 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 19.342 GB
Metis partitioning: 2.128 seconds, peak memory: 19.659 GB
Split the graph: 0.576 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  4.06173038482666
8212
8370
8195
8298
8352
8044
8339
7974
8365
8209
8385
8388
7969
7967
8013
7981
8245
7990
8383
7994
8085
8069
8364
8380
metis partition time  4.065518379211426
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010164737701416016
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.078392744064331
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  8.32591700553894
self.buckets_partition() spend  sec:  4.088608503341675
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.83349609375 GB
    Memory Allocated: 0.30497026443481445  GigaBytes
Max Memory Allocated: 0.30497026443481445  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.39208984375 GB
    Memory Allocated: 11.605860233306885  GigaBytes
Max Memory Allocated: 11.794475078582764  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.39208984375 GB
    Memory Allocated: 11.607590675354004  GigaBytes
Max Memory Allocated: 11.794475078582764  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.39990234375 GB
    Memory Allocated: 0.3329453468322754  GigaBytes
Max Memory Allocated: 11.794475078582764  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.66357421875 GB
    Memory Allocated: 11.880369663238525  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.66357421875 GB
    Memory Allocated: 11.882086277008057  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.66357421875 GB
    Memory Allocated: 0.33335113525390625  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.67333984375 GB
    Memory Allocated: 11.635631561279297  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.67333984375 GB
    Memory Allocated: 11.637341499328613  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.67333984375 GB
    Memory Allocated: 0.3409724235534668  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.67529296875 GB
    Memory Allocated: 11.79546070098877  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.67529296875 GB
    Memory Allocated: 11.797633171081543  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.67529296875 GB
    Memory Allocated: 0.34574413299560547  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.68310546875 GB
    Memory Allocated: 11.763844013214111  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.68310546875 GB
    Memory Allocated: 11.76576042175293  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.68310546875 GB
    Memory Allocated: 0.34687232971191406  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.68701171875 GB
    Memory Allocated: 11.452046871185303  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.68701171875 GB
    Memory Allocated: 11.453557014465332  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.68701171875 GB
    Memory Allocated: 0.35707807540893555  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.69482421875 GB
    Memory Allocated: 11.822486877441406  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.69482421875 GB
    Memory Allocated: 11.823997020721436  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.69482421875 GB
    Memory Allocated: 0.35477495193481445  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.71630859375 GB
    Memory Allocated: 11.3318772315979  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.71630859375 GB
    Memory Allocated: 11.333352088928223  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.71630859375 GB
    Memory Allocated: 0.36852169036865234  GigaBytes
Max Memory Allocated: 12.074280261993408  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.71630859375 GB
    Memory Allocated: 11.92282247543335  GigaBytes
Max Memory Allocated: 12.11612606048584  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.71630859375 GB
    Memory Allocated: 11.924297332763672  GigaBytes
Max Memory Allocated: 12.11612606048584  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.71630859375 GB
    Memory Allocated: 0.3706331253051758  GigaBytes
Max Memory Allocated: 12.11612606048584  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.71630859375 GB
    Memory Allocated: 11.69533109664917  GigaBytes
Max Memory Allocated: 12.11612606048584  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.71630859375 GB
    Memory Allocated: 11.69676923751831  GigaBytes
Max Memory Allocated: 12.11612606048584  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.71630859375 GB
    Memory Allocated: 0.37955760955810547  GigaBytes
Max Memory Allocated: 12.11612606048584  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.71630859375 GB
    Memory Allocated: 11.934430599212646  GigaBytes
Max Memory Allocated: 12.128643035888672  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.71630859375 GB
    Memory Allocated: 11.935967922210693  GigaBytes
Max Memory Allocated: 12.128643035888672  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.71630859375 GB
    Memory Allocated: 0.38397884368896484  GigaBytes
Max Memory Allocated: 12.128643035888672  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.84326171875 GB
    Memory Allocated: 11.948629379272461  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.84326171875 GB
    Memory Allocated: 11.950528621673584  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.84326171875 GB
    Memory Allocated: 0.3815464973449707  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.86083984375 GB
    Memory Allocated: 11.408029079437256  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.86083984375 GB
    Memory Allocated: 11.409442901611328  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.86083984375 GB
    Memory Allocated: 0.3854236602783203  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.86083984375 GB
    Memory Allocated: 11.395610332489014  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.86083984375 GB
    Memory Allocated: 11.397024154663086  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.86083984375 GB
    Memory Allocated: 0.3909282684326172  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.87646484375 GB
    Memory Allocated: 11.435412883758545  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.87646484375 GB
    Memory Allocated: 11.436830520629883  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.87646484375 GB
    Memory Allocated: 0.39467954635620117  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.87646484375 GB
    Memory Allocated: 11.382357597351074  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.87646484375 GB
    Memory Allocated: 11.38399362564087  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.87646484375 GB
    Memory Allocated: 0.4082818031311035  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.87646484375 GB
    Memory Allocated: 11.773151874542236  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.87646484375 GB
    Memory Allocated: 11.774662971496582  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.87646484375 GB
    Memory Allocated: 0.40589141845703125  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.88427734375 GB
    Memory Allocated: 11.438472270965576  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.88427734375 GB
    Memory Allocated: 11.44006633758545  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.88427734375 GB
    Memory Allocated: 0.4181065559387207  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.90185546875 GB
    Memory Allocated: 11.883904933929443  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.90185546875 GB
    Memory Allocated: 11.88539743423462  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.90185546875 GB
    Memory Allocated: 0.41583824157714844  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.90185546875 GB
    Memory Allocated: 11.400397777557373  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.90185546875 GB
    Memory Allocated: 11.401826858520508  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.90185546875 GB
    Memory Allocated: 0.42278242111206055  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.90185546875 GB
    Memory Allocated: 11.552903652191162  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.90185546875 GB
    Memory Allocated: 11.554332733154297  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.90185546875 GB
    Memory Allocated: 0.4289522171020508  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.90185546875 GB
    Memory Allocated: 11.561325550079346  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.90185546875 GB
    Memory Allocated: 11.563004493713379  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.90185546875 GB
    Memory Allocated: 0.43903589248657227  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.922755718231201  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.924517631530762  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.4458494186401367  GigaBytes
Max Memory Allocated: 12.142874717712402  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.953425407409668  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.955015182495117  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

number of input  18680148
----------------------------------------after optimizer
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.4645853042602539  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.216553211212158
pure train time :  7.465243101119995
the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 0.568 seconds, peak memory: 45.976 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.976 GB
Metis partitioning: 2.148 seconds, peak memory: 45.976 GB
Split the graph: 0.700 seconds
Construct subgraphs: 0.040 seconds
metis partition ---------------pure dgl.metis_partition spent  3.468463897705078
8283
8027
8276
7979
8359
8056
8402
8027
8101
7991
7972
8282
8084
7955
8436
8330
8007
8207
8414
8356
8126
8146
8363
8392
metis partition time  3.472233533859253
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012205839157104492
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.4869375228881836
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.735369920730591
self.buckets_partition() spend  sec:  3.4992215633392334
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.33152341842651367  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.732254028320312  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.728787899017334  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.32758140563964844  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.416227340698242  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.418080806732178  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.33769893646240234  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.728229522705078  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.729867458343506  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.3387441635131836  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.41936206817627  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.420781135559082  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.3487973213195801  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.810657501220703  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.81221342086792  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.3468303680419922  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.46143102645874  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.462953567504883  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.3595428466796875  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.85372543334961  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.855895042419434  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.3587822914123535  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.450070858001709  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.451793670654297  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.3639402389526367  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.511948108673096  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.513609886169434  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.36655664443969727  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.388082027435303  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.38960313796997  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.3709073066711426  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.362361907958984  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.363862991333008  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.38210535049438477  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.740103244781494  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.74158000946045  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.38350439071655273  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.536557674407959  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.53815746307373  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.38701677322387695  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.370553493499756  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.371986389160156  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.39990997314453125  GigaBytes
Max Memory Allocated: 12.147657871246338  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.971091747283936  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.972640991210938  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.4043135643005371  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.861639976501465  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.86316728591919  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.40250444412231445  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.443518161773682  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.444931983947754  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.4122943878173828  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.724164962768555  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.725884914398193  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.4214615821838379  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.967931747436523  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.96952772140503  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.42604541778564453  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.935457229614258  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.937053203582764  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.425076961517334  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.595057010650635  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 11.596806526184082  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.53662109375 GB
    Memory Allocated: 0.43209171295166016  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.673655986785889  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.675486087799072  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.4405999183654785  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.926830768585205  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.92835807800293  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.44510889053344727  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.967136859893799  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.968664169311523  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

number of input  18674109
----------------------------------------after optimizer
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.4622039794921875  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.474088191986084
pure train time :  4.701179265975952
the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 0.594 seconds, peak memory: 45.976 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.976 GB
Metis partitioning: 2.163 seconds, peak memory: 45.976 GB
Split the graph: 0.549 seconds
Construct subgraphs: 0.028 seconds
metis partition ---------------pure dgl.metis_partition spent  3.346144437789917
8212
8370
8195
8298
8352
8044
8339
7974
8365
8209
8385
8388
7969
7967
8013
7981
8245
7990
8383
7994
8085
8069
8364
8380
metis partition time  3.349515199661255
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011604547500610352
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.3646187782287598
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.590951919555664
self.buckets_partition() spend  sec:  3.3763225078582764
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.32835960388183594  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.617321491241455  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.613607406616211  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.33300256729125977  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.838244438171387  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.839853286743164  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.3366708755493164  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.625319004058838  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.626852035522461  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.3428616523742676  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.747772216796875  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.749238014221191  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.3470759391784668  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.802943706512451  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.804584980010986  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.35001516342163086  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.480371952056885  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.48201322555542  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.3580918312072754  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.77168607711792  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.773456573486328  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.3567380905151367  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.37562608718872  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.377262592315674  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.36967897415161133  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.845940589904785  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.847790718078613  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.37331438064575195  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.708227634429932  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.710075378417969  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.3816971778869629  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.92183542251587  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.92334508895874  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.38767576217651367  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.928091526031494  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.929648876190186  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.3832664489746094  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.390334129333496  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.39176321029663  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.3895087242126465  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.456984043121338  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.4584379196167  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.39223241806030273  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.411097526550293  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.41252088546753  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.39843225479125977  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.440784454345703  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.442356586456299  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.4079399108886719  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.712955474853516  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.715017318725586  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.40668201446533203  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.406197547912598  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.407997131347656  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.4203639030456543  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.915652751922607  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.917336463928223  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.41776084899902344  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.425417423248291  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.427094459533691  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.4253969192504883  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.569664001464844  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.57111406326294  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.4288792610168457  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.550203800201416  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.552147388458252  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.4409666061401367  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.9195876121521  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.921150207519531  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.44577503204345703  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.956374645233154  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.957843780517578  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

number of input  18676643
----------------------------------------after optimizer
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.4629368782043457  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7354297637939453
pure train time :  4.400076627731323
the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 0.478 seconds, peak memory: 45.976 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.976 GB
Metis partitioning: 2.094 seconds, peak memory: 45.976 GB
Split the graph: 1.017 seconds
Construct subgraphs: 0.029 seconds
metis partition ---------------pure dgl.metis_partition spent  3.6251814365386963
8283
8027
8276
7979
8359
8056
8402
8027
8101
7991
7972
8282
8084
7955
8436
8330
8007
8207
8414
8356
8126
8146
8363
8392
metis partition time  3.6286206245422363
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010923385620117188
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.647162914276123
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.91570258140564
self.buckets_partition() spend  sec:  3.6581308841705322
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.3307070732116699  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.703663349151611  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.700227737426758  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.3266782760620117  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.342494010925293  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.343974113464355  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.33754777908325195  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.74191665649414  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.743437767028809  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.3352484703063965  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.346883296966553  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.348323822021484  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.348111629486084  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.808751583099365  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.810390949249268  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.347562313079834  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.445186138153076  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.446678161621094  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.35805559158325195  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.841942310333252  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.843796253204346  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.35647153854370117  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.38168478012085  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.383301734924316  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.3643798828125  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.551369190216064  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.552809715270996  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.3686032295227051  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.456398487091064  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.45781421661377  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.3721151351928711  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.424622058868408  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.426123142242432  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.38204097747802734  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.728193283081055  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.730185508728027  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.3853435516357422  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.54653549194336  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.548445224761963  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.38812828063964844  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.423202991485596  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.424609184265137  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.39998769760131836  GigaBytes
Max Memory Allocated: 12.16616439819336  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.975597381591797  GigaBytes
Max Memory Allocated: 12.170018196105957  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.977392196655273  GigaBytes
Max Memory Allocated: 12.170018196105957  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.40496158599853516  GigaBytes
Max Memory Allocated: 12.170018196105957  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.830407619476318  GigaBytes
Max Memory Allocated: 12.170018196105957  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.83199405670166  GigaBytes
Max Memory Allocated: 12.170018196105957  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.4031991958618164  GigaBytes
Max Memory Allocated: 12.170018196105957  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.445968627929688  GigaBytes
Max Memory Allocated: 12.170018196105957  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.447461128234863  GigaBytes
Max Memory Allocated: 12.170018196105957  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.4129467010498047  GigaBytes
Max Memory Allocated: 12.170018196105957  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.775899887084961  GigaBytes
Max Memory Allocated: 12.170018196105957  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 11.77755069732666  GigaBytes
Max Memory Allocated: 12.170018196105957  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.54833984375 GB
    Memory Allocated: 0.421694278717041  GigaBytes
Max Memory Allocated: 12.170018196105957  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 12.008213520050049  GigaBytes
Max Memory Allocated: 12.20360803604126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 12.00984001159668  GigaBytes
Max Memory Allocated: 12.20360803604126  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.4236159324645996  GigaBytes
Max Memory Allocated: 12.20360803604126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.842122077941895  GigaBytes
Max Memory Allocated: 12.20360803604126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.84386157989502  GigaBytes
Max Memory Allocated: 12.20360803604126  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.4255380630493164  GigaBytes
Max Memory Allocated: 12.20360803604126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.6140775680542  GigaBytes
Max Memory Allocated: 12.20360803604126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.61563777923584  GigaBytes
Max Memory Allocated: 12.20360803604126  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.4319591522216797  GigaBytes
Max Memory Allocated: 12.20360803604126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.67537784576416  GigaBytes
Max Memory Allocated: 12.20360803604126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.6773042678833  GigaBytes
Max Memory Allocated: 12.20360803604126  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.44137096405029297  GigaBytes
Max Memory Allocated: 12.20360803604126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.936930179595947  GigaBytes
Max Memory Allocated: 12.20360803604126  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.938489437103271  GigaBytes
Max Memory Allocated: 12.20360803604126  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.44724512100219727  GigaBytes
Max Memory Allocated: 12.20360803604126  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 12.02085018157959  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 12.02232313156128  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

number of input  18675298
----------------------------------------after optimizer
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.4643239974975586  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.233085870742798
pure train time :  4.381904363632202
the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 0.426 seconds, peak memory: 45.976 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.976 GB
Metis partitioning: 2.003 seconds, peak memory: 45.976 GB
Split the graph: 1.145 seconds
Construct subgraphs: 0.036 seconds
metis partition ---------------pure dgl.metis_partition spent  3.611377000808716
8283
8027
8276
7979
8359
8056
8402
8027
8101
7991
7972
8282
8084
7955
8436
8330
8007
8207
8414
8356
8126
8146
8363
8392
metis partition time  3.615034580230713
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011089324951171875
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.6305947303771973
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.910224199295044
self.buckets_partition() spend  sec:  3.6417272090911865
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.33063173294067383  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.682427883148193  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.679256916046143  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.3283843994140625  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.423948287963867  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.42598819732666  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.3370389938354492  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.718514442443848  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.72044038772583  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.33705568313598633  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.354489803314209  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.355920791625977  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.3488960266113281  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.832064628601074  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.833957195281982  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.34836292266845703  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.479557991027832  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.48142385482788  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.35988807678222656  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.84691333770752  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.848677158355713  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.35899925231933594  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.501884937286377  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.503488540649414  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.36434030532836914  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.54798936843872  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.549481391906738  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.36578845977783203  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.383887767791748  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.385366916656494  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.3723320960998535  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.378586292266846  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.380053520202637  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.38104820251464844  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.75682783126831  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.758295059204102  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.3827686309814453  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.515852451324463  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.51747465133667  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.3884305953979492  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.401196956634521  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.402704238891602  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.40007686614990234  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.944315910339355  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.94649362564087  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.40500688552856445  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.881072998046875  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.882787704467773  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.40347957611083984  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.464263439178467  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.466016292572021  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.4111461639404297  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.702350616455078  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.704285144805908  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.42090749740600586  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.969640254974365  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.97134780883789  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.4258260726928711  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.907463073730469  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.909183025360107  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.42622900009155273  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.605148315429688  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.606804370880127  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.4326448440551758  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.68664264678955  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.688069820404053  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.4414653778076172  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.913955211639404  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.915719509124756  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.4458346366882324  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.957844257354736  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.959653377532959  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

number of input  18677985
----------------------------------------after optimizer
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.4629349708557129  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7786798477172852
pure train time :  4.334448337554932
the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 0.456 seconds, peak memory: 45.976 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.976 GB
Metis partitioning: 2.102 seconds, peak memory: 45.976 GB
Split the graph: 1.020 seconds
Construct subgraphs: 0.029 seconds
metis partition ---------------pure dgl.metis_partition spent  3.60821270942688
8212
8370
8195
8298
8352
8044
8339
7974
8365
8209
8385
8388
7969
7967
8013
7981
8245
7990
8383
7994
8085
8069
8364
8380
metis partition time  3.6117489337921143
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013218879699707031
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.6317636966705322
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.867274761199951
self.buckets_partition() spend  sec:  3.6450297832489014
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.3307161331176758  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.640942573547363  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.637852191925049  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.3347592353820801  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.827647686004639  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.829434394836426  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.33501148223876953  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.632269382476807  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.634382724761963  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.3431510925292969  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.784868717193604  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.786436557769775  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.34898900985717773  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.81465196609497  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.816202163696289  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.3477635383605957  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.444609642028809  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.446159839630127  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.35891151428222656  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.827304363250732  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.8289794921875  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.35668468475341797  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.351674556732178  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.353118896484375  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.3692498207092285  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.84884262084961  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.850460052490234  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.37253236770629883  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.681578636169434  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.683801651000977  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.37963294982910156  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.864560604095459  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.866223812103271  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.3871803283691406  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.965329647064209  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.96698808670044  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.38275909423828125  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.38654375076294  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.38797664642334  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.3861355781555176  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.365741729736328  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.367174625396729  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.3944082260131836  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.429757118225098  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.431605815887451  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.39803552627563477  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.431979656219482  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.433788776397705  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.4080367088317871  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.764670372009277  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.766154766082764  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.40814924240112305  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.448043823242188  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.449767589569092  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.4213547706604004  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.955146312713623  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.956870079040527  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.41884899139404297  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.482784748077393  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.48428201675415  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.42647409439086914  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.61222219467163  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 11.61369514465332  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.19677734375 GB
    Memory Allocated: 0.42861080169677734  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.532795906066895  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.534209251403809  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.4412350654602051  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.93876028060913  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.940787315368652  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.44518327713012695  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.933807849884033  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.93541431427002  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

number of input  18676689
----------------------------------------after optimizer
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.462923526763916  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.553762674331665
pure train time :  4.352722406387329
the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 0.455 seconds, peak memory: 45.976 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.976 GB
Metis partitioning: 2.013 seconds, peak memory: 45.976 GB
Split the graph: 0.903 seconds
Construct subgraphs: 0.035 seconds
metis partition ---------------pure dgl.metis_partition spent  3.408123016357422
8283
8027
8276
7979
8359
8056
8402
8027
8101
7991
7972
8282
8084
7955
8436
8330
8007
8207
8414
8356
8126
8146
8363
8392
metis partition time  3.4115822315216064
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.00936579704284668
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.427898406982422
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.683604001998901
self.buckets_partition() spend  sec:  3.4373130798339844
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.3314533233642578  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.731184959411621  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.727462768554688  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.32652950286865234  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.387962341308594  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.38945722579956  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.3349747657775879  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.641786575317383  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.643263339996338  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.3384394645690918  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.40187931060791  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.403356075286865  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.3487715721130371  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.819554328918457  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.82137155532837  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.3489217758178711  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.485337257385254  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.487113952636719  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.36008214950561523  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.932264804840088  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.933885097503662  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.3582453727722168  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.41951608657837  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.421136379241943  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.3642745018005371  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.505849838256836  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.507524967193604  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.3675522804260254  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.423325538635254  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.42501163482666  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.37233734130859375  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.383881092071533  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.385457038879395  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.38306140899658203  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.831098079681396  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.832557201385498  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.38507938385009766  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.556533813476562  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.558136463165283  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.38623571395874023  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.381196975708008  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.382742404937744  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.40134143829345703  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.984829425811768  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.986361980438232  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.4051685333251953  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.868449211120605  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.869960308074951  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.401212215423584  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.428446292877197  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.43018388748169  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.41275978088378906  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.709174633026123  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.711560726165771  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.421785831451416  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.990665912628174  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.992403984069824  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.4242839813232422  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.879539489746094  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.881138324737549  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.4263420104980469  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.59946346282959  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.601062297821045  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.4321441650390625  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.659883499145508  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.66133975982666  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.44156455993652344  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.933557510375977  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.935118198394775  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.4463987350463867  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 12.017998218536377  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 12.019678115844727  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

number of input  18682720
----------------------------------------after optimizer
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.46370363235473633  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3953059911727905
pure train time :  4.371600389480591
the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 0.473 seconds, peak memory: 45.976 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.976 GB
Metis partitioning: 2.012 seconds, peak memory: 45.976 GB
Split the graph: 0.579 seconds
Construct subgraphs: 0.039 seconds
metis partition ---------------pure dgl.metis_partition spent  3.1042697429656982
8283
8027
8276
7979
8359
8056
8402
8027
8101
7991
7972
8282
8084
7955
8436
8330
8007
8207
8414
8356
8126
8146
8363
8392
metis partition time  3.1079330444335938
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01074838638305664
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1244049072265625
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.388381004333496
self.buckets_partition() spend  sec:  3.1353328227996826
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.331662654876709  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.716300010681152  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.712708473205566  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.32788944244384766  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.443511486053467  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.445164203643799  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.3368239402770996  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.727842330932617  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.72948169708252  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.33665037155151367  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.372677326202393  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.374463081359863  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.34867095947265625  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.814250946044922  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.815716743469238  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.3470182418823242  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.41559362411499  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.417059421539307  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.36077404022216797  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.919301986694336  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.920873641967773  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.35945749282836914  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.475664138793945  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.477392196655273  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.3655366897583008  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.559296607971191  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.560919284820557  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.3673281669616699  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.408703804016113  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.41025447845459  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.37288427352905273  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.413939476013184  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.415364742279053  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.382138729095459  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.771388053894043  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.773115158081055  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.38332462310791016  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.531428813934326  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.53284502029419  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.38646602630615234  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.377704620361328  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.379152774810791  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.3998584747314453  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.965730667114258  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.967613220214844  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.4046163558959961  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.893590927124023  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.895346641540527  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.4025554656982422  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.455154418945312  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.45691728591919  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.41274452209472656  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.711932182312012  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.713817119598389  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.4226412773132324  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.99011516571045  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.99175500869751  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.4242739677429199  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.884923458099365  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.886536121368408  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.42380809783935547  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.576741695404053  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.578345775604248  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.4313797950744629  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.64478874206543  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.646356105804443  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.44153356552124023  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.959720611572266  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 11.961244583129883  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.20654296875 GB
    Memory Allocated: 0.44479846954345703  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.91554594039917  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.917033195495605  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

number of input  18675521
----------------------------------------after optimizer
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.4618682861328125  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2748852968215942
pure train time :  4.548904180526733
the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 0.538 seconds, peak memory: 45.976 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.976 GB
Metis partitioning: 1.973 seconds, peak memory: 45.976 GB
Split the graph: 0.507 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  3.068310260772705
8212
8370
8195
8298
8352
8044
8339
7974
8365
8209
8385
8388
7969
7967
8013
7981
8245
7990
8383
7994
8085
8069
8364
8380
metis partition time  3.071951389312744
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01003575325012207
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.0875205993652344
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.374433755874634
self.buckets_partition() spend  sec:  3.097599744796753
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.33057308197021484  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.638720512390137  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.634989261627197  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.3355884552001953  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.860995769500732  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.862898349761963  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.3352022171020508  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.631608009338379  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.633955478668213  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.34216737747192383  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.72781229019165  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.729481220245361  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.3479909896850586  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.816747188568115  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.818233013153076  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.34798765182495117  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.482000350952148  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.48348617553711  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.3579716682434082  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.774205684661865  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.775966167449951  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.35669708251953125  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.348525524139404  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.34998893737793  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.3706779479980469  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.884395599365234  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.885945796966553  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.370419979095459  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.632022857666016  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.633530139923096  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.3810596466064453  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.914243698120117  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.915861129760742  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.3857135772705078  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.875473976135254  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.877259731292725  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.38285255432128906  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.403918266296387  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.405370235443115  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.38707923889160156  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.403852939605713  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.405523300170898  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.3936014175415039  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.446825981140137  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.448289394378662  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.3989710807800293  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.453242778778076  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.454697608947754  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.4082317352294922  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.754193305969238  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.755860805511475  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.4068470001220703  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.405900955200195  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.407360553741455  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.4188261032104492  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.880609035491943  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.882134914398193  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.41799259185791016  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.470296859741211  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.471822738647461  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.42531442642211914  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.532364845275879  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.533781051635742  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.43152761459350586  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.572882652282715  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.574543952941895  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.4417233467102051  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.917143821716309  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.918750762939453  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.4460134506225586  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.932572841644287  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.934256553649902  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

number of input  18670475
----------------------------------------after optimizer
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.4631819725036621  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1779870986938477
pure train time :  4.368440628051758
the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 0.449 seconds, peak memory: 45.976 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.976 GB
Metis partitioning: 2.030 seconds, peak memory: 45.976 GB
Split the graph: 0.475 seconds
Construct subgraphs: 0.032 seconds
metis partition ---------------pure dgl.metis_partition spent  2.9925332069396973
8283
8027
8276
7979
8359
8056
8402
8027
8101
7991
7972
8282
8084
7955
8436
8330
8007
8207
8414
8356
8126
8146
8363
8392
metis partition time  2.9961843490600586
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011624813079833984
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.0122721195220947
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.27254056930542
self.buckets_partition() spend  sec:  3.023942708969116
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.33089685440063477  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.681068420410156  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.677608966827393  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.3268575668334961  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.38181734085083  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.383523941040039  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.33732175827026367  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.717278957366943  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.718947887420654  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.3368406295776367  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.367040157318115  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.368438720703125  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.34898996353149414  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.831662654876709  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.8334321975708  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.34748411178588867  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.416272163391113  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.41784143447876  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.3596615791320801  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.894535541534424  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.896400451660156  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.35773134231567383  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.42107105255127  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.422794818878174  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.3649301528930664  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.553442478179932  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.55509090423584  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.36807870864868164  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.428976058959961  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.430595397949219  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.37334156036376953  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.419252395629883  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.420654773712158  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.38199615478515625  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.70647144317627  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.708641052246094  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.38217973709106445  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.470633506774902  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.472501754760742  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.387662410736084  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.383986473083496  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 11.385488033294678  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.21240234375 GB
    Memory Allocated: 0.40216922760009766  GigaBytes
Max Memory Allocated: 12.215405464172363  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 12.040022850036621  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 12.042333602905273  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4039134979248047  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.867199897766113  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.868709564208984  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4031791687011719  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.467324256896973  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.468986988067627  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.41171693801879883  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.722804069519043  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.724602222442627  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4232907295227051  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 12.01409387588501  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 12.015793323516846  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.42520999908447266  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.887660503387451  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.88918399810791  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.42588281631469727  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.604553699493408  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.606077194213867  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4310903549194336  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.643239498138428  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.644700050354004  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.44139814376831055  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.940315246582031  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.94194507598877  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4467740058898926  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 12.004261493682861  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 12.005831241607666  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

number of input  18682943
----------------------------------------after optimizer
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.46398401260375977  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0851573944091797
pure train time :  4.376414775848389
the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 0.507 seconds, peak memory: 45.976 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.976 GB
Metis partitioning: 2.028 seconds, peak memory: 45.976 GB
Split the graph: 1.013 seconds
Construct subgraphs: 0.039 seconds
metis partition ---------------pure dgl.metis_partition spent  3.6012628078460693
8283
8027
8276
7979
8359
8056
8402
8027
8101
7991
7972
8282
8084
7955
8436
8330
8007
8207
8414
8356
8126
8146
8363
8392
metis partition time  3.6047654151916504
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01027822494506836
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.621746301651001
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.900227308273315
self.buckets_partition() spend  sec:  3.6320714950561523
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3308539390563965  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.704233646392822  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.700675964355469  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.32719993591308594  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.406336307525635  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.407790660858154  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3355293273925781  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.712142944335938  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.713597297668457  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.33637046813964844  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.372822761535645  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.374244213104248  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3485422134399414  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.81401538848877  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.815510749816895  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.34731626510620117  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.465545654296875  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.467628002166748  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3607668876647949  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.882925033569336  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.88462781906128  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.35677433013916016  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.40140676498413  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.40296983718872  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3644685745239258  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.514289855957031  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.516162395477295  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.367189884185791  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.41512155532837  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.41695499420166  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.371762752532959  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.387579917907715  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.389232158660889  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.38206052780151367  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.724920272827148  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.727115154266357  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3852872848510742  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.555386066436768  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.557375431060791  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3869166374206543  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.371606349945068  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.373104095458984  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4017033576965332  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.994488716125488  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.995986461639404  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4052004814147949  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.869379997253418  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.870938301086426  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.40245580673217773  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.467842102050781  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.469330787658691  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.412078857421875  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.70894718170166  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.710419178009033  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.42062950134277344  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.941449642181396  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.943309307098389  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.42569684982299805  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.908098220825195  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.909906387329102  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4264521598815918  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.611868858337402  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.613543033599854  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4306473731994629  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.646199226379395  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.64763355255127  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.44043779373168945  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.86246395111084  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.864029884338379  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.44747400283813477  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 12.00846815109253  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 12.01023244857788  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

number of input  18668782
----------------------------------------after optimizer
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.46439266204833984  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.006587028503418
pure train time :  4.3462207317352295
the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 0.476 seconds, peak memory: 45.976 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.976 GB
Metis partitioning: 1.993 seconds, peak memory: 45.976 GB
Split the graph: 0.509 seconds
Construct subgraphs: 0.026 seconds
metis partition ---------------pure dgl.metis_partition spent  3.0058021545410156
8283
8027
8276
7979
8359
8056
8402
8027
8101
7991
7972
8282
8084
7955
8436
8330
8007
8207
8414
8356
8126
8146
8363
8392
metis partition time  3.0093259811401367
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010046958923339844
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.024704694747925
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.282538652420044
self.buckets_partition() spend  sec:  3.034806489944458
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3307042121887207  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.660536766052246  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.656867504119873  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.32862424850463867  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.43592357635498  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.438077926635742  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3378171920776367  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.74729061126709  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.748868942260742  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3357710838317871  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.362983226776123  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.364721775054932  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3476719856262207  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.766511917114258  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.7682785987854  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.34790897369384766  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.472425937652588  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.47419261932373  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3593716621398926  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.880401611328125  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.882030010223389  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.35702085494995117  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.404473304748535  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.405989170074463  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.36263465881347656  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.492348670959473  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.4938645362854  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3674192428588867  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.421179294586182  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.422800540924072  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3724374771118164  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.40993070602417  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.411357879638672  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3840303421020508  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.788227558135986  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.789679527282715  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.38399314880371094  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.52399206161499  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.52584457397461  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.38738489151000977  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.370206356048584  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.371679306030273  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.40161705017089844  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 12.024195194244385  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 12.025883197784424  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.40342044830322266  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.852815628051758  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.854461193084717  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.40272092819213867  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.448962211608887  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.450388431549072  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4111928939819336  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.697856426239014  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.699430465698242  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4216599464416504  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.993994235992432  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.995535373687744  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4249305725097656  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.88538646697998  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.886941909790039  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.42676782608032227  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.67689561843872  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.678439617156982  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.43126583099365234  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.658010005950928  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.65944766998291  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4422764778137207  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.951955795288086  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.953579902648926  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4472179412841797  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.963411331176758  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.964996337890625  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

number of input  18675175
----------------------------------------after optimizer
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4645519256591797  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9598869681358337
pure train time :  4.440322637557983
the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 0.459 seconds, peak memory: 45.976 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.976 GB
Metis partitioning: 1.964 seconds, peak memory: 45.976 GB
Split the graph: 1.120 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  3.5895767211914062
8283
8027
8276
7979
8359
8056
8402
8027
8101
7991
7972
8282
8084
7955
8436
8330
8007
8207
8414
8356
8126
8146
8363
8392
metis partition time  3.5930869579315186
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009538412094116211
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.6081838607788086
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.864558219909668
self.buckets_partition() spend  sec:  3.6178693771362305
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.33164262771606445  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.729950904846191  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.726324558258057  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3274693489074707  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.41357946395874  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.415421485900879  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.33651208877563477  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.714234352111816  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.715955257415771  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3375868797302246  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.373230457305908  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.374963760375977  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.348268985748291  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.828288078308105  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.829843044281006  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.34878110885620117  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.480236530303955  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.481904029846191  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3615531921386719  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.929506301879883  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.931042194366455  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3587765693664551  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.444973945617676  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.44670820236206  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3651461601257324  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.52291202545166  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.525104999542236  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.36768007278442383  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.421979427337646  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.423458099365234  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3698387145996094  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.354171752929688  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.35560655593872  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.384366512298584  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.80871295928955  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.810379981994629  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3830556869506836  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.504057884216309  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.505636215209961  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3859872817993164  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.364567279815674  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.366233825683594  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.40195465087890625  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.9976224899292  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.999169826507568  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.40468740463256836  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.858386516571045  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.859923362731934  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4024205207824707  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.446194648742676  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.447606563568115  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.41055774688720703  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.71495532989502  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.717310905456543  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.42198801040649414  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 12.009750366210938  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 12.012045860290527  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4256114959716797  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.906224727630615  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.907779216766357  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.424713134765625  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.594866752624512  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.59635066986084  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4307875633239746  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.672486305236816  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.674115180969238  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.44148826599121094  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.925026893615723  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.926788330078125  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.44637441635131836  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.9504714012146  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.95211124420166  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

number of input  18677697
----------------------------------------after optimizer
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4634528160095215  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9114402532577515
pure train time :  4.420083284378052
the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 0.430 seconds, peak memory: 45.976 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.976 GB
Metis partitioning: 1.992 seconds, peak memory: 45.976 GB
Split the graph: 0.726 seconds
Construct subgraphs: 0.028 seconds
metis partition ---------------pure dgl.metis_partition spent  3.184129476547241
8212
8370
8195
8298
8352
8044
8339
7974
8365
8209
8385
8388
7969
7967
8013
7981
8245
7990
8383
7994
8085
8069
8364
8380
metis partition time  3.187772274017334
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010680437088012695
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.203172445297241
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.461908578872681
self.buckets_partition() spend  sec:  3.2138962745666504
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.33057117462158203  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.63260555267334  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.628869533538818  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.33353376388549805  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.804503440856934  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.805996894836426  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.33658552169799805  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.623100757598877  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.62459421157837  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.34274816513061523  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.75450611114502  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.755980491638184  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3494749069213867  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.825265884399414  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.826740264892578  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3467535972595215  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.412739276885986  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.414299964904785  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3586134910583496  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.826319694519043  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.828169345855713  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.35767126083374023  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.384817600250244  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.386565685272217  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.36778736114501953  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.794668674468994  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.796387195587158  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.37265729904174805  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.666645526885986  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.668292045593262  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.38123273849487305  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.869460105895996  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.87111520767212  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.38541412353515625  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.927136421203613  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.928799152374268  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3826737403869629  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.386789798736572  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.388529777526855  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3872971534729004  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.418696403503418  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.420135021209717  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3937668800354004  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.44442081451416  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.446111679077148  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.39793872833251953  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.44057035446167  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.441991806030273  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4081912040710449  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.766775131225586  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.76856517791748  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4075469970703125  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.431706428527832  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.433679103851318  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4218111038208008  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.952312469482422  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.95419454574585  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4185500144958496  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.421829223632812  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.423256397247314  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4244394302368164  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.559744834899902  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.561424732208252  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.42920541763305664  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.554948806762695  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.556562900543213  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4400444030761719  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.934035778045654  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.935554504394531  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4471931457519531  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.962950229644775  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.964438438415527  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

number of input  18673262
----------------------------------------after optimizer
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.46441030502319336  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8763407468795776
pure train time :  4.427783966064453
the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 0.408 seconds, peak memory: 45.976 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.976 GB
Metis partitioning: 2.018 seconds, peak memory: 45.976 GB
Split the graph: 0.651 seconds
Construct subgraphs: 0.036 seconds
metis partition ---------------pure dgl.metis_partition spent  3.114673137664795
8283
8027
8276
7979
8359
8056
8402
8027
8101
7991
7972
8282
8084
7955
8436
8330
8007
8207
8414
8356
8126
8146
8363
8392
metis partition time  3.118250608444214
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011016130447387695
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.134732961654663
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.4104297161102295
self.buckets_partition() spend  sec:  3.145796060562134
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3321852684020996  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.712575435638428  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.708963394165039  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3275566101074219  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.426755905151367  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.428589344024658  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3366060256958008  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.693556785583496  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.695416927337646  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.33623790740966797  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.344035625457764  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.34548568725586  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3497943878173828  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.850536346435547  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.852195262908936  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3485431671142578  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.502177715301514  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.503715515136719  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.35888099670410156  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.83134412765503  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.832821369171143  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.35648012161254883  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.415236949920654  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.416714191436768  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.36565256118774414  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.587966442108154  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.589555740356445  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3669109344482422  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.369785785675049  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.371275901794434  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3710598945617676  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.386857032775879  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.388270854949951  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.38203859329223633  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.732056617736816  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.73413610458374  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.38512182235717773  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.538928031921387  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.540851593017578  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.38671064376831055  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.374850273132324  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.376332759857178  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.39969682693481445  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.972353458404541  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.974130630493164  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.40436458587646484  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.86187744140625  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.863409042358398  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4046964645385742  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.462217807769775  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.463841915130615  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4131026268005371  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.734442234039307  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.73656415939331  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4201393127441406  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.959184646606445  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.961036682128906  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.42395830154418945  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.859403610229492  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.860928058624268  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4268355369567871  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.612566947937012  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.614047527313232  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4309697151184082  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.629463195800781  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.630920886993408  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.44114065170288086  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.956329345703125  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.958033084869385  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.44627904891967773  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.964826107025146  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.966392993927002  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

number of input  18676760
----------------------------------------after optimizer
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4634227752685547  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8322250247001648
pure train time :  4.58779764175415
the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 0.436 seconds, peak memory: 45.976 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.976 GB
Metis partitioning: 1.998 seconds, peak memory: 45.976 GB
Split the graph: 0.808 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  3.287010431289673
8283
8027
8276
7979
8359
8056
8402
8027
8101
7991
7972
8282
8084
7955
8436
8330
8007
8207
8414
8356
8126
8146
8363
8392
metis partition time  3.290724515914917
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009039163589477539
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.3064770698547363
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.649648189544678
self.buckets_partition() spend  sec:  3.315561294555664
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.33076953887939453  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.692464351654053  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.68925142288208  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.32633447647094727  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.387412548065186  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.389066219329834  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3365945816040039  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.68842363357544  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.690496921539307  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.33673667907714844  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.34612512588501  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.347578048706055  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.34777164459228516  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.818606853485107  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.820335865020752  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3477797508239746  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.462048530578613  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.464210510253906  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.35869932174682617  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.85625410079956  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.85804557800293  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.35744714736938477  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.396946430206299  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.398385047912598  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.363706111907959  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.557056903839111  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.55849552154541  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3678312301635742  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.421320915222168  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.42288589477539  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3719964027404785  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.38659381866455  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.388062477111816  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.38214921951293945  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.7354416847229  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.737010955810547  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.38564395904541016  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.563477039337158  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.565219402313232  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3867955207824707  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.400195598602295  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.401655197143555  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3988065719604492  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.901692867279053  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.903340339660645  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.40516042709350586  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.87593126296997  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.877480506896973  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.40517139434814453  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.496285915374756  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.498498439788818  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.41204261779785156  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.708028793334961  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.710056781768799  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.42110109329223633  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.993023872375488  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.99473524093628  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.425600528717041  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.9014253616333  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.903294086456299  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.42564868927001953  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.598426342010498  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.600143909454346  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.43062305450439453  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.670186519622803  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.671613693237305  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4411044120788574  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.932479858398438  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.934597969055176  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4450798034667969  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.948602199554443  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.950868606567383  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

number of input  18661965
----------------------------------------after optimizer
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.462313175201416  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7963627576828003
pure train time :  4.486811637878418
the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 0.495 seconds, peak memory: 45.976 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.976 GB
Metis partitioning: 1.951 seconds, peak memory: 45.976 GB
Split the graph: 0.565 seconds
Construct subgraphs: 0.028 seconds
metis partition ---------------pure dgl.metis_partition spent  3.0523788928985596
8283
8027
8276
7979
8359
8056
8402
8027
8101
7991
7972
8282
8084
7955
8436
8330
8007
8207
8414
8356
8126
8146
8363
8392
metis partition time  3.0559005737304688
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009765386581420898
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.0709750652313232
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.327217102050781
self.buckets_partition() spend  sec:  3.0807883739471436
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.33234548568725586  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.725344181060791  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.721810817718506  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.32735443115234375  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.421266078948975  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.422672271728516  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3375992774963379  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.716614723205566  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.718118667602539  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3357539176940918  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.332247734069824  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.33371877670288  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.34821176528930664  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.8219575881958  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.823421955108643  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.348020076751709  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.478164196014404  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.480104923248291  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3600645065307617  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.872021675109863  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.873677253723145  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.35893821716308594  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.447703838348389  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.449440002441406  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.364654541015625  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.534409999847412  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.536103248596191  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3672218322753906  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.40954065322876  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.4109787940979  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.37203550338745117  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.386457920074463  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.38786792755127  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.38440561294555664  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.787033557891846  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.788653373718262  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.38277578353881836  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.475638389587402  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.477388858795166  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.38548803329467773  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.362681865692139  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.364160537719727  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.39974403381347656  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.96269178390503  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.964170455932617  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.403963565826416  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.868313789367676  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.869810104370117  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.40285396575927734  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.447578430175781  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.448997974395752  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.41162824630737305  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.700552940368652  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.701990604400635  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4223356246948242  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.965933322906494  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.967788219451904  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.42384767532348633  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.884454727172852  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.88604736328125  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.42600488662719727  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.65563440322876  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.657192707061768  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4317145347595215  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.66763973236084  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.66907024383545  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4410696029663086  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.919770240783691  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.921379566192627  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.44596338272094727  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.958664417266846  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.960146427154541  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

number of input  18677366
----------------------------------------after optimizer
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4631528854370117  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7609863877296448
pure train time :  4.53857946395874
the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 0.477 seconds, peak memory: 45.976 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.976 GB
Metis partitioning: 1.960 seconds, peak memory: 45.976 GB
Split the graph: 0.911 seconds
Construct subgraphs: 0.043 seconds
metis partition ---------------pure dgl.metis_partition spent  3.397096872329712
8283
8027
8276
7979
8359
8056
8402
8027
8101
7991
7972
8282
8084
7955
8436
8330
8007
8207
8414
8356
8126
8146
8363
8392
metis partition time  3.4015772342681885
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011673212051391602
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.4186227321624756
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.69022536277771
self.buckets_partition() spend  sec:  3.430345296859741
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3321371078491211  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.746218204498291  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.742710590362549  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3275322914123535  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.422443389892578  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.424052715301514  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.33598756790161133  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.708069801330566  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.70973014831543  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3362903594970703  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.322670936584473  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.324214458465576  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3492741584777832  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.876803398132324  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.878699779510498  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3500990867614746  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.486138343811035  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.487748146057129  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3590850830078125  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.863155364990234  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.864833354949951  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.35697174072265625  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.388808727264404  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.390521049499512  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.36467695236206055  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.54377031326294  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.545355796813965  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.36713457107543945  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.370384693145752  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.371817588806152  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3715324401855469  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.38568639755249  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.387292861938477  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.38218021392822266  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.773358821868896  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.774967670440674  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3843040466308594  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.519454002380371  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.52096939086914  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.38695383071899414  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.383069515228271  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.384531497955322  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.40018701553344727  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.944329738616943  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.945897102355957  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4033489227294922  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.853720664978027  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.855352401733398  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4018683433532715  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.443397998809814  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.445029735565186  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4130110740661621  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.74201488494873  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.743688583374023  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4198427200317383  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.930991172790527  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.933097839355469  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.42591333389282227  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.902003765106201  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.903597354888916  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4263033866882324  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.628713607788086  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.630241394042969  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.43155431747436523  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.651463985443115  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.652918815612793  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4411921501159668  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.934706687927246  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.936563491821289  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4457979202270508  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.963681697845459  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.965968608856201  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

number of input  18673027
----------------------------------------after optimizer
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.46282339096069336  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7282338738441467
pure train time :  4.63713526725769
the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 0.483 seconds, peak memory: 45.976 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.976 GB
Metis partitioning: 1.988 seconds, peak memory: 45.976 GB
Split the graph: 1.011 seconds
Construct subgraphs: 0.029 seconds
metis partition ---------------pure dgl.metis_partition spent  3.5237083435058594
8283
8027
8276
7979
8359
8056
8402
8027
8101
7991
7972
8282
8084
7955
8436
8330
8007
8207
8414
8356
8126
8146
8363
8392
metis partition time  3.5274040699005127
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010484695434570312
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.5434021949768066
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.809364080429077
self.buckets_partition() spend  sec:  3.5539324283599854
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3308396339416504  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.71041202545166  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.7070894241333  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.32548999786376953  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.349884510040283  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.351662635803223  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3379487991333008  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.723583698272705  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.725322246551514  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.33756113052368164  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.387404918670654  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.388952255249023  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.34890079498291016  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.812492370605469  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.814011096954346  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3488163948059082  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.485390186309814  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.486908912658691  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.35989904403686523  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.845839500427246  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.84731149673462  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3589930534362793  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.467648983001709  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.469323635101318  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3644065856933594  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.500772476196289  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.502596378326416  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3677077293395996  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.392714500427246  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.394176006317139  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.37138843536376953  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.399742126464844  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.40138053894043  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3822908401489258  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.767839431762695  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.769300937652588  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.38487911224365234  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.55201530456543  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.553476810455322  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.384188175201416  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.366204738616943  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.367624282836914  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4005608558654785  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.990248203277588  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.992136001586914  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4040203094482422  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.856668949127197  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.858205795288086  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.40229177474975586  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.455143928527832  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.456652164459229  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4120650291442871  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.725263118743896  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.727142333984375  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4214787483215332  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.996118068695068  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.997828006744385  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.42609691619873047  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.919433116912842  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.921143054962158  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.42565059661865234  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.611845016479492  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.613531112670898  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.43048858642578125  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.61708116531372  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.618609428405762  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4405655860900879  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.91759204864502  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.919292449951172  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4461030960083008  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.962440490722656  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.963963508605957  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

number of input  18673792
----------------------------------------after optimizer
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4631800651550293  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6991756558418274
pure train time :  4.409627676010132
the output layer 
self.num_batch (get_in_degree_bucketing) 24
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  24
Convert a graph into a bidirected graph: 0.434 seconds, peak memory: 45.976 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.976 GB
Metis partitioning: 2.002 seconds, peak memory: 45.976 GB
Split the graph: 0.748 seconds
Construct subgraphs: 0.030 seconds
metis partition ---------------pure dgl.metis_partition spent  3.2201955318450928
8212
8370
8195
8298
8352
8044
8339
7974
8365
8209
8385
8388
7969
7967
8013
7981
8245
7990
8383
7994
8085
8069
8364
8380
metis partition time  3.2237401008605957
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.00898122787475586
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.2404985427856445
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.477468013763428
self.buckets_partition() spend  sec:  3.249525308609009
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3307356834411621  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.631627559661865  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.627897262573242  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3341054916381836  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.821444511413574  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.823147296905518  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.336728572845459  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.626957416534424  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.628592491149902  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.34374475479125977  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.751920700073242  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.75345754623413  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3488731384277344  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.810075759887695  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.811635494232178  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.34989309310913086  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.486685276031494  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.488234043121338  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.35809898376464844  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.813750267028809  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.815319061279297  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3588285446166992  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.429813385009766  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.431211948394775  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3697657585144043  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.855664253234863  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.857388019561768  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3731198310852051  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.683467388153076  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.685240745544434  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.38035154342651367  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.856184959411621  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.858024597167969  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3846430778503418  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.891451358795166  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.893560409545898  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3826894760131836  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.413750171661377  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.415177345275879  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.38657331466674805  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.401905059814453  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.403332233428955  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3938412666320801  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.463480472564697  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.464969158172607  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.3974156379699707  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.462588787078857  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.464074611663818  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.40818023681640625  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.732256412506104  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.734028339385986  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4083390235900879  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.43467664718628  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.43612289428711  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.41976356506347656  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.886934757232666  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.888745784759521  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4187932014465332  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.45407485961914  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.455732345581055  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.42464351654052734  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.578145980834961  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.579787731170654  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4293675422668457  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.517058849334717  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.518657684326172  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.4386463165283203  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.861599445343018  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.86309003829956  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.44553232192993164  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.953567028045654  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 11.955083847045898  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

number of input  18674981
----------------------------------------after optimizer
 Nvidia-smi: 14.86279296875 GB
    Memory Allocated: 0.46266984939575195  GigaBytes
Max Memory Allocated: 12.235315322875977  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6717221736907959
pure train time :  4.430038213729858
epoch_time_list  [32.863882541656494, 30.676581382751465, 27.996854543685913, 29.15969467163086, 28.003392934799194, 29.38740038871765, 28.52643132209778, 27.664268255233765, 28.629895210266113, 27.291390419006348, 28.64461660385132, 27.980720281600952, 28.055296182632446, 27.92936420440674, 28.041377067565918, 28.425945281982422, 28.356070280075073, 28.367011785507202, 28.231869220733643, 28.59380030632019]

loading_time list   [0.5408718585968018, 0.6084425449371338, 0.5623674392700195, 0.46573734283447266, 0.41977858543395996, 0.5199155807495117, 0.3817908763885498, 0.3971128463745117, 0.47810959815979004, 0.45119810104370117, 0.4534182548522949, 0.4597327709197998, 0.386228084564209, 0.45070719718933105, 0.4810974597930908, 0.3818633556365967, 0.42871809005737305, 0.4382820129394531, 0.46665430068969727, 0.4607830047607422]

 data loader gen time  19.628406047821045
	---backpack schedule time  [8.400993347167969, 7.805278062820435, 7.675777912139893, 7.993960380554199, 7.977705955505371, 7.95098876953125, 7.76291036605835, 7.446575403213501, 7.453007459640503, 7.353754758834839, 7.979089021682739, 7.338794946670532, 7.944843053817749, 7.523313999176025, 7.472524642944336, 7.722432374954224, 7.394282579421997, 7.742884635925293, 7.871216535568237, 7.554734706878662]
	---connection_check_time_list  [7.226930856704712, 8.21142053604126, 6.204527378082275, 7.047412872314453, 6.24747371673584, 7.106937885284424, 6.608365058898926, 6.246660232543945, 6.893445730209351, 6.188377380371094, 6.517273187637329, 6.755422115325928, 6.296184539794922, 6.31672739982605, 6.324329614639282, 6.8870086669921875, 6.474357843399048, 6.392713785171509, 6.3376898765563965, 6.921625375747681]
	---block_gen_time_list  [4.5093865394592285, 4.652192115783691, 4.56933331489563, 4.6507322788238525, 4.348440408706665, 4.823184251785278, 4.81706976890564, 4.47871994972229, 4.698636293411255, 4.291304111480713, 4.733773469924927, 4.349343538284302, 4.326219797134399, 4.513140678405762, 4.548436164855957, 4.278902053833008, 4.836131572723389, 4.541290283203125, 4.504217863082886, 4.570213794708252]
training time  [11.572480201721191, 8.753664493560791, 8.358415126800537, 8.367776155471802, 8.394766330718994, 8.349794626235962, 8.342859268188477, 8.47614073753357, 8.468536138534546, 8.393124341964722, 8.325748443603516, 8.461705207824707, 8.481731414794922, 8.502066612243652, 8.59256649017334, 8.530765771865845, 8.605904817581177, 8.631748676300049, 8.41994571685791, 8.474184036254883]
---feature block loading time  [4.077579021453857, 3.9673070907592773, 3.8763043880462646, 3.902937173843384, 3.975421190261841, 3.913994312286377, 3.8857696056365967, 3.843247652053833, 4.015418291091919, 3.932612419128418, 3.8958981037139893, 3.9358041286468506, 3.9785702228546143, 3.9905447959899902, 3.921058416366577, 3.9629194736480713, 3.9816882610321045, 3.9096076488494873, 3.9278852939605713, 3.960674285888672]


epoch_time avg   28.258053109049797
loading_time avg   0.44096188247203827
 data loader gen time avg 19.320918947458267
	---backpack schedule time avg 7.6555662006139755
	---connection_check_time avg  6.5321620255708694
	---block_gen_time avg  4.54118900001049
training time  8.465724289417267
---feature block loading time  3.9394446313381195
pure train time per /epoch  [7.465243101119995, 4.701179265975952, 4.400076627731323, 4.381904363632202, 4.334448337554932, 4.352722406387329, 4.371600389480591, 4.548904180526733, 4.368440628051758, 4.376414775848389, 4.3462207317352295, 4.440322637557983, 4.420083284378052, 4.427783966064453, 4.58779764175415, 4.486811637878418, 4.53857946395874, 4.63713526725769, 4.409627676010132, 4.430038213729858]
pure train time average  4.438755035400391
num_input list  [18680148, 18674109, 18676643, 18675298, 18677985, 18676689, 18682720, 18675521, 18670475, 18682943, 18668782, 18675175, 18677697, 18673262, 18676760, 18661965, 18677366, 18673027, 18673792, 18674981]
num_input  average  18675266.9
