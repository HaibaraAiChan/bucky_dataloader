main start at this time 1713149427.7854214
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 1.257 seconds, peak memory: 19.344 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 19.344 GB
Metis partitioning: 2.012 seconds, peak memory: 19.632 GB
Split the graph: 1.127 seconds
Construct subgraphs: 0.026 seconds
metis partition ---------------pure dgl.metis_partition spent  4.434123992919922
13969
13997
14316
14280
13708
14426
13764
13853
14417
13778
14079
13753
13895
14336
metis partition time  4.43859076499939
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01118779182434082
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.452723264694214
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.937148809432983
self.buckets_partition() spend  sec:  4.463949203491211
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.92919921875 GB
    Memory Allocated: 0.39097070693969727  GigaBytes
Max Memory Allocated: 0.39097070693969727  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.99365234375 GB
    Memory Allocated: 18.07656240463257  GigaBytes
Max Memory Allocated: 18.395854949951172  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.99365234375 GB
    Memory Allocated: 18.079233169555664  GigaBytes
Max Memory Allocated: 18.395854949951172  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.00146484375 GB
    Memory Allocated: 0.4237051010131836  GigaBytes
Max Memory Allocated: 18.395854949951172  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.21435546875 GB
    Memory Allocated: 18.200464725494385  GigaBytes
Max Memory Allocated: 18.523236751556396  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.21435546875 GB
    Memory Allocated: 18.203580856323242  GigaBytes
Max Memory Allocated: 18.523236751556396  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.21435546875 GB
    Memory Allocated: 0.43487119674682617  GigaBytes
Max Memory Allocated: 18.523236751556396  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.51318359375 GB
    Memory Allocated: 18.498496532440186  GigaBytes
Max Memory Allocated: 18.83006238937378  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.51318359375 GB
    Memory Allocated: 18.501003742218018  GigaBytes
Max Memory Allocated: 18.83006238937378  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.51318359375 GB
    Memory Allocated: 0.44443273544311523  GigaBytes
Max Memory Allocated: 18.83006238937378  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.51318359375 GB
    Memory Allocated: 18.440006256103516  GigaBytes
Max Memory Allocated: 18.83006238937378  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.51318359375 GB
    Memory Allocated: 18.442670345306396  GigaBytes
Max Memory Allocated: 18.83006238937378  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.51318359375 GB
    Memory Allocated: 0.44764089584350586  GigaBytes
Max Memory Allocated: 18.83006238937378  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.51318359375 GB
    Memory Allocated: 17.88324213027954  GigaBytes
Max Memory Allocated: 18.83006238937378  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.51318359375 GB
    Memory Allocated: 17.886535167694092  GigaBytes
Max Memory Allocated: 18.83006238937378  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.51318359375 GB
    Memory Allocated: 0.46979522705078125  GigaBytes
Max Memory Allocated: 18.83006238937378  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.02294921875 GB
    Memory Allocated: 18.69686269760132  GigaBytes
Max Memory Allocated: 19.030527114868164  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.02294921875 GB
    Memory Allocated: 18.700084686279297  GigaBytes
Max Memory Allocated: 19.030527114868164  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.02294921875 GB
    Memory Allocated: 0.46788549423217773  GigaBytes
Max Memory Allocated: 19.030527114868164  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.02490234375 GB
    Memory Allocated: 17.909680366516113  GigaBytes
Max Memory Allocated: 19.030527114868164  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.02490234375 GB
    Memory Allocated: 17.912686347961426  GigaBytes
Max Memory Allocated: 19.030527114868164  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.02490234375 GB
    Memory Allocated: 0.47997522354125977  GigaBytes
Max Memory Allocated: 19.030527114868164  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.02490234375 GB
    Memory Allocated: 18.116629600524902  GigaBytes
Max Memory Allocated: 19.030527114868164  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.02490234375 GB
    Memory Allocated: 18.11905574798584  GigaBytes
Max Memory Allocated: 19.030527114868164  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.02490234375 GB
    Memory Allocated: 0.49840307235717773  GigaBytes
Max Memory Allocated: 19.030527114868164  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.723798751831055  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.72728395462036  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 0.4993114471435547  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.015227794647217  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.01777935028076  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 0.5119543075561523  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.380897998809814  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.38370704650879  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 0.5178990364074707  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.007408142089844  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.010301113128662  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 0.5285139083862305  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.153983116149902  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.15641689300537  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 0.5450296401977539  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.64373207092285  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.64624261856079  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

number of input  13875350
----------------------------------------after optimizer
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 0.5738925933837891  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.209266185760498
pure train time :  5.093419313430786
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 0.570 seconds, peak memory: 46.727 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.727 GB
Metis partitioning: 2.016 seconds, peak memory: 46.727 GB
Split the graph: 0.737 seconds
Construct subgraphs: 0.022 seconds
metis partition ---------------pure dgl.metis_partition spent  3.357569694519043
14404
14336
13960
13694
14043
13738
14461
13820
13733
14332
13718
14205
13879
14248
metis partition time  3.3623199462890625
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011996030807495117
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.379627227783203
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.90182900428772
self.buckets_partition() spend  sec:  3.391691207885742
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 0.4267878532409668  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.619309902191162  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.612977504730225  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 0.42766904830932617  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.516839504241943  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.519350051879883  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 0.43401336669921875  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.16802978515625  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.171210765838623  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 0.4414653778076172  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 17.848016262054443  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 17.851054191589355  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 0.45402002334594727  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.227436542510986  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 18.2304744720459  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 0.46097469329833984  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 17.908557891845703  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 17.911785125732422  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.02099609375 GB
    Memory Allocated: 0.47993946075439453  GigaBytes
Max Memory Allocated: 19.05651044845581  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.758427143096924  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.760987281799316  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.481809139251709  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.043440341949463  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.046130657196045  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.49166202545166016  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 17.92175054550171  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 17.924452304840088  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.50909423828125  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.594756603240967  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.597740173339844  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.5123271942138672  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 17.980979442596436  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 17.983695030212402  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.5270833969116211  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.487370491027832  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.490183353424072  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.5334653854370117  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.118840217590332  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.121574878692627  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.5455946922302246  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.490179538726807  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.492685317993164  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

number of input  13861101
----------------------------------------after optimizer
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.572728157043457  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.468801259994507
pure train time :  3.483349084854126
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 0.702 seconds, peak memory: 47.015 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.015 GB
Metis partitioning: 2.336 seconds, peak memory: 47.015 GB
Split the graph: 0.796 seconds
Construct subgraphs: 0.049 seconds
metis partition ---------------pure dgl.metis_partition spent  3.8948097229003906
13969
13997
14316
14280
13708
14426
13764
13853
14417
13778
14079
13753
13895
14336
metis partition time  3.900336265563965
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014202356338500977
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.9215292930603027
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.539391040802002
self.buckets_partition() spend  sec:  3.9358832836151123
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.42038965225219727  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.077430725097656  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.071104049682617  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.42215585708618164  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.128103733062744  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.13134479522705  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.4384608268737793  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.531202793121338  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.534384727478027  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.4474678039550781  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.47955560684204  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.48236083984375  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.4512596130371094  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 17.94026756286621  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 17.94323444366455  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.4691734313964844  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.676273822784424  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.679304599761963  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.4681377410888672  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 17.93253993988037  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 17.935422897338867  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.47875261306762695  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.076704025268555  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.079458713531494  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.49640846252441406  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.6471529006958  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.65056276321411  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.49941205978393555  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.043756008148193  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.046266078948975  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.5126204490661621  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.328484535217285  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.331331253051758  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.5187044143676758  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 17.995246410369873  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 17.997746467590332  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.5300297737121582  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.15827178955078  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.16095209121704  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.5464096069335938  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.674440383911133  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.677248001098633  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

number of input  13866315
----------------------------------------after optimizer
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.5731453895568848  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.731696367263794
pure train time :  3.447126626968384
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 0.711 seconds, peak memory: 47.648 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.648 GB
Metis partitioning: 2.267 seconds, peak memory: 47.648 GB
Split the graph: 0.920 seconds
Construct subgraphs: 0.035 seconds
metis partition ---------------pure dgl.metis_partition spent  3.9350619316101074
14404
14336
13960
13694
14043
13738
14461
13820
13733
14332
13718
14205
13879
14248
metis partition time  3.9398887157440186
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014936447143554688
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.9621753692626953
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.563020706176758
self.buckets_partition() spend  sec:  3.9771652221679688
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.4275369644165039  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.671735286712646  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.666049003601074  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.4292945861816406  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.556259632110596  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.55885887145996  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.43339967727661133  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.139400959014893  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.141845703125  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.4418463706970215  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 17.923014163970947  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 17.926230430603027  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.45429086685180664  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.291877269744873  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.294644832611084  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.4584956169128418  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 17.895464420318604  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 17.8985857963562  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.47769641876220703  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.66567373275757  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.668378829956055  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.47882080078125  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.024674892425537  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.027199745178223  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.4861907958984375  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 17.86917209625244  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 17.871959686279297  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.5045251846313477  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.56182861328125  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 18.564574718475342  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.5085525512695312  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 17.960388660430908  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 17.962968826293945  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.02880859375 GB
    Memory Allocated: 0.5237255096435547  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.459837436676025  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.46283769607544  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5300583839416504  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.224304676055908  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.22724962234497  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5449275970458984  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.54051160812378  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.543814659118652  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

number of input  13869167
----------------------------------------after optimizer
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5720138549804688  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.234631061553955
pure train time :  3.5306155681610107
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 0.599 seconds, peak memory: 47.851 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.851 GB
Metis partitioning: 2.274 seconds, peak memory: 47.851 GB
Split the graph: 0.748 seconds
Construct subgraphs: 0.036 seconds
metis partition ---------------pure dgl.metis_partition spent  3.6582555770874023
14404
14336
13960
13694
14043
13738
14461
13820
13733
14332
13718
14205
13879
14248
metis partition time  3.6633405685424805
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012663125991821289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.684929609298706
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.479600429534912
self.buckets_partition() spend  sec:  3.6976447105407715
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.42751598358154297  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.614339351654053  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.607354640960693  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4256911277770996  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.478991508483887  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.481929302215576  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.43427515029907227  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.095032691955566  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.097793579101562  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.44220399856567383  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.875784397125244  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.878657341003418  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4552006721496582  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.2370343208313  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.23961639404297  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.46079444885253906  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.910435676574707  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.91320037841797  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4788784980773926  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.73008966445923  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.732629776000977  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.48283863067626953  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.012131690979004  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.014889240264893  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.49143218994140625  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.03077745437622  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.033466339111328  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5073995590209961  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.567261695861816  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.570425510406494  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5112247467041016  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.936177253723145  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.939197063446045  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5283846855163574  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.52130365371704  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.5240797996521  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.532660961151123  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.152336597442627  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.155362129211426  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5458836555480957  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.56606960296631  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.568564891815186  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

number of input  13867100
----------------------------------------after optimizer
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5744161605834961  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7721147537231445
pure train time :  3.50443172454834
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 0.509 seconds, peak memory: 47.995 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.995 GB
Metis partitioning: 2.167 seconds, peak memory: 47.995 GB
Split the graph: 0.739 seconds
Construct subgraphs: 0.027 seconds
metis partition ---------------pure dgl.metis_partition spent  3.444723606109619
14404
14336
13960
13694
14043
13738
14461
13820
13733
14332
13718
14205
13879
14248
metis partition time  3.449270486831665
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011172056198120117
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.469094753265381
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.188790559768677
self.buckets_partition() spend  sec:  3.4803860187530518
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4276609420776367  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.606956958770752  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.60017156600952  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.42676544189453125  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.498058319091797  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.500648021697998  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.43437814712524414  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.141121864318848  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.143903255462646  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.44262027740478516  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.845745086669922  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.84908151626587  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.45507335662841797  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.26731777191162  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.2704119682312  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4618072509765625  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.998427391052246  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.000959396362305  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.47772836685180664  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.717377185821533  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.7205548286438  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.48075008392333984  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.060606479644775  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.063289165496826  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4880485534667969  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.86692523956299  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.870001792907715  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5065197944641113  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.6112961769104  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.614641666412354  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5088391304016113  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.91283130645752  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.915234088897705  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5256705284118652  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.553786277770996  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.556565761566162  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5300173759460449  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.120874881744385  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.123603343963623  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5433802604675293  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.551639080047607  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.554224491119385  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

number of input  13864818
----------------------------------------after optimizer
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5714449882507324  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.547435998916626
pure train time :  3.3655638694763184
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 0.488 seconds, peak memory: 48.103 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.103 GB
Metis partitioning: 2.187 seconds, peak memory: 48.103 GB
Split the graph: 0.758 seconds
Construct subgraphs: 0.026 seconds
metis partition ---------------pure dgl.metis_partition spent  3.4604697227478027
13969
13997
14316
14280
13708
14426
13764
13853
14417
13778
14079
13753
13895
14336
metis partition time  3.465123414993286
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012210607528686523
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.4836795330047607
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.2529144287109375
self.buckets_partition() spend  sec:  3.4959490299224854
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.425356388092041  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.217339515686035  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.20919132232666  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.425142765045166  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.171167373657227  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.174571990966797  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4367241859436035  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.472938537597656  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.47544574737549  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4460110664367676  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.39319133758545  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.395692348480225  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.45016956329345703  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.89958381652832  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.902071475982666  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.46936655044555664  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.745314598083496  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.748202800750732  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4721078872680664  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.97925615310669  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.9819598197937  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.48293018341064453  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.124109745025635  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.126535892486572  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4989447593688965  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.62998867034912  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.63275671005249  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5045638084411621  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.05568265914917  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.05831480026245  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5163288116455078  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.37323760986328  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.376113891601562  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5219497680664062  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.011531829833984  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.014136791229248  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5321922302246094  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.16806936264038  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.170748233795166  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5482525825500488  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.622084140777588  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.62523889541626  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

number of input  13870485
----------------------------------------after optimizer
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5756292343139648  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3915880918502808
pure train time :  3.3148162364959717
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 0.479 seconds, peak memory: 48.248 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.248 GB
Metis partitioning: 2.148 seconds, peak memory: 48.248 GB
Split the graph: 0.705 seconds
Construct subgraphs: 0.032 seconds
metis partition ---------------pure dgl.metis_partition spent  3.3650381565093994
14404
14336
13960
13694
14043
13738
14461
13820
13733
14332
13718
14205
13879
14248
metis partition time  3.369629383087158
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01032257080078125
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.388425350189209
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.898008346557617
self.buckets_partition() spend  sec:  3.398798704147339
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.42755603790283203  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.586246967315674  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.579407691955566  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.42960596084594727  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.599080562591553  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.60178565979004  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4330010414123535  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.13958215713501  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.14236354827881  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4391145706176758  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.84465503692627  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.84743642807007  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.45165586471557617  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.186370372772217  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.18882989883423  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4576444625854492  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.891837120056152  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.894243240356445  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4767599105834961  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.69084119796753  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.693373680114746  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.47863340377807617  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.979154586791992  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.98157501220703  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.49054718017578125  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.040308952331543  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.0430269241333  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5057029724121094  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.58165407180786  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.58419179916382  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5097475051879883  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.970906257629395  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.973656177520752  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.523770809173584  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.517265796661377  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.520256519317627  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5319108963012695  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.210932731628418  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.213363647460938  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.543553352355957  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.51570415496826  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.51819944381714  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

number of input  13866189
----------------------------------------after optimizer
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5717525482177734  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2683067321777344
pure train time :  3.4663615226745605
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 0.484 seconds, peak memory: 48.249 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.249 GB
Metis partitioning: 2.074 seconds, peak memory: 48.249 GB
Split the graph: 0.731 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  3.3277690410614014
14404
14336
13960
13694
14043
13738
14461
13820
13733
14332
13718
14205
13879
14248
metis partition time  3.332566976547241
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012335777282714844
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.3499584197998047
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.167443513870239
self.buckets_partition() spend  sec:  3.362372398376465
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4284501075744629  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.56720733642578  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.55847406387329  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.42587852478027344  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.47234010696411  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.47485065460205  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.43256711959838867  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.14049005508423  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.14345407485962  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.44136476516723633  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.881229877471924  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.883628368377686  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.45467281341552734  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.260464191436768  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.263372898101807  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4599013328552246  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.961527347564697  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.96419382095337  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.47768592834472656  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.688809871673584  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.691402912139893  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.48172903060913086  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.985885620117188  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.988436698913574  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4910006523132324  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.99949598312378  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.001901149749756  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5051016807556152  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.54700517654419  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.55043935775757  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5111160278320312  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.968327045440674  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.971445560455322  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5252132415771484  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.431769371032715  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.434396266937256  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5309629440307617  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.117560863494873  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.120187759399414  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.545844554901123  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.547133922576904  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.55038356781006  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

number of input  13862075
----------------------------------------after optimizer
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5744194984436035  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1729726791381836
pure train time :  3.452641248703003
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 0.462 seconds, peak memory: 48.312 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.312 GB
Metis partitioning: 2.040 seconds, peak memory: 48.312 GB
Split the graph: 0.709 seconds
Construct subgraphs: 0.040 seconds
metis partition ---------------pure dgl.metis_partition spent  3.2510008811950684
14404
14336
13960
13694
14043
13738
14461
13820
13733
14332
13718
14205
13879
14248
metis partition time  3.2557976245880127
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010019302368164062
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.2736711502075195
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.777675151824951
self.buckets_partition() spend  sec:  3.2837424278259277
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4294257164001465  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.662784099578857  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.655094623565674  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.42888927459716797  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.535106658935547  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.53804302215576  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4360365867614746  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.189953327178955  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.19288969039917  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.44153547286987305  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.888492107391357  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.89122438430786  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.45401430130004883  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.202016353607178  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.20447587966919  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.46080589294433594  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.899083614349365  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.90161371231079  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4789009094238281  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.661590576171875  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.664581775665283  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.48151493072509766  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.99500846862793  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.997581481933594  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.49046993255615234  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.936593532562256  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.93958854675293  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5080904960632324  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.63312578201294  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.635801315307617  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5111298561096191  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.948613166809082  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.951441764831543  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5261693000793457  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.457538604736328  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.460522651672363  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.534599781036377  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.2262225151062  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.22865343093872  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5461940765380859  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.48213768005371  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.484661102294922  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

number of input  13864501
----------------------------------------after optimizer
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5738358497619629  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.080130934715271
pure train time :  3.4510505199432373
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 0.451 seconds, peak memory: 48.312 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.312 GB
Metis partitioning: 1.933 seconds, peak memory: 48.312 GB
Split the graph: 0.875 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  3.29898738861084
13969
13997
14316
14280
13708
14426
13764
13853
14417
13778
14079
13753
13895
14336
metis partition time  3.303685188293457
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011530876159667969
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.325167655944824
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.867920637130737
self.buckets_partition() spend  sec:  3.3367557525634766
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.421295166015625  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.140126705169678  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.132815837860107  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.42427730560302734  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.140063285827637  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.14285373687744  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.43877506256103516  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.49568271636963  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.49880886077881  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.44859933853149414  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.46616220474243  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.468719482421875  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4551267623901367  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.89512586593628  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.897683143615723  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4703788757324219  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.627004146575928  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.630396366119385  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4735836982727051  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.950806140899658  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.95356845855713  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.48447608947753906  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.085514545440674  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.087960720062256  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5005073547363281  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.695722103118896  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.6988263130188  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5026955604553223  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.087019443511963  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.089633464813232  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.514930248260498  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.296650886535645  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.29914665222168  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5223860740661621  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.00569438934326  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.008756160736084  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5318922996520996  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.21843910217285  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.22087287902832  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.547111988067627  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.638699054718018  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.641209602355957  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

number of input  13866972
----------------------------------------after optimizer
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5752396583557129  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0030449628829956
pure train time :  3.420654773712158
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 0.595 seconds, peak memory: 48.312 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.312 GB
Metis partitioning: 2.133 seconds, peak memory: 48.312 GB
Split the graph: 0.895 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  3.663295269012451
14404
14336
13960
13694
14043
13738
14461
13820
13733
14332
13718
14205
13879
14248
metis partition time  3.668313503265381
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012187004089355469
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.688443899154663
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.4427289962768555
self.buckets_partition() spend  sec:  3.700697660446167
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.42846202850341797  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.623911380767822  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.6163969039917  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4274864196777344  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.485239505767822  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.487818241119385  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.43500661849975586  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.137979984283447  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.141011238098145  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.44267845153808594  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.8602352142334  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.86263370513916  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4556894302368164  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.226459503173828  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.229705810546875  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.46338415145874023  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.001319885253906  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.00393581390381  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.47885751724243164  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.68881320953369  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.691345691680908  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.48131656646728516  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.982324600219727  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.984891891479492  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.48954010009765625  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.919392108917236  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.922579765319824  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5069026947021484  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.539506435394287  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.54201650619507  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5117740631103516  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.953802585601807  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.956639289855957  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5275688171386719  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.523521423339844  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.52600908279419  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5356359481811523  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.1751708984375  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.178040981292725  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5504350662231445  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.61213445663452  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.614875316619873  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

number of input  13868543
----------------------------------------after optimizer
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5783548355102539  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9547069072723389
pure train time :  3.2814979553222656
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 0.447 seconds, peak memory: 48.312 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.312 GB
Metis partitioning: 2.019 seconds, peak memory: 48.312 GB
Split the graph: 0.768 seconds
Construct subgraphs: 0.028 seconds
metis partition ---------------pure dgl.metis_partition spent  3.262005090713501
13969
13997
14316
14280
13708
14426
13764
13853
14417
13778
14079
13753
13895
14336
metis partition time  3.2664921283721924
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009580135345458984
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.2864878177642822
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.794708490371704
self.buckets_partition() spend  sec:  3.2961153984069824
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4243454933166504  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.170846939086914  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.162261962890625  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4245166778564453  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.150864601135254  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.153701782226562  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.43688154220581055  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.53683614730835  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.53947639465332  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4463181495666504  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.504611015319824  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.50744104385376  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.45038795471191406  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.904887676239014  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.908002853393555  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.46887779235839844  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.718821048736572  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.722049713134766  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4695868492126465  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.95561456680298  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.958242893218994  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.48023033142089844  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.080135345458984  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.082732677459717  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.49443578720092773  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.642611026763916  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.6451358795166  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.49866437911987305  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.99809741973877  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.000656127929688  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5116410255432129  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.337276458740234  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.34027099609375  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5183095932006836  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.007956981658936  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.010992527008057  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.530360221862793  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.20987844467163  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.21297550201416  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5445489883422852  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.618738651275635  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.621315002441406  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

number of input  13872096
----------------------------------------after optimizer
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5725569725036621  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.914882481098175
pure train time :  3.448789358139038
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 0.586 seconds, peak memory: 48.312 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.312 GB
Metis partitioning: 2.296 seconds, peak memory: 48.312 GB
Split the graph: 0.737 seconds
Construct subgraphs: 0.035 seconds
metis partition ---------------pure dgl.metis_partition spent  3.6549925804138184
14404
14336
13960
13694
14043
13738
14461
13820
13733
14332
13718
14205
13879
14248
metis partition time  3.659644842147827
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010141849517822266
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.6792104244232178
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.35476541519165
self.buckets_partition() spend  sec:  3.6894123554229736
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4280977249145508  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.572951316833496  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.564870834350586  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4276285171508789  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.55527639389038  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.55810308456421  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.43337249755859375  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.142056941986084  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.145465850830078  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4406566619873047  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.87503957748413  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.87763500213623  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4503030776977539  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.16909646987915  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.17237663269043  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.46035051345825195  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.959274768829346  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.962603092193604  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4782085418701172  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.64811086654663  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.650741577148438  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.48190736770629883  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.056761741638184  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.059327602386475  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.49029970169067383  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.914401054382324  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.917367935180664  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5078716278076172  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.67829132080078  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.68104124069214  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.509636402130127  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.950432300567627  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.953182220458984  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5247268676757812  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.46485996246338  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.467658519744873  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5307021141052246  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.1574444770813  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.16002655029297  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5433282852172852  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.546527862548828  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.54919672012329  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

number of input  13867753
----------------------------------------after optimizer
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5711588859558105  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8687483072280884
pure train time :  3.8240773677825928
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 0.543 seconds, peak memory: 48.312 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.312 GB
Metis partitioning: 2.399 seconds, peak memory: 48.312 GB
Split the graph: 0.736 seconds
Construct subgraphs: 0.030 seconds
metis partition ---------------pure dgl.metis_partition spent  3.70947527885437
14404
14336
13960
13694
14043
13738
14461
13820
13733
14332
13718
14205
13879
14248
metis partition time  3.714226484298706
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012920618057250977
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.7357983589172363
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.446145057678223
self.buckets_partition() spend  sec:  3.7487783432006836
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4291973114013672  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.61641788482666  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.60905122756958  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4282965660095215  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.551974773406982  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.554823875427246  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4348764419555664  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.1776180267334  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.180786609649658  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4389371871948242  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.813518524169922  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.8164324760437  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.45237016677856445  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.21846342086792  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.221226692199707  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.46062231063842773  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.922388553619385  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.925631999969482  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4758181571960449  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.654691696166992  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.657657623291016  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4810910224914551  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.09941339492798  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.102076053619385  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.48822784423828125  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.94129180908203  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.943954467773438  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5062680244445801  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.594056129455566  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.59748935699463  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5099711418151855  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.979461193084717  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.98193883895874  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5229029655456543  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.454381942749023  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.45686960220337  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5290279388427734  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.119702339172363  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.12218999862671  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5427122116088867  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.527782917022705  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.530951976776123  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

number of input  13867060
----------------------------------------after optimizer
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5715389251708984  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8308752179145813
pure train time :  3.43278431892395
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 0.482 seconds, peak memory: 48.312 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.312 GB
Metis partitioning: 2.280 seconds, peak memory: 48.312 GB
Split the graph: 0.715 seconds
Construct subgraphs: 0.037 seconds
metis partition ---------------pure dgl.metis_partition spent  3.5153212547302246
13969
13997
14316
14280
13708
14426
13764
13853
14417
13778
14079
13753
13895
14336
metis partition time  3.52004075050354
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011760711669921875
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.5420467853546143
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.277385950088501
self.buckets_partition() spend  sec:  3.5539400577545166
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4220542907714844  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.123531341552734  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.115478038787842  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4247450828552246  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.137232303619385  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.139683723449707  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4379715919494629  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.494659900665283  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.497458934783936  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.44644689559936523  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.448033332824707  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.450534343719482  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4505748748779297  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.886367321014404  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.889357089996338  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.46805715560913086  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.6367449760437  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.63972282409668  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4721202850341797  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.976340293884277  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.9789400100708  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.48197078704833984  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.094614028930664  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.0970401763916  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4971146583557129  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.652318477630615  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.65556001663208  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5015153884887695  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.019972801208496  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.02277183532715  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5145182609558105  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.388089179992676  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.390745162963867  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.519932746887207  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.034510612487793  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.037073612213135  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5324578285217285  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.211220741271973  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.21365451812744  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5441021919250488  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.563119411468506  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.566044807434082  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

number of input  13858591
----------------------------------------after optimizer
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5724353790283203  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7944673299789429
pure train time :  3.535512685775757
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 0.510 seconds, peak memory: 48.312 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.312 GB
Metis partitioning: 2.167 seconds, peak memory: 48.312 GB
Split the graph: 0.748 seconds
Construct subgraphs: 0.034 seconds
metis partition ---------------pure dgl.metis_partition spent  3.4604928493499756
13969
13997
14316
14280
13708
14426
13764
13853
14417
13778
14079
13753
13895
14336
metis partition time  3.464982032775879
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011480093002319336
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.483407974243164
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.1984946727752686
self.buckets_partition() spend  sec:  3.4949355125427246
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4236788749694824  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.19359588623047  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.18636703491211  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.423764705657959  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.148329734802246  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.15086030960083  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.43735361099243164  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.50869369506836  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.51120090484619  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4503040313720703  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.483513832092285  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.48601484298706  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.45462608337402344  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.928633213043213  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.93118906021118  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.47419166564941406  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.74790096282959  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.7510347366333  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.47481727600097656  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.965516090393066  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.968470573425293  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.48493099212646484  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.056634426116943  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.059123516082764  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5014810562133789  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.610071659088135  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.613515853881836  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5057888031005859  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.97110080718994  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.974100589752197  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5185351371765137  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.375263214111328  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.378117561340332  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5230445861816406  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.96181344985962  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.96508026123047  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5346641540527344  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.149678707122803  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.15211248397827  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5491733551025391  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.63962459564209  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.642385005950928  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

number of input  13865498
----------------------------------------after optimizer
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5764074325561523  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7605676651000977
pure train time :  3.595050811767578
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 0.435 seconds, peak memory: 48.312 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.312 GB
Metis partitioning: 2.146 seconds, peak memory: 48.312 GB
Split the graph: 0.783 seconds
Construct subgraphs: 0.039 seconds
metis partition ---------------pure dgl.metis_partition spent  3.4039783477783203
14404
14336
13960
13694
14043
13738
14461
13820
13733
14332
13718
14205
13879
14248
metis partition time  3.4085981845855713
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011230945587158203
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.430964708328247
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.166757345199585
self.buckets_partition() spend  sec:  3.442251205444336
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4275212287902832  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.591418266296387  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.58437442779541  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4277687072753906  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.53983497619629  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.54234552383423  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.43151283264160156  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.097095012664795  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.100180625915527  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.43982648849487305  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.85861873626709  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.86180019378662  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4537186622619629  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.21307134628296  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.215822219848633  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4608149528503418  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.96970224380493  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.9727783203125  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4768495559692383  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.67318868637085  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.675721168518066  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.48249053955078125  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.102381229400635  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.10505247116089  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4908781051635742  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.96618127822876  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.96905279159546  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5058112144470215  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.5685772895813  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.5711727142334  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5095787048339844  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.969000339508057  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.971562385559082  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5243864059448242  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.45305061340332  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.455557346343994  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5319018363952637  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.099151134490967  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.101913452148438  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5456647872924805  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.54543685913086  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.548662185668945  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

number of input  13868303
----------------------------------------after optimizer
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5747299194335938  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7281776666641235
pure train time :  3.5585289001464844
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 0.518 seconds, peak memory: 48.312 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.312 GB
Metis partitioning: 2.174 seconds, peak memory: 48.312 GB
Split the graph: 0.697 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  3.4284963607788086
14404
14336
13960
13694
14043
13738
14461
13820
13733
14332
13718
14205
13879
14248
metis partition time  3.4332659244537354
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010562658309936523
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.4552628993988037
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.204566240310669
self.buckets_partition() spend  sec:  3.4659552574157715
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.42917966842651367  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.587456226348877  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.579286098480225  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4276432991027832  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.555670738220215  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.558376789093018  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4323749542236328  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.105620861053467  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.108139038085938  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4373788833618164  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.809770107269287  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.812288284301758  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4541492462158203  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.299256801605225  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.301830291748047  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4593043327331543  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.91653537750244  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.919471740722656  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4774465560913086  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.69888687133789  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.701419353485107  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.48354196548461914  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.069766521453857  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.07222890853882  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.49059295654296875  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.97101068496704  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.973607540130615  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5050010681152344  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.50359296798706  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.50670337677002  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5095691680908203  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.924962997436523  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.928268432617188  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5244565010070801  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.469780921936035  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.473225593566895  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5325922966003418  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.176523208618164  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.17959499359131  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5439438819885254  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.55763339996338  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.560128688812256  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

number of input  13865422
----------------------------------------after optimizer
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5715227127075195  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7022360563278198
pure train time :  3.469961643218994
the output layer 
self.num_batch (get_in_degree_bucketing) 14
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  14
Convert a graph into a bidirected graph: 0.469 seconds, peak memory: 48.312 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.312 GB
Metis partitioning: 2.170 seconds, peak memory: 48.312 GB
Split the graph: 0.720 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  3.3979809284210205
14404
14336
13960
13694
14043
13738
14461
13820
13733
14332
13718
14205
13879
14248
metis partition time  3.4028398990631104
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011197090148925781
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.423126220703125
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.212159156799316
self.buckets_partition() spend  sec:  3.43447208404541
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4298515319824219  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.615726470947266  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.608693599700928  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.427396297454834  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.515169620513916  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.517731189727783  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4336552619934082  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.134538650512695  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.137049198150635  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.44260454177856445  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.94303321838379  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.945546627044678  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.45386838912963867  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.20805835723877  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.21052074432373  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4585423469543457  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.909001350402832  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.911407470703125  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.4783792495727539  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.677086353302002  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.68007183074951  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.48074769973754883  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.994760036468506  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.997180461883545  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.48891544342041016  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.932344436645508  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.93488597869873  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5035066604614258  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.53626298904419  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.539384365081787  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.507448673248291  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.962708950042725  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 17.965712547302246  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5234198570251465  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.476295948028564  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.479193210601807  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5305638313293457  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.22437334060669  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.226983547210693  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.5449185371398926  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.560920238494873  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 18.563581943511963  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

number of input  13865275
----------------------------------------after optimizer
 Nvidia-smi: 22.03076171875 GB
    Memory Allocated: 0.572023868560791  GigaBytes
Max Memory Allocated: 19.09333038330078  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6707121133804321
pure train time :  3.4914586544036865
epoch_time_list  [29.964171409606934, 26.670727968215942, 30.624555349349976, 30.94391369819641, 27.888341665267944, 26.26538348197937, 28.23850440979004, 27.471418380737305, 26.452250242233276, 26.764418125152588, 25.237982034683228, 28.44420313835144, 25.515363216400146, 29.36105704307556, 28.857839345932007, 26.48675298690796, 26.315441370010376, 27.66540241241455, 27.94943594932556, 25.85978865623474]

loading_time list   [0.5415198802947998, 0.6118841171264648, 0.6022200584411621, 0.5800375938415527, 0.424055814743042, 0.4056425094604492, 0.6775574684143066, 0.5353062152862549, 0.3428483009338379, 0.3822207450866699, 0.35683369636535645, 0.4105403423309326, 0.405719518661499, 0.4611685276031494, 0.6531007289886475, 0.34217262268066406, 0.40268969535827637, 0.3059101104736328, 0.46661972999572754, 0.3421590328216553]

 data loader gen time  19.071038722991943
	---backpack schedule time  [7.02008056640625, 5.978816032409668, 6.635134220123291, 6.6385722160339355, 6.554242134094238, 6.251204490661621, 6.332763195037842, 5.969099760055542, 6.230896234512329, 5.85193395614624, 5.930970191955566, 6.508070230484009, 5.860115051269531, 6.407076358795166, 6.512747049331665, 6.353184938430786, 6.255849361419678, 6.2255539894104, 6.2663819789886475, 6.282062768936157]
	---connection_check_time_list  [8.168619632720947, 7.2072434425354, 11.160630702972412, 11.649344444274902, 8.602452278137207, 7.003386735916138, 8.941161155700684, 8.921300172805786, 7.214450836181641, 8.697714805603027, 7.237574338912964, 9.232992887496948, 7.476233005523682, 9.816315174102783, 9.651618480682373, 7.82082462310791, 7.80009126663208, 8.300464868545532, 9.21694016456604, 7.171219110488892]
	---block_gen_time_list  [4.918318271636963, 5.076199293136597, 4.828500747680664, 4.793971538543701, 4.986599445343018, 4.9587318897247314, 4.599196910858154, 4.5164794921875, 5.117446422576904, 4.304932117462158, 4.699401617050171, 4.8906214237213135, 4.699379920959473, 4.7896692752838135, 4.9388508796691895, 4.822709321975708, 4.614543676376343, 5.055834770202637, 4.943420886993408, 4.975625514984131]
training time  [8.69699740409851, 7.117569923400879, 6.659026622772217, 6.61786150932312, 6.463782548904419, 6.985734701156616, 7.028123617172241, 6.867614269256592, 6.951710224151611, 6.872731447219849, 6.41539192199707, 6.7667295932769775, 6.476348161697388, 7.140515089035034, 6.430966138839722, 6.4638283252716064, 6.553930282592773, 7.135527849197388, 6.416752576828003, 6.42081356048584]
---feature block loading time  [3.5871970653533936, 3.508652687072754, 3.0943353176116943, 2.9614205360412598, 2.833632469177246, 3.5030598640441895, 3.595198154449463, 3.2831995487213135, 3.3778300285339355, 3.3041958808898926, 2.867152214050293, 3.3663949966430664, 2.9036195278167725, 3.194361686706543, 2.881479024887085, 2.8070030212402344, 2.8358497619628906, 3.4585320949554443, 2.8301279544830322, 2.8068222999572754]


epoch_time avg   27.173348903656006
loading_time avg   0.43215906620025635
 data loader gen time avg 20.004695624113083
	---backpack schedule time avg 6.237009480595589
	---connection_check_time avg  8.31904624402523
	---block_gen_time avg  4.807090222835541
training time  6.711906269192696
---feature block loading time  3.1155286580324173
pure train time per /epoch  [5.093419313430786, 3.483349084854126, 3.447126626968384, 3.5306155681610107, 3.50443172454834, 3.3655638694763184, 3.3148162364959717, 3.4663615226745605, 3.452641248703003, 3.4510505199432373, 3.420654773712158, 3.2814979553222656, 3.448789358139038, 3.8240773677825928, 3.43278431892395, 3.535512685775757, 3.595050811767578, 3.5585289001464844, 3.469961643218994, 3.4914586544036865]
pure train time average  3.4790468917173496
num_input list  [13875350, 13861101, 13866315, 13869167, 13867100, 13864818, 13870485, 13866189, 13862075, 13864501, 13866972, 13868543, 13872096, 13867753, 13867060, 13858591, 13865498, 13868303, 13865422, 13865275]
num_input  average  13866630.7
