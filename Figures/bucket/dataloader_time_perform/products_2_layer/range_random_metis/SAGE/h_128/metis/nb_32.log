main start at this time 1713155279.5961983
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 1.271 seconds, peak memory: 19.343 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 19.343 GB
Metis partitioning: 2.101 seconds, peak memory: 19.655 GB
Split the graph: 0.605 seconds
Construct subgraphs: 0.053 seconds
metis partition ---------------pure dgl.metis_partition spent  4.042639970779419
6242
6204
6299
6297
6024
6144
5975
6307
6296
6026
6202
5985
6291
6003
5973
6325
6242
6260
6139
6258
6286
6247
6142
6049
6000
6256
6049
5995
6005
5963
6011
6076
metis partition time  4.048080682754517
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009292125701904297
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.063512086868286
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  9.85360860824585
self.buckets_partition() spend  sec:  4.072851896286011
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.79638671875 GB
    Memory Allocated: 0.2660055160522461  GigaBytes
Max Memory Allocated: 0.2660055160522461  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.95263671875 GB
    Memory Allocated: 9.199447631835938  GigaBytes
Max Memory Allocated: 9.342063426971436  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.95263671875 GB
    Memory Allocated: 9.201059341430664  GigaBytes
Max Memory Allocated: 9.342063426971436  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.96044921875 GB
    Memory Allocated: 0.2848968505859375  GigaBytes
Max Memory Allocated: 9.342063426971436  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.44873046875 GB
    Memory Allocated: 9.118109226226807  GigaBytes
Max Memory Allocated: 9.342063426971436  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.44873046875 GB
    Memory Allocated: 9.119440078735352  GigaBytes
Max Memory Allocated: 9.342063426971436  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.44873046875 GB
    Memory Allocated: 0.2908177375793457  GigaBytes
Max Memory Allocated: 9.342063426971436  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23583984375 GB
    Memory Allocated: 9.289415836334229  GigaBytes
Max Memory Allocated: 9.435682773590088  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23583984375 GB
    Memory Allocated: 9.290626525878906  GigaBytes
Max Memory Allocated: 9.435682773590088  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23583984375 GB
    Memory Allocated: 0.2959270477294922  GigaBytes
Max Memory Allocated: 9.435682773590088  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.73388671875 GB
    Memory Allocated: 9.288461208343506  GigaBytes
Max Memory Allocated: 9.435682773590088  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.73388671875 GB
    Memory Allocated: 9.289613246917725  GigaBytes
Max Memory Allocated: 9.435682773590088  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.73388671875 GB
    Memory Allocated: 0.29357099533081055  GigaBytes
Max Memory Allocated: 9.435682773590088  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.73583984375 GB
    Memory Allocated: 8.959240436553955  GigaBytes
Max Memory Allocated: 9.435682773590088  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.73583984375 GB
    Memory Allocated: 8.960572242736816  GigaBytes
Max Memory Allocated: 9.435682773590088  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.73583984375 GB
    Memory Allocated: 0.2982778549194336  GigaBytes
Max Memory Allocated: 9.435682773590088  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.74169921875 GB
    Memory Allocated: 9.031620502471924  GigaBytes
Max Memory Allocated: 9.435682773590088  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.74169921875 GB
    Memory Allocated: 9.03324842453003  GigaBytes
Max Memory Allocated: 9.435682773590088  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.74169921875 GB
    Memory Allocated: 0.29889440536499023  GigaBytes
Max Memory Allocated: 9.435682773590088  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.74169921875 GB
    Memory Allocated: 8.847864627838135  GigaBytes
Max Memory Allocated: 9.435682773590088  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.74169921875 GB
    Memory Allocated: 8.848938941955566  GigaBytes
Max Memory Allocated: 9.435682773590088  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.74169921875 GB
    Memory Allocated: 0.3100242614746094  GigaBytes
Max Memory Allocated: 9.435682773590088  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.74755859375 GB
    Memory Allocated: 9.23735761642456  GigaBytes
Max Memory Allocated: 9.435682773590088  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.74755859375 GB
    Memory Allocated: 9.23883581161499  GigaBytes
Max Memory Allocated: 9.435682773590088  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.74755859375 GB
    Memory Allocated: 0.3154010772705078  GigaBytes
Max Memory Allocated: 9.435682773590088  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.75927734375 GB
    Memory Allocated: 9.311444282531738  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.75927734375 GB
    Memory Allocated: 9.312592029571533  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.75927734375 GB
    Memory Allocated: 0.3113136291503906  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.76318359375 GB
    Memory Allocated: 8.889182567596436  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.76318359375 GB
    Memory Allocated: 8.890256881713867  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.76318359375 GB
    Memory Allocated: 0.3193855285644531  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.76513671875 GB
    Memory Allocated: 9.161757469177246  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.76513671875 GB
    Memory Allocated: 9.162937641143799  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.76513671875 GB
    Memory Allocated: 0.31806516647338867  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.76513671875 GB
    Memory Allocated: 8.844497680664062  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.76513671875 GB
    Memory Allocated: 8.845579624176025  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.76513671875 GB
    Memory Allocated: 0.33090734481811523  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.77490234375 GB
    Memory Allocated: 9.276586055755615  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.77490234375 GB
    Memory Allocated: 9.277752876281738  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.77490234375 GB
    Memory Allocated: 0.32639551162719727  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.77490234375 GB
    Memory Allocated: 8.913681983947754  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.77490234375 GB
    Memory Allocated: 8.914848804473877  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.77490234375 GB
    Memory Allocated: 0.3290128707885742  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.77490234375 GB
    Memory Allocated: 8.888257503509521  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.77490234375 GB
    Memory Allocated: 8.889322280883789  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.77490234375 GB
    Memory Allocated: 0.3413572311401367  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.78076171875 GB
    Memory Allocated: 9.297861099243164  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.78076171875 GB
    Memory Allocated: 9.299186706542969  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.78076171875 GB
    Memory Allocated: 0.34319257736206055  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.78271484375 GB
    Memory Allocated: 9.25838565826416  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.78271484375 GB
    Memory Allocated: 9.259711265563965  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.78271484375 GB
    Memory Allocated: 0.34824371337890625  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.78857421875 GB
    Memory Allocated: 9.26757287979126  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.78857421875 GB
    Memory Allocated: 9.269076347351074  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.78857421875 GB
    Memory Allocated: 0.3502650260925293  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.79833984375 GB
    Memory Allocated: 9.104100704193115  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.79833984375 GB
    Memory Allocated: 9.105329513549805  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.79833984375 GB
    Memory Allocated: 0.35574913024902344  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.80224609375 GB
    Memory Allocated: 9.281342029571533  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.80224609375 GB
    Memory Allocated: 9.282570838928223  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.80224609375 GB
    Memory Allocated: 0.3594522476196289  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.80615234375 GB
    Memory Allocated: 9.28885555267334  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.80615234375 GB
    Memory Allocated: 9.290445804595947  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.80615234375 GB
    Memory Allocated: 0.3628988265991211  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.80615234375 GB
    Memory Allocated: 9.207401752471924  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.80615234375 GB
    Memory Allocated: 9.20877742767334  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.80615234375 GB
    Memory Allocated: 0.3645453453063965  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.80810546875 GB
    Memory Allocated: 9.096853256225586  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.80810546875 GB
    Memory Allocated: 9.098127841949463  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.80810546875 GB
    Memory Allocated: 0.3658895492553711  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.81005859375 GB
    Memory Allocated: 9.029370784759521  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.81005859375 GB
    Memory Allocated: 9.030582427978516  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.81005859375 GB
    Memory Allocated: 0.36855363845825195  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.81005859375 GB
    Memory Allocated: 8.95428466796875  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.81005859375 GB
    Memory Allocated: 8.956031799316406  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.81005859375 GB
    Memory Allocated: 0.37845706939697266  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.82373046875 GB
    Memory Allocated: 9.269994258880615  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.82373046875 GB
    Memory Allocated: 9.271284580230713  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.82373046875 GB
    Memory Allocated: 0.37784671783447266  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.82763671875 GB
    Memory Allocated: 9.007087707519531  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.82763671875 GB
    Memory Allocated: 9.00868034362793  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.82763671875 GB
    Memory Allocated: 0.37998056411743164  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.82763671875 GB
    Memory Allocated: 8.942389965057373  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.82763671875 GB
    Memory Allocated: 8.94346809387207  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.82763671875 GB
    Memory Allocated: 0.3836398124694824  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.83349609375 GB
    Memory Allocated: 8.915938377380371  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.83349609375 GB
    Memory Allocated: 8.917016506195068  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.83349609375 GB
    Memory Allocated: 0.3862724304199219  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.83349609375 GB
    Memory Allocated: 8.93047285079956  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.83349609375 GB
    Memory Allocated: 8.931560516357422  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.83349609375 GB
    Memory Allocated: 0.3944058418273926  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.83349609375 GB
    Memory Allocated: 9.020955085754395  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.83349609375 GB
    Memory Allocated: 9.022042751312256  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.83349609375 GB
    Memory Allocated: 0.3974776268005371  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.072089195251465  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.074028968811035  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

number of input  21428548
----------------------------------------after optimizer
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 0.41114234924316406  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.2062578201293945
pure train time :  7.978604316711426
the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 0.568 seconds, peak memory: 39.625 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 39.625 GB
Metis partitioning: 2.120 seconds, peak memory: 39.646 GB
Split the graph: 0.887 seconds
Construct subgraphs: 0.041 seconds
metis partition ---------------pure dgl.metis_partition spent  3.628471851348877
6196
6157
6279
6277
5996
6230
5964
6255
6100
6284
5988
6273
6024
6260
6251
6320
5976
5993
6220
5972
5973
6139
6178
6019
6017
5964
6303
5963
6292
6288
6165
6255
metis partition time  3.632225513458252
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01083993911743164
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.646052360534668
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  9.440988779067993
self.buckets_partition() spend  sec:  3.657001495361328
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 0.28449583053588867  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.089650630950928  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.087131023406982  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 0.284182071685791  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.03316354751587  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.034311294555664  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 0.2921905517578125  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.220964431762695  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.222400188446045  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 0.2957310676574707  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.253132343292236  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.254464149475098  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 0.29293012619018555  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 8.85608720779419  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 8.85718059539795  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 0.30246496200561523  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.176241874694824  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.1774263381958  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 0.2998080253601074  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 8.8150315284729  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 8.816103458404541  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 0.31040382385253906  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.230613708496094  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.232314109802246  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 0.31227827072143555  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.019920825958252  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.021621227264404  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 0.3205127716064453  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.248341083526611  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.249738216400146  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 0.31641292572021484  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 8.875829219818115  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 8.876884460449219  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 0.32667016983032227  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.248937129974365  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.250135898590088  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 0.32572269439697266  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 8.925927639007568  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 8.927079677581787  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 0.3329482078552246  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.21830129623413  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.219438076019287  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 0.33771276473999023  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.256825923919678  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 9.257962703704834  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.84130859375 GB
    Memory Allocated: 0.34400272369384766  GigaBytes
Max Memory Allocated: 9.457255840301514  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 9.345271110534668  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 9.34640884399414  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 0.33835601806640625  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 8.848657131195068  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 8.849769115447998  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 0.3434944152832031  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 8.922202587127686  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 8.92357349395752  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 0.3512144088745117  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 9.183533668518066  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 9.184700965881348  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 0.35053300857543945  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 8.902995586395264  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 8.904054641723633  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 0.3553633689880371  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 8.939815044403076  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 8.940893173217773  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 0.36212635040283203  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 9.110975742340088  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 9.112053871154785  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 0.36774158477783203  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 9.17438554763794  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 9.175548553466797  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 0.3667745590209961  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 8.981022834777832  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 8.982588768005371  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 0.37110185623168945  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 8.981029987335205  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 8.982128620147705  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 0.37261390686035156  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 8.918604850769043  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 8.919663906097412  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 0.3845491409301758  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 9.31381893157959  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 9.315389156341553  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 0.38060760498046875  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 8.929494857788086  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 8.930576801300049  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 0.39426136016845703  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 9.342472553253174  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 9.34373950958252  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.34716796875 GB
    Memory Allocated: 0.39571380615234375  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35107421875 GB
    Memory Allocated: 9.324997901916504  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35107421875 GB
    Memory Allocated: 9.326594829559326  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35107421875 GB
    Memory Allocated: 0.3966965675354004  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.202191352844238  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.203766345977783  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.40378713607788086  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.330982685089111  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.332539081573486  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

number of input  21415806
----------------------------------------after optimizer
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.41661500930786133  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.4793949127197266
pure train time :  5.366335391998291
the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 0.556 seconds, peak memory: 41.781 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 41.781 GB
Metis partitioning: 2.171 seconds, peak memory: 41.781 GB
Split the graph: 0.686 seconds
Construct subgraphs: 0.052 seconds
metis partition ---------------pure dgl.metis_partition spent  3.4755213260650635
6242
6204
6299
6297
6024
6144
5975
6307
6296
6026
6202
5985
6291
6003
5973
6325
6242
6260
6139
6258
6286
6247
6142
6049
6000
6256
6049
5995
6005
5963
6011
6076
metis partition time  3.481016159057617
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011117696762084961
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.504434585571289
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  9.910536050796509
self.buckets_partition() spend  sec:  3.5157620906829834
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.28619861602783203  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.141250610351562  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.138635635375977  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.28664588928222656  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.118949890136719  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.120044231414795  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.2913985252380371  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.229050159454346  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.230603218078613  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.2960844039916992  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.256642818450928  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.257981300354004  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.29335689544677734  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.898244380950928  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.899368286132812  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3002443313598633  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.036375999450684  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.03804874420166  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.301450252532959  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.81043529510498  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.81154203414917  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.312136173248291  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.271374702453613  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.272481441497803  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3156280517578125  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.26142406463623  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.26259708404541  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.31430673599243164  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.931221008300781  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.932445526123047  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.32175254821777344  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.15234375  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.15344524383545  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.31927013397216797  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.848576068878174  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.849662780761719  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.33252525329589844  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.28014087677002  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.281345844268799  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3311138153076172  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.942582130432129  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.944020748138428  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3310532569885254  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.879944324493408  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.880999565124512  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3442807197570801  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.3438720703125  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.345049858093262  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.34499502182006836  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.262544631958008  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.26372241973877  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3491659164428711  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.20933485031128  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.210529327392578  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3492603302001953  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.076366424560547  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.077501773834229  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.35695600509643555  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.233808040618896  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.235113143920898  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3620872497558594  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.288951396942139  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.290150165557861  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.36284303665161133  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.203859806060791  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.205058574676514  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.366363525390625  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.113497734069824  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.114713191986084  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3673219680786133  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.005219459533691  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.006382465362549  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.37126874923706055  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.953679084777832  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.95484209060669  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3817481994628906  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.324955463409424  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.326351165771484  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3814396858215332  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.0711088180542  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.07264232635498  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.382537841796875  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.973287582397461  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.975178718566895  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.38549327850341797  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.975449085235596  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.976514339447021  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3908076286315918  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.959946632385254  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.961015224456787  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3929433822631836  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.952935218811035  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.954003810882568  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3990645408630371  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.07761001586914  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.07874345779419  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

number of input  21415256
----------------------------------------after optimizer
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.4118962287902832  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.737793445587158
pure train time :  5.948675155639648
the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 0.479 seconds, peak memory: 42.132 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.132 GB
Metis partitioning: 2.102 seconds, peak memory: 42.132 GB
Split the graph: 0.938 seconds
Construct subgraphs: 0.043 seconds
metis partition ---------------pure dgl.metis_partition spent  3.5637311935424805
6196
6157
6279
6277
5996
6230
5964
6255
6100
6284
5988
6273
6024
6260
6251
6320
5976
5993
6220
5972
5973
6139
6178
6019
6017
5964
6303
5963
6292
6288
6165
6255
metis partition time  3.567737340927124
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011152505874633789
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.5860164165496826
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  9.429313898086548
self.buckets_partition() spend  sec:  3.597249746322632
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.2860589027404785  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.110911846160889  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.108476638793945  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.2856779098510742  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.048366069793701  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.049610614776611  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.2941875457763672  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.233942985534668  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.235356330871582  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.29645633697509766  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.249513149261475  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.250834465026855  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.2946038246154785  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.886078357696533  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.887202262878418  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3027195930480957  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.177610874176025  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.17873477935791  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3003840446472168  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.851689338684082  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.852809429168701  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3126392364501953  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.24503469467163  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.24615478515625  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3119535446166992  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.033880710601807  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.035228252410889  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.31943607330322266  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.253763675689697  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.254865646362305  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.31869983673095703  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.936851024627686  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.938092231750488  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.32561159133911133  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.244261741638184  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.245393753051758  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3267550468444824  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.96355390548706  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.964688777923584  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.33382749557495117  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.256720066070557  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.25785493850708  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.33749818801879883  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.213189125061035  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.214455604553223  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.34341955184936523  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.3063645362854  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.307596206665039  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3385124206542969  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.88789987564087  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.888995170593262  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3425178527832031  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.87348747253418  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.874582767486572  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3529071807861328  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.205694675445557  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.206816673278809  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.34932518005371094  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.871846199035645  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.872937679290771  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3545694351196289  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.915444374084473  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.916505336761475  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.36199235916137695  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.103661060333252  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.10524606704712  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.36718225479125977  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.174376487731934  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.175934314727783  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.36663055419921875  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.92958688735962  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.930651664733887  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.36891889572143555  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.965070724487305  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.966125011444092  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3731980323791504  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.927069664001465  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.928174495697021  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.38562536239624023  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.345598697662354  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.346860408782959  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3794236183166504  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.856448650360107  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 8.85755205154419  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.3907761573791504  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.33863639831543  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.340017795562744  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.39501333236694336  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.316269874572754  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.317907810211182  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.39723873138427734  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.19628095626831  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 9.197402954101562  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35302734375 GB
    Memory Allocated: 0.40256643295288086  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.26258134841919  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.263703346252441  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

number of input  21417805
----------------------------------------after optimizer
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.41486167907714844  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.230825662612915
pure train time :  5.77951192855835
the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 0.513 seconds, peak memory: 42.132 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.132 GB
Metis partitioning: 2.033 seconds, peak memory: 42.239 GB
Split the graph: 0.608 seconds
Construct subgraphs: 0.042 seconds
metis partition ---------------pure dgl.metis_partition spent  3.1963727474212646
6242
6204
6299
6297
6024
6144
5975
6307
6296
6026
6202
5985
6291
6003
5973
6325
6242
6260
6139
6258
6286
6247
6142
6049
6000
6256
6049
5995
6005
5963
6011
6076
metis partition time  3.200181484222412
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013287782669067383
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.2174577713012695
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  8.956684112548828
self.buckets_partition() spend  sec:  3.230802297592163
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.28598690032958984  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.161553859710693  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.15878438949585  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.28598594665527344  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.092070579528809  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.093213558197021  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2924528121948242  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.251723766326904  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.252840042114258  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29704904556274414  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.246085166931152  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.247294425964355  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29311513900756836  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.903172492980957  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.904425144195557  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.30034637451171875  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.010159969329834  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.011554718017578  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3006277084350586  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.850015640258789  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.851114749908447  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.31395387649536133  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.31635332107544  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.317479610443115  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3148179054260254  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.25010871887207  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.251235008239746  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.31325435638427734  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.947540283203125  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.948748111724854  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.32164525985717773  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.161087036132812  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.162277698516846  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3215141296386719  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.882832050323486  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.883912086486816  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.33275461196899414  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.28307294845581  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.28439474105835  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.32816171646118164  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.892080307006836  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.89347505569458  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.33203887939453125  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.895089626312256  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.89620590209961  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.34389257431030273  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.34522819519043  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.346336364746094  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.34519195556640625  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.227699756622314  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.228803634643555  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.34813547134399414  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.194044589996338  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.195148468017578  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.35153865814208984  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.147156715393066  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.148328304290771  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3578200340270996  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.287696838378906  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.288868427276611  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36353063583374023  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.310347557067871  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.31173324584961  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36531591415405273  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.289435863494873  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.290821552276611  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3665180206298828  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.104188442230225  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.105823516845703  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3679208755493164  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.007869720458984  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.009032249450684  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3712630271911621  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.941834449768066  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.943414688110352  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3804783821105957  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.29624605178833  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.297508239746094  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3791050910949707  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.998623847961426  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.999802112579346  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38340091705322266  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.964484691619873  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.965679168701172  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38721609115600586  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.983755111694336  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.98487901687622  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38849830627441406  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.909246444702148  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.910353183746338  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3928689956665039  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.973767280578613  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.974826335906982  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.39928436279296875  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.102785110473633  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.104114532470703  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

number of input  21425844
----------------------------------------after optimizer
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.41230201721191406  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7779693603515625
pure train time :  5.384113073348999
the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 0.495 seconds, peak memory: 42.372 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.372 GB
Metis partitioning: 2.067 seconds, peak memory: 42.372 GB
Split the graph: 1.322 seconds
Construct subgraphs: 0.042 seconds
metis partition ---------------pure dgl.metis_partition spent  3.926553249359131
6242
6204
6299
6297
6024
6144
5975
6307
6296
6026
6202
5985
6291
6003
5973
6325
6242
6260
6139
6258
6286
6247
6142
6049
6000
6256
6049
5995
6005
5963
6011
6076
metis partition time  3.9302942752838135
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01271963119506836
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.948967695236206
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  9.74782681465149
self.buckets_partition() spend  sec:  3.9618654251098633
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.28629112243652344  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.15207052230835  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.149398803710938  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.28819894790649414  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.157755374908447  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.159069538116455  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29197263717651367  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.230369567871094  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.231683731079102  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29721641540527344  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.254868030548096  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.256001472473145  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2934737205505371  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.889379024505615  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.890573501586914  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.30104589462280273  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.096858501434326  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.09821891784668  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.301297664642334  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.860747814178467  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.861858367919922  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.313748836517334  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.316967487335205  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.31807804107666  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3158707618713379  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.287708759307861  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.288938999176025  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3147587776184082  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.941857814788818  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.943460464477539  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3224935531616211  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.185248374938965  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.186601161956787  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.31937170028686523  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.84162425994873  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.842711925506592  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.33112287521362305  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.262989521026611  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.264426708221436  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3290748596191406  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.926005840301514  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.927517890930176  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.33045339584350586  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.83521318435669  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.836356163024902  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3449282646179199  GigaBytes
Max Memory Allocated: 9.492641925811768  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.352226257324219  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.353369235992432  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3446078300476074  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.21714735031128  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.218378067016602  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.34930896759033203  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.275408267974854  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.276638984680176  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.34949302673339844  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.04737138748169  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.048811435699463  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3577699661254883  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.275317668914795  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.27668285369873  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3621196746826172  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.308085918426514  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.309283256530762  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.364194393157959  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.2353835105896  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.236510753631592  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3659934997558594  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.074952125549316  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.076062679290771  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3672170639038086  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.001644611358643  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.002742767333984  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3710508346557617  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.929049491882324  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.930118083953857  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.37969160079956055  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.254335880279541  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.255627632141113  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38016510009765625  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.057645320892334  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.058770656585693  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38195133209228516  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.96088457107544  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.961944580078125  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3846592903137207  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.957247734069824  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.95835828781128  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3897242546081543  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.94986629486084  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.950961589813232  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.39419078826904297  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.018413543701172  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.01950216293335  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.39859485626220703  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.078911781311035  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.080000400543213  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

number of input  21416002
----------------------------------------after optimizer
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.4114670753479004  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5502252578735352
pure train time :  5.587265968322754
the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 0.446 seconds, peak memory: 42.372 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.372 GB
Metis partitioning: 2.080 seconds, peak memory: 42.427 GB
Split the graph: 0.512 seconds
Construct subgraphs: 0.037 seconds
metis partition ---------------pure dgl.metis_partition spent  3.076040744781494
6228
6263
6035
6025
5998
6102
6115
6075
6278
6272
6285
6312
6039
6229
6079
5968
5993
6225
5972
6176
6165
6167
5966
5978
5996
6272
6275
6180
6291
6280
6005
6327
metis partition time  3.080740451812744
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01274251937866211
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1000170707702637
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  8.996442556381226
self.buckets_partition() spend  sec:  3.112910747528076
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.28483152389526367  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.127307415008545  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.124749183654785  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.289642333984375  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.218017578125  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.219256401062012  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.28529834747314453  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.850368022918701  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.851465225219727  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2902565002441406  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.923004150390625  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.92410135269165  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2934880256652832  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.87190866470337  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.873018264770508  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29785919189453125  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.976577758789062  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.978044033050537  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3037252426147461  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.046893119812012  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.048297882080078  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3047924041748047  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.915696144104004  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.91710090637207  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3166937828063965  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.26441240310669  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.265796661376953  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3183407783508301  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.205067157745361  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.206461906433105  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.32457780838012695  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.317014694213867  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.318204879760742  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3263278007507324  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.293513774871826  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.294681549072266  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3257265090942383  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.9496488571167  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.950816631317139  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.33310365676879883  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.19721794128418  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.198530673980713  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3352518081665039  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.030699729919434  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.031944274902344  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3332400321960449  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.81748342514038  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.818614959716797  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3379693031311035  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.869564533233643  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.870696067810059  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3489513397216797  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.208712100982666  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.210216045379639  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3465242385864258  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.877054214477539  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.878130435943604  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.35546445846557617  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.181973457336426  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.18318796157837  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3599410057067871  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.160919666290283  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.162215232849121  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36285877227783203  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.174153327941895  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.175565242767334  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36232757568359375  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.879719257354736  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.880841255187988  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3660292625427246  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.938867568969727  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.939932346343994  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36946630477905273  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.952454090118408  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.953505516052246  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3804340362548828  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.311911582946777  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.313430786132812  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3859744071960449  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.314661979675293  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.316129207611084  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3863992691040039  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.233279705047607  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.234399795532227  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.39357948303222656  GigaBytes
Max Memory Allocated: 9.498109817504883  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.39059066772461  GigaBytes
Max Memory Allocated: 9.536328315734863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.391710758209229  GigaBytes
Max Memory Allocated: 9.536328315734863  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.39516496658325195  GigaBytes
Max Memory Allocated: 9.536328315734863  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.323039054870605  GigaBytes
Max Memory Allocated: 9.536328315734863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.324222564697266  GigaBytes
Max Memory Allocated: 9.536328315734863  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3945155143737793  GigaBytes
Max Memory Allocated: 9.536328315734863  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.964886665344238  GigaBytes
Max Memory Allocated: 9.536328315734863  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.965941905975342  GigaBytes
Max Memory Allocated: 9.536328315734863  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.4056053161621094  GigaBytes
Max Memory Allocated: 9.536328315734863  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.41330623626709  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.414416313171387  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

number of input  21422736
----------------------------------------after optimizer
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.41814756393432617  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.395997166633606
pure train time :  5.374127626419067
the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 0.422 seconds, peak memory: 42.541 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.541 GB
Metis partitioning: 1.996 seconds, peak memory: 42.541 GB
Split the graph: 1.193 seconds
Construct subgraphs: 0.039 seconds
metis partition ---------------pure dgl.metis_partition spent  3.6520819664001465
6242
6204
6299
6297
6024
6144
5975
6307
6296
6026
6202
5985
6291
6003
5973
6325
6242
6260
6139
6258
6286
6247
6142
6049
6000
6256
6049
5995
6005
5963
6011
6076
metis partition time  3.655761480331421
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010190010070800781
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.672325372695923
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  9.41132926940918
self.buckets_partition() spend  sec:  3.682574987411499
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.287076473236084  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.21538257598877  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.212528705596924  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2861313819885254  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.099770545959473  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.100950717926025  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2909555435180664  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.221075534820557  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.22225570678711  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29804277420043945  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.24498176574707  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.246333599090576  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29450178146362305  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.93855905532837  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.939640998840332  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.30020999908447266  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.047046661376953  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.048128604888916  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3011345863342285  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.865199565887451  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.866279602050781  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.31348228454589844  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.31383991241455  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.314979076385498  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3147602081298828  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.248278617858887  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.249417781829834  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3120460510253906  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.867177486419678  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.868268966674805  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.32079505920410156  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.155760765075684  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.15685224533081  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.320343017578125  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.883248329162598  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.884320735931396  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3306608200073242  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.261039733886719  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.2626314163208  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3282761573791504  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.920484066009521  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.921784400939941  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.33090734481811523  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.881606101989746  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.882703304290771  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3442234992980957  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.302530288696289  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.303840160369873  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3459033966064453  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.261945247650146  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.263245582580566  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.35047435760498047  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.275990009307861  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.277544975280762  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.35250234603881836  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.14454174041748  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.145820140838623  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.35929155349731445  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.287240505218506  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.288408279418945  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3617739677429199  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.286638259887695  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.288074016571045  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36517810821533203  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.283132553100586  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.284837245941162  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3657073974609375  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.079814434051514  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.08151912689209  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36757898330688477  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.984610557556152  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.985996723175049  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.37183666229248047  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.952149868011475  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.953556060791016  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38134288787841797  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.305952072143555  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.307573795318604  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38044261932373047  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.044437408447266  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.045699119567871  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3826279640197754  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.965823650360107  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.966987609863281  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3868985176086426  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.992351531982422  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.993510723114014  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38950347900390625  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.944580078125  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.945641040802002  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.39358043670654297  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.01512861251831  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.016804218292236  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3989992141723633  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.084687232971191  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.086241722106934  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

number of input  21418725
----------------------------------------after optimizer
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.41060972213745117  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2746968269348145
pure train time :  5.535682916641235
the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 0.443 seconds, peak memory: 42.541 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.541 GB
Metis partitioning: 2.019 seconds, peak memory: 42.541 GB
Split the graph: 0.837 seconds
Construct subgraphs: 0.041 seconds
metis partition ---------------pure dgl.metis_partition spent  3.348468780517578
6242
6204
6299
6297
6024
6144
5975
6307
6296
6026
6202
5985
6291
6003
5973
6325
6242
6260
6139
6258
6286
6247
6142
6049
6000
6256
6049
5995
6005
5963
6011
6076
metis partition time  3.3521664142608643
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009664535522460938
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.3702921867370605
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  9.28463077545166
self.buckets_partition() spend  sec:  3.380014181137085
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2859978675842285  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.150384426116943  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.148093223571777  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2856607437133789  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.104526996612549  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.105664253234863  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29140186309814453  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.226131439208984  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.22733736038208  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29795360565185547  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.272704601287842  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.273927211761475  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29361629486083984  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.88084363937378  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.882545471191406  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3006782531738281  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.058953762054443  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.06063175201416  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.300504207611084  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.804608345031738  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.805701732635498  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3134498596191406  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.262503623962402  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.263770580291748  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3165569305419922  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.276435852050781  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.277762413024902  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3141183853149414  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.974538803100586  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.975830078125  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.320833683013916  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.157704830169678  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.159631252288818  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3197011947631836  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.847798347473145  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.84886121749878  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.33205366134643555  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.300066947937012  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.301303386688232  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3282489776611328  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.90438985824585  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.905964851379395  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3308548927307129  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.893671035766602  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.894758701324463  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3446168899536133  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.35215139389038  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.353259563446045  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.34465980529785156  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.201685905456543  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.20298719406128  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3495907783508301  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.272792339324951  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.274499416351318  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.35184621810913086  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.108070850372314  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.109169483184814  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3577880859375  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.286596298217773  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.288140773773193  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3613290786743164  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.281546115875244  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.283090591430664  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3649425506591797  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.281062126159668  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.282294750213623  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36656999588012695  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.122697353363037  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.123803615570068  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36668825149536133  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.99681282043457  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.997919082641602  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.37038087844848633  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.941248416900635  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.942347526550293  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3795771598815918  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.30186128616333  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.302960395812988  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3799281120300293  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.024912357330322  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.026105880737305  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38149356842041016  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.94081735610962  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.941880226135254  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3866901397705078  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.982406616210938  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.983463764190674  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3898444175720215  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.946436882019043  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.94749402999878  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3935856819152832  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.98534107208252  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.986901760101318  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.39884233474731445  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.070585250854492  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.07168436050415  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

number of input  21415728
----------------------------------------after optimizer
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.41086673736572266  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1769829988479614
pure train time :  5.383413314819336
the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 0.513 seconds, peak memory: 42.541 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.541 GB
Metis partitioning: 2.060 seconds, peak memory: 42.541 GB
Split the graph: 0.542 seconds
Construct subgraphs: 0.040 seconds
metis partition ---------------pure dgl.metis_partition spent  3.163771152496338
6242
6204
6299
6297
6024
6144
5975
6307
6296
6026
6202
5985
6291
6003
5973
6325
6242
6260
6139
6258
6286
6247
6142
6049
6000
6256
6049
5995
6005
5963
6011
6076
metis partition time  3.1674692630767822
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010830879211425781
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1860122680664062
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  9.011266946792603
self.buckets_partition() spend  sec:  3.196889877319336
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.28542375564575195  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.143046855926514  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.140369415283203  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.287752628326416  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.150703430175781  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.151832103729248  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29370880126953125  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.289064884185791  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.290265083312988  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2972145080566406  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.256672859191895  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.257828712463379  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29483985900878906  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.911600112915039  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.912842273712158  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3018207550048828  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.093287944793701  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.094940185546875  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3004164695739746  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.824530124664307  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.825629234313965  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.31251001358032227  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.267118453979492  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.268388271331787  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.31298208236694336  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.197465419769287  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.198675155639648  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.31362152099609375  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.911474227905273  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.912683963775635  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3211984634399414  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.150129795074463  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.151394844055176  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.320892333984375  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.895810604095459  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.896873474121094  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.33275938034057617  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.279285430908203  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.280686855316162  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3285198211669922  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.897668838500977  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.89875078201294  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3320298194885254  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.896693229675293  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.89775800704956  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3424239158630371  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.29024076461792  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.291687488555908  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.34788942337036133  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.274414539337158  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.275850296020508  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.35024070739746094  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.273239612579346  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.274573802947998  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.35089588165283203  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.085005760192871  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.086484432220459  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3571200370788574  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.244091987609863  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.245258808135986  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3605680465698242  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.281651973724365  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.282818794250488  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36458683013916016  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.238695621490479  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.240002155303955  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3649725914001465  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.106933116912842  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.108239650726318  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3704414367675781  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.051604747772217  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.05292797088623  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3699460029602051  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.931542873382568  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.932641506195068  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3806118965148926  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.300796508789062  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.302467346191406  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38054943084716797  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.052807807922363  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.053943157196045  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38167619705200195  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.959863662719727  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.961223602294922  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3858604431152344  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.975255012512207  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.976306915283203  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3892049789428711  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.940865516662598  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.941916942596436  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.39386796951293945  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.979721069335938  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.980968952178955  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3990659713745117  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.07933235168457  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.08050012588501  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

number of input  21427009
----------------------------------------after optimizer
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.4118189811706543  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.08335542678833
pure train time :  5.412734746932983
the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 0.565 seconds, peak memory: 42.557 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.557 GB
Metis partitioning: 2.053 seconds, peak memory: 42.557 GB
Split the graph: 0.907 seconds
Construct subgraphs: 0.043 seconds
metis partition ---------------pure dgl.metis_partition spent  3.5846126079559326
6242
6204
6299
6297
6024
6144
5975
6307
6296
6026
6202
5985
6291
6003
5973
6325
6242
6260
6139
6258
6286
6247
6142
6049
6000
6256
6049
5995
6005
5963
6011
6076
metis partition time  3.588340997695923
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009610652923583984
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.6040103435516357
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  9.440473079681396
self.buckets_partition() spend  sec:  3.613670825958252
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.285738468170166  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.199289321899414  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.197168827056885  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2870965003967285  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.105334281921387  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.106454372406006  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.293673038482666  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.29393196105957  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.295076847076416  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29699039459228516  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.231062412261963  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.232207298278809  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2937307357788086  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.902294158935547  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.903470993041992  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2990074157714844  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.02610969543457  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.027535915374756  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3007216453552246  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.850247383117676  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.85133695602417  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.31198883056640625  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.269944667816162  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.271260261535645  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.31781482696533203  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.27776575088501  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.279081344604492  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3139028549194336  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.929986476898193  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.931590557098389  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.32093000411987305  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.152294158935547  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.153671741485596  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3206062316894531  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.884467124938965  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.885556697845459  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3332371711730957  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.300396919250488  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.301636695861816  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.32874298095703125  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.887008666992188  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.888081073760986  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3309512138366699  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.885208129882812  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.886265277862549  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3428840637207031  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.343832969665527  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.345000267028809  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3456301689147949  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.268036365509033  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.269203662872314  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.34815168380737305  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.21056604385376  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.211750507354736  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3495621681213379  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.066690444946289  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.068087577819824  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.35718631744384766  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.283959865570068  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.285570621490479  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36189746856689453  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.30590009689331  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.307300567626953  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36548280715942383  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.242234706878662  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.243414878845215  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36673402786254883  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.160411834716797  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.161728382110596  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3653111457824707  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.971944808959961  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.973295211791992  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.37148618698120117  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.963108539581299  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.964163780212402  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.37975597381591797  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.257873058319092  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.25917673110962  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3797311782836914  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.014829635620117  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.01597785949707  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3815174102783203  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.950032711029053  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.951609134674072  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3869643211364746  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.997045516967773  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.998261451721191  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3902316093444824  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.964497566223145  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.965548992156982  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3922286033630371  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.96033000946045  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.961418628692627  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.40006542205810547  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.077627182006836  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.078749656677246  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

number of input  21415848
----------------------------------------after optimizer
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.4120292663574219  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.003145694732666
pure train time :  5.407952785491943
the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 0.508 seconds, peak memory: 42.592 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.592 GB
Metis partitioning: 2.045 seconds, peak memory: 42.606 GB
Split the graph: 0.816 seconds
Construct subgraphs: 0.041 seconds
metis partition ---------------pure dgl.metis_partition spent  3.4254651069641113
6242
6204
6299
6297
6024
6144
5975
6307
6296
6026
6202
5985
6291
6003
5973
6325
6242
6260
6139
6258
6286
6247
6142
6049
6000
6256
6049
5995
6005
5963
6011
6076
metis partition time  3.42923641204834
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010643720626831055
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.4485132694244385
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  9.316135168075562
self.buckets_partition() spend  sec:  3.4592061042785645
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2874622344970703  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.217644214630127  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.215322494506836  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2865452766418457  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.099189758300781  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.100473403930664  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2937283515930176  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.255706310272217  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.256825923919678  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2966146469116211  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.25398588180542  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.25515079498291  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2933053970336914  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.867201805114746  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.868643283843994  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3018155097961426  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.097621440887451  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.098952293395996  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.30039453506469727  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.854397296905518  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.8560152053833  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3132200241088867  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.314436912536621  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.315579891204834  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3156137466430664  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.252307891845703  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.253450870513916  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3133864402770996  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.932928085327148  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.934359073638916  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.32189083099365234  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.181751251220703  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.183267593383789  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.32060956954956055  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.877980709075928  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.879066467285156  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3309154510498047  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.259627342224121  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.261180400848389  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.327817440032959  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.90705680847168  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.9086275100708  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.33130550384521484  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.885866165161133  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.887342929840088  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3443179130554199  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.349698066711426  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.35085391998291  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3454732894897461  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.218518257141113  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.219674110412598  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3497042655944824  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.272437572479248  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.274068355560303  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3509039878845215  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.073668479919434  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.075286388397217  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.35700225830078125  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.27527904510498  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.276894092559814  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3616471290588379  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.287973403930664  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.289153575897217  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3639674186706543  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.206119537353516  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.207239627838135  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36597204208374023  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.1536545753479  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.155152320861816  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3667764663696289  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.97783374786377  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.979519367218018  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.37078189849853516  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.944794178009033  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.945918083190918  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3788156509399414  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.241404056549072  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.242527961730957  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3792915344238281  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.037536144256592  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.038700103759766  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38202619552612305  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.974283218383789  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.975418090820312  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3876466751098633  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.975433826446533  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.976999759674072  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3885183334350586  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.903589248657227  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.904640674591064  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.39385366439819336  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.978775978088379  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.979920864105225  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.40020179748535156  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.114881038665771  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.116001605987549  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

number of input  21416436
----------------------------------------after optimizer
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.4123234748840332  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9537435173988342
pure train time :  5.426246166229248
the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 0.419 seconds, peak memory: 42.606 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.606 GB
Metis partitioning: 2.018 seconds, peak memory: 42.606 GB
Split the graph: 1.426 seconds
Construct subgraphs: 0.042 seconds
metis partition ---------------pure dgl.metis_partition spent  3.9131736755371094
6242
6204
6299
6297
6024
6144
5975
6307
6296
6026
6202
5985
6291
6003
5973
6325
6242
6260
6139
6258
6286
6247
6142
6049
6000
6256
6049
5995
6005
5963
6011
6076
metis partition time  3.9168741703033447
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010697603225708008
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.933854579925537
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  9.704864740371704
self.buckets_partition() spend  sec:  3.94460129737854
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2871222496032715  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.206975936889648  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.204774379730225  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.286043643951416  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.100231170654297  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.101583003997803  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2936739921569824  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.236206531524658  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.237573623657227  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2960677146911621  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.234371662139893  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.235738754272461  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.294553279876709  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.911588668823242  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.912949085235596  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.30170774459838867  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.098289489746094  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.099490642547607  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.301267147064209  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.863537788391113  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.864790439605713  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.31160926818847656  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.266600608825684  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.267940998077393  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.31559276580810547  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.248229026794434  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.249569416046143  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.31278228759765625  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.882651805877686  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.883718490600586  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3212137222290039  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.135522365570068  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.136616706848145  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3204364776611328  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.879371643066406  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.88045358657837  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.333526611328125  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.337677955627441  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.338779926300049  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3269615173339844  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.879989624023438  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.881067752838135  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3312535285949707  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.889759540557861  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.890837669372559  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3427925109863281  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.30528974533081  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.30662488937378  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.34618425369262695  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.205718040466309  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.207293033599854  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3491506576538086  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.279999256134033  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.281492710113525  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.351898193359375  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.146272659301758  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.14776611328125  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3578672409057617  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.239656925201416  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.240823745727539  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3618769645690918  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.302700996398926  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.304090976715088  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3651728630065918  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.285837173461914  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.287227153778076  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36685800552368164  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.160214900970459  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.16161823272705  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36795520782470703  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.011998176574707  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.013444423675537  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.37065982818603516  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.941964626312256  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.943164348602295  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3808269500732422  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.307639122009277  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.309187412261963  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3807373046875  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.078678131103516  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.079787254333496  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3813309669494629  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.961444854736328  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.963133335113525  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38543701171875  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.950559139251709  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.951614379882812  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3873467445373535  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.863199710845947  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.864279747009277  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3945436477661133  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.99491262435913  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.996177673339844  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.400240421295166  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.094411849975586  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.09562349319458  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

number of input  21424320
----------------------------------------after optimizer
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.41206932067871094  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9133439064025879
pure train time :  5.402766942977905
the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 0.506 seconds, peak memory: 42.606 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.606 GB
Metis partitioning: 2.094 seconds, peak memory: 42.606 GB
Split the graph: 0.752 seconds
Construct subgraphs: 0.039 seconds
metis partition ---------------pure dgl.metis_partition spent  3.3994932174682617
6242
6204
6299
6297
6024
6144
5975
6307
6296
6026
6202
5985
6291
6003
5973
6325
6242
6260
6139
6258
6286
6247
6142
6049
6000
6256
6049
5995
6005
5963
6011
6076
metis partition time  3.403244972229004
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009362936019897461
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.419074773788452
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  9.223753929138184
self.buckets_partition() spend  sec:  3.428612232208252
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.286959171295166  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.205527305603027  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.20329999923706  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.28568220138549805  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.088545799255371  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.089856624603271  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29327392578125  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.244019508361816  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.245275497436523  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29617786407470703  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.241557598114014  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.24295711517334  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2954287528991699  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.92558765411377  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.926721096038818  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3003120422363281  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.010860443115234  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.011936664581299  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3003072738647461  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.826347827911377  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.827445030212402  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3134498596191406  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.27838134765625  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.279548168182373  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.31433820724487305  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.236539363861084  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.237706184387207  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.313234806060791  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.914845943450928  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.916165351867676  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3204360008239746  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.156923294067383  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.158459186553955  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.32017993927001953  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.882521629333496  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.88410472869873  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3313279151916504  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.259312152862549  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.260870456695557  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3282909393310547  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.906144142150879  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.907235622406006  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.330747127532959  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.883841514587402  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.884894847869873  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.34418296813964844  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.296001434326172  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.29736852645874  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.34624481201171875  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.278029918670654  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.27920389175415  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.35155391693115234  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.276687622070312  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.278055667877197  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.35047483444213867  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.106000900268555  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.107122421264648  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3565225601196289  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.22174596786499  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.222867488861084  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36255836486816406  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.319539546966553  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.320790767669678  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3655672073364258  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.237732887268066  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.239102363586426  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3672919273376465  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.114130020141602  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.115499496459961  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3688230514526367  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.040504455566406  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.04217529296875  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3700871467590332  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.945280075073242  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.946335315704346  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38106632232666016  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.310105800628662  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.311272621154785  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.37984323501586914  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.005425453186035  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.006592273712158  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3830223083496094  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.975196838378906  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.97656774520874  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3860783576965332  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.97795820236206  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.979187965393066  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38900041580200195  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.916084289550781  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.91717004776001  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.393338680267334  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.974974155426025  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.97634506225586  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.4001431465148926  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.096822261810303  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.098000526428223  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

number of input  21425016
----------------------------------------after optimizer
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.41210508346557617  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.875777006149292
pure train time :  5.408588409423828
the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 0.463 seconds, peak memory: 42.606 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.606 GB
Metis partitioning: 2.015 seconds, peak memory: 42.606 GB
Split the graph: 1.148 seconds
Construct subgraphs: 0.041 seconds
metis partition ---------------pure dgl.metis_partition spent  3.674679756164551
6228
6263
6035
6025
5998
6102
6115
6075
6278
6272
6285
6312
6039
6229
6079
5968
5993
6225
5972
6176
6165
6167
5966
5978
5996
6272
6275
6180
6291
6280
6005
6327
metis partition time  3.6784441471099854
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01050257682800293
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.696368932723999
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  9.497363805770874
self.buckets_partition() spend  sec:  3.706921100616455
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.28613901138305664  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.158514976501465  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.155806541442871  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2882871627807617  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.222349643707275  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.223808765411377  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2861366271972656  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.894097328186035  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.895646095275879  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2892136573791504  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.879863739013672  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.88095235824585  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29236316680908203  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.862184047698975  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.863234996795654  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3000674247741699  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.991745471954346  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.993006229400635  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3033266067504883  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.014044761657715  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.015440940856934  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.30553150177001953  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.953278064727783  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.954376697540283  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.31558942794799805  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.285030364990234  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.28627061843872  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3205075263977051  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.255315780639648  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.256515979766846  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.324007511138916  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.275084972381592  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.276285171508789  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3285255432128906  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.30186128616333  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.30309772491455  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3259878158569336  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.96070671081543  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.961931705474854  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.33384180068969727  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.248914241790771  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.250519275665283  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.33482933044433594  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.037346839904785  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.038412094116211  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3366522789001465  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.865052700042725  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.86616325378418  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3383827209472656  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.903739929199219  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.904850482940674  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3484807014465332  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.171585083007812  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.172775745391846  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.34645748138427734  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.90424633026123  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.90532636642456  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.35437822341918945  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.109071731567383  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.110320091247559  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.35889577865600586  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.151859283447266  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.15351152420044  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36233091354370117  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.110174179077148  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.111511707305908  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36202239990234375  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.88370943069458  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.8848295211792  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36579370498657227  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.914735317230225  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.915851593017578  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.37025022506713867  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.958734512329102  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.959850788116455  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3805408477783203  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.303799152374268  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.305402278900146  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38501882553100586  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.330621242523193  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.331789016723633  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38539838790893555  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.197821617126465  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.199242115020752  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3927912712097168  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.327812194824219  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.32910442352295  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3959941864013672  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.331406116485596  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.33266830444336  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.39274168014526367  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.974281311035156  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.975340366363525  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.4055976867675781  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.413348197937012  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.414650440216064  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

number of input  21424770
----------------------------------------after optimizer
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.41822147369384766  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8382570743560791
pure train time :  5.408363342285156
the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 0.480 seconds, peak memory: 42.606 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.606 GB
Metis partitioning: 2.053 seconds, peak memory: 42.641 GB
Split the graph: 1.259 seconds
Construct subgraphs: 0.042 seconds
metis partition ---------------pure dgl.metis_partition spent  3.8480372428894043
6242
6204
6299
6297
6024
6144
5975
6307
6296
6026
6202
5985
6291
6003
5973
6325
6242
6260
6139
6258
6286
6247
6142
6049
6000
6256
6049
5995
6005
5963
6011
6076
metis partition time  3.851762056350708
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01087808609008789
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.86934757232666
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  9.663208484649658
self.buckets_partition() spend  sec:  3.8802781105041504
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2857551574707031  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.176441669464111  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.17367696762085  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.28641176223754883  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.125611782073975  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.126923084259033  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2926673889160156  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.243003845214844  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.244244575500488  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29633665084838867  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.251058578491211  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.252381324768066  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2950582504272461  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.895232200622559  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.896658897399902  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.30171823501586914  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.04281234741211  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.04414176940918  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29952383041381836  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.824090003967285  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.825149059295654  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.31160974502563477  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.260794639587402  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.261928081512451  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3171114921569824  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.287271499633789  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.28852367401123  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3132147789001465  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.910200119018555  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.911519050598145  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.32247304916381836  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.165196895599365  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.166359901428223  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.32039785385131836  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.889498710632324  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.890553951263428  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3298659324645996  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.215141296386719  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.216419696807861  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3282942771911621  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.928379535675049  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.929657936096191  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.33393239974975586  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.907409191131592  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.908477783203125  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3426809310913086  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.304336071014404  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.30566930770874  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.34527111053466797  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.220603942871094  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.221718788146973  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.34924888610839844  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.274235248565674  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.275394439697266  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.34953927993774414  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.038933277130127  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.040114879608154  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3592567443847656  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.297533512115479  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.298867225646973  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36035919189453125  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.282074928283691  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.283408641815186  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36468935012817383  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.248857021331787  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.250536441802979  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36628293991088867  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.104341506958008  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.105885982513428  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.37022876739501953  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.061723709106445  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.06291389465332  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.37000417709350586  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.93567705154419  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.93674373626709  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3803291320800781  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.30329942703247  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.304921627044678  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.37994909286499023  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.988870620727539  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.990492820739746  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3818092346191406  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.944175243377686  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.945475578308105  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3862037658691406  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.974776268005371  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.975980281829834  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3893284797668457  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.904494285583496  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.905589580535889  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.39318180084228516  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.961563110351562  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.963428020477295  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.39892148971557617  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.08506727218628  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.08654260635376  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

number of input  21406972
----------------------------------------after optimizer
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.4105343818664551  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7953740358352661
pure train time :  5.644535303115845
the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 0.472 seconds, peak memory: 42.641 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.641 GB
Metis partitioning: 1.964 seconds, peak memory: 42.641 GB
Split the graph: 0.881 seconds
Construct subgraphs: 0.032 seconds
metis partition ---------------pure dgl.metis_partition spent  3.3634231090545654
6228
6263
6035
6025
5998
6102
6115
6075
6278
6272
6285
6312
6039
6229
6079
5968
5993
6225
5972
6176
6165
6167
5966
5978
5996
6272
6275
6180
6291
6280
6005
6327
metis partition time  3.3671693801879883
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011137247085571289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.384382724761963
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  9.15658450126648
self.buckets_partition() spend  sec:  3.395569324493408
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.28489160537719727  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.122289657592773  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.120265007019043  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.28658103942871094  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.171515941619873  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.17264699935913  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2865943908691406  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.92449426651001  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.925625324249268  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2901782989501953  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.907691955566406  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.908857822418213  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2933382987976074  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.869633674621582  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.870858669281006  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29985475540161133  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.011453628540039  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.01326036453247  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.30258750915527344  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.015732288360596  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.017205715179443  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3078484535217285  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.984639167785645  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.985751152038574  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3149995803833008  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.251071453094482  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.252482414245605  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3189973831176758  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.24945878982544  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.250792980194092  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.32225751876831055  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.246846675872803  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.248079299926758  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.32711267471313477  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.277031421661377  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.278212547302246  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.32453203201293945  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.920074939727783  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.921375274658203  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3329300880432129  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.1438307762146  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.145087718963623  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3340473175048828  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.007418155670166  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.008483409881592  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.33565855026245117  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.888375759124756  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.889482498168945  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.34047985076904297  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.925700187683105  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.926768779754639  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3487544059753418  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.213260173797607  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.21470594406128  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3462357521057129  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.858949184417725  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.860018253326416  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.35547447204589844  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.166339874267578  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.16756296157837  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.35910749435424805  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.122486591339111  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.123709678649902  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36393117904663086  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.161621570587158  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.162914752960205  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3628392219543457  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.92257022857666  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.923669338226318  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3657255172729492  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.94015121459961  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.941250324249268  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.37032222747802734  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.945237636566162  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.946319580078125  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38222455978393555  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.314090728759766  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.315553188323975  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3838005065917969  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.316361904144287  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.317831993103027  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3855562210083008  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.19041919708252  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.19170618057251  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.39114952087402344  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.332094669342041  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.333198070526123  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3976287841796875  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.330908298492432  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.332347393035889  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3936948776245117  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.94977331161499  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.950847625732422  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.4062380790710449  GigaBytes
Max Memory Allocated: 9.55965805053711  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.42620038986206  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.428013324737549  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

number of input  21429604
----------------------------------------after optimizer
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.4188542366027832  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7597897052764893
pure train time :  5.413006067276001
the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 0.486 seconds, peak memory: 42.641 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.641 GB
Metis partitioning: 2.081 seconds, peak memory: 42.646 GB
Split the graph: 0.846 seconds
Construct subgraphs: 0.032 seconds
metis partition ---------------pure dgl.metis_partition spent  3.4592397212982178
6242
6204
6299
6297
6024
6144
5975
6307
6296
6026
6202
5985
6291
6003
5973
6325
6242
6260
6139
6258
6286
6247
6142
6049
6000
6256
6049
5995
6005
5963
6011
6076
metis partition time  3.463024854660034
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010683774948120117
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.4804749488830566
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  9.257766962051392
self.buckets_partition() spend  sec:  3.49120831489563
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.28660011291503906  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.165338039398193  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.1625394821167  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2862982749938965  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.122442245483398  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.123619079589844  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.293881893157959  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.259835720062256  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.261002540588379  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2959623336791992  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.240530014038086  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.241696834564209  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2945518493652344  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.91694974899292  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.91844129562378  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3010077476501465  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.094332695007324  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.095663070678711  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.30098676681518555  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.859700202941895  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.860803127288818  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.31114768981933594  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.261981964111328  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.263340950012207  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.31709766387939453  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.25699520111084  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.258354187011719  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3146209716796875  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.925727844238281  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.927148818969727  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.322934627532959  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.165934085845947  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.167584419250488  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.32062339782714844  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.888655662536621  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.889796733856201  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3309602737426758  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.264369487762451  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.265510559082031  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3299837112426758  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.950623512268066  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.951676845550537  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.32976484298706055  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.837122917175293  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.838176250457764  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3433666229248047  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.310221672058105  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.311330318450928  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.34436750411987305  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.212310314178467  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.213651180267334  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3494086265563965  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.26789140701294  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.269124031066895  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.35056209564208984  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.107125282287598  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.108251094818115  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3563566207885742  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.206516742706299  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.207642555236816  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.36201000213623047  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.313365936279297  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.314725399017334  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3662285804748535  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.29224681854248  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.293606281280518  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3663935661315918  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.082006454467773  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.083266258239746  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3680858612060547  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.984882354736328  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.9861421585083  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.37072181701660156  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.945217609405518  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.94665241241455  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38082075119018555  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.307222843170166  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.30886173248291  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3787379264831543  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.000538349151611  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.001917362213135  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38159751892089844  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.934380054473877  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.935465812683105  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3865795135498047  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.9969162940979  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.997968196868896  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.38909482955932617  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.910123825073242  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.911245822906494  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.39319753646850586  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.983519077301025  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 8.984641075134277  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.39908790588378906  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.073316097259521  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.074583053588867  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

number of input  21414150
----------------------------------------after optimizer
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.4111518859863281  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7312926054000854
pure train time :  5.443749904632568
the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 0.521 seconds, peak memory: 42.646 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.646 GB
Metis partitioning: 2.166 seconds, peak memory: 42.646 GB
Split the graph: 1.251 seconds
Construct subgraphs: 0.040 seconds
metis partition ---------------pure dgl.metis_partition spent  3.99139404296875
6168
6324
6322
6146
6327
5963
5969
6327
6148
5963
5978
5963
5964
6146
5963
6190
5969
6146
6294
6172
6327
6262
6148
5973
6327
6293
6327
6275
6055
6202
5975
5965
metis partition time  3.9951226711273193
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009695291519165039
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.01148533821106
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  9.787904262542725
self.buckets_partition() spend  sec:  4.021235704421997
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2842435836791992  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.080417156219482  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.077882766723633  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.28853940963745117  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.227586269378662  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.229095935821533  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.2927265167236328  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.250847816467285  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.252113819122314  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.29458093643188477  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.09304428100586  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 9.094396114349365  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.35693359375 GB
    Memory Allocated: 0.3023247718811035  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.33878469467163  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.340029239654541  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.29540395736694336  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.771277904510498  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.772420883178711  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.30085325241088867  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.854660511016846  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.855727195739746  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.31349754333496094  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.270825862884521  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.27216625213623  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.31363725662231445  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.11634874343872  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.117666244506836  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.3125481605529785  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.862951755523682  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.864031791687012  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.31640625  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.815427303314209  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.816507339477539  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.3200950622558594  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.880380153656006  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.881433963775635  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.32268810272216797  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.842392444610596  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.843470573425293  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.3305840492248535  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.090578079223633  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.09165620803833  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.3303709030151367  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.835193157196045  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.836297988891602  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.339813232421875  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.18431806564331  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.185422897338867  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.3387789726257324  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.899504661560059  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.900636196136475  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.34639787673950195  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.141594886779785  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.142726421356201  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.35344505310058594  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.317142963409424  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.31840467453003  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.35418081283569336  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.148193836212158  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.149519920349121  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.3626136779785156  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.36585521697998  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.366966247558594  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.36348724365234375  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.241157054901123  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.242268085479736  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.36749935150146484  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.1691255569458  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.170365810394287  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.3653531074523926  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.887269973754883  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.888329029083252  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.3787569999694824  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.38821029663086  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.39005994796753  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.381380558013916  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.312845706939697  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.314231872558594  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.38525390625  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.388411521911621  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.389557838439941  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.388671875  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.286113739013672  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.287260055541992  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.38518476486206055  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.022751331329346  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.024051666259766  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.39385318756103516  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.218467712402344  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.219577312469482  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.39266252517700195  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.951445579528809  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.952529430389404  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.39649009704589844  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.919672012329102  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.920755863189697  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

number of input  21415092
----------------------------------------after optimizer
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.4087367057800293  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7027394771575928
pure train time :  5.4728734493255615
the output layer 
self.num_batch (get_in_degree_bucketing) 32
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  32
Convert a graph into a bidirected graph: 0.509 seconds, peak memory: 47.072 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.072 GB
Metis partitioning: 2.055 seconds, peak memory: 47.145 GB
Split the graph: 0.684 seconds
Construct subgraphs: 0.031 seconds
metis partition ---------------pure dgl.metis_partition spent  3.292243003845215
6228
6263
6035
6025
5998
6102
6115
6075
6278
6272
6285
6312
6039
6229
6079
5968
5993
6225
5972
6176
6165
6167
5966
5978
5996
6272
6275
6180
6291
6280
6005
6327
metis partition time  3.295999526977539
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010401248931884766
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.312655210494995
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  9.067909479141235
self.buckets_partition() spend  sec:  3.3231041431427
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.28522396087646484  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.139804363250732  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.137685775756836  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.28834009170532227  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.162947654724121  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.164291381835938  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.28621387481689453  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.891767978668213  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.89285659790039  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.29059362411499023  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.89772367477417  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.898812294006348  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.2941598892211914  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.881014347076416  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.882075309753418  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.2982654571533203  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.999264240264893  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.000333309173584  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.303530216217041  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.03586196899414  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.037154197692871  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.30594301223754883  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.941876411437988  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.943335056304932  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.3163471221923828  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.27298879623413  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.274296760559082  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.31880760192871094  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.24371337890625  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.244912147521973  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.32369136810302734  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.271649360656738  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.272848129272461  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.3290443420410156  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.328380584716797  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.329550743103027  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.32463502883911133  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.939229488372803  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.940756797790527  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.3335103988647461  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.201495170593262  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.202981948852539  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.33357954025268555  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.020668983459473  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.022016525268555  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.33492565155029297  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.858598709106445  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.859681129455566  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.33971214294433594  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.937073230743408  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.938302993774414  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.3479270935058594  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.184905052185059  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.186134815216064  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.34612035751342773  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.909690856933594  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.910778522491455  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.35491132736206055  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.165134906768799  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.16622257232666  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.3590846061706543  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.157844543457031  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.159170627593994  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.36202478408813477  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.161762237548828  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.163059711456299  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  22
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.36309385299682617  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.949797630310059  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.95085859298706  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  23
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.3666529655456543  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.934429168701172  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.935490131378174  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  24
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.3700590133666992  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.937676429748535  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.938745021820068  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  25
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.37943506240844727  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.32180118560791  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.323066234588623  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  26
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.3836832046508789  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.326183319091797  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.327586650848389  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  27
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.3851766586303711  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.135592460632324  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.136751651763916  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  28
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.391817569732666  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.334089756011963  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.335543155670166  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  29
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.39489221572875977  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.276959896087646  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.278159141540527  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  30
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.3928947448730469  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.957956790924072  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 8.959541320800781  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

step  31
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.40448713302612305  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.375302791595459  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 9.376509189605713  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

number of input  21417641
----------------------------------------after optimizer
 Nvidia-smi: 21.47802734375 GB
    Memory Allocated: 0.4167799949645996  GigaBytes
Max Memory Allocated: 9.572938919067383  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6752028465270996
pure train time :  5.440913677215576
epoch_time_list  [37.01696252822876, 34.36207413673401, 35.53047323226929, 33.98138976097107, 32.580024003982544, 33.31953144073486, 32.70117664337158, 32.5990149974823, 32.19814586639404, 32.137280225753784, 32.43469715118408, 32.56874108314514, 33.255637407302856, 31.822508811950684, 32.1786584854126, 33.270673513412476, 31.62937021255493, 31.985997676849365, 32.329317569732666, 31.986158847808838]

loading_time list   [0.5413227081298828, 0.6180367469787598, 0.561450719833374, 0.5600278377532959, 0.41283488273620605, 0.4313027858734131, 0.5017576217651367, 0.4526662826538086, 0.39573025703430176, 0.5010876655578613, 0.4435751438140869, 0.519193172454834, 0.5075550079345703, 0.4102137088775635, 0.43829941749572754, 0.49634790420532227, 0.45314455032348633, 0.4681079387664795, 0.4992492198944092, 0.4863414764404297]

 data loader gen time  21.64009714126587
	---backpack schedule time  [9.936198949813843, 9.510032176971436, 9.977127313613892, 9.501543283462524, 9.032249927520752, 9.81699538230896, 9.065465688705444, 9.489817142486572, 9.364818334579468, 9.089590787887573, 9.517664194107056, 9.390320777893066, 9.781776189804077, 9.306097507476807, 9.567333459854126, 9.72257924079895, 9.218793630599976, 9.33431077003479, 9.844743728637695, 9.124108791351318]
	---connection_check_time_list  [7.404127836227417, 7.759722948074341, 8.43942666053772, 7.772120714187622, 7.120524644851685, 6.939839601516724, 7.028674840927124, 6.569449186325073, 6.437711954116821, 6.8320088386535645, 6.385325908660889, 6.479762554168701, 7.027157306671143, 6.265564680099487, 6.301098823547363, 6.863271951675415, 6.210502624511719, 6.221387624740601, 6.171726942062378, 6.446470022201538]
	---block_gen_time_list  [5.971419334411621, 5.768247842788696, 6.088019371032715, 5.387903690338135, 5.564874649047852, 5.484082937240601, 5.686141014099121, 5.570095062255859, 5.543100357055664, 5.263673305511475, 5.487284421920776, 5.715167284011841, 5.521796941757202, 5.361865520477295, 5.408835172653198, 5.5064215660095215, 5.290550947189331, 5.441737651824951, 5.35176420211792, 5.47119927406311]
training time  [12.55625581741333, 10.03816270828247, 9.789546966552734, 10.124716997146606, 9.796756267547607, 10.013415813446045, 9.75625729560852, 9.88300085067749, 9.799921035766602, 9.807682037353516, 9.958726167678833, 9.822577238082886, 9.780613899230957, 9.84572148323059, 9.823997735977173, 10.048859596252441, 9.813353300094604, 9.88072395324707, 9.819650411605835, 9.819332361221313]
---feature block loading time  [4.539708375930786, 4.594580411911011, 3.7369022369384766, 4.258213758468628, 4.334763765335083, 4.346991777420044, 4.304654598236084, 4.268343210220337, 4.337867021560669, 4.296176910400391, 4.474900484085083, 4.320922136306763, 4.298933506011963, 4.3633527755737305, 4.337742567062378, 4.330067157745361, 4.308966398239136, 4.341875314712524, 4.2720115184783936, 4.29591965675354]


epoch_time avg   32.43730837106705
loading_time avg   0.4635879397392273
 data loader gen time avg 22.078165844082832
	---backpack schedule time avg 9.416666597127914
	---connection_check_time avg  6.581279844045639
	---block_gen_time avg  5.479286894202232
training time  9.854411840438843
---feature block loading time  4.3270930498838425
pure train time per /epoch  [7.978604316711426, 5.366335391998291, 5.948675155639648, 5.77951192855835, 5.384113073348999, 5.587265968322754, 5.374127626419067, 5.535682916641235, 5.383413314819336, 5.412734746932983, 5.407952785491943, 5.426246166229248, 5.402766942977905, 5.408588409423828, 5.408363342285156, 5.644535303115845, 5.413006067276001, 5.443749904632568, 5.4728734493255615, 5.440913677215576]
pure train time average  5.46622621311861
num_input list  [21428548, 21415806, 21415256, 21417805, 21425844, 21416002, 21422736, 21418725, 21415728, 21427009, 21415848, 21416436, 21424320, 21425016, 21424770, 21406972, 21429604, 21414150, 21415092, 21417641]
num_input  average  21419665.4
