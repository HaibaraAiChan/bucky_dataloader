main start at this time 1713153263.508993
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 1.274 seconds, peak memory: 19.342 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 19.342 GB
Metis partitioning: 2.089 seconds, peak memory: 19.654 GB
Split the graph: 0.559 seconds
Construct subgraphs: 0.028 seconds
metis partition ---------------pure dgl.metis_partition spent  3.96101450920105
9826
9637
9993
9681
10009
9748
10098
9853
9633
10050
9638
9639
9779
9551
9928
9673
10083
9627
10051
10074
metis partition time  3.965888023376465
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009282827377319336
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.9796078205108643
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.515216112136841
self.buckets_partition() spend  sec:  3.988924980163574
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.85888671875 GB
    Memory Allocated: 0.3321714401245117  GigaBytes
Max Memory Allocated: 0.3321714401245117  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.35498046875 GB
    Memory Allocated: 13.534242630004883  GigaBytes
Max Memory Allocated: 13.759466171264648  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.35498046875 GB
    Memory Allocated: 13.536293983459473  GigaBytes
Max Memory Allocated: 13.759466171264648  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.36279296875 GB
    Memory Allocated: 0.35796594619750977  GigaBytes
Max Memory Allocated: 13.759466171264648  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.07958984375 GB
    Memory Allocated: 13.403159141540527  GigaBytes
Max Memory Allocated: 13.759466171264648  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.07958984375 GB
    Memory Allocated: 13.405210018157959  GigaBytes
Max Memory Allocated: 13.759466171264648  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.07958984375 GB
    Memory Allocated: 0.36915016174316406  GigaBytes
Max Memory Allocated: 13.759466171264648  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.80224609375 GB
    Memory Allocated: 13.831052780151367  GigaBytes
Max Memory Allocated: 14.06287956237793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.80224609375 GB
    Memory Allocated: 13.832924842834473  GigaBytes
Max Memory Allocated: 14.06287956237793  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.80224609375 GB
    Memory Allocated: 0.36834716796875  GigaBytes
Max Memory Allocated: 14.06287956237793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.80810546875 GB
    Memory Allocated: 13.362679958343506  GigaBytes
Max Memory Allocated: 14.06287956237793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.80810546875 GB
    Memory Allocated: 13.365058898925781  GigaBytes
Max Memory Allocated: 14.06287956237793  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.80810546875 GB
    Memory Allocated: 0.38211822509765625  GigaBytes
Max Memory Allocated: 14.06287956237793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.81396484375 GB
    Memory Allocated: 13.840875625610352  GigaBytes
Max Memory Allocated: 14.073275566101074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.81396484375 GB
    Memory Allocated: 13.842628955841064  GigaBytes
Max Memory Allocated: 14.073275566101074  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.81396484375 GB
    Memory Allocated: 0.3840780258178711  GigaBytes
Max Memory Allocated: 14.073275566101074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.82763671875 GB
    Memory Allocated: 13.513570308685303  GigaBytes
Max Memory Allocated: 14.073275566101074  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.82763671875 GB
    Memory Allocated: 13.515384674072266  GigaBytes
Max Memory Allocated: 14.073275566101074  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.82763671875 GB
    Memory Allocated: 0.3946371078491211  GigaBytes
Max Memory Allocated: 14.073275566101074  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.79833984375 GB
    Memory Allocated: 13.90114974975586  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.79833984375 GB
    Memory Allocated: 13.902918338775635  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.79833984375 GB
    Memory Allocated: 0.396878719329834  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.79833984375 GB
    Memory Allocated: 13.605637550354004  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.79833984375 GB
    Memory Allocated: 13.607577800750732  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.79833984375 GB
    Memory Allocated: 0.4002532958984375  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.79833984375 GB
    Memory Allocated: 13.396459579467773  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.79833984375 GB
    Memory Allocated: 13.398399829864502  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.79833984375 GB
    Memory Allocated: 0.4126300811767578  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.54638671875 GB
    Memory Allocated: 13.855993747711182  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.54638671875 GB
    Memory Allocated: 13.858520030975342  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.54638671875 GB
    Memory Allocated: 0.41199731826782227  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.54638671875 GB
    Memory Allocated: 13.364533424377441  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.54638671875 GB
    Memory Allocated: 13.366940975189209  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.54638671875 GB
    Memory Allocated: 0.4178338050842285  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.54638671875 GB
    Memory Allocated: 13.372775554656982  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.54638671875 GB
    Memory Allocated: 13.374492645263672  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.54638671875 GB
    Memory Allocated: 0.42508506774902344  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.56005859375 GB
    Memory Allocated: 13.537420272827148  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.56005859375 GB
    Memory Allocated: 13.539547443389893  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.56005859375 GB
    Memory Allocated: 0.42870092391967773  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.58349609375 GB
    Memory Allocated: 13.29149341583252  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.58349609375 GB
    Memory Allocated: 13.293470859527588  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.58349609375 GB
    Memory Allocated: 0.44267702102661133  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.58349609375 GB
    Memory Allocated: 13.751136302947998  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.58349609375 GB
    Memory Allocated: 13.752944946289062  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.58349609375 GB
    Memory Allocated: 0.44237852096557617  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.58349609375 GB
    Memory Allocated: 13.473254203796387  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.58349609375 GB
    Memory Allocated: 13.475062847137451  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.58349609375 GB
    Memory Allocated: 0.45525693893432617  GigaBytes
Max Memory Allocated: 14.133721828460693  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.58349609375 GB
    Memory Allocated: 13.924267292022705  GigaBytes
Max Memory Allocated: 14.156757831573486  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.58349609375 GB
    Memory Allocated: 13.926242351531982  GigaBytes
Max Memory Allocated: 14.156757831573486  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.58349609375 GB
    Memory Allocated: 0.4543781280517578  GigaBytes
Max Memory Allocated: 14.156757831573486  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.59326171875 GB
    Memory Allocated: 13.415527820587158  GigaBytes
Max Memory Allocated: 14.156757831573486  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.59326171875 GB
    Memory Allocated: 13.417582511901855  GigaBytes
Max Memory Allocated: 14.156757831573486  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.59326171875 GB
    Memory Allocated: 0.4680757522583008  GigaBytes
Max Memory Allocated: 14.156757831573486  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.59326171875 GB
    Memory Allocated: 13.924744606018066  GigaBytes
Max Memory Allocated: 14.156757831573486  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.59326171875 GB
    Memory Allocated: 13.926801204681396  GigaBytes
Max Memory Allocated: 14.156757831573486  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.59326171875 GB
    Memory Allocated: 0.4738898277282715  GigaBytes
Max Memory Allocated: 14.156757831573486  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.958820819854736  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.96060848236084  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

number of input  16996178
----------------------------------------after optimizer
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.49547481536865234  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.193971157073975
pure train time :  6.646196126937866
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 0.561 seconds, peak memory: 46.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.476 GB
Metis partitioning: 2.090 seconds, peak memory: 46.476 GB
Split the graph: 0.726 seconds
Construct subgraphs: 0.031 seconds
metis partition ---------------pure dgl.metis_partition spent  3.4209020137786865
9615
9566
9688
9957
10020
9910
10093
9584
9581
9806
9998
9588
9999
9608
10027
9613
9865
10030
9948
10075
metis partition time  3.425832748413086
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011726617813110352
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.4418230056762695
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.006452798843384
self.buckets_partition() spend  sec:  3.453591823577881
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.3571958541870117  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.31423807144165  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.310412406921387  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.3580937385559082  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.243500709533691  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.245372295379639  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.3656597137451172  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.409602165222168  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.411312580108643  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.37779951095581055  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.794509887695312  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.796284198760986  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.3816089630126953  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.808647632598877  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.810910701751709  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.3869352340698242  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.645707607269287  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.64759635925293  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.39656639099121094  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.8721923828125  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.874081134796143  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.39446115493774414  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.277101039886475  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.279038906097412  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.39867496490478516  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.273053646087646  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.274957656860352  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.4086732864379883  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.55307674407959  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.555219173431396  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.4188666343688965  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.828943729400635  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.830787181854248  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.4195079803466797  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.377796173095703  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.38019609451294  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.4310450553894043  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.813101768493652  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.815584659576416  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.4325246810913086  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.342275142669678  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.344421863555908  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.4432382583618164  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.856061458587646  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.857817649841309  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.44263792037963867  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.398492813110352  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.400858402252197  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.4541492462158203  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.710595607757568  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.71255874633789  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.4630851745605469  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.898418426513672  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.900381565093994  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.46807336807250977  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.859707832336426  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.861510753631592  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.4743518829345703  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.946430683135986  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.948233604431152  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

number of input  16978752
----------------------------------------after optimizer
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.49472808837890625  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.477254867553711
pure train time :  3.9428257942199707
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 0.584 seconds, peak memory: 46.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.476 GB
Metis partitioning: 2.062 seconds, peak memory: 46.476 GB
Split the graph: 1.163 seconds
Construct subgraphs: 0.034 seconds
metis partition ---------------pure dgl.metis_partition spent  3.8533103466033936
9826
9637
9993
9681
10009
9748
10098
9853
9633
10050
9638
9639
9779
9551
9928
9673
10083
9627
10051
10074
metis partition time  3.8583366870880127
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01313018798828125
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.8772010803222656
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.484538793563843
self.buckets_partition() spend  sec:  3.890375852584839
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.36046934127807617  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.559823513031006  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.555586814880371  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.3577694892883301  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.305521011352539  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.307920932769775  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.3710761070251465  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.745742321014404  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.747570037841797  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.3712177276611328  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.370124340057373  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 13.371952056884766  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.60498046875 GB
    Memory Allocated: 0.3830389976501465  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.8014235496521  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.803483486175537  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.3856849670410156  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.55052661895752  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.55262804031372  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.3965015411376953  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.8901948928833  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.892061710357666  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.39928245544433594  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.60386610031128  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.605830192565918  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.40363216400146484  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.411190509796143  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.413154602050781  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.41510438919067383  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.896915435791016  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.898777484893799  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.41263675689697266  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.356301307678223  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.358494758605957  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.4199376106262207  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.405468940734863  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.407859325408936  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.42983055114746094  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.607635974884033  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.609723091125488  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.4322848320007324  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.325623035430908  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.327710151672363  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.4420433044433594  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.730753898620605  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.732659816741943  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.4441714286804199  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.432807922363281  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.435108661651611  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.4557485580444336  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.935474395751953  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.937346935272217  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.45665931701660156  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.408280372619629  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.410741329193115  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.467526912689209  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.899435997009277  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.901450634002686  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.4758567810058594  GigaBytes
Max Memory Allocated: 14.19193696975708  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.963775157928467  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.965576171875  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

number of input  16988525
----------------------------------------after optimizer
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.4954085350036621  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7272582054138184
pure train time :  4.213836193084717
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 0.442 seconds, peak memory: 46.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.476 GB
Metis partitioning: 2.021 seconds, peak memory: 46.476 GB
Split the graph: 1.105 seconds
Construct subgraphs: 0.041 seconds
metis partition ---------------pure dgl.metis_partition spent  3.60941743850708
9615
9566
9688
9957
10020
9910
10093
9584
9581
9806
9998
9588
9999
9608
10027
9613
9865
10030
9948
10075
metis partition time  3.6143991947174072
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012838363647460938
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.6317405700683594
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.220669507980347
self.buckets_partition() spend  sec:  3.6446805000305176
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.35716772079467773  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.26742696762085  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.263181686401367  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.3578939437866211  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.266972541809082  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.269083023071289  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.36498117446899414  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.386483192443848  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.388323783874512  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.37454700469970703  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.682076930999756  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.68387222290039  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.38282346725463867  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.80633544921875  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.808130741119385  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.3866763114929199  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.649256229400635  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.651198387145996  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.3951582908630371  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.877464294433594  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.879247188568115  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.3937239646911621  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.32942008972168  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.331182956695557  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.40149688720703125  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.357210159301758  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.35896635055542  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.4105057716369629  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.576895713806152  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.578948497772217  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.41800546646118164  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.77757453918457  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.779346942901611  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.4199814796447754  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.385171890258789  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.38694429397583  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.4327664375305176  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.862846374511719  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.864838600158691  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.43216991424560547  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.391083717346191  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.393476009368896  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.44394540786743164  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.883095264434814  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.885465145111084  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.4446578025817871  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.428062438964844  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.430370807647705  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.45386171340942383  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.698282241821289  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.700235843658447  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.46215295791625977  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.87769079208374  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.879981994628906  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.4685521125793457  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.823222160339355  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 13.825009822845459  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.33935546875 GB
    Memory Allocated: 0.4753403663635254  GigaBytes
Max Memory Allocated: 14.19714641571045  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.972192764282227  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.97398042678833  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

number of input  16989413
----------------------------------------after optimizer
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.49535131454467773  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.233584403991699
pure train time :  3.98073410987854
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 0.507 seconds, peak memory: 46.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.476 GB
Metis partitioning: 2.051 seconds, peak memory: 46.476 GB
Split the graph: 0.946 seconds
Construct subgraphs: 0.030 seconds
metis partition ---------------pure dgl.metis_partition spent  3.536234140396118
9615
9566
9688
9957
10020
9910
10093
9584
9581
9806
9998
9588
9999
9608
10027
9613
9865
10030
9948
10075
metis partition time  3.54130482673645
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011394023895263672
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.5601847171783447
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.1398890018463135
self.buckets_partition() spend  sec:  3.5716896057128906
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.3578925132751465  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.320953369140625  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.317112445831299  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.35780763626098633  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.252032279968262  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.254159927368164  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.3649897575378418  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.361621379852295  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.363950729370117  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.37446022033691406  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.6818528175354  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.68367862701416  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.3827505111694336  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.824854373931885  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.826680183410645  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.3885979652404785  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.753538131713867  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.755320072174072  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.39589834213256836  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.868589878082275  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.87037181854248  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.3959484100341797  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.328166484832764  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.330129146575928  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.40044212341308594  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.344985485076904  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.346736907958984  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.40833139419555664  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.56193208694458  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.564021110534668  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.41852760314941406  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.768651485443115  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.770450592041016  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.4189434051513672  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.322293758392334  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.324092864990234  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.4314689636230469  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.849059581756592  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.851541519165039  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.43198633193969727  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.35512399673462  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.356916427612305  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.444368839263916  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.887731552124023  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.88948917388916  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.4423232078552246  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.37946367263794  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.38142728805542  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.4540748596191406  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.696608543395996  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.698644161224365  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.462399959564209  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.916781902313232  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.918817520141602  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.4658041000366211  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.759000778198242  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.760830402374268  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.47603893280029297  GigaBytes
Max Memory Allocated: 14.205291748046875  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.986551284790039  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.988380908966064  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

number of input  16982551
----------------------------------------after optimizer
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.4964718818664551  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7801246643066406
pure train time :  4.182575702667236
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 0.434 seconds, peak memory: 46.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.476 GB
Metis partitioning: 1.980 seconds, peak memory: 46.476 GB
Split the graph: 1.443 seconds
Construct subgraphs: 0.040 seconds
metis partition ---------------pure dgl.metis_partition spent  3.8979508876800537
9615
9566
9688
9957
10020
9910
10093
9584
9581
9806
9998
9588
9999
9608
10027
9613
9865
10030
9948
10075
metis partition time  3.9030754566192627
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0169680118560791
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.9254508018493652
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.506660461425781
self.buckets_partition() spend  sec:  3.9424638748168945
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.35927915573120117  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.339522361755371  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.335634231567383  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.35781240463256836  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.290372848510742  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.292462825775146  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.364652156829834  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.364447593688965  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.36679220199585  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.3751716613769531  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.662764549255371  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.664628982543945  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.38313865661621094  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.83232069015503  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.834228515625  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.38675785064697266  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.636208534240723  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 13.638028621673584  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.34130859375 GB
    Memory Allocated: 0.39626407623291016  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.943716526031494  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.945536613464355  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 0.394503116607666  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.308852195739746  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.310861110687256  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 0.4001145362854004  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.298123359680176  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.299855709075928  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 0.4093489646911621  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.586873054504395  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.588791847229004  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 0.4188661575317383  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.820462226867676  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.822213649749756  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 0.41767024993896484  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.314648151397705  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.316766738891602  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 0.431394100189209  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.816955089569092  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.818735122680664  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 0.43106603622436523  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.340375423431396  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.342155456542969  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 0.44484758377075195  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.915567874908447  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.917425155639648  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 0.444338321685791  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.402795314788818  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.405231475830078  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 0.4528989791870117  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.687761306762695  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.689539432525635  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 0.4627566337585449  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.925445556640625  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.927223682403564  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 0.4663996696472168  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.815158367156982  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 13.816902160644531  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09521484375 GB
    Memory Allocated: 0.47536134719848633  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.958322525024414  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.960394859313965  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

number of input  16982490
----------------------------------------after optimizer
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4954085350036621  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5474823713302612
pure train time :  3.927987575531006
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 0.437 seconds, peak memory: 46.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.476 GB
Metis partitioning: 2.032 seconds, peak memory: 46.476 GB
Split the graph: 1.479 seconds
Construct subgraphs: 0.037 seconds
metis partition ---------------pure dgl.metis_partition spent  3.9853577613830566
9615
9566
9688
9957
10020
9910
10093
9584
9581
9806
9998
9588
9999
9608
10027
9613
9865
10030
9948
10075
metis partition time  3.990626096725464
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012860298156738281
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.009816646575928
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.586999893188477
self.buckets_partition() spend  sec:  4.022722244262695
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.35690784454345703  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.317070484161377  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.313240051269531  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3568153381347656  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.180453300476074  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.18287992477417  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.36463212966918945  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.419094562530518  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.420859336853027  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3775300979614258  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.779640674591064  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.781428337097168  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.38288021087646484  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.835099697113037  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.83688735961914  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3876309394836426  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.664727687835693  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.666645050048828  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.39641284942626953  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.900232791900635  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.902000904083252  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3950381278991699  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.298250198364258  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.300134658813477  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.40076637268066406  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.343382835388184  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.345847606658936  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4112825393676758  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.638007640838623  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.63978385925293  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.41846418380737305  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.786258697509766  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.788023471832275  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.42034912109375  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.362467765808105  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.364232540130615  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4313392639160156  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.80174732208252  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.804233074188232  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.43108701705932617  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.37426233291626  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.37635326385498  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.44387245178222656  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.847212791442871  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.8496675491333  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4436225891113281  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.388899326324463  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.391310691833496  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4542670249938965  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.75411081314087  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.756033897399902  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.46358680725097656  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.924987316131592  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.926910400390625  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4676661491394043  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.815047264099121  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.816857814788818  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.47571802139282227  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.968673706054688  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.970438480377197  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

number of input  16994772
----------------------------------------after optimizer
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4957275390625  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3942543268203735
pure train time :  3.9214916229248047
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 0.434 seconds, peak memory: 46.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.476 GB
Metis partitioning: 2.024 seconds, peak memory: 46.476 GB
Split the graph: 0.566 seconds
Construct subgraphs: 0.040 seconds
metis partition ---------------pure dgl.metis_partition spent  3.064608097076416
9615
9566
9688
9957
10020
9910
10093
9584
9581
9806
9998
9588
9999
9608
10027
9613
9865
10030
9948
10075
metis partition time  3.069509267807007
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010702848434448242
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.0860931873321533
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.682264804840088
self.buckets_partition() spend  sec:  3.096919059753418
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.35897397994995117  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.325956344604492  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.322113990783691  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3562946319580078  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.26834774017334  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.270138263702393  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3658781051635742  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.399166584014893  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.400920867919922  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.37565183639526367  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.724705696105957  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.726512432098389  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3820524215698242  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.754167556762695  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.755974292755127  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3902115821838379  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.737756729125977  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.739641666412354  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3968343734741211  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.894502639770508  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.896270751953125  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3955268859863281  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.364858150482178  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.36699390411377  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4003596305847168  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.284875869750977  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.286712169647217  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.40856170654296875  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.567095279693604  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.569157600402832  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4176216125488281  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.776533126831055  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.778343200683594  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.418546199798584  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.33451223373413  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.336334228515625  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4311833381652832  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.815813064575195  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.817564487457275  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4310169219970703  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.331813335418701  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.333928108215332  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.44237422943115234  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.85807180404663  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.85995626449585  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4433293342590332  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.375566005706787  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.378023147583008  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4532146453857422  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.729718208312988  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.731616497039795  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4638237953186035  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.946567058563232  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.948356628417969  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4672822952270508  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.811183452606201  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.812971115112305  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.47403812408447266  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.93802547454834  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.940589427947998  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

number of input  16982127
----------------------------------------after optimizer
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.49394893646240234  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2709492444992065
pure train time :  4.18481707572937
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 0.412 seconds, peak memory: 46.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.476 GB
Metis partitioning: 2.059 seconds, peak memory: 46.476 GB
Split the graph: 1.280 seconds
Construct subgraphs: 0.046 seconds
metis partition ---------------pure dgl.metis_partition spent  3.7980527877807617
9615
9566
9688
9957
10020
9910
10093
9584
9581
9806
9998
9588
9999
9608
10027
9613
9865
10030
9948
10075
metis partition time  3.803170919418335
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012321949005126953
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.821847438812256
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.434892654418945
self.buckets_partition() spend  sec:  3.8342220783233643
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.35823965072631836  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.297087669372559  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.29265022277832  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.35580921173095703  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.200557231903076  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.202888488769531  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.36518335342407227  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.417591094970703  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.419374465942383  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.37618017196655273  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.73376750946045  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.735549449920654  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3819856643676758  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.780611038208008  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.78237009048462  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3884572982788086  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.698167324066162  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.699926376342773  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3945126533508301  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.869051933288574  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.870891094207764  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.39656972885131836  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.369603157043457  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.371915817260742  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3991670608520508  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.263526439666748  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.265604496002197  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4106593132019043  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.606693744659424  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.608680248260498  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4193997383117676  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.829315185546875  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.831295013427734  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.41880369186401367  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.325507640838623  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.327447891235352  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.43042564392089844  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.848294734954834  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.85004997253418  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.42902231216430664  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.325931549072266  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.328269004821777  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4450082778930664  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.884919166564941  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.887041091918945  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4435405731201172  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.393314361572266  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.395421981811523  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.45331859588623047  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.68959665298462  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.691381454467773  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.46114301681518555  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.845637798309326  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.847394466400146  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4684925079345703  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.868045806884766  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.869802474975586  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.476318359375  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.957678318023682  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.95946216583252  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

number of input  16979037
----------------------------------------after optimizer
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.4961881637573242  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1716523170471191
pure train time :  3.9361038208007812
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 0.425 seconds, peak memory: 46.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.476 GB
Metis partitioning: 2.066 seconds, peak memory: 46.476 GB
Split the graph: 1.127 seconds
Construct subgraphs: 0.041 seconds
metis partition ---------------pure dgl.metis_partition spent  3.6609103679656982
9615
9566
9688
9957
10020
9910
10093
9584
9581
9806
9998
9588
9999
9608
10027
9613
9865
10030
9948
10075
metis partition time  3.6659317016601562
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010863780975341797
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.6839406490325928
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.2892937660217285
self.buckets_partition() spend  sec:  3.6948602199554443
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3570995330810547  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.276653289794922  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.27214527130127  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.35840702056884766  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.268006324768066  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.269737720489502  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3652768135070801  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.37448263168335  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.376803398132324  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.37477779388427734  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.722594738006592  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.724369049072266  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.38258981704711914  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.801520824432373  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.803295135498047  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.3880434036254883  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.666113376617432  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 13.6680326461792  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.09912109375 GB
    Memory Allocated: 0.39672327041625977  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.947988986968994  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.949908256530762  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.39608240127563477  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.328010082244873  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.330462455749512  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4007267951965332  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.355579853057861  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.357321739196777  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4090447425842285  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.554144382476807  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.556241035461426  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.41816139221191406  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.775181770324707  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.777278423309326  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4208106994628906  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.3844895362854  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.386862754821777  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4318718910217285  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.880650043487549  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.882627010345459  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.43202972412109375  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.372387886047363  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.374202728271484  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.44364404678344727  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.82178783416748  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.823562145233154  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4442143440246582  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.42667531967163  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.428449630737305  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.454282283782959  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.721266269683838  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.72307825088501  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4633617401123047  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.922894954681396  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.924706935882568  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.46572446823120117  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.76330280303955  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.765174388885498  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4737386703491211  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.937077045440674  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.938948631286621  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

number of input  16987662
----------------------------------------after optimizer
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4935946464538574  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0805346965789795
pure train time :  3.93605375289917
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 0.457 seconds, peak memory: 46.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.476 GB
Metis partitioning: 2.065 seconds, peak memory: 46.476 GB
Split the graph: 0.680 seconds
Construct subgraphs: 0.029 seconds
metis partition ---------------pure dgl.metis_partition spent  3.231917142868042
9615
9566
9688
9957
10020
9910
10093
9584
9581
9806
9998
9588
9999
9608
10027
9613
9865
10030
9948
10075
metis partition time  3.2368974685668945
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012964725494384766
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.255251407623291
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.851232051849365
self.buckets_partition() spend  sec:  3.2682645320892334
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.3571786880493164  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.30843210220337  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.304014205932617  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.35631799697875977  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.222612380981445  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.224854946136475  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.3656587600708008  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.401963233947754  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.403892517089844  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.37575435638427734  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.729891300201416  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.731656074523926  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.38256359100341797  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.79991865158081  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.80168342590332  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.3869490623474121  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.63814640045166  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.640086650848389  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.39606523513793945  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.869959354400635  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.871899604797363  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.3951692581176758  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.331505298614502  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.333934783935547  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4000725746154785  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.289228439331055  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.291524887084961  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4097299575805664  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.563623905181885  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.565728187561035  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4191408157348633  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.822002410888672  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.823790073394775  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.41800689697265625  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.320518970489502  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.322306632995605  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.430814266204834  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.860281467437744  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.86226511001587  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4308662414550781  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.366298198699951  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.368159294128418  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.44348812103271484  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.818433284759521  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.820211410522461  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.44326114654541016  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.385599136352539  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.387377262115479  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4553694725036621  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.695098400115967  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.696829319000244  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.46220874786376953  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.90770673751831  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.910200119018555  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4680304527282715  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.83669376373291  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.838436126708984  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4770841598510742  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.950132369995117  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.952720165252686  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

number of input  16979826
----------------------------------------after optimizer
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4968266487121582  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.999117374420166
pure train time :  3.912787914276123
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 0.443 seconds, peak memory: 46.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.476 GB
Metis partitioning: 1.924 seconds, peak memory: 46.476 GB
Split the graph: 0.897 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  3.303687572479248
9615
9566
9688
9957
10020
9910
10093
9584
9581
9806
9998
9588
9999
9608
10027
9613
9865
10030
9948
10075
metis partition time  3.30865478515625
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009810447692871094
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.324597120285034
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.894947528839111
self.buckets_partition() spend  sec:  3.3344550132751465
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.3585395812988281  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.33378553390503  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.329849243164062  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.359316349029541  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.293320178985596  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.295174598693848  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.36431217193603516  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.343857765197754  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.3462233543396  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.375  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.728628635406494  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.73043155670166  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.3820466995239258  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.763373374938965  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.765159130096436  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.38569211959838867  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.630184173583984  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.631969928741455  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.3956446647644043  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.86893606185913  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.871355533599854  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.39411067962646484  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.307898044586182  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.30971908569336  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4008307456970215  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.346589088439941  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.348397254943848  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.411038875579834  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.609160900115967  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.611111640930176  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4190526008605957  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.798240661621094  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.800026416778564  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4179363250732422  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.337188720703125  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.338974475860596  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4312424659729004  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.844178676605225  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.845980644226074  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.43279361724853516  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.398994445800781  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.400960922241211  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.44423675537109375  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.906768798828125  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.90917158126831  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4437065124511719  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.380704879760742  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.382457256317139  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.45402002334594727  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.703109741210938  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.70509958267212  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.46280956268310547  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.914589405059814  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.916579246520996  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4666461944580078  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.762367248535156  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.764231204986572  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.47615575790405273  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.96038293838501  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.962174892425537  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

number of input  16987362
----------------------------------------after optimizer
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4962129592895508  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9555827379226685
pure train time :  3.947526454925537
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 0.490 seconds, peak memory: 46.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.476 GB
Metis partitioning: 2.013 seconds, peak memory: 46.476 GB
Split the graph: 1.247 seconds
Construct subgraphs: 0.040 seconds
metis partition ---------------pure dgl.metis_partition spent  3.791956901550293
9615
9566
9688
9957
10020
9910
10093
9584
9581
9806
9998
9588
9999
9608
10027
9613
9865
10030
9948
10075
metis partition time  3.7970879077911377
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012893438339233398
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.8164467811584473
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.4618079662323
self.buckets_partition() spend  sec:  3.829387903213501
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.35793066024780273  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.339881896972656  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.335497856140137  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.357210636138916  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.240489482879639  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.242294311523438  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.3651270866394043  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.40494966506958  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.406754493713379  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.3762331008911133  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.729413032531738  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.731204509735107  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.3823366165161133  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.811458110809326  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.813249588012695  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.3881692886352539  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.66868543624878  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.670455932617188  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.397122859954834  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.939223766326904  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.940994262695312  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.39502716064453125  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.336638450622559  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.339086055755615  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4003424644470215  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.264050006866455  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.266007423400879  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.41065168380737305  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.637415409088135  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.639204978942871  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.41926050186157227  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.800151824951172  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.801903247833252  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4182319641113281  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.352441310882568  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.354873657226562  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4323692321777344  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.86612606048584  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.86791467666626  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.43279027938842773  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.383533477783203  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.385436534881592  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.44190073013305664  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.798609256744385  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.800381660461426  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.44330358505249023  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.3805513381958  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.382707595825195  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.45360660552978516  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.685633182525635  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.68739938735962  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4635958671569824  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.932095527648926  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.93386173248291  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4663376808166504  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.76038408279419  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.76225757598877  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.4737076759338379  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.93592643737793  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.93779993057251  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

number of input  16986510
----------------------------------------after optimizer
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.49361562728881836  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.911258339881897
pure train time :  3.936109781265259
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 0.419 seconds, peak memory: 46.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.476 GB
Metis partitioning: 1.983 seconds, peak memory: 46.476 GB
Split the graph: 0.849 seconds
Construct subgraphs: 0.039 seconds
metis partition ---------------pure dgl.metis_partition spent  3.290804386138916
9615
9566
9688
9957
10020
9910
10093
9584
9581
9806
9998
9588
9999
9608
10027
9613
9865
10030
9948
10075
metis partition time  3.2956595420837402
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012936830520629883
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.3153867721557617
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.922921895980835
self.buckets_partition() spend  sec:  3.3284637928009033
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.35775327682495117  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.319202899932861  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.315422534942627  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.3581538200378418  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.207505226135254  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.209320545196533  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.3647022247314453  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.426032066345215  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.427748680114746  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.3763723373413086  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.731610774993896  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.733419418334961  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.3832516670227051  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.836046695709229  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.837855339050293  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.3862471580505371  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.6460599899292  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 13.648044109344482  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.84130859375 GB
    Memory Allocated: 0.39786720275878906  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.956113815307617  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.957881927490234  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.39362525939941406  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.29833698272705  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.300217628479004  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4001350402832031  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.290822982788086  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.292647361755371  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.41048765182495117  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.59309196472168  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.595137596130371  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.419921875  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.8014554977417  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.803252696990967  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4199390411376953  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.36228895187378  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.364086151123047  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.43197107315063477  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.83741569519043  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.839190006256104  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4304194450378418  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.380839347839355  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.38261365890503  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4437217712402344  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.866950511932373  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.869388103485107  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4431157112121582  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.391141891479492  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.393520832061768  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4537529945373535  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.675204753875732  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.677057266235352  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.46340274810791016  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.928754806518555  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.930607318878174  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.46717405319213867  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.822362899780273  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.824394702911377  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4752650260925293  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.937586784362793  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.940134525299072  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

number of input  16992852
----------------------------------------after optimizer
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4954342842102051  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8753527402877808
pure train time :  4.005075693130493
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 0.531 seconds, peak memory: 46.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.476 GB
Metis partitioning: 2.006 seconds, peak memory: 46.476 GB
Split the graph: 1.097 seconds
Construct subgraphs: 0.041 seconds
metis partition ---------------pure dgl.metis_partition spent  3.676760196685791
9615
9566
9688
9957
10020
9910
10093
9584
9581
9806
9998
9588
9999
9608
10027
9613
9865
10030
9948
10075
metis partition time  3.6818947792053223
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012783527374267578
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.702294111251831
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.344339847564697
self.buckets_partition() spend  sec:  3.7151265144348145
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3573431968688965  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.298413276672363  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.29459810256958  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.35910558700561523  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.305296421051025  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.307717323303223  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3661770820617676  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.40196704864502  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.403738498687744  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.37562084197998047  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.722110748291016  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.723965167999268  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.38344669342041016  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.861185073852539  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.863036632537842  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.38687801361083984  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.673202514648438  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.675018310546875  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.39640045166015625  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.892229080200195  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.894000053405762  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.39348363876342773  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.299014568328857  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.300899028778076  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3986086845397949  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.23309850692749  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.234816074371338  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4092073440551758  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.521650791168213  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.523613452911377  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4195384979248047  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.831212520599365  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.832984924316406  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4185967445373535  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.314568996429443  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.316341400146484  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.431973934173584  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.842230796813965  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.843982219696045  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4317598342895508  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.380975246429443  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.383441925048828  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4440345764160156  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.86812448501587  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.869885921478271  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4440326690673828  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.414043426513672  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.415870666503906  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.45458364486694336  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.721888065338135  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.723708152770996  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.46241283416748047  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.926844596862793  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.928664684295654  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4677557945251465  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.815275192260742  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.817055225372314  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4761390686035156  GigaBytes
Max Memory Allocated: 14.219286918640137  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 14.016470909118652  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 14.018250942230225  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

number of input  16991587
----------------------------------------after optimizer
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4964885711669922  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8311737179756165
pure train time :  4.250100374221802
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 0.484 seconds, peak memory: 46.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.476 GB
Metis partitioning: 2.042 seconds, peak memory: 46.476 GB
Split the graph: 0.540 seconds
Construct subgraphs: 0.030 seconds
metis partition ---------------pure dgl.metis_partition spent  3.097121000289917
9615
9566
9688
9957
10020
9910
10093
9584
9581
9806
9998
9588
9999
9608
10027
9613
9865
10030
9948
10075
metis partition time  3.1021904945373535
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010419130325317383
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1187353134155273
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.743533372879028
self.buckets_partition() spend  sec:  3.129204273223877
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.35716676712036133  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.312683582305908  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.308664321899414  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3567781448364258  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.211275100708008  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.21384859085083  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3652982711791992  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.391672134399414  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.393920421600342  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.37491750717163086  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.722519397735596  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.724329948425293  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.38111257553100586  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.747527122497559  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.749330043792725  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3879837989807129  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.681618690490723  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.683421611785889  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.39538145065307617  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.889734745025635  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.891502857208252  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.39516401290893555  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.292781352996826  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.294688701629639  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.39954423904418945  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.29340648651123  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.295173645019531  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4098191261291504  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.561577796936035  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.563626766204834  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4175839424133301  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.774883270263672  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.776644229888916  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.41948366165161133  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.369920253753662  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.371681213378906  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4312567710876465  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.836650848388672  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.838751792907715  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4312753677368164  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.38668441772461  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.388835906982422  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4445037841796875  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.888386249542236  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.890242099761963  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.444185733795166  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.406771659851074  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.408916473388672  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4541158676147461  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.708884239196777  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.710830211639404  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.46138620376586914  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.897571086883545  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.899517059326172  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4690065383911133  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.825236320495605  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.827069759368896  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.47610902786254883  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.974928379058838  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.976761817932129  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

number of input  16977292
----------------------------------------after optimizer
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.49651432037353516  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7980618476867676
pure train time :  4.387997150421143
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 0.485 seconds, peak memory: 46.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.476 GB
Metis partitioning: 2.279 seconds, peak memory: 46.476 GB
Split the graph: 1.396 seconds
Construct subgraphs: 0.042 seconds
metis partition ---------------pure dgl.metis_partition spent  4.2041120529174805
9826
9637
9993
9681
10009
9748
10098
9853
9633
10050
9638
9639
9779
9551
9928
9673
10083
9627
10051
10074
metis partition time  4.209671497344971
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011806488037109375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.235098838806152
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  8.138836860656738
self.buckets_partition() spend  sec:  4.246973752975464
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3617091178894043  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.573445796966553  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.569028854370117  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.35779333114624023  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.311866760253906  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.314316272735596  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.37206268310546875  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.805248260498047  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.807559490203857  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.37123727798461914  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.379668712615967  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.3818359375  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.38416290283203125  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.806861877441406  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.809189319610596  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.38471317291259766  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.475072860717773  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.477176666259766  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3958911895751953  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.86203670501709  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.864529132843018  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.39925336837768555  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.643507480621338  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.645233154296875  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.40117931365966797  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.381946086883545  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.384288787841797  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4119410514831543  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.836419582366943  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.838299751281738  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.414581298828125  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.395353317260742  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.39771318435669  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.42047882080078125  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.412194728851318  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.414520263671875  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4296703338623047  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.592185497283936  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.594305038452148  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.43010377883911133  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.292946815490723  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.295116901397705  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4445362091064453  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.793078422546387  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.794915676116943  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4447669982910156  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.430734634399414  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.43257188796997  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.45754528045654297  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.972398281097412  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.974750518798828  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.45763683319091797  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.436963558197021  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.439376831054688  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4686417579650879  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.909753799438477  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.912294864654541  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.475217342376709  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.961426258087158  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.963489532470703  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

number of input  16993254
----------------------------------------after optimizer
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.49509143829345703  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7575321793556213
pure train time :  4.417629718780518
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 0.522 seconds, peak memory: 46.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.476 GB
Metis partitioning: 2.282 seconds, peak memory: 46.476 GB
Split the graph: 0.846 seconds
Construct subgraphs: 0.040 seconds
metis partition ---------------pure dgl.metis_partition spent  3.6913859844207764
9615
9566
9688
9957
10020
9910
10093
9584
9581
9806
9998
9588
9999
9608
10027
9613
9865
10030
9948
10075
metis partition time  3.696565628051758
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01219797134399414
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.7148611545562744
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.590078592300415
self.buckets_partition() spend  sec:  3.7271125316619873
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.357759952545166  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.324790477752686  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.320945739746094  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3577876091003418  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.28360891342163  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.285781860351562  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3653879165649414  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.413071155548096  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.415247440338135  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3752107620239258  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.717164039611816  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.718966960906982  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.38298511505126953  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.857522964477539  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.859639644622803  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.38785886764526367  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.648845672607422  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.650774478912354  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.39538002014160156  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.866295337677002  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.868224143981934  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3943657875061035  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.285089492797852  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.287448406219482  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4010014533996582  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.266889572143555  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.268840312957764  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4092717170715332  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.592370510101318  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.59412956237793  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.41991758346557617  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.803022861480713  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.804781913757324  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.41829395294189453  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.288011074066162  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.289770126342773  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4303560256958008  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.828634262084961  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.830474376678467  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4321708679199219  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.39246654510498  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.394386768341064  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.44478559494018555  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.920226573944092  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.92204475402832  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.44211530685424805  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.354601860046387  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.356412887573242  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.45411062240600586  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.701013565063477  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.703014850616455  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.46130847930908203  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.874380588531494  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.876541137695312  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.46738719940185547  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.816944122314453  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.818701267242432  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4753575325012207  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.959982872009277  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.961823463439941  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

number of input  16983396
----------------------------------------after optimizer
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.49531126022338867  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.730721652507782
pure train time :  4.333852529525757
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 0.469 seconds, peak memory: 46.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.476 GB
Metis partitioning: 2.070 seconds, peak memory: 46.476 GB
Split the graph: 0.648 seconds
Construct subgraphs: 0.042 seconds
metis partition ---------------pure dgl.metis_partition spent  3.230780601501465
9615
9566
9688
9957
10020
9910
10093
9584
9581
9806
9998
9588
9999
9608
10027
9613
9865
10030
9948
10075
metis partition time  3.235913038253784
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013307809829711914
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.2644124031066895
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.874860763549805
self.buckets_partition() spend  sec:  3.277862310409546
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.35756683349609375  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.305659294128418  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.301807403564453  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.35728931427001953  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.220693588256836  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.222687244415283  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3643198013305664  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.37967824935913  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.381659984588623  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3769259452819824  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.736344337463379  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.73814344406128  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3834710121154785  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.834447860717773  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.836246967315674  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.38898420333862305  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.724421977996826  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.726346969604492  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.39563751220703125  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.860490322113037  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.862415313720703  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.39366865158081055  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.29601001739502  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.297886371612549  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.39990854263305664  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.307610511779785  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.309433460235596  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.41016530990600586  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.58887004852295  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.59093713760376  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.420438289642334  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.80144739151001  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.80319881439209  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4177556037902832  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.283422470092773  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.285365104675293  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4311561584472656  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.849245071411133  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.851065158843994  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4281139373779297  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.305743217468262  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.307563304901123  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4440464973449707  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.899716854095459  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.901627540588379  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4430723190307617  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.407259464263916  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.409712791442871  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.45430612564086914  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.677835464477539  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.679646492004395  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.46185779571533203  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.925540447235107  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.927611351013184  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.46862268447875977  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.869361877441406  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.87110424041748  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4769878387451172  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.986796379089355  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.988561153411865  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

number of input  16981600
----------------------------------------after optimizer
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4967803955078125  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7008729577064514
pure train time :  4.364745616912842
the output layer 
self.num_batch (get_in_degree_bucketing) 20
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  20
Convert a graph into a bidirected graph: 0.448 seconds, peak memory: 46.476 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.476 GB
Metis partitioning: 2.144 seconds, peak memory: 46.476 GB
Split the graph: 0.525 seconds
Construct subgraphs: 0.027 seconds
metis partition ---------------pure dgl.metis_partition spent  3.1441328525543213
9826
9637
9993
9681
10009
9748
10098
9853
9633
10050
9638
9639
9779
9551
9928
9673
10083
9627
10051
10074
metis partition time  3.1492364406585693
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012104272842407227
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.166887044906616
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.788783550262451
self.buckets_partition() spend  sec:  3.179049015045166
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3605942726135254  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.526845932006836  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.522624015808105  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.36001110076904297  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.342159748077393  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.344513893127441  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.37176084518432617  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.784663677215576  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.78645133972168  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3715701103210449  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.374993801116943  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.376781463623047  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3840065002441406  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.816534519195557  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.81828784942627  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3855562210083008  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.556092262268066  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.558127403259277  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.39702606201171875  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.901321411132812  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.903090000152588  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.3998713493347168  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.649662017822266  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.651609897613525  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.401583194732666  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.354783058166504  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.356730937957764  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4129509925842285  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.8377366065979  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.839663028717041  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4145336151123047  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.405597686767578  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.407390117645264  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.41869592666625977  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.379340648651123  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.381152629852295  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4271068572998047  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.580615997314453  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.582689762115479  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.43111610412597656  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.369581699371338  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.372052192687988  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.44191646575927734  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.706092834472656  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.708033084869385  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.44373369216918945  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.450574398040771  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.4525146484375  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.45677995681762695  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.914802074432373  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.91677188873291  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.45430803298950195  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.366786479949951  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.368593692779541  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4680328369140625  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.912269592285156  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.914143085479736  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.4743199348449707  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.920022964477539  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 13.921884536743164  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

number of input  16979066
----------------------------------------after optimizer
 Nvidia-smi: 18.59716796875 GB
    Memory Allocated: 0.49419307708740234  GigaBytes
Max Memory Allocated: 14.249357223510742  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6724496483802795
pure train time :  4.046250581741333
epoch_time_list  [31.318169116973877, 27.76062798500061, 28.852903604507446, 27.693048238754272, 27.970382928848267, 27.769800662994385, 27.021284580230713, 27.126060009002686, 27.83952307701111, 27.61126685142517, 27.224283456802368, 27.102696895599365, 28.28264880180359, 26.790744066238403, 26.89804720878601, 29.05518627166748, 30.905967712402344, 31.177207946777344, 27.626036643981934, 27.690595388412476]

loading_time list   [0.5401909351348877, 0.6088693141937256, 0.5452730655670166, 0.462322473526001, 0.550938606262207, 0.5059494972229004, 0.4701378345489502, 0.3627898693084717, 0.3367576599121094, 0.3784444332122803, 0.470090389251709, 0.3541135787963867, 0.46929025650024414, 0.35552072525024414, 0.38834476470947266, 0.3533155918121338, 0.4544413089752197, 0.6796183586120605, 0.32130956649780273, 0.31965160369873047]

 data loader gen time  19.450050830841064
	---backpack schedule time  [7.58456015586853, 7.07669472694397, 7.555144786834717, 7.3021605014801025, 7.208439826965332, 7.593406915664673, 7.66852331161499, 6.740952491760254, 7.51552939414978, 7.357792377471924, 6.938210487365723, 6.962215900421143, 7.543959617614746, 7.003798246383667, 7.4073803424835205, 6.817423343658447, 8.19970154762268, 7.669332265853882, 6.943997621536255, 6.8448405265808105]
	---connection_check_time_list  [7.7005836963653564, 7.295756101608276, 7.655826807022095, 7.023532152175903, 7.053623199462891, 6.975256443023682, 6.449865102767944, 6.982593536376953, 6.973623514175415, 6.974461317062378, 7.161351203918457, 6.638396501541138, 7.235583782196045, 6.533854722976685, 6.500286340713501, 8.860194444656372, 9.279444694519043, 9.601165771484375, 7.522998571395874, 7.55056619644165]
	---block_gen_time_list  [4.41842794418335, 4.296992063522339, 4.247178554534912, 4.211615562438965, 4.316816568374634, 4.133045673370361, 4.0843751430511475, 4.34543776512146, 4.527022361755371, 4.553744316101074, 4.28216552734375, 4.746535778045654, 4.598633766174316, 4.368040323257446, 3.984016180038452, 4.618657827377319, 4.746518135070801, 4.444666147232056, 4.005255937576294, 4.46600341796875]
training time  [10.463154792785645, 7.816994667053223, 8.196057081222534, 8.068775177001953, 8.238405466079712, 7.94595193862915, 7.739604711532593, 8.067794799804688, 7.883667707443237, 7.73450231552124, 7.7579333782196045, 7.79674220085144, 7.800478219985962, 7.9091856479644775, 8.015381097793579, 7.737706661224365, 7.504275560379028, 8.127828359603882, 8.208177328109741, 7.883453369140625]
---feature block loading time  [3.7938854694366455, 3.781768560409546, 3.887693166732788, 3.9967870712280273, 3.957120656967163, 3.9232590198516846, 3.722691774368286, 3.7907567024230957, 3.8509950637817383, 3.707420587539673, 3.7503907680511475, 3.7553136348724365, 3.7708945274353027, 3.810593843460083, 3.6702866554260254, 3.2453513145446777, 2.9878857135772705, 3.6998448371887207, 3.744507074356079, 3.7411837577819824]


epoch_time avg   28.005733281373978
loading_time avg   0.4231696277856827
 data loader gen time avg 19.65660846233368
	---backpack schedule time avg 7.275969013571739
	---connection_check_time avg  7.393329083919525
	---block_gen_time avg  4.38880842924118
training time  7.896943047642708
---feature block loading time  3.6955309957265854
pure train time per /epoch  [6.646196126937866, 3.9428257942199707, 4.213836193084717, 3.98073410987854, 4.182575702667236, 3.927987575531006, 3.9214916229248047, 4.18481707572937, 3.9361038208007812, 3.93605375289917, 3.912787914276123, 3.947526454925537, 3.936109781265259, 4.005075693130493, 4.250100374221802, 4.387997150421143, 4.417629718780518, 4.333852529525757, 4.364745616912842, 4.046250581741333]
pure train time average  4.098343498566571
num_input list  [16996178, 16978752, 16988525, 16989413, 16982551, 16982490, 16994772, 16982127, 16979037, 16987662, 16979826, 16987362, 16986510, 16992852, 16991587, 16977292, 16993254, 16983396, 16981600, 16979066]
num_input  average  16985712.6
