main start at this time 1713150683.835132
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 1.274 seconds, peak memory: 19.343 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 19.343 GB
Metis partitioning: 2.048 seconds, peak memory: 19.586 GB
Split the graph: 0.705 seconds
Construct subgraphs: 0.027 seconds
metis partition ---------------pure dgl.metis_partition spent  4.067275285720825
12432
12040
12018
12546
12021
12287
12319
12608
12154
12544
12535
12265
12199
12452
12080
12071
metis partition time  4.071974992752075
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009256601333618164
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.086200475692749
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.032441854476929
self.buckets_partition() spend  sec:  4.095498085021973
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.91162109375 GB
    Memory Allocated: 0.3732433319091797  GigaBytes
Max Memory Allocated: 0.3732433319091797  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.38232421875 GB
    Memory Allocated: 16.452391624450684  GigaBytes
Max Memory Allocated: 16.73755407333374  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.38232421875 GB
    Memory Allocated: 16.45533275604248  GigaBytes
Max Memory Allocated: 16.73755407333374  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.39013671875 GB
    Memory Allocated: 0.39718055725097656  GigaBytes
Max Memory Allocated: 16.73755407333374  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.39013671875 GB
    Memory Allocated: 16.04441213607788  GigaBytes
Max Memory Allocated: 16.73755407333374  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.39013671875 GB
    Memory Allocated: 16.046955108642578  GigaBytes
Max Memory Allocated: 16.73755407333374  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.39013671875 GB
    Memory Allocated: 0.4051856994628906  GigaBytes
Max Memory Allocated: 16.73755407333374  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.39013671875 GB
    Memory Allocated: 16.009591579437256  GigaBytes
Max Memory Allocated: 16.73755407333374  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.39013671875 GB
    Memory Allocated: 16.01212501525879  GigaBytes
Max Memory Allocated: 16.73755407333374  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.39013671875 GB
    Memory Allocated: 0.421079158782959  GigaBytes
Max Memory Allocated: 16.73755407333374  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.49560546875 GB
    Memory Allocated: 16.582207679748535  GigaBytes
Max Memory Allocated: 16.871507167816162  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.49560546875 GB
    Memory Allocated: 16.585063934326172  GigaBytes
Max Memory Allocated: 16.871507167816162  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.49755859375 GB
    Memory Allocated: 0.4233856201171875  GigaBytes
Max Memory Allocated: 16.871507167816162  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.50146484375 GB
    Memory Allocated: 16.001070976257324  GigaBytes
Max Memory Allocated: 16.871507167816162  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.50146484375 GB
    Memory Allocated: 16.00350332260132  GigaBytes
Max Memory Allocated: 16.871507167816162  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.50146484375 GB
    Memory Allocated: 0.4389643669128418  GigaBytes
Max Memory Allocated: 16.871507167816162  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.50146484375 GB
    Memory Allocated: 16.383924961090088  GigaBytes
Max Memory Allocated: 16.871507167816162  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.50146484375 GB
    Memory Allocated: 16.3862361907959  GigaBytes
Max Memory Allocated: 16.871507167816162  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.50146484375 GB
    Memory Allocated: 0.4444875717163086  GigaBytes
Max Memory Allocated: 16.871507167816162  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.50341796875 GB
    Memory Allocated: 16.387884616851807  GigaBytes
Max Memory Allocated: 16.871507167816162  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 17.50341796875 GB
    Memory Allocated: 16.390141010284424  GigaBytes
Max Memory Allocated: 16.871507167816162  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 17.50537109375 GB
    Memory Allocated: 0.4585251808166504  GigaBytes
Max Memory Allocated: 16.871507167816162  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.03076171875 GB
    Memory Allocated: 16.774885654449463  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.03076171875 GB
    Memory Allocated: 16.77749538421631  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.03076171875 GB
    Memory Allocated: 0.4605979919433594  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.04052734375 GB
    Memory Allocated: 16.30631113052368  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.04052734375 GB
    Memory Allocated: 16.30868673324585  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.04052734375 GB
    Memory Allocated: 0.4731931686401367  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.13037109375 GB
    Memory Allocated: 16.715497493743896  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.13037109375 GB
    Memory Allocated: 16.7179856300354  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.13037109375 GB
    Memory Allocated: 0.48323488235473633  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01318359375 GB
    Memory Allocated: 16.69834041595459  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.01318359375 GB
    Memory Allocated: 16.700721263885498  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01318359375 GB
    Memory Allocated: 0.49005937576293945  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01708984375 GB
    Memory Allocated: 16.44415807723999  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.01708984375 GB
    Memory Allocated: 16.446537971496582  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 0.49660587310791016  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.37117910385132  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.373791694641113  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 0.5098280906677246  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.656567096710205  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.659666061401367  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 0.5130038261413574  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.152604579925537  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.15512704849243  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 0.5219054222106934  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.20207452774048  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.204939365386963  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

number of input  15004928
----------------------------------------after optimizer
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 0.5481109619140625  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.203699111938477
pure train time :  6.493818044662476
the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 0.559 seconds, peak memory: 47.200 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.200 GB
Metis partitioning: 2.024 seconds, peak memory: 47.200 GB
Split the graph: 0.786 seconds
Construct subgraphs: 0.028 seconds
metis partition ---------------pure dgl.metis_partition spent  3.406156063079834
12523
12289
12207
12121
11985
12388
12014
11967
12621
12583
12437
12412
12002
12001
12475
12546
metis partition time  3.4108009338378906
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011790752410888672
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.426088809967041
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.3140294551849365
self.buckets_partition() spend  sec:  3.437922477722168
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 0.40291643142700195  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.581255435943604  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.575629234313965  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 0.40054750442504883  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.308173656463623  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.310677528381348  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 0.4073052406311035  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.253780364990234  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.256121158599854  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 0.41627073287963867  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.22581195831299  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.228042602539062  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 0.4226045608520508  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 15.957940578460693  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 15.960610389709473  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 0.43541383743286133  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.414477825164795  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.416932106018066  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 0.443453311920166  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.10092258453369  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.103268146514893  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 0.4510345458984375  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.034578800201416  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 16.037548065185547  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.01904296875 GB
    Memory Allocated: 0.4678683280944824  GigaBytes
Max Memory Allocated: 17.066555500030518  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92333984375 GB
    Memory Allocated: 16.799997806549072  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92333984375 GB
    Memory Allocated: 16.80263090133667  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92333984375 GB
    Memory Allocated: 0.4759540557861328  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92333984375 GB
    Memory Allocated: 16.7373948097229  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92333984375 GB
    Memory Allocated: 16.73978042602539  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92333984375 GB
    Memory Allocated: 0.48346471786499023  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92529296875 GB
    Memory Allocated: 16.569807052612305  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92529296875 GB
    Memory Allocated: 16.572200775146484  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92529296875 GB
    Memory Allocated: 0.49135923385620117  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.563926696777344  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.566184043884277  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.49358367919921875  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.11308002471924  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.11528968811035  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.5044164657592773  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.127339363098145  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.129546642303467  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.5168066024780273  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.646838665008545  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.649463653564453  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.5266127586364746  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.71721076965332  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.720340251922607  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

number of input  14995568
----------------------------------------after optimizer
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.5525374412536621  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.4825117588043213
pure train time :  3.761484146118164
the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 0.583 seconds, peak memory: 47.200 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.200 GB
Metis partitioning: 2.201 seconds, peak memory: 47.200 GB
Split the graph: 0.701 seconds
Construct subgraphs: 0.039 seconds
metis partition ---------------pure dgl.metis_partition spent  3.536013603210449
12432
12040
12018
12546
12021
12287
12319
12608
12154
12544
12535
12265
12199
12452
12080
12071
metis partition time  3.540848731994629
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011626720428466797
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.557884693145752
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.485276937484741
self.buckets_partition() spend  sec:  3.5695667266845703
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.40473365783691406  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.501479148864746  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.492940425872803  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.39748287200927734  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.040539741516113  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.04274034500122  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.4054226875305176  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 15.992949485778809  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 15.995437145233154  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.4221630096435547  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.613742351531982  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.61602258682251  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.4252004623413086  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.041285037994385  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.043565273284912  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.4390716552734375  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.362133502960205  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.364285469055176  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.44710445404052734  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.43392848968506  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.43673610687256  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.45876121520996094  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.70612907409668  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.7088360786438  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.4620475769042969  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.275391101837158  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.278053283691406  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.47569894790649414  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.685369968414307  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.68781852722168  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.48481321334838867  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.662610054016113  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.664897441864014  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.4934206008911133  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.41440200805664  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.417485237121582  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.5003619194030762  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.33899164199829  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.341586112976074  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.5127930641174316  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.627378940582275  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.629913330078125  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.5149674415588379  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.20157480239868  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.204293251037598  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.5239362716674805  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.238412380218506  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.24077796936035  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

number of input  14995753
----------------------------------------after optimizer
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.5471286773681641  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7328758239746094
pure train time :  3.568709373474121
the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 0.443 seconds, peak memory: 47.200 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.200 GB
Metis partitioning: 2.099 seconds, peak memory: 47.200 GB
Split the graph: 0.663 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  3.243734836578369
12523
12289
12207
12121
11985
12388
12014
11967
12621
12583
12437
12412
12002
12001
12475
12546
metis partition time  3.2483954429626465
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011873722076416016
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.264676094055176
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.19036078453064
self.buckets_partition() spend  sec:  3.276603937149048
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.4010648727416992  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.552669525146484  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.5467848777771  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.40073347091674805  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.287354946136475  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.290069580078125  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.41020917892456055  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.228893280029297  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.231329917907715  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.41808128356933594  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.173323154449463  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.17622137069702  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.42586374282836914  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.084545612335205  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.086692810058594  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.4393119812011719  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.50874614715576  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.511173725128174  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.4425196647644043  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.08048677444458  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.08283281326294  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.4501309394836426  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 15.989126682281494  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 15.991383075714111  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.46845245361328125  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.796571731567383  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.79892921447754  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.47577810287475586  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.697944164276123  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.700251579284668  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.4857668876647949  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.614990234375  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.61750555038452  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.4934706687927246  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.601955890655518  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.604153633117676  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.49683141708374023  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.084835529327393  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.08722686767578  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.5070352554321289  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.128111839294434  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 16.13088893890381  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92724609375 GB
    Memory Allocated: 0.5225529670715332  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 16.69285821914673  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 16.69565486907959  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 0.5339713096618652  GigaBytes
Max Memory Allocated: 17.092885494232178  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 16.843278408050537  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 16.846043586730957  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

number of input  15000916
----------------------------------------after optimizer
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 0.5597176551818848  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.2307467460632324
pure train time :  4.158379554748535
the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 0.633 seconds, peak memory: 47.200 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.200 GB
Metis partitioning: 2.343 seconds, peak memory: 47.200 GB
Split the graph: 0.716 seconds
Construct subgraphs: 0.035 seconds
metis partition ---------------pure dgl.metis_partition spent  3.7292847633361816
12432
12040
12018
12546
12021
12287
12319
12608
12154
12544
12535
12265
12199
12452
12080
12071
metis partition time  3.7352070808410645
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012371540069580078
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.7531607151031494
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.93045711517334
self.buckets_partition() spend  sec:  3.765650987625122
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 0.4040870666503906  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 16.53196382522583  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 16.524261951446533  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 0.39638519287109375  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 16.04121494293213  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 16.043580532073975  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 0.4068460464477539  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 16.057126998901367  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 16.05979633331299  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 0.4205765724182129  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 16.60112237930298  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 16.60364294052124  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 0.4240751266479492  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 16.08359146118164  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 16.08618688583374  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 0.43442583084106445  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 16.36185646057129  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 16.36432647705078  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 0.44353628158569336  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 16.382277011871338  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 16.384610176086426  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.92919921875 GB
    Memory Allocated: 0.45789289474487305  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.40771484375 GB
    Memory Allocated: 16.796918392181396  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.40771484375 GB
    Memory Allocated: 16.799126625061035  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.40771484375 GB
    Memory Allocated: 0.46064090728759766  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.41552734375 GB
    Memory Allocated: 16.230770587921143  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.41552734375 GB
    Memory Allocated: 16.23297882080078  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.41552734375 GB
    Memory Allocated: 0.4747653007507324  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.41552734375 GB
    Memory Allocated: 16.671347618103027  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.41552734375 GB
    Memory Allocated: 16.673784255981445  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.41552734375 GB
    Memory Allocated: 0.4847264289855957  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.41552734375 GB
    Memory Allocated: 16.66984224319458  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.41552734375 GB
    Memory Allocated: 16.672589778900146  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.41552734375 GB
    Memory Allocated: 0.49004507064819336  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.41748046875 GB
    Memory Allocated: 16.391571521759033  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.41748046875 GB
    Memory Allocated: 16.39371967315674  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.41748046875 GB
    Memory Allocated: 0.4988436698913574  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.41748046875 GB
    Memory Allocated: 16.357616424560547  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.41748046875 GB
    Memory Allocated: 16.360427856445312  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.41748046875 GB
    Memory Allocated: 0.511009693145752  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.584838390350342  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.587093353271484  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.5161447525024414  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.247816562652588  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.24999761581421  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.525904655456543  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.26173162460327  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.263927936553955  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

number of input  15004825
----------------------------------------after optimizer
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.5512709617614746  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7768949270248413
pure train time :  4.28554892539978
the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 0.547 seconds, peak memory: 51.460 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 51.460 GB
Metis partitioning: 2.185 seconds, peak memory: 51.460 GB
Split the graph: 0.693 seconds
Construct subgraphs: 0.028 seconds
metis partition ---------------pure dgl.metis_partition spent  3.4547066688537598
12432
12040
12018
12546
12021
12287
12319
12608
12154
12544
12535
12265
12199
12452
12080
12071
metis partition time  3.4595839977264404
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011934041976928711
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.477501630783081
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.719585657119751
self.buckets_partition() spend  sec:  3.4895079135894775
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.4037504196166992  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.55290460586548  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.54667615890503  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.3987545967102051  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.08014965057373  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.0826153755188  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.40544557571411133  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 15.961657524108887  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 15.964049816131592  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.4214816093444824  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.634148120880127  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.636422157287598  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.42372560501098633  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.046659469604492  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.049495220184326  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.4369339942932129  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.394277572631836  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.39690637588501  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.445345401763916  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.40173101425171  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.404237747192383  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.45831727981567383  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.722529411315918  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.725165367126465  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.46137332916259766  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.243751525878906  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.246273040771484  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.47644996643066406  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.685949325561523  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.688153743743896  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.48517465591430664  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.682325839996338  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.68453025817871  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.4935879707336426  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.43094491958618  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.43363904953003  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.5010256767272949  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.366662979125977  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.369038581848145  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.5123329162597656  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.58829164505005  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.590615272521973  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.5179862976074219  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.244767665863037  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 16.247036457061768  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29248046875 GB
    Memory Allocated: 0.523674488067627  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.29833984375 GB
    Memory Allocated: 16.200467109680176  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.29833984375 GB
    Memory Allocated: 16.202735424041748  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

number of input  14993568
----------------------------------------after optimizer
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5478835105895996  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5496968030929565
pure train time :  4.057667255401611
the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 0.518 seconds, peak memory: 51.460 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 51.460 GB
Metis partitioning: 2.286 seconds, peak memory: 51.460 GB
Split the graph: 0.812 seconds
Construct subgraphs: 0.044 seconds
metis partition ---------------pure dgl.metis_partition spent  3.660815954208374
12432
12040
12018
12546
12021
12287
12319
12608
12154
12544
12535
12265
12199
12452
12080
12071
metis partition time  3.665722608566284
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012003421783447266
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.682941436767578
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.86234712600708
self.buckets_partition() spend  sec:  3.695101737976074
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.3995943069458008  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.44529962539673  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.4392728805542  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.39484310150146484  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.01390838623047  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.016801357269287  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.40776777267456055  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.09690570831299  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.099364280700684  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4216752052307129  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.66718339920044  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.669410705566406  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4222393035888672  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.066739559173584  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.06898021697998  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4360008239746094  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.41237163543701  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.415189743041992  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.44354963302612305  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.397447109222412  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.399693965911865  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4586648941040039  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.716495037078857  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.719346046447754  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4636421203613281  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.306764602661133  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.308964252471924  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.47336244583129883  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.69421148300171  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.697016716003418  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.48384618759155273  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.687288284301758  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.689563751220703  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4900050163269043  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.42062520980835  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.42284393310547  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.49513864517211914  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.324026107788086  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.326383590698242  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5091795921325684  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.599026679992676  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.60126256942749  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.515073299407959  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.268633365631104  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.270819664001465  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5222182273864746  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.216227054595947  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.219130516052246  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

number of input  15007019
----------------------------------------after optimizer
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5456509590148926  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3954182863235474
pure train time :  3.95219087600708
the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 0.493 seconds, peak memory: 51.460 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 51.460 GB
Metis partitioning: 2.235 seconds, peak memory: 51.460 GB
Split the graph: 0.993 seconds
Construct subgraphs: 0.037 seconds
metis partition ---------------pure dgl.metis_partition spent  3.7595410346984863
12523
12289
12207
12121
11985
12388
12014
11967
12621
12583
12437
12412
12002
12001
12475
12546
metis partition time  3.7645528316497803
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012688636779785156
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.7847118377685547
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.966479063034058
self.buckets_partition() spend  sec:  3.7974534034729004
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4017162322998047  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.580500602722168  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.575425624847412  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.40578317642211914  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.425421237945557  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.428050994873047  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.41135311126708984  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.301806926727295  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.304436683654785  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.417724609375  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.125444412231445  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.12785768508911  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.42582273483276367  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.060057640075684  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.06247091293335  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.43898773193359375  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.488768100738525  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.491071701049805  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.44409704208374023  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.092713356018066  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.095414638519287  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.45314836502075195  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.0607328414917  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.06309461593628  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.46965694427490234  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.771841526031494  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.774197578430176  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4754905700683594  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.67082405090332  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.673243045806885  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4840049743652344  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.56996726989746  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.572261333465576  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4913315773010254  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.51910161972046  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.521388053894043  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4955763816833496  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.119789600372314  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.122236728668213  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5057826042175293  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.169915199279785  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.172086715698242  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5199856758117676  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.668789386749268  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.67161464691162  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5297064781188965  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.728886604309082  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.73155117034912  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

number of input  14998815
----------------------------------------after optimizer
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5538396835327148  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2675340175628662
pure train time :  4.094494104385376
the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 0.467 seconds, peak memory: 51.460 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 51.460 GB
Metis partitioning: 2.181 seconds, peak memory: 51.460 GB
Split the graph: 1.405 seconds
Construct subgraphs: 0.035 seconds
metis partition ---------------pure dgl.metis_partition spent  4.0900559425354
12523
12289
12207
12121
11985
12388
12014
11967
12621
12583
12437
12412
12002
12001
12475
12546
metis partition time  4.095285892486572
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011988639831542969
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.11180305480957
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.179447889328003
self.buckets_partition() spend  sec:  4.123842239379883
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4029960632324219  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.536280632019043  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.530426025390625  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.403226375579834  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.40572738647461  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.408184051513672  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.40831899642944336  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.217482566833496  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.220001220703125  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4146742820739746  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.136478424072266  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.13860321044922  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.42145776748657227  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 15.974262237548828  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 15.976642608642578  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4402642250061035  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.516698837280273  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.51907205581665  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4435257911682129  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.097728729248047  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.10037326812744  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4523439407348633  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.070554733276367  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.073403358459473  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.46985673904418945  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.754051208496094  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.7568998336792  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4775676727294922  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.70932674407959  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.71164083480835  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.48534059524536133  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.630087852478027  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.63278102874756  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4938206672668457  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.499648571014404  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.5019474029541  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.49677371978759766  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.112319469451904  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.115203857421875  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5046100616455078  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.090003490447998  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.092470169067383  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5199804306030273  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.67625093460083  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.678479194641113  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5325784683227539  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.791266918182373  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.794011116027832  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

number of input  14998841
----------------------------------------after optimizer
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5572214126586914  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1779708862304688
pure train time :  3.7796807289123535
the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 0.571 seconds, peak memory: 51.460 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 51.460 GB
Metis partitioning: 2.307 seconds, peak memory: 51.460 GB
Split the graph: 0.704 seconds
Construct subgraphs: 0.041 seconds
metis partition ---------------pure dgl.metis_partition spent  3.624760627746582
12432
12040
12018
12546
12021
12287
12319
12608
12154
12544
12535
12265
12199
12452
12080
12071
metis partition time  3.6298415660858154
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011806488037109375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.650517225265503
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.84151291847229
self.buckets_partition() spend  sec:  3.662388563156128
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.40236616134643555  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.47818088531494  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.470914363861084  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.39651918411254883  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.03531312942505  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.03787660598755  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.40602970123291016  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.058607578277588  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.06117057800293  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4225001335144043  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.60142946243286  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.60423994064331  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4275798797607422  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.11625623703003  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.11870050430298  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.43597888946533203  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.329192638397217  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.331706523895264  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.44668006896972656  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.458334922790527  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.461044311523438  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.45943784713745117  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.719622135162354  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.72213077545166  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.46216583251953125  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.242891311645508  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.245166778564453  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4754171371459961  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.720208168029785  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.722424030303955  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.48296642303466797  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.655088424682617  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.657304286956787  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.48983097076416016  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.399823665618896  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.4019718170166  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.49920082092285156  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.299992561340332  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.302422523498535  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5103020668029785  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.599847316741943  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.602158546447754  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5151572227478027  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.273621559143066  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.275908946990967  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5233907699584961  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.25162172317505  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.254220485687256  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

number of input  14999572
----------------------------------------after optimizer
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5473432540893555  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0794569253921509
pure train time :  4.094696998596191
the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 0.537 seconds, peak memory: 51.460 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 51.460 GB
Metis partitioning: 2.199 seconds, peak memory: 51.460 GB
Split the graph: 1.318 seconds
Construct subgraphs: 0.037 seconds
metis partition ---------------pure dgl.metis_partition spent  4.098832368850708
12432
12040
12018
12546
12021
12287
12319
12608
12154
12544
12535
12265
12199
12452
12080
12071
metis partition time  4.103949546813965
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011890172958374023
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.11970329284668
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.260457992553711
self.buckets_partition() spend  sec:  4.131726980209351
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4017815589904785  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.480716705322266  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.474793910980225  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.3959498405456543  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.05522060394287  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.05743408203125  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4066047668457031  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.066571712493896  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.069201946258545  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4214334487915039  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.60233449935913  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.604753971099854  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.42610740661621094  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.10070514678955  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.103203296661377  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4371170997619629  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.338128089904785  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.34029722213745  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4471168518066406  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.38427209854126  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.387167930603027  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4586982727050781  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.711654663085938  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.714177131652832  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4639592170715332  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.264658451080322  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.267040729522705  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4765968322753906  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.653889656066895  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.65636968612671  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4857673645019531  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.673994064331055  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.676296710968018  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4916701316833496  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.41447353363037  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.41696786880493  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.49798107147216797  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.316880702972412  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.319110870361328  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5112571716308594  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.62949800491333  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.63184690475464  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5128521919250488  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.213289737701416  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.215538024902344  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5224919319152832  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.249199390411377  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.2519588470459  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

number of input  14998057
----------------------------------------after optimizer
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5456423759460449  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.003164291381836
pure train time :  4.126559734344482
the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 0.522 seconds, peak memory: 51.460 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 51.460 GB
Metis partitioning: 2.178 seconds, peak memory: 51.460 GB
Split the graph: 0.744 seconds
Construct subgraphs: 0.037 seconds
metis partition ---------------pure dgl.metis_partition spent  3.483083486557007
12523
12289
12207
12121
11985
12388
12014
11967
12621
12583
12437
12412
12002
12001
12475
12546
metis partition time  3.487837553024292
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009998083114624023
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.5060558319091797
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.724552869796753
self.buckets_partition() spend  sec:  3.5161056518554688
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.40208911895751953  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.56097936630249  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.555133819580078  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4004936218261719  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.322460651397705  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.32512331008911  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4089341163635254  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.27145528793335  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.273593425750732  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.41588306427001953  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.146399974822998  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.1486554145813  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.42280054092407227  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.00758695602417  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.01003885269165  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4375429153442383  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.520568370819092  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.522765159606934  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.43905067443847656  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.0864200592041  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.089069366455078  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.44600534439086914  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 15.985304355621338  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 15.987853050231934  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4658074378967285  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.773552894592285  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.776065349578857  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4725227355957031  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.684224605560303  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.686737060546875  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4815940856933594  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.596972942352295  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.59933853149414  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.489530086517334  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.573922157287598  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.576301097869873  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4910244941711426  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.103656768798828  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.106309413909912  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5014276504516602  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.1570987701416  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.15946674346924  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5159296989440918  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.6656494140625  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.667834281921387  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5238156318664551  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.698620319366455  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.70148515701294  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

number of input  14999068
----------------------------------------after optimizer
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5481200218200684  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9585826396942139
pure train time :  4.324361801147461
the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 0.520 seconds, peak memory: 51.460 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 51.460 GB
Metis partitioning: 2.257 seconds, peak memory: 51.460 GB
Split the graph: 0.679 seconds
Construct subgraphs: 0.037 seconds
metis partition ---------------pure dgl.metis_partition spent  3.4933838844299316
12523
12289
12207
12121
11985
12388
12014
11967
12621
12583
12437
12412
12002
12001
12475
12546
metis partition time  3.498169183731079
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010992050170898438
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.514892578125
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.731846332550049
self.buckets_partition() spend  sec:  3.5259368419647217
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4028282165527344  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.5911226272583  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.58551597595215  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4013075828552246  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.353904247283936  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.356544017791748  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4075651168823242  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.27103853225708  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.273176670074463  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.41427183151245117  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.163901329040527  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.166056632995605  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.42183780670166016  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 15.985802173614502  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 15.988253116607666  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.43585777282714844  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.51668691635132  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.51905345916748  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.44029712677001953  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.109492778778076  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.112057209014893  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.44747018814086914  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.042884826660156  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.045449256896973  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.46435070037841797  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.752342224121094  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.75522470474243  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4746251106262207  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.765404224395752  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.768521308898926  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.47777414321899414  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.542130947113037  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.544437408447266  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4864192008972168  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.51881217956543  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.521769523620605  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4900498390197754  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.107157707214355  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.1094651222229  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5005297660827637  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.16537570953369  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.167877674102783  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5132970809936523  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.62807321548462  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.630560874938965  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5221748352050781  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.65745210647583  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.65964937210083  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

number of input  15001269
----------------------------------------after optimizer
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5457940101623535  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9119027256965637
pure train time :  3.882119655609131
the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 0.571 seconds, peak memory: 51.460 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 51.460 GB
Metis partitioning: 2.158 seconds, peak memory: 51.460 GB
Split the graph: 0.696 seconds
Construct subgraphs: 0.041 seconds
metis partition ---------------pure dgl.metis_partition spent  3.468331813812256
12432
12040
12018
12546
12021
12287
12319
12608
12154
12544
12535
12265
12199
12452
12080
12071
metis partition time  3.4732866287231445
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012935638427734375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.494224786758423
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.735092878341675
self.buckets_partition() spend  sec:  3.5072178840637207
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4010462760925293  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.504096508026123  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.498550415039062  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.39593076705932617  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.016781330108643  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.01906108856201  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.40751171112060547  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.081908226013184  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.084385871887207  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.422271728515625  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.641836643218994  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.644073486328125  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.42501115798950195  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.070117473602295  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.072322368621826  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.437868595123291  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.358887195587158  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.361521244049072  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.44825267791748047  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.480417728424072  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.483012676239014  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4609537124633789  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.68684959411621  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.689265251159668  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.46640825271606445  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.265021324157715  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.26718044281006  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4804420471191406  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.689342975616455  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.691880226135254  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.48873233795166016  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.654935836791992  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.657744884490967  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4963040351867676  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.426448345184326  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.429376125335693  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4999971389770508  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.311131477355957  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.31328582763672  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5151181221008301  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.663150310516357  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.665532112121582  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5192127227783203  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.1996488571167  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.201894760131836  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5266084671020508  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.19692325592041  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.199514389038086  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

number of input  15001270
----------------------------------------after optimizer
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5509414672851562  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8748949766159058
pure train time :  3.831158399581909
the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 0.605 seconds, peak memory: 51.460 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 51.460 GB
Metis partitioning: 2.208 seconds, peak memory: 51.460 GB
Split the graph: 0.772 seconds
Construct subgraphs: 0.030 seconds
metis partition ---------------pure dgl.metis_partition spent  3.6240036487579346
12432
12040
12018
12546
12021
12287
12319
12608
12154
12544
12535
12265
12199
12452
12080
12071
metis partition time  3.628790855407715
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012756586074829102
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.645808696746826
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.840097427368164
self.buckets_partition() spend  sec:  3.6587085723876953
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4008512496948242  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.464088439941406  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.45790147781372  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.39882946014404297  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.095234394073486  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.097569465637207  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4055943489074707  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.032119274139404  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.034969806671143  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.42330312728881836  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.695303916931152  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.69844341278076  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4244856834411621  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.066707611083984  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.069121837615967  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.43628978729248047  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.309276580810547  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.3114333152771  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.44445037841796875  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.36204767227173  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.364798545837402  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.45771121978759766  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.73872423171997  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.741150856018066  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.46053457260131836  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.243436336517334  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.24593210220337  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.47589874267578125  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.710129261016846  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.71300172805786  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.48538923263549805  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.678752899169922  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.68138599395752  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.49329376220703125  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.430262088775635  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.433167934417725  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4999709129333496  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.339982986450195  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.342317581176758  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.512331485748291  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.634342670440674  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.637467861175537  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5133681297302246  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.191797733306885  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.194393157958984  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.525322437286377  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.251954555511475  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.254411697387695  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

number of input  15002465
----------------------------------------after optimizer
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5495223999023438  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8358325958251953
pure train time :  3.917923927307129
the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 0.569 seconds, peak memory: 51.460 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 51.460 GB
Metis partitioning: 2.071 seconds, peak memory: 51.460 GB
Split the graph: 1.304 seconds
Construct subgraphs: 0.037 seconds
metis partition ---------------pure dgl.metis_partition spent  3.9818637371063232
12432
12040
12018
12546
12021
12287
12319
12608
12154
12544
12535
12265
12199
12452
12080
12071
metis partition time  3.98707914352417
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01101541519165039
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.0040669441223145
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.9140400886535645
self.buckets_partition() spend  sec:  4.015131235122681
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.40046119689941406  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.478451251983643  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.47163963317871  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.3978123664855957  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.051362991333008  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.053754806518555  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4070925712585449  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.022922039031982  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.025146484375  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4211544990539551  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.614930629730225  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.617127895355225  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4271574020385742  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.101789474487305  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.10432767868042  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4372239112854004  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.332303524017334  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.334587574005127  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.44527769088745117  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.379382610321045  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.38206148147583  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.45896148681640625  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.716596126556396  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.71895933151245  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.46163082122802734  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.251527309417725  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.25366497039795  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4764261245727539  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.698400020599365  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.70088481903076  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.48654603958129883  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.743898391723633  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.74647617340088  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4909696578979492  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.42728900909424  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.42963933944702  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4987983703613281  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.349167346954346  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.351500511169434  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5083842277526855  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.566558837890625  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.56897735595703  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5117783546447754  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.187602043151855  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.19027280807495  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5212798118591309  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.220280170440674  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.222705364227295  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

number of input  14985878
----------------------------------------after optimizer
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5443296432495117  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7954285144805908
pure train time :  3.765298843383789
the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 0.453 seconds, peak memory: 51.460 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 51.460 GB
Metis partitioning: 1.952 seconds, peak memory: 51.460 GB
Split the graph: 1.195 seconds
Construct subgraphs: 0.035 seconds
metis partition ---------------pure dgl.metis_partition spent  3.6366851329803467
12523
12289
12207
12121
11985
12388
12014
11967
12621
12583
12437
12412
12002
12001
12475
12546
metis partition time  3.641547918319702
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010020971298217773
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.658162832260132
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.585081100463867
self.buckets_partition() spend  sec:  3.668241262435913
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4013175964355469  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.580322742462158  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.574588298797607  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4003005027770996  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.305259227752686  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.307973861694336  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4086909294128418  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.2563157081604  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.258453845977783  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4174489974975586  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.175255298614502  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.178150177001953  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4255976676940918  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.093773365020752  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.096436023712158  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4381899833679199  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.501261711120605  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.50348663330078  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.44027042388916016  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.046225547790527  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.04862356185913  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.44962215423583984  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.081505298614502  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.08384895324707  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4648561477661133  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.753055095672607  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.75612449645996  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4721989631652832  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.648934841156006  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.65200424194336  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.48305368423461914  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.648643970489502  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.650822162628174  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.48953962326049805  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.552493572235107  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.55475950241089  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4948244094848633  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.157390117645264  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.15955877304077  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5010671615600586  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.11332941055298  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.11546277999878  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5147552490234375  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.666564464569092  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.669641494750977  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.525942325592041  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.69925832748413  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.701737880706787  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

number of input  15001352
----------------------------------------after optimizer
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5509114265441895  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7612324357032776
pure train time :  3.7478742599487305
the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 0.488 seconds, peak memory: 51.460 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 51.460 GB
Metis partitioning: 2.007 seconds, peak memory: 51.460 GB
Split the graph: 0.798 seconds
Construct subgraphs: 0.028 seconds
metis partition ---------------pure dgl.metis_partition spent  3.3224120140075684
12432
12040
12018
12546
12021
12287
12319
12608
12154
12544
12535
12265
12199
12452
12080
12071
metis partition time  3.3275327682495117
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012337684631347656
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.3441264629364014
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.578495740890503
self.buckets_partition() spend  sec:  3.35652232170105
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4046974182128906  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.475545406341553  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.46720266342163  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.39867067337036133  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.078808784484863  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.081288814544678  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4073452949523926  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.050230503082275  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.05271053314209  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4234275817871094  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.69754648208618  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.700706958770752  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.424623966217041  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.06857395172119  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.071349143981934  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4367375373840332  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.352112770080566  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.354264736175537  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.44463348388671875  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.41003131866455  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.412734508514404  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4591054916381836  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.717461585998535  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.719847679138184  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.46060705184936523  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.22536277770996  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.22811985015869  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.47410058975219727  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.676589488983154  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.679048538208008  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4833683967590332  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.652576446533203  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.65495538711548  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.48955440521240234  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.400841236114502  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.4030704498291  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4983053207397461  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.36266279220581  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.364869594573975  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.509824275970459  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.619876861572266  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.6229887008667  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5145730972290039  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.235087871551514  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.237844944000244  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5225343704223633  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.22442388534546  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.226609230041504  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

number of input  15001868
----------------------------------------after optimizer
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5460515022277832  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7303847074508667
pure train time :  3.768681764602661
the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 0.488 seconds, peak memory: 51.460 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 51.460 GB
Metis partitioning: 1.976 seconds, peak memory: 51.460 GB
Split the graph: 0.718 seconds
Construct subgraphs: 0.027 seconds
metis partition ---------------pure dgl.metis_partition spent  3.2104179859161377
12432
12040
12018
12546
12021
12287
12319
12608
12154
12544
12535
12265
12199
12452
12080
12071
metis partition time  3.215358257293701
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011692285537719727
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.2329163551330566
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.13175892829895
self.buckets_partition() spend  sec:  3.2446742057800293
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.40126943588256836  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.48614740371704  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.479918956756592  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.3957805633544922  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.00163745880127  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.00394582748413  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.40811681747436523  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.09720277786255  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.099472999572754  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4236178398132324  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.65405035018921  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.656747817993164  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4245414733886719  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.100589275360107  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.103037357330322  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4363994598388672  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.367820262908936  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.370219707489014  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.44608068466186523  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.36922597885132  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.371625423431396  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4597620964050293  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.733705043792725  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.736403465270996  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4621095657348633  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.230878353118896  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.233294010162354  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.47557497024536133  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.689765453338623  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.692230701446533  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4847373962402344  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.74830198287964  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.750879764556885  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4877943992614746  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.417285442352295  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.4195499420166  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4977259635925293  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.35120153427124  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.35366153717041  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5076799392700195  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.599835872650146  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.602217197418213  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5123944282531738  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.18147897720337  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.183594703674316  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5223455429077148  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.216552257537842  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.21866798400879  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

number of input  14999450
----------------------------------------after optimizer
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5457544326782227  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7027067542076111
pure train time :  3.5411932468414307
the output layer 
self.num_batch (get_in_degree_bucketing) 16
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  16
Convert a graph into a bidirected graph: 0.491 seconds, peak memory: 51.460 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 51.460 GB
Metis partitioning: 1.982 seconds, peak memory: 51.460 GB
Split the graph: 0.655 seconds
Construct subgraphs: 0.044 seconds
metis partition ---------------pure dgl.metis_partition spent  3.173710584640503
12523
12289
12207
12121
11985
12388
12014
11967
12621
12583
12437
12412
12002
12001
12475
12546
metis partition time  3.178431510925293
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013024568557739258
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1996307373046875
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.0948076248168945
self.buckets_partition() spend  sec:  3.212797164916992
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.40241146087646484  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.534078121185303  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.52778959274292  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4007720947265625  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.308578968048096  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.311257362365723  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.408541202545166  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.2955961227417  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.297799587249756  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.41462087631225586  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.08891487121582  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.09103775024414  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4216146469116211  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.010897159576416  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.013020038604736  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4353971481323242  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.41777753829956  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.420154094696045  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4410686492919922  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.114130973815918  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.116315364837646  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.44924449920654297  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.08492660522461  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.087376594543457  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4676828384399414  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.781681060791016  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.784130573272705  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4729290008544922  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.686818599700928  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.689087390899658  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.47993898391723633  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.517066955566406  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.519415855407715  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4925069808959961  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.63868999481201  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.64091682434082  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.4957280158996582  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.132004261016846  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.134284496307373  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5027093887329102  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.133991718292236  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.13660717010498  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5178589820861816  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.68528938293457  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.687559604644775  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5278363227844238  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.74217414855957  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 16.744701385498047  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

number of input  14994284
----------------------------------------after optimizer
 Nvidia-smi: 19.30029296875 GB
    Memory Allocated: 0.5523953437805176  GigaBytes
Max Memory Allocated: 17.133609294891357  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6722212433815002
pure train time :  3.5549232959747314
epoch_time_list  [29.086522102355957, 26.607118606567383, 25.804901123046875, 25.400145292282104, 29.449418783187866, 27.06925129890442, 26.718812704086304, 26.434849977493286, 27.72404170036316, 27.89690399169922, 27.083741188049316, 25.963303804397583, 29.076345205307007, 26.42516326904297, 28.23308777809143, 27.042542695999146, 24.996811866760254, 27.821383714675903, 25.025132179260254, 24.760815143585205]

loading_time list   [0.5423610210418701, 0.606295108795166, 0.5864813327789307, 0.5702428817749023, 0.5521523952484131, 0.5572330951690674, 0.5602037906646729, 0.506718635559082, 0.42394065856933594, 0.4681723117828369, 0.5890853404998779, 0.4676513671875, 0.6464462280273438, 0.5076465606689453, 0.43358540534973145, 0.6132638454437256, 0.32935309410095215, 0.5114638805389404, 0.3257784843444824, 0.4956493377685547]

 data loader gen time  17.060712337493896
	---backpack schedule time  [7.104719638824463, 6.402234792709351, 6.554679870605469, 6.259178400039673, 7.0130860805511475, 6.792656421661377, 6.9366631507873535, 7.042536497116089, 7.237339735031128, 6.926299333572388, 7.326233625411987, 6.800886154174805, 6.784038782119751, 6.817715406417847, 6.9099438190460205, 6.982386589050293, 6.659153461456299, 6.6342878341674805, 6.1983911991119385, 6.1655285358428955]
	---connection_check_time_list  [7.137976169586182, 7.526162385940552, 7.298487901687622, 6.973463773727417, 9.750293731689453, 8.315014362335205, 7.207888603210449, 7.03190803527832, 8.499282836914062, 8.511990547180176, 7.6285529136657715, 6.813294172286987, 9.233918905258179, 7.054142236709595, 8.707790851593018, 7.8602166175842285, 6.409245729446411, 8.830898523330688, 7.344086647033691, 6.951312303543091]
	---block_gen_time_list  [3.624013662338257, 3.876333236694336, 3.570620536804199, 3.827183723449707, 3.9439494609832764, 3.619135618209839, 3.921619176864624, 4.07918643951416, 3.653353452682495, 4.022174596786499, 3.6850991249084473, 3.8287951946258545, 4.249039888381958, 4.0357818603515625, 3.965092658996582, 3.7709574699401855, 3.5944883823394775, 4.037358999252319, 3.4908246994018555, 3.341670036315918]
training time  [10.04803204536438, 7.492910623550415, 7.124701976776123, 7.113867282867432, 7.209136724472046, 7.061679363250732, 7.380767822265625, 7.0518505573272705, 7.239541530609131, 7.2862160205841064, 7.1192944049835205, 7.342999219894409, 7.438287019729614, 7.349443435668945, 7.489361524581909, 7.174030303955078, 7.383499622344971, 7.139645576477051, 7.040709495544434, 7.1841020584106445]
---feature block loading time  [3.5346364974975586, 3.6097261905670166, 3.4551432132720947, 2.853379964828491, 2.8136658668518066, 2.8958821296691895, 3.331456184387207, 2.8435161113739014, 3.3574790954589844, 3.084078788757324, 2.8819642066955566, 2.903733491897583, 3.45255970954895, 3.4201200008392334, 3.4806747436523438, 3.3135604858398438, 3.5290610790252686, 3.2639362812042236, 3.3947644233703613, 3.5231056213378906]


epoch_time avg   26.982600331306458
loading_time avg   0.49927152693271637
 data loader gen time avg 19.212415874004364
	---backpack schedule time avg 6.826696664094925
	---connection_check_time avg  7.884364813566208
	---block_gen_time avg  3.827407941222191
training time  7.243160292506218
---feature block loading time  3.2180973887443542
pure train time per /epoch  [6.493818044662476, 3.761484146118164, 3.568709373474121, 4.158379554748535, 4.28554892539978, 4.057667255401611, 3.95219087600708, 4.094494104385376, 3.7796807289123535, 4.094696998596191, 4.126559734344482, 4.324361801147461, 3.882119655609131, 3.831158399581909, 3.917923927307129, 3.765298843383789, 3.7478742599487305, 3.768681764602661, 3.5411932468414307, 3.5549232959747314]
pure train time average  3.934279610128964
num_input list  [15004928, 14995568, 14995753, 15000916, 15004825, 14993568, 15007019, 14998815, 14998841, 14999572, 14998057, 14999068, 15001269, 15001270, 15002465, 14985878, 15001352, 15001868, 14999450, 14994284]
num_input  average  14999238.3
