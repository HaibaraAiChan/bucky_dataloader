main start at this time 1713150078.4316266
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 1.281 seconds, peak memory: 19.342 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 19.342 GB
Metis partitioning: 2.032 seconds, peak memory: 19.628 GB
Split the graph: 0.790 seconds
Construct subgraphs: 0.035 seconds
metis partition ---------------pure dgl.metis_partition spent  4.149150848388672
13450
12768
13497
13458
12785
12810
13442
13390
12756
12750
13491
12824
13471
12788
12891
metis partition time  4.153726100921631
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010484933853149414
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.167872428894043
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.852903366088867
self.buckets_partition() spend  sec:  4.178401231765747
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.92333984375 GB
    Memory Allocated: 0.3862795829772949  GigaBytes
Max Memory Allocated: 0.3862795829772949  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.57763671875 GB
    Memory Allocated: 17.64354705810547  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.57763671875 GB
    Memory Allocated: 17.64590311050415  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.58740234375 GB
    Memory Allocated: 0.40766286849975586  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.59912109375 GB
    Memory Allocated: 16.829861164093018  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.59912109375 GB
    Memory Allocated: 16.832518577575684  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.60107421875 GB
    Memory Allocated: 0.4269242286682129  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.75146484375 GB
    Memory Allocated: 17.626713752746582  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 18.75146484375 GB
    Memory Allocated: 17.629077434539795  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 18.75146484375 GB
    Memory Allocated: 0.43702173233032227  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.68310546875 GB
    Memory Allocated: 17.594054222106934  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.68310546875 GB
    Memory Allocated: 17.59665060043335  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.68310546875 GB
    Memory Allocated: 0.4366135597229004  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.68310546875 GB
    Memory Allocated: 16.898322105407715  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.68310546875 GB
    Memory Allocated: 16.90091562271118  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.68310546875 GB
    Memory Allocated: 0.44851160049438477  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.68310546875 GB
    Memory Allocated: 16.960495471954346  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.68310546875 GB
    Memory Allocated: 16.96312427520752  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.68310546875 GB
    Memory Allocated: 0.46368980407714844  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.69091796875 GB
    Memory Allocated: 17.628132343292236  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.69091796875 GB
    Memory Allocated: 17.630698204040527  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.69287109375 GB
    Memory Allocated: 0.4728846549987793  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.69287109375 GB
    Memory Allocated: 17.608922004699707  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.69287109375 GB
    Memory Allocated: 17.61139440536499  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.69287109375 GB
    Memory Allocated: 0.4752640724182129  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.69287109375 GB
    Memory Allocated: 16.88609552383423  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.69287109375 GB
    Memory Allocated: 16.8885235786438  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.69287109375 GB
    Memory Allocated: 0.48435211181640625  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.69287109375 GB
    Memory Allocated: 16.956298351287842  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 19.69287109375 GB
    Memory Allocated: 16.958940505981445  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 19.69287109375 GB
    Memory Allocated: 0.5021963119506836  GigaBytes
Max Memory Allocated: 17.9526104927063  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.62841796875 GB
    Memory Allocated: 17.723971366882324  GigaBytes
Max Memory Allocated: 18.035747051239014  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.62841796875 GB
    Memory Allocated: 17.726436614990234  GigaBytes
Max Memory Allocated: 18.035747051239014  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.62841796875 GB
    Memory Allocated: 0.5051784515380859  GigaBytes
Max Memory Allocated: 18.035747051239014  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.62841796875 GB
    Memory Allocated: 17.037562370300293  GigaBytes
Max Memory Allocated: 18.035747051239014  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.62841796875 GB
    Memory Allocated: 17.039971828460693  GigaBytes
Max Memory Allocated: 18.035747051239014  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.62841796875 GB
    Memory Allocated: 0.5217685699462891  GigaBytes
Max Memory Allocated: 18.035747051239014  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.62841796875 GB
    Memory Allocated: 17.7431697845459  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.62841796875 GB
    Memory Allocated: 17.745680332183838  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63037109375 GB
    Memory Allocated: 0.5234107971191406  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 16.937415599822998  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 16.939857959747314  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 0.5346560478210449  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 17.096067905426025  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 17.09847116470337  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

number of input  14449567
----------------------------------------after optimizer
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 0.5617728233337402  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.2026519775390625
pure train time :  6.156156778335571
the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 0.561 seconds, peak memory: 42.814 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 42.814 GB
Metis partitioning: 1.994 seconds, peak memory: 42.814 GB
Split the graph: 1.028 seconds
Construct subgraphs: 0.046 seconds
metis partition ---------------pure dgl.metis_partition spent  3.641200542449951
13450
12768
13497
13458
12785
12810
13442
13390
12756
12750
13491
12824
13471
12788
12891
metis partition time  3.6462974548339844
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012146711349487305
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.6614878177642822
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.3545002937316895
self.buckets_partition() spend  sec:  3.6736769676208496
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 0.4145693778991699  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 17.612308979034424  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 17.605754375457764  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 0.40959930419921875  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 16.873658180236816  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 16.876270294189453  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 0.42679452896118164  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 17.656954765319824  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 17.659318447113037  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 0.43478918075561523  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 17.634042263031006  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 17.6365327835083  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 0.43753480911254883  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 16.929696559906006  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 16.932273864746094  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 0.4461555480957031  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 16.90706777572632  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 16.909509658813477  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 0.46561765670776367  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 17.641013145446777  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 17.643427848815918  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 0.47586584091186523  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 17.60170602798462  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 17.60412073135376  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 0.47830772399902344  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 16.894245624542236  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 16.896777153015137  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 0.48601818084716797  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 16.900672912597656  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 16.903414249420166  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 20.63232421875 GB
    Memory Allocated: 0.5058255195617676  GigaBytes
Max Memory Allocated: 18.053767681121826  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52490234375 GB
    Memory Allocated: 17.76198434829712  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52490234375 GB
    Memory Allocated: 17.764731407165527  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 0.5060892105102539  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 16.991124153137207  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 16.99367666244507  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 0.5228066444396973  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 17.694204807281494  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 17.6966609954834  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 0.5241689682006836  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 16.980379581451416  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 16.98287343978882  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 0.5340766906738281  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 17.069551467895508  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 17.072014331817627  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

number of input  14443482
----------------------------------------after optimizer
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 0.5589056015014648  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.4762232303619385
pure train time :  3.7013652324676514
the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 0.573 seconds, peak memory: 46.151 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.151 GB
Metis partitioning: 2.101 seconds, peak memory: 46.151 GB
Split the graph: 0.709 seconds
Construct subgraphs: 0.029 seconds
metis partition ---------------pure dgl.metis_partition spent  3.429157257080078
13423
12819
13487
13401
12782
12818
13432
12787
12788
13172
13422
12983
13044
13386
12827
metis partition time  3.4339191913604736
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012820005416870117
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.451284646987915
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.181968688964844
self.buckets_partition() spend  sec:  3.4642131328582764
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 0.41347408294677734  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 17.561760902404785  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 17.554739475250244  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 0.40984344482421875  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 16.90610361099243  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 16.90867328643799  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 0.42899513244628906  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 17.644830226898193  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 17.647827625274658  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 0.4367709159851074  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 17.51742124557495  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 17.519858837127686  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 0.4389019012451172  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 16.821277618408203  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 16.823927402496338  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 0.449857234954834  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 16.925537109375  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 16.928186893463135  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 0.4665365219116211  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 17.650915145874023  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 17.653481483459473  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 0.4701056480407715  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 16.958481788635254  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 16.960925579071045  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 0.4784379005432129  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 16.96052885055542  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 16.962841033935547  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 0.4923820495605469  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 17.362617015838623  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 17.365174770355225  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 0.5040493011474609  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 17.63952112197876  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 17.64202880859375  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 0.5102705955505371  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 17.22661828994751  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 17.228963375091553  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52685546875 GB
    Memory Allocated: 0.5198769569396973  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.26716661453247  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.269922733306885  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.5323066711425781  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.646719455718994  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.649320602416992  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.5358386039733887  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.063443183898926  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.06608533859253  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

number of input  14443795
----------------------------------------after optimizer
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.560570240020752  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7427964210510254
pure train time :  3.4206643104553223
the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 0.535 seconds, peak memory: 46.655 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.655 GB
Metis partitioning: 2.062 seconds, peak memory: 46.655 GB
Split the graph: 1.185 seconds
Construct subgraphs: 0.043 seconds
metis partition ---------------pure dgl.metis_partition spent  3.8349292278289795
13031
12786
13391
12830
13034
13387
13376
13026
12741
12730
13333
13392
13402
12772
13340
metis partition time  3.8397419452667236
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012112617492675781
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.859410047531128
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.594006538391113
self.buckets_partition() spend  sec:  3.8715760707855225
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.41059398651123047  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.14255666732788  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.136788368225098  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.40985870361328125  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.935701847076416  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.938345909118652  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.42492008209228516  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.49238348007202  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.494729042053223  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.4278292655944824  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.958364486694336  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.960976123809814  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.439633846282959  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.189740657806396  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.192498683929443  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.45136499404907227  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.491422653198242  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.493767261505127  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.4606747627258301  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.506980419158936  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.510199069976807  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.46660757064819336  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.213418006896973  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.216197967529297  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.4722142219543457  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.874234199523926  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.876952648162842  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.4813408851623535  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.887364864349365  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.89008331298828  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.49887943267822266  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.54879903793335  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.551332473754883  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.5122942924499512  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.68741226196289  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.690178394317627  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.5201201438903809  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.663009643554688  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.665565013885498  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.5228924751281738  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.9699125289917  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.97259283065796  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.539433479309082  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.648880004882812  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.65208673477173  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

number of input  14449368
----------------------------------------after optimizer
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.5654139518737793  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.2410507202148438
pure train time :  3.428396701812744
the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 0.533 seconds, peak memory: 46.683 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.683 GB
Metis partitioning: 2.070 seconds, peak memory: 46.683 GB
Split the graph: 1.670 seconds
Construct subgraphs: 0.042 seconds
metis partition ---------------pure dgl.metis_partition spent  4.3162713050842285
12792
12789
13347
12852
13277
13368
13377
12753
13327
13410
13396
12911
12797
12814
13361
metis partition time  4.320987939834595
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011545419692993164
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.337427616119385
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.031078815460205
self.buckets_partition() spend  sec:  4.349017143249512
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.40926265716552734  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.870519638061523  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.864198207855225  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.40784740447998047  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.864047050476074  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.86664915084839  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.4254417419433594  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.53800392150879  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.5403413772583  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.42738771438598633  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.983492851257324  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.985830307006836  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.4409618377685547  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.398419857025146  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.400745391845703  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.4527573585510254  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.610339164733887  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.612749099731445  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.4609389305114746  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.481250762939453  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.48366069793701  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.4636225700378418  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.89182138442993  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.894444465637207  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.4806356430053711  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.510149002075195  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.513095378875732  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.4904193878173828  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.57819890975952  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.581088066101074  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.5007658004760742  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.624183654785156  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.62694215774536  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.504615306854248  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.101970672607422  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.104340076446533  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.5112209320068359  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.97729253768921  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 16.979639530181885  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.5209612846374512  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.032983779907227  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 17.035399913787842  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.52880859375 GB
    Memory Allocated: 0.5364036560058594  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53271484375 GB
    Memory Allocated: 17.62665367126465  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53271484375 GB
    Memory Allocated: 17.629183292388916  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

number of input  14442440
----------------------------------------after optimizer
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.562924861907959  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7820844650268555
pure train time :  3.61247181892395
the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 0.577 seconds, peak memory: 46.787 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.787 GB
Metis partitioning: 2.291 seconds, peak memory: 46.787 GB
Split the graph: 0.837 seconds
Construct subgraphs: 0.047 seconds
metis partition ---------------pure dgl.metis_partition spent  3.7596452236175537
12931
12797
13385
12845
13088
13364
13345
13276
13070
12994
13144
13222
13301
12814
12995
metis partition time  3.764720916748047
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013094902038574219
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.788367509841919
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.575291156768799
self.buckets_partition() spend  sec:  3.8015244007110596
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4090089797973633  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.01477861404419  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.00775384902954  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4078946113586426  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.86342430114746  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.865828037261963  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.42563629150390625  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.60334062576294  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.605684757232666  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.428131103515625  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.905266761779785  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.9078688621521  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4420204162597656  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.26549768447876  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.268149852752686  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4531431198120117  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.514248371124268  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.51659917831421  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4609689712524414  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.48656129837036  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.488898754119873  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4713778495788574  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.46383047103882  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.466155529022217  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4761819839477539  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.21208429336548  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.21496295928955  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.48575258255004883  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.19289207458496  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.195770740509033  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.49825477600097656  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.398301601409912  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.401458740234375  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5066871643066406  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.406378746032715  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.40879774093628  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5193943977355957  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.575254440307617  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.578048706054688  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.523289680480957  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.06287717819214  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.065380096435547  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5362324714660645  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.242361068725586  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.244688510894775  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

number of input  14449914
----------------------------------------after optimizer
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5620231628417969  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5489919185638428
pure train time :  3.437052011489868
the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 0.511 seconds, peak memory: 46.935 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 46.935 GB
Metis partitioning: 2.171 seconds, peak memory: 46.943 GB
Split the graph: 0.769 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  3.492180109024048
12792
12789
13347
12852
13277
13368
13377
12753
13327
13410
13396
12911
12797
12814
13361
metis partition time  3.4972190856933594
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011760234832763672
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.514185905456543
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.2158119678497314
self.buckets_partition() spend  sec:  3.5260047912597656
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4076876640319824  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.91923189163208  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.911299228668213  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.40932798385620117  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.870802879333496  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.873429775238037  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4232349395751953  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.42489719390869  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.427234649658203  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.42766284942626953  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.951666355133057  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.954136848449707  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.44315528869628906  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.475202560424805  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.478361129760742  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4531211853027344  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.529649257659912  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.532736778259277  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.46274757385253906  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.589635372161865  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.592495441436768  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.46669578552246094  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.946188926696777  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.948819160461426  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4818453788757324  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.582162857055664  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.584659099578857  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4910268783569336  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.63188886642456  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.634390830993652  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5010218620300293  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.612460136413574  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.61492681503296  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5044670104980469  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.193883419036865  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.196186065673828  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5090866088867188  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.9547176361084  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.957327365875244  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5203442573547363  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.99452829360962  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.997138023376465  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5364899635314941  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.60438632965088  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.606844425201416  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

number of input  14450289
----------------------------------------after optimizer
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5629744529724121  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3915013074874878
pure train time :  3.427246570587158
the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 0.516 seconds, peak memory: 47.053 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.053 GB
Metis partitioning: 2.077 seconds, peak memory: 47.053 GB
Split the graph: 0.742 seconds
Construct subgraphs: 0.044 seconds
metis partition ---------------pure dgl.metis_partition spent  3.38066029548645
13423
12819
13487
13401
12782
12818
13432
12787
12788
13172
13422
12983
13044
13386
12827
metis partition time  3.3853909969329834
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011546850204467773
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.4083542823791504
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.084648609161377
self.buckets_partition() spend  sec:  3.419956922531128
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4158763885498047  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.57191228866577  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.564963817596436  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4105796813964844  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.905643939971924  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.90828227996826  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4275054931640625  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.691057205200195  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.69414758682251  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.43614959716796875  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.513426303863525  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.51602840423584  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4388127326965332  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.885849952697754  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.88850164413452  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.44989776611328125  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.012977600097656  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.015482425689697  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4639701843261719  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.632904052734375  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.635273933410645  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.46473264694213867  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.933001041412354  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.935526847839355  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.47513437271118164  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.93760395050049  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.940297603607178  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.48654651641845703  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.28891086578369  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.291458129882812  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5009560585021973  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.621144771575928  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.62370252609253  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.50616455078125  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.210721015930176  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.213850021362305  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5155248641967773  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.283947944641113  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.286592960357666  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5296344757080078  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.64348268508911  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.645930767059326  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5316481590270996  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.095834255218506  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.098308563232422  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

number of input  14447473
----------------------------------------after optimizer
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5567092895507812  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.271937370300293
pure train time :  3.413463592529297
the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 0.431 seconds, peak memory: 47.053 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.053 GB
Metis partitioning: 1.941 seconds, peak memory: 47.053 GB
Split the graph: 0.702 seconds
Construct subgraphs: 0.028 seconds
metis partition ---------------pure dgl.metis_partition spent  3.1031713485717773
13031
12786
13391
12830
13034
13387
13376
13026
12741
12730
13333
13392
13402
12772
13340
metis partition time  3.107933759689331
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011403799057006836
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1256611347198486
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.819889545440674
self.buckets_partition() spend  sec:  3.1371145248413086
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.41035032272338867  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.18525791168213  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.179518222808838  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.40721607208251953  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.84613847732544  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.848792552947998  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.42676353454589844  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.498413562774658  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.50075912475586  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.42923688888549805  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.883761405944824  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.88631010055542  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.44049882888793945  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.10854482650757  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.111785888671875  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4583773612976074  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.58949041366577  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.592544078826904  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4651646614074707  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.539029121398926  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.54181957244873  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.47122859954833984  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.184756755828857  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.187057495117188  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4765739440917969  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.930076599121094  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.932377338409424  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.48539066314697266  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.914395809173584  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.91707420349121  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.499021053314209  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.52346897125244  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.526639938354492  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5122942924499512  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.707741737365723  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.71034574508667  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5172901153564453  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.577622413635254  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.579969882965088  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5218524932861328  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.995717525482178  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.998416900634766  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.535454273223877  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.600501537322998  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.602838039398193  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

number of input  14442234
----------------------------------------after optimizer
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5615267753601074  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1776001453399658
pure train time :  3.627317190170288
the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 0.452 seconds, peak memory: 47.053 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.053 GB
Metis partitioning: 1.904 seconds, peak memory: 47.053 GB
Split the graph: 0.864 seconds
Construct subgraphs: 0.042 seconds
metis partition ---------------pure dgl.metis_partition spent  3.2632734775543213
13423
12819
13487
13401
12782
12818
13432
12787
12788
13172
13422
12983
13044
13386
12827
metis partition time  3.268223524093628
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01016092300415039
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.290295362472534
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.985495567321777
self.buckets_partition() spend  sec:  3.300586462020874
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.41642189025878906  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.62731170654297  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.619263648986816  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4104437828063965  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.906071186065674  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.908650398254395  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4278068542480469  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.623635292053223  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.626503944396973  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.43747854232788086  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.51177167892456  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.514277458190918  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4401063919067383  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.941317081451416  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.943774223327637  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.45084381103515625  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.93346881866455  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.93607473373413  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.46826887130737305  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.662391185760498  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.66483974456787  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4694399833679199  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.951391220092773  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.953813552856445  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.47762250900268555  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.935299396514893  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.937840461730957  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4901556968688965  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.368991374969482  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.37144660949707  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5039238929748535  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.619965076446533  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.62287473678589  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5063896179199219  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.181195735931396  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.184383869171143  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.518040657043457  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.241676807403564  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.24461078643799  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5307097434997559  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.61373472213745  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.61636734008789  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5335016250610352  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.036907196044922  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.039318561553955  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

number of input  14443973
----------------------------------------after optimizer
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5577511787414551  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.085847020149231
pure train time :  3.6449573040008545
the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 0.584 seconds, peak memory: 47.053 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.053 GB
Metis partitioning: 2.261 seconds, peak memory: 47.053 GB
Split the graph: 0.691 seconds
Construct subgraphs: 0.038 seconds
metis partition ---------------pure dgl.metis_partition spent  3.5753276348114014
13450
12768
13497
13458
12785
12810
13442
13390
12756
12750
13491
12824
13471
12788
12891
metis partition time  3.5804290771484375
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014648914337158203
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.5996859073638916
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.533231496810913
self.buckets_partition() spend  sec:  3.614473342895508
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4157695770263672  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.618541717529297  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.613487720489502  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.40967226028442383  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.856170654296875  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.858856678009033  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.42873382568359375  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.64838218688965  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.65074586868286  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4361414909362793  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.59481191635132  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.59800148010254  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.43902587890625  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.915960788726807  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.918578147888184  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4485807418823242  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.899276733398438  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.901894092559814  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4663386344909668  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.614838123321533  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.618010997772217  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.47785091400146484  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.60229730606079  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.605470180511475  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4803009033203125  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.85732126235962  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.860102653503418  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.48782873153686523  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.92401361465454  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.926634788513184  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5076699256896973  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.7449312210083  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.74814224243164  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5149197578430176  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.09643316268921  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.098913192749023  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5279808044433594  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.7270565032959  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.72962188720703  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5294384956359863  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.987634658813477  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.99015188217163  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5392961502075195  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.098828315734863  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.101274013519287  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

number of input  14443969
----------------------------------------after optimizer
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5647673606872559  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0017116069793701
pure train time :  3.4428045749664307
the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 0.484 seconds, peak memory: 47.053 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.053 GB
Metis partitioning: 2.102 seconds, peak memory: 47.053 GB
Split the graph: 1.001 seconds
Construct subgraphs: 0.028 seconds
metis partition ---------------pure dgl.metis_partition spent  3.6164634227752686
13031
12786
13391
12830
13034
13387
13376
13026
12741
12730
13333
13392
13402
12772
13340
metis partition time  3.6216602325439453
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011120319366455078
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.642345666885376
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.333504676818848
self.buckets_partition() spend  sec:  3.653520107269287
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.41048240661621094  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.131733417510986  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.125864028930664  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.40981101989746094  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.905434131622314  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.90773868560791  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4274783134460449  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.583526134490967  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.58641290664673  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.42838239669799805  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.9703311920166  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.972763538360596  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4392566680908203  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.095974445343018  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.09833812713623  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.45563411712646484  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.533745288848877  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.53608989715576  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.46556806564331055  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.54622983932495  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.54947566986084  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4698143005371094  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.20348358154297  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.20632791519165  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4753389358520508  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.885844707489014  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.888290882110596  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.48515796661376953  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.88321352005005  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.88560438156128  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5029253959655762  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.612674713134766  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.61531400680542  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5117249488830566  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.592551708221436  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.595537185668945  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5243368148803711  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.69381809234619  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.696165561676025  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.52301025390625  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.927226066589355  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.929816246032715  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5408668518066406  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.606813430786133  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.6100172996521  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

number of input  14447958
----------------------------------------after optimizer
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5665345191955566  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9586969614028931
pure train time :  3.4392170906066895
the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 0.385 seconds, peak memory: 47.053 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.053 GB
Metis partitioning: 2.029 seconds, peak memory: 47.053 GB
Split the graph: 0.674 seconds
Construct subgraphs: 0.030 seconds
metis partition ---------------pure dgl.metis_partition spent  3.1194393634796143
13423
12819
13487
13401
12782
12818
13432
12787
12788
13172
13422
12983
13044
13386
12827
metis partition time  3.124232530593872
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010801553726196289
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.145761489868164
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.854113340377808
self.buckets_partition() spend  sec:  3.156614303588867
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4148869514465332  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.562435626983643  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.55649709701538  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.40833139419555664  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.92257261276245  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.925046920776367  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4253101348876953  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.69100332260132  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.693365573883057  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4340176582336426  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.570157051086426  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.57332992553711  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.43564558029174805  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.848527431488037  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.851207733154297  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4469747543334961  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.939407348632812  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.942001819610596  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4649033546447754  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.680257320404053  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.68295907974243  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.46611833572387695  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.936931610107422  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.939522743225098  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4736151695251465  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.922913551330566  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.925544261932373  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4864468574523926  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.283390045166016  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.286004543304443  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5002155303955078  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.553669929504395  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.556636333465576  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5025548934936523  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.14209508895874  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.144424438476562  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5154857635498047  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.313114166259766  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.315632820129395  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5280780792236328  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.679594039916992  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.68231725692749  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5313286781311035  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.081507205963135  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.08412265777588  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

number of input  14443071
----------------------------------------after optimizer
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5552330017089844  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.914436399936676
pure train time :  3.612030029296875
the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 0.457 seconds, peak memory: 47.053 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.053 GB
Metis partitioning: 1.982 seconds, peak memory: 47.053 GB
Split the graph: 0.961 seconds
Construct subgraphs: 0.030 seconds
metis partition ---------------pure dgl.metis_partition spent  3.431462049484253
13423
12819
13487
13401
12782
12818
13432
12787
12788
13172
13422
12983
13044
13386
12827
metis partition time  3.4361321926116943
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010776042938232422
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.452592134475708
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.150308132171631
self.buckets_partition() spend  sec:  3.4634268283843994
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.41532278060913086  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.57715892791748  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.571415424346924  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4075760841369629  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.897780895233154  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.90028953552246  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.427886962890625  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.632176399230957  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.634538650512695  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4362473487854004  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.560331344604492  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.56269359588623  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4404921531677246  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.913736820220947  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.9162654876709  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4492340087890625  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.913513660430908  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.91615581512451  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4682741165161133  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.721485137939453  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.723893642425537  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.46920251846313477  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.974113941192627  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.976771354675293  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.47837018966674805  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.9488205909729  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.95139217376709  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.49030208587646484  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.291038036346436  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.293588161468506  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5035204887390137  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.650081634521484  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.652607440948486  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5076003074645996  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.225151538848877  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.228137493133545  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5174765586853027  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.240028858184814  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.242720127105713  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5314297676086426  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.628252029418945  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.631415843963623  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5334987640380859  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.033061504364014  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.035634994506836  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

number of input  14448296
----------------------------------------after optimizer
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.557774543762207  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8795275688171387
pure train time :  3.450432538986206
the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 0.518 seconds, peak memory: 47.053 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.053 GB
Metis partitioning: 1.995 seconds, peak memory: 47.053 GB
Split the graph: 1.197 seconds
Construct subgraphs: 0.037 seconds
metis partition ---------------pure dgl.metis_partition spent  3.755676507949829
13031
12786
13391
12830
13034
13387
13376
13026
12741
12730
13333
13392
13402
12772
13340
metis partition time  3.7609212398529053
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01254582405090332
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.782750368118286
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.471725940704346
self.buckets_partition() spend  sec:  3.795423984527588
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4105257987976074  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.160507202148438  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.154715061187744  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4094266891479492  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.883068561553955  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.8854341506958  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4248838424682617  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.510676383972168  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.513521194458008  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.42827796936035156  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.88860845565796  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.8909649848938  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4405488967895508  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.199900150299072  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.20260238647461  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.45365333557128906  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.6121826171875  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.61502504348755  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4635934829711914  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.53910207748413  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.542035579681396  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.46735048294067383  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.191808223724365  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.194727897644043  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.47426939010620117  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.91888666152954  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.921576499938965  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4807004928588867  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.85355043411255  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.855827808380127  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4987974166870117  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.57490587234497  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.578003883361816  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5077247619628906  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.62668800354004  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.62928009033203  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5172100067138672  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.65309762954712  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.65585947036743  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5186500549316406  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.927072048187256  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.92983627319336  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5354385375976562  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.580537796020508  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.58318042755127  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

number of input  14447311
----------------------------------------after optimizer
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5618257522583008  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8351514339447021
pure train time :  3.4395804405212402
the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 0.427 seconds, peak memory: 47.053 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.053 GB
Metis partitioning: 2.017 seconds, peak memory: 47.053 GB
Split the graph: 0.709 seconds
Construct subgraphs: 0.024 seconds
metis partition ---------------pure dgl.metis_partition spent  3.1778411865234375
13031
12786
13391
12830
13034
13387
13376
13026
12741
12730
13333
13392
13402
12772
13340
metis partition time  3.1825387477874756
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010829448699951172
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.2059943675994873
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.920432090759277
self.buckets_partition() spend  sec:  3.216867685317993
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4119291305541992  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.161635875701904  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.15515899658203  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4086189270019531  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.90554904937744  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.90812063217163  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.42429351806640625  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.492099285125732  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.495158672332764  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.42864561080932617  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.94936466217041  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.951798915863037  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4396824836730957  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.18769073486328  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.190250396728516  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.45250511169433594  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.49427604675293  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.496737003326416  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4620680809020996  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.58298921585083  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.58557367324829  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4653501510620117  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.11809539794922  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.120380878448486  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.47409677505493164  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.925645351409912  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.92793083190918  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.479825496673584  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.800467014312744  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.803040027618408  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4989023208618164  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.610296726226807  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.613555431365967  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5092082023620605  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.645917415618896  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.64897584915161  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5169601440429688  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.650190353393555  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.652771949768066  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5210614204406738  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.981188774108887  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.983558177947998  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5346555709838867  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.56367254257202  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.566039085388184  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

number of input  14437435
----------------------------------------after optimizer
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5602340698242188  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7969078421592712
pure train time :  3.450852155685425
the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 0.414 seconds, peak memory: 47.103 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.103 GB
Metis partitioning: 1.891 seconds, peak memory: 47.103 GB
Split the graph: 0.727 seconds
Construct subgraphs: 0.035 seconds
metis partition ---------------pure dgl.metis_partition spent  3.0686259269714355
13423
12819
13487
13401
12782
12818
13432
12787
12788
13172
13422
12983
13044
13386
12827
metis partition time  3.0733113288879395
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011367321014404297
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.0931146144866943
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.767972707748413
self.buckets_partition() spend  sec:  3.1045308113098145
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4152989387512207  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.557325839996338  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.551822662353516  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.41309118270874023  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.95939540863037  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.96197271347046  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.42857885360717773  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.643869400024414  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.646231651306152  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4373002052307129  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.605456352233887  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.608009338378906  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4397158622741699  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.90639019012451  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.90905523300171  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4492983818054199  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.945109844207764  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.947416305541992  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.46506690979003906  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.62667989730835  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.62919330596924  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.46514320373535156  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.913284301757812  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.915716648101807  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.47490978240966797  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.930697917938232  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.933131217956543  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4905276298522949  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.293346881866455  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.29592800140381  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5026869773864746  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.581965923309326  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.584914207458496  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5086936950683594  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.18450403213501  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.18681240081787  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.518157958984375  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.307340145111084  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.309834957122803  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5316953659057617  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.687349796295166  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.68990468978882  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5334062576293945  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.06491756439209  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.067420482635498  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

number of input  14447949
----------------------------------------after optimizer
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5584416389465332  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7638668417930603
pure train time :  3.4450056552886963
the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 0.375 seconds, peak memory: 47.103 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.103 GB
Metis partitioning: 1.882 seconds, peak memory: 47.103 GB
Split the graph: 0.738 seconds
Construct subgraphs: 0.037 seconds
metis partition ---------------pure dgl.metis_partition spent  3.0349535942077637
13423
12819
13487
13401
12782
12818
13432
12787
12788
13172
13422
12983
13044
13386
12827
metis partition time  3.040039539337158
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009592533111572266
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.0594117641448975
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.777771472930908
self.buckets_partition() spend  sec:  3.0691394805908203
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.41542673110961914  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.573516368865967  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.56750726699829  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4101104736328125  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.941163063049316  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.943681240081787  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4261808395385742  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.632891178131104  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.635419368743896  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.43720245361328125  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.631510257720947  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.634031295776367  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4364304542541504  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.80948495864868  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.81221866607666  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4457120895385742  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.922147274017334  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.924768447875977  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.46145105361938477  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.59588623046875  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.598238945007324  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4663815498352051  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.95379066467285  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.956438541412354  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4745979309082031  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.914411067962646  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.91705894470215  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.48812389373779297  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.34911298751831  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.35194969177246  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5034236907958984  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.649500846862793  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.652337551116943  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5086860656738281  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.24225664138794  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.245067596435547  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5162115097045898  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.26138973236084  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.26413631439209  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5299530029296875  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.61832332611084  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.621022701263428  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5308389663696289  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.019027709960938  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.02152109146118  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

number of input  14446403
----------------------------------------after optimizer
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5551714897155762  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7321005463600159
pure train time :  3.445444107055664
the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 0.429 seconds, peak memory: 47.253 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.253 GB
Metis partitioning: 1.898 seconds, peak memory: 47.253 GB
Split the graph: 0.698 seconds
Construct subgraphs: 0.027 seconds
metis partition ---------------pure dgl.metis_partition spent  3.0541493892669678
13423
12819
13487
13401
12782
12818
13432
12787
12788
13172
13422
12983
13044
13386
12827
metis partition time  3.0587570667266846
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010776281356811523
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.077838182449341
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.741562128067017
self.buckets_partition() spend  sec:  3.088660955429077
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4151430130004883  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.58208179473877  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.576108932495117  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4079122543334961  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.852492332458496  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.85508680343628  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.42749500274658203  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.631103515625  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.63346576690674  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.43753480911254883  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.587823390960693  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.590806484222412  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.43877363204956055  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.941800117492676  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.94442892074585  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.44603729248046875  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.937626838684082  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.939880847930908  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.46363258361816406  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.555039405822754  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.557880878448486  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4645576477050781  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.928959369659424  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.931586265563965  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4752616882324219  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.968117713928223  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.970716953277588  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.48920249938964844  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.384934425354004  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.387309551239014  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5019321441650391  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.670199871063232  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.672580242156982  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.507103443145752  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.22418737411499  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.226463317871094  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5159754753112793  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.269365787506104  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.272109031677246  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.529594898223877  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.66169834136963  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.664475917816162  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5338077545166016  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.002958297729492  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.00549030303955  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

number of input  14444907
----------------------------------------after optimizer
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5588698387145996  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7035202383995056
pure train time :  3.443211555480957
the output layer 
self.num_batch (get_in_degree_bucketing) 15
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  15
Convert a graph into a bidirected graph: 0.404 seconds, peak memory: 47.253 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.253 GB
Metis partitioning: 1.855 seconds, peak memory: 47.253 GB
Split the graph: 0.663 seconds
Construct subgraphs: 0.024 seconds
metis partition ---------------pure dgl.metis_partition spent  2.947880983352661
12931
12797
13385
12845
13088
13364
13345
13276
13070
12994
13144
13222
13301
12814
12995
metis partition time  2.9524567127227783
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011280298233032227
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.9700121879577637
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  5.649187803268433
self.buckets_partition() spend  sec:  2.981343984603882
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4091916084289551  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.065664768218994  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.05834674835205  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4094223976135254  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.911884784698486  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.914170265197754  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4232473373413086  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.542859077453613  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.54520320892334  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.42610645294189453  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.964422702789307  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.96692943572998  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4370694160461426  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.18443727493286  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.186767578125  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.44926929473876953  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.458735942840576  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.461076736450195  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.45786476135253906  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.471392154693604  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.473896980285645  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.46872806549072266  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.456599712371826  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.45901107788086  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4774904251098633  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.309524536132812  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.312456607818604  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.4850473403930664  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.18280553817749  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.185138702392578  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.49414634704589844  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.320966720581055  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.323373317718506  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5060396194458008  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.43251609802246  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.435086250305176  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5176534652709961  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.57819890975952  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.581039905548096  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.518214225769043  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.931955337524414  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 16.93446636199951  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5314393043518066  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.24540901184082  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 17.248406887054443  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

number of input  14441110
----------------------------------------after optimizer
 Nvidia-smi: 22.53466796875 GB
    Memory Allocated: 0.5571489334106445  GigaBytes
Max Memory Allocated: 18.074084281921387  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6758370399475098
pure train time :  3.4526097774505615
epoch_time_list  [29.114405632019043, 27.819956064224243, 25.3879337310791, 25.4389386177063, 25.68758201599121, 27.488061904907227, 25.445260763168335, 24.935794830322266, 23.743632316589355, 27.22424077987671, 28.33451247215271, 25.092748880386353, 25.26383352279663, 24.748321056365967, 24.20176863670349, 24.236720323562622, 23.350374460220337, 23.40044331550598, 23.297727823257446, 23.40699005126953]

loading_time list   [0.543083667755127, 0.605867862701416, 0.5940430164337158, 0.5583689212799072, 0.5474388599395752, 0.6815319061279297, 0.531461238861084, 0.5231246948242188, 0.41485023498535156, 0.44284772872924805, 0.6163649559020996, 0.3269643783569336, 0.4651327133178711, 0.3758275508880615, 0.410433292388916, 0.3838839530944824, 0.33440589904785156, 0.39395761489868164, 0.40569591522216797, 0.38369321823120117]

 data loader gen time  16.11349129676819
	---backpack schedule time  [6.931081056594849, 6.429304599761963, 6.267916440963745, 6.679602861404419, 7.105664968490601, 6.647882461547852, 6.283502817153931, 6.1468892097473145, 5.880259275436401, 6.05586576461792, 6.611857175827026, 6.415865421295166, 5.915719509124756, 6.214611530303955, 6.530054569244385, 5.985019683837891, 5.8272600173950195, 5.828042268753052, 5.80578088760376, 5.704302549362183]
	---connection_check_time_list  [7.104865550994873, 8.32026481628418, 7.333391904830933, 6.90048360824585, 6.899455547332764, 8.931973218917847, 7.788019895553589, 7.31917667388916, 6.396817207336426, 9.278635740280151, 9.279993772506714, 7.192692279815674, 7.388447046279907, 6.721896648406982, 6.4041619300842285, 7.081218957901001, 6.144621849060059, 6.260874509811401, 6.134652376174927, 6.752291202545166]
	---block_gen_time_list  [4.0692760944366455, 4.347114324569702, 3.4905800819396973, 3.5303943157196045, 3.4941465854644775, 3.5232534408569336, 3.274240732192993, 3.401047468185425, 3.8288183212280273, 3.9156298637390137, 4.135206937789917, 3.6097049713134766, 3.731717586517334, 3.78460431098938, 3.3594045639038086, 3.2177836894989014, 3.5299453735351562, 3.4166018962860107, 3.481520652770996, 3.0672924518585205]
training time  [9.830295324325562, 7.40507173538208, 7.019767999649048, 7.137421131134033, 7.00339674949646, 7.0174806118011475, 6.937365293502808, 6.936655521392822, 6.621483564376831, 6.855285167694092, 7.028518915176392, 6.935777902603149, 7.160081386566162, 7.045228719711304, 6.870553970336914, 6.964897394180298, 6.912431478500366, 6.8886847496032715, 6.881287336349487, 6.891024112701416]
---feature block loading time  [3.656841993331909, 3.5838379859924316, 3.4910929203033447, 3.5959017276763916, 3.279954433441162, 3.471100091934204, 3.402663230895996, 3.412956714630127, 2.8630874156951904, 3.0971360206604004, 3.4774415493011475, 3.385571241378784, 3.437407970428467, 3.483703374862671, 3.321532726287842, 3.4058499336242676, 3.359318494796753, 3.3370113372802734, 3.330051898956299, 3.3311104774475098]


epoch_time avg   24.99112582206726
loading_time avg   0.4523508846759796
 data loader gen time avg 17.581732481718063
	---backpack schedule time avg 6.184911131858826
	---connection_check_time avg  7.2484330534935
	---block_gen_time avg  3.548182427883148
training time  6.9343845546245575
---feature block loading time  3.3372435569763184
pure train time per /epoch  [6.156156778335571, 3.7013652324676514, 3.4206643104553223, 3.428396701812744, 3.61247181892395, 3.437052011489868, 3.427246570587158, 3.413463592529297, 3.627317190170288, 3.6449573040008545, 3.4428045749664307, 3.4392170906066895, 3.612030029296875, 3.450432538986206, 3.4395804405212402, 3.450852155685425, 3.4450056552886963, 3.445444107055664, 3.443211555480957, 3.4526097774505615]
pure train time average  3.4830643008737003
num_input list  [14449567, 14443482, 14443795, 14449368, 14442440, 14449914, 14450289, 14447473, 14442234, 14443973, 14443969, 14447958, 14443071, 14448296, 14447311, 14437435, 14447949, 14446403, 14444907, 14441110]
num_input  average  14445547.2
