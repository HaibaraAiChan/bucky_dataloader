main start at this time 1713153925.3894541
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 1.276 seconds, peak memory: 19.343 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 19.343 GB
Metis partitioning: 2.057 seconds, peak memory: 19.660 GB
Split the graph: 0.520 seconds
Construct subgraphs: 0.034 seconds
metis partition ---------------pure dgl.metis_partition spent  3.8995707035064697
9135
9135
8878
9048
9027
9125
9156
8722
9135
8716
8719
8694
8790
9126
9103
9118
8980
8741
8732
8721
9055
8715
metis partition time  3.9039113521575928
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009330034255981445
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.9178171157836914
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.831295013427734
self.buckets_partition() spend  sec:  3.9271795749664307
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.84912109375 GB
    Memory Allocated: 0.32314538955688477  GigaBytes
Max Memory Allocated: 0.32314538955688477  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.60693359375 GB
    Memory Allocated: 12.781134128570557  GigaBytes
Max Memory Allocated: 12.990994453430176  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.60693359375 GB
    Memory Allocated: 12.782734870910645  GigaBytes
Max Memory Allocated: 12.990994453430176  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.61474609375 GB
    Memory Allocated: 0.3467068672180176  GigaBytes
Max Memory Allocated: 12.990994453430176  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.30615234375 GB
    Memory Allocated: 12.75655460357666  GigaBytes
Max Memory Allocated: 12.990994453430176  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.30615234375 GB
    Memory Allocated: 12.75815486907959  GigaBytes
Max Memory Allocated: 12.990994453430176  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.30615234375 GB
    Memory Allocated: 0.34818267822265625  GigaBytes
Max Memory Allocated: 12.990994453430176  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.31005859375 GB
    Memory Allocated: 12.450782775878906  GigaBytes
Max Memory Allocated: 12.990994453430176  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.31005859375 GB
    Memory Allocated: 12.452512264251709  GigaBytes
Max Memory Allocated: 12.990994453430176  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.31005859375 GB
    Memory Allocated: 0.35579681396484375  GigaBytes
Max Memory Allocated: 12.990994453430176  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.33154296875 GB
    Memory Allocated: 12.620422840118408  GigaBytes
Max Memory Allocated: 12.990994453430176  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.33154296875 GB
    Memory Allocated: 12.622007846832275  GigaBytes
Max Memory Allocated: 12.990994453430176  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.33154296875 GB
    Memory Allocated: 0.3628091812133789  GigaBytes
Max Memory Allocated: 12.990994453430176  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.33154296875 GB
    Memory Allocated: 12.67434024810791  GigaBytes
Max Memory Allocated: 12.990994453430176  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.33154296875 GB
    Memory Allocated: 12.675921440124512  GigaBytes
Max Memory Allocated: 12.990994453430176  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.33154296875 GB
    Memory Allocated: 0.37072324752807617  GigaBytes
Max Memory Allocated: 12.990994453430176  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.02685546875 GB
    Memory Allocated: 12.821466445922852  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.02685546875 GB
    Memory Allocated: 12.823064804077148  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.02685546875 GB
    Memory Allocated: 0.3762187957763672  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.05224609375 GB
    Memory Allocated: 12.783631324768066  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.05224609375 GB
    Memory Allocated: 12.785327911376953  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.05224609375 GB
    Memory Allocated: 0.37235450744628906  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.05224609375 GB
    Memory Allocated: 12.275944709777832  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.05224609375 GB
    Memory Allocated: 12.277560234069824  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.05224609375 GB
    Memory Allocated: 0.38722658157348633  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.05224609375 GB
    Memory Allocated: 12.79623031616211  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.05224609375 GB
    Memory Allocated: 12.798092365264893  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.05224609375 GB
    Memory Allocated: 0.3842182159423828  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.05224609375 GB
    Memory Allocated: 12.275943756103516  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.05224609375 GB
    Memory Allocated: 12.278011798858643  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.05224609375 GB
    Memory Allocated: 0.3907771110534668  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.06201171875 GB
    Memory Allocated: 12.328293323516846  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.06201171875 GB
    Memory Allocated: 12.330117225646973  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.06201171875 GB
    Memory Allocated: 0.3955211639404297  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.06982421875 GB
    Memory Allocated: 12.28786849975586  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.06982421875 GB
    Memory Allocated: 12.289879322052002  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.06982421875 GB
    Memory Allocated: 0.4017324447631836  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.06982421875 GB
    Memory Allocated: 12.382030963897705  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.06982421875 GB
    Memory Allocated: 12.383952140808105  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.06982421875 GB
    Memory Allocated: 0.41375112533569336  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.06982421875 GB
    Memory Allocated: 12.81301736831665  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.06982421875 GB
    Memory Allocated: 12.814615726470947  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.06982421875 GB
    Memory Allocated: 0.41849327087402344  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.08935546875 GB
    Memory Allocated: 12.748170375823975  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.08935546875 GB
    Memory Allocated: 12.74983835220337  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.08935546875 GB
    Memory Allocated: 0.42505884170532227  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.08935546875 GB
    Memory Allocated: 12.794436931610107  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.08935546875 GB
    Memory Allocated: 12.79612684249878  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.08935546875 GB
    Memory Allocated: 0.4278836250305176  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.10107421875 GB
    Memory Allocated: 12.629355907440186  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.10107421875 GB
    Memory Allocated: 12.630929946899414  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.10107421875 GB
    Memory Allocated: 0.4285893440246582  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.10107421875 GB
    Memory Allocated: 12.35340166091919  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.10107421875 GB
    Memory Allocated: 12.354975700378418  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.10107421875 GB
    Memory Allocated: 0.43344926834106445  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.10693359375 GB
    Memory Allocated: 12.293910026550293  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.10693359375 GB
    Memory Allocated: 12.295740127563477  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.10693359375 GB
    Memory Allocated: 0.4381752014160156  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.352551460266113  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.354084968566895  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.45391273498535156  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.775492191314697  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.77707815170288  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.4507894515991211  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.320003509521484  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.32209825515747  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

number of input  17868596
----------------------------------------after optimizer
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.46949243545532227  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.20408821105957
pure train time :  5.469909906387329
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 0.547 seconds, peak memory: 36.864 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 36.864 GB
Metis partitioning: 2.072 seconds, peak memory: 36.878 GB
Split the graph: 0.494 seconds
Construct subgraphs: 0.033 seconds
metis partition ---------------pure dgl.metis_partition spent  3.1582648754119873
9135
9135
8878
9048
9027
9125
9156
8722
9135
8716
8719
8694
8790
9126
9103
9118
8980
8741
8732
8721
9055
8715
metis partition time  3.162640333175659
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011640310287475586
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1781094074249268
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.166668176651001
self.buckets_partition() spend  sec:  3.189790964126587
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.3474555015563965  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.754016876220703  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.750271320343018  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.34924793243408203  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.803321838378906  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.804922103881836  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.3507843017578125  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.484774112701416  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.486473083496094  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.357635498046875  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.636545181274414  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.638244152069092  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.3636026382446289  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.638391017913818  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.63997220993042  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.3719630241394043  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.757521629333496  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.759398937225342  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.3782787322998047  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.783981800079346  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.785585403442383  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.37575435638427734  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.271159172058105  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.273278713226318  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.38754844665527344  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.765638828277588  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.767375469207764  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.3847646713256836  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.28119945526123  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.282987117767334  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.3924999237060547  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.323096752166748  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.325141906738281  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.3971529006958008  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.302359580993652  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.304393291473389  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.40317249298095703  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.36192798614502  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.363625049591064  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.41559362411499023  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.781399250030518  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.783798217773438  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.4206671714782715  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.806470394134521  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.808249473571777  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.42746591567993164  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.804992198944092  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.807240962982178  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.4310431480407715  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.651663780212402  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.653270244598389  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.43048763275146484  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.380299091339111  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.381905555725098  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.4364609718322754  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.351711750030518  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.353658199310303  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.4414234161376953  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.353477954864502  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.355483055114746  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.4517488479614258  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.716400623321533  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.718240737915039  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.4515256881713867  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.319204807281494  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.321297645568848  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

number of input  17854472
----------------------------------------after optimizer
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.46834373474121094  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.471567153930664
pure train time :  4.770061492919922
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 0.573 seconds, peak memory: 38.313 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 38.313 GB
Metis partitioning: 2.258 seconds, peak memory: 38.313 GB
Split the graph: 0.630 seconds
Construct subgraphs: 0.040 seconds
metis partition ---------------pure dgl.metis_partition spent  3.5138638019561768
8715
8700
8965
8796
9200
8674
9203
8725
9046
8996
9133
9199
8790
9000
9194
8950
9200
8780
8674
9203
8678
8750
metis partition time  3.51853346824646
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014549493789672852
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.5402629375457764
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.876630544662476
self.buckets_partition() spend  sec:  3.5548617839813232
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.3396873474121094  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.261635780334473  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.258286952972412  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.3400387763977051  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.176967144012451  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.178938388824463  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.3515496253967285  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.560914039611816  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.562488079071045  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.3509650230407715  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.294164657592773  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 12.295738697052002  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.13037109375 GB
    Memory Allocated: 0.36748647689819336  GigaBytes
Max Memory Allocated: 13.032554626464844  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.860787868499756  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.86266279220581  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.36383914947509766  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.266334533691406  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.268465518951416  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.37746524810791016  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.844131469726562  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.845828533172607  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.3732438087463379  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.249181270599365  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.251256942749023  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.38498592376708984  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.659473419189453  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.661057949066162  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.3913850784301758  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.618105411529541  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.619698524475098  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.3986845016479492  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.782407760620117  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.784467220306396  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.4044308662414551  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.835556983947754  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.83788776397705  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.40288734436035156  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.381832599639893  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.383795738220215  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.41472816467285156  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.686400413513184  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.688363552093506  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.42176246643066406  GigaBytes
Max Memory Allocated: 13.073741436004639  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.880126476287842  GigaBytes
Max Memory Allocated: 13.092990398406982  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.882467269897461  GigaBytes
Max Memory Allocated: 13.092990398406982  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.4242744445800781  GigaBytes
Max Memory Allocated: 13.092990398406982  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.600077152252197  GigaBytes
Max Memory Allocated: 13.092990398406982  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.601714134216309  GigaBytes
Max Memory Allocated: 13.092990398406982  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.4347987174987793  GigaBytes
Max Memory Allocated: 13.092990398406982  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.909139633178711  GigaBytes
Max Memory Allocated: 13.120926856994629  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.910776615142822  GigaBytes
Max Memory Allocated: 13.120926856994629  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.43003225326538086  GigaBytes
Max Memory Allocated: 13.120926856994629  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.387590408325195  GigaBytes
Max Memory Allocated: 13.120926856994629  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.389219760894775  GigaBytes
Max Memory Allocated: 13.120926856994629  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.43563175201416016  GigaBytes
Max Memory Allocated: 13.120926856994629  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.347122192382812  GigaBytes
Max Memory Allocated: 13.120926856994629  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.349180698394775  GigaBytes
Max Memory Allocated: 13.120926856994629  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.4506402015686035  GigaBytes
Max Memory Allocated: 13.120926856994629  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.920823574066162  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.922882080078125  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.44666099548339844  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.2858247756958  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.287436962127686  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.4540371894836426  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.412031650543213  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.413572311401367  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

number of input  17861221
----------------------------------------after optimizer
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.4711637496948242  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.730139970779419
pure train time :  4.4890031814575195
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 0.538 seconds, peak memory: 45.949 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.949 GB
Metis partitioning: 2.320 seconds, peak memory: 45.949 GB
Split the graph: 0.682 seconds
Construct subgraphs: 0.041 seconds
metis partition ---------------pure dgl.metis_partition spent  3.5813944339752197
8715
8700
8965
8796
9200
8674
9203
8725
9046
8996
9133
9199
8790
9000
9194
8950
9200
8780
8674
9203
8678
8750
metis partition time  3.586042881011963
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013856649398803711
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.605696678161621
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.591496706008911
self.buckets_partition() spend  sec:  3.6195991039276123
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.3401827812194824  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.25818157196045  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.254444122314453  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.3399796485900879  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.185964584350586  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.187499523162842  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.3516249656677246  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.546531200408936  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.548149108886719  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.3526148796081543  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.319453716278076  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.321006774902344  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.3659653663635254  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.829680919647217  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.831692218780518  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.36249780654907227  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.209602355957031  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.21132516860962  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.3755946159362793  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.829231262207031  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.830896377563477  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.3720736503601074  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.234269142150879  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.235823631286621  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.3862318992614746  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.73259973526001  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.734356880187988  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.3904142379760742  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.620460033416748  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.622045516967773  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.39803457260131836  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.792954444885254  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 12.794724464416504  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.57177734375 GB
    Memory Allocated: 0.4063882827758789  GigaBytes
Max Memory Allocated: 13.13410758972168  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.940324306488037  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.941981792449951  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4036688804626465  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.393065929412842  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.394723415374756  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.41336488723754883  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.644585132598877  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.646172523498535  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.42346715927124023  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.8870530128479  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.888663291931152  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.42458438873291016  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.652588367462158  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.654371738433838  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43299198150634766  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.896597862243652  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.898789405822754  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43166160583496094  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.405574798583984  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.407463550567627  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4351072311401367  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.292445659637451  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.294416904449463  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4504857063293457  GigaBytes
Max Memory Allocated: 13.153647422790527  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.942977905273438  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.944687366485596  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.44660186767578125  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.328282356262207  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.330380916595459  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4520707130432129  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.406766414642334  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.408763885498047  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

number of input  17861355
----------------------------------------after optimizer
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.46919679641723633  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.2352004051208496
pure train time :  4.367109775543213
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 0.552 seconds, peak memory: 47.088 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.088 GB
Metis partitioning: 2.231 seconds, peak memory: 47.132 GB
Split the graph: 0.669 seconds
Construct subgraphs: 0.030 seconds
metis partition ---------------pure dgl.metis_partition spent  3.482633113861084
8715
8700
8965
8796
9200
8674
9203
8725
9046
8996
9133
9199
8790
9000
9194
8950
9200
8780
8674
9203
8678
8750
metis partition time  3.487339735031128
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013257741928100586
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.5047991275787354
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.436362266540527
self.buckets_partition() spend  sec:  3.5181219577789307
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3398752212524414  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.246239185333252  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.24279260635376  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.34131288528442383  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.238016605377197  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.239681720733643  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.35129785537719727  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.556743621826172  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.558364868164062  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.35267114639282227  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.341108798980713  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.342867851257324  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.36631345748901367  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.825757026672363  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.827991962432861  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3619656562805176  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.199235916137695  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.200937271118164  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3773064613342285  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.834375381469727  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.83613109588623  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.37540721893310547  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.36779260635376  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.36957597732544  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.38506603240966797  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.667656421661377  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.669589519500732  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.39144182205200195  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.621167182922363  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.622743129730225  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3980379104614258  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.787033081054688  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.788888454437256  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.40438270568847656  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.823574542999268  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.825429916381836  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.40734291076660156  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.477428436279297  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.479138851165771  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.41248321533203125  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.665013313293457  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.666612148284912  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.42208290100097656  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.884479999542236  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.886377811431885  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.423311710357666  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.601144790649414  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.602766513824463  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43434858322143555  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.933179378509521  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.93480110168457  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43085813522338867  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.385830879211426  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.38780927658081  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43530941009521484  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.288215160369873  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.289807319641113  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.44925832748413086  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.916598320007324  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.918210506439209  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4475846290588379  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.323989868164062  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.326151371002197  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.452392578125  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.367673873901367  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.369694232940674  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

number of input  17865522
----------------------------------------after optimizer
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.46956729888916016  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7774574756622314
pure train time :  4.143428087234497
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 0.463 seconds, peak memory: 47.176 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.176 GB
Metis partitioning: 2.269 seconds, peak memory: 47.176 GB
Split the graph: 0.682 seconds
Construct subgraphs: 0.034 seconds
metis partition ---------------pure dgl.metis_partition spent  3.449888229370117
8715
8700
8965
8796
9200
8674
9203
8725
9046
8996
9133
9199
8790
9000
9194
8950
9200
8780
8674
9203
8678
8750
metis partition time  3.45430588722229
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010279417037963867
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.472956895828247
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.364095211029053
self.buckets_partition() spend  sec:  3.4832873344421387
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.34202051162719727  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.322929859161377  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.319485664367676  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3395233154296875  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.187533378601074  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.189151763916016  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3512539863586426  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.565695762634277  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.56731367111206  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.35221195220947266  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.308281898498535  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.309899806976318  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3662838935852051  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.827698707580566  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.829646110534668  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.36359214782714844  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.252525329589844  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.254381656646729  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3781752586364746  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.872835159301758  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.874804973602295  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3731832504272461  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.233330249786377  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.235079765319824  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.38557910919189453  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.656777381896973  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.65917158126831  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.39020347595214844  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.619266510009766  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.620842456817627  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3985142707824707  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.815962314605713  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.817562103271484  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4056868553161621  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.891606330871582  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.893469333648682  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4035477638244629  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.405252933502197  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.406839370727539  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.41472721099853516  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.688557624816895  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.690446853637695  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4220871925354004  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.851497650146484  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.853107929229736  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.42485713958740234  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.629342079162598  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.631107330322266  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4338231086730957  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.91175651550293  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.913490295410156  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43114376068115234  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.402031421661377  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.403903007507324  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.434112548828125  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.274951934814453  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.276666641235352  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4503312110900879  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.92050552368164  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.922220230102539  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4458446502685547  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.271407127380371  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.273470878601074  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4531288146972656  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.429468154907227  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.431242942810059  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

number of input  17866952
----------------------------------------after optimizer
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.47029685974121094  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.5480737686157227
pure train time :  4.145544052124023
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 0.403 seconds, peak memory: 47.208 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.208 GB
Metis partitioning: 2.217 seconds, peak memory: 47.208 GB
Split the graph: 0.854 seconds
Construct subgraphs: 0.039 seconds
metis partition ---------------pure dgl.metis_partition spent  3.514636754989624
8715
8700
8965
8796
9200
8674
9203
8725
9046
8996
9133
9199
8790
9000
9194
8950
9200
8780
8674
9203
8678
8750
metis partition time  3.519310474395752
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.015127182006835938
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.5397565364837646
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.478914022445679
self.buckets_partition() spend  sec:  3.5549283027648926
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3370857238769531  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.152628421783447  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.1491379737854  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.34005069732666016  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.212417125701904  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.214146137237549  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3519425392150879  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.610752582550049  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.61236572265625  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.35341644287109375  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.336442947387695  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.338062763214111  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.36614418029785156  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.858980178833008  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.86115026473999  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3636441230773926  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.256176471710205  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.25798511505127  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.37759971618652344  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.848246097564697  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.849861145019531  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3742051124572754  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.271873950958252  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.273648738861084  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.38602447509765625  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.700779438018799  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.702363967895508  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.39116907119750977  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.625000953674316  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.626611232757568  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.39971494674682617  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.850590705871582  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.852200984954834  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.40534257888793945  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.875848770141602  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.878420352935791  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4050107002258301  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.417832374572754  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.419504642486572  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.41493988037109375  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.678983688354492  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.68065595626831  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.42266273498535156  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.89194917678833  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.893559455871582  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.42462587356567383  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.619527339935303  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.62114143371582  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43288660049438477  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.902603149414062  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.90421724319458  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4300246238708496  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.372617244720459  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.37457275390625  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4340825080871582  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.24619436264038  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.248149871826172  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4510040283203125  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.921492576599121  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.923229694366455  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4456949234008789  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.314079761505127  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.316189765930176  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4545297622680664  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.408443450927734  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.41047716140747  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

number of input  17867579
----------------------------------------after optimizer
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4711027145385742  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3927725553512573
pure train time :  4.1462790966033936
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 0.429 seconds, peak memory: 47.208 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.208 GB
Metis partitioning: 2.189 seconds, peak memory: 47.208 GB
Split the graph: 1.531 seconds
Construct subgraphs: 0.041 seconds
metis partition ---------------pure dgl.metis_partition spent  4.19101357460022
8715
8700
8965
8796
9200
8674
9203
8725
9046
8996
9133
9199
8790
9000
9194
8950
9200
8780
8674
9203
8678
8750
metis partition time  4.195559978485107
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012838125228881836
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  4.214856147766113
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  8.161768198013306
self.buckets_partition() spend  sec:  4.227818965911865
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.33919572830200195  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.255421161651611  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.25156831741333  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3409433364868164  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.238373756408691  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.240066051483154  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3508591651916504  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.522609233856201  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.524206638336182  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3525686264038086  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.328003406524658  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.329587459564209  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3668856620788574  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.834457874298096  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.836424827575684  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3651895523071289  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.27534008026123  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.277442455291748  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3770112991333008  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.837738037109375  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.83935022354126  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3751821517944336  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.3034348487854  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.305047035217285  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.38582706451416016  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.674559116363525  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.676594734191895  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3917679786682129  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.695393562316895  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.69734525680542  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.39740705490112305  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.76509714126587  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.76703691482544  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4054083824157715  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.86229133605957  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.863919258117676  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4040966033935547  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.433691501617432  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.435369491577148  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.41446924209594727  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.684335231781006  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.686013221740723  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.42402076721191406  GigaBytes
Max Memory Allocated: 13.156018257141113  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.953245639801025  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.955423831939697  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.42180824279785156  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.53341817855835  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.535042762756348  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.432070255279541  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.898421287536621  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.901007652282715  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43176889419555664  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.402981758117676  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.404937267303467  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4342665672302246  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.249671459197998  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.251886367797852  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4507598876953125  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.924443244934082  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.926721572875977  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4457583427429199  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.298404693603516  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.300118446350098  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.45274829864501953  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.431828498840332  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.433465957641602  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

number of input  17860468
----------------------------------------after optimizer
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4696526527404785  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2706429958343506
pure train time :  4.161462783813477
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 0.464 seconds, peak memory: 47.242 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.242 GB
Metis partitioning: 2.142 seconds, peak memory: 47.248 GB
Split the graph: 0.821 seconds
Construct subgraphs: 0.029 seconds
metis partition ---------------pure dgl.metis_partition spent  3.4565701484680176
8715
8700
8965
8796
9200
8674
9203
8725
9046
8996
9133
9199
8790
9000
9194
8950
9200
8780
8674
9203
8678
8750
metis partition time  3.4611995220184326
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011591196060180664
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.4801993370056152
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.466219902038574
self.buckets_partition() spend  sec:  3.4919111728668213
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.34067773818969727  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.231882095336914  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.228512287139893  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3397331237792969  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.209303855895996  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.211042404174805  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3510146141052246  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.511894226074219  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.513513088226318  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.35286951065063477  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.34946346282959  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.351054668426514  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3663620948791504  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.856817722320557  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.858435153961182  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.36412477493286133  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.262327671051025  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.26406478881836  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.37633371353149414  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.837187767028809  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.839183330535889  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.37370967864990234  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.270159721374512  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.271776676177979  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3843345642089844  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.655116558074951  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.65709114074707  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3918304443359375  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.66007661819458  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.661673545837402  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.39954423904418945  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.790834903717041  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.792739391326904  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4053053855895996  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.870232582092285  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.872137069702148  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4039578437805176  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.38847541809082  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.390234470367432  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4136815071105957  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.679476261138916  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.681235313415527  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4226984977722168  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.880706787109375  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.882558822631836  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4245147705078125  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.595434188842773  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.597053527832031  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43195056915283203  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.88962173461914  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.891471862792969  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43029069900512695  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.415450096130371  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.417184829711914  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43440675735473633  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.268407344818115  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.270100593566895  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.45113134384155273  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.930507183074951  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.932434558868408  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.44561338424682617  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.294104099273682  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.295867919921875  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.45313072204589844  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.419888973236084  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.421489715576172  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

number of input  17856502
----------------------------------------after optimizer
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.47034502029418945  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1740025281906128
pure train time :  4.146023273468018
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 0.436 seconds, peak memory: 47.392 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.392 GB
Metis partitioning: 1.906 seconds, peak memory: 47.392 GB
Split the graph: 0.598 seconds
Construct subgraphs: 0.031 seconds
metis partition ---------------pure dgl.metis_partition spent  2.97219181060791
9135
9135
8878
9048
9027
9125
9156
8722
9135
8716
8719
8694
8790
9126
9103
9118
8980
8741
8732
8721
9055
8715
metis partition time  2.9767212867736816
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01115870475769043
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  2.995692491531372
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  6.920813083648682
self.buckets_partition() spend  sec:  3.006903886795044
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3489255905151367  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.748312950134277  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.74467658996582  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.349578857421875  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.796482563018799  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.798083305358887  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3500990867614746  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.452489852905273  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.454090118408203  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3581681251525879  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.644984722137451  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.646569728851318  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.36325740814208984  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.594412326812744  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.595993518829346  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3716897964477539  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.75712251663208  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.759151935577393  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3760242462158203  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.76185131072998  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.763880729675293  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3769412040710449  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.308318614959717  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.310379028320312  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.38846826553344727  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.765563011169434  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.76762342453003  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3877573013305664  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.331659317016602  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.333679676055908  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.39049720764160156  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.267524242401123  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.269643783569336  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.39544105529785156  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.227526187896729  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.229357719421387  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.40391016006469727  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.408215045928955  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.409946918487549  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.41636037826538086  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.815273761749268  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.817138671875  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4193611145019531  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.75634765625  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.758153438568115  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4282073974609375  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.827023983001709  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.82862138748169  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4291963577270508  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.625936508178711  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.627537250518799  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4303016662597656  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.346254348754883  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.34785509109497  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43714237213134766  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.362334251403809  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.364402294158936  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.44194984436035156  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.380501747131348  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.38249921798706  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.45282554626464844  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.76231861114502  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.764316082000732  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.45302677154541016  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.361105918884277  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.363094806671143  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

number of input  17863374
----------------------------------------after optimizer
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4699416160583496  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0821559429168701
pure train time :  4.146068334579468
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 0.466 seconds, peak memory: 47.392 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.392 GB
Metis partitioning: 2.110 seconds, peak memory: 47.392 GB
Split the graph: 0.596 seconds
Construct subgraphs: 0.035 seconds
metis partition ---------------pure dgl.metis_partition spent  3.219985246658325
8715
8700
8965
8796
9200
8674
9203
8725
9046
8996
9133
9199
8790
9000
9194
8950
9200
8780
8674
9203
8678
8750
metis partition time  3.2247068881988525
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01140284538269043
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.2442104816436768
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.208105564117432
self.buckets_partition() spend  sec:  3.2556653022766113
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.33875417709350586  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.241596698760986  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.238187789916992  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.34027528762817383  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.213122367858887  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.214708805084229  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.35204124450683594  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.559168815612793  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.560794353485107  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.35228824615478516  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.342866897583008  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.344492435455322  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3661537170410156  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.832636833190918  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.834452152252197  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3640623092651367  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.221312522888184  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.222839832305908  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3771538734436035  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.841593742370605  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.84320592880249  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.37201547622680664  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.22350263595581  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.225037097930908  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3860359191894531  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.724593162536621  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.72617769241333  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.39182043075561523  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.656122207641602  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.657698154449463  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.39800024032592773  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.764644145965576  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.766998291015625  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.40540504455566406  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.877589702606201  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.879387855529785  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4039030075073242  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.36957836151123  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.371498584747314  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4139437675476074  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.684626579284668  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.686253070831299  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.42270708084106445  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.898440837860107  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.900296211242676  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.424227237701416  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.600496768951416  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.602071762084961  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43335819244384766  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.900681972503662  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.90298080444336  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43081140518188477  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.433542251586914  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.435095310211182  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43389034271240234  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.271838188171387  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.273385524749756  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.45120668411254883  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.918407440185547  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.920019626617432  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.44567441940307617  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.28772783279419  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.289600849151611  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.45328664779663086  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.3914213180542  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.393006324768066  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

number of input  17858188
----------------------------------------after optimizer
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4705018997192383  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0025678873062134
pure train time :  4.141020774841309
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 0.459 seconds, peak memory: 47.394 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.394 GB
Metis partitioning: 2.034 seconds, peak memory: 47.394 GB
Split the graph: 1.155 seconds
Construct subgraphs: 0.043 seconds
metis partition ---------------pure dgl.metis_partition spent  3.692220449447632
9135
9135
8878
9048
9027
9125
9156
8722
9135
8716
8719
8694
8790
9126
9103
9118
8980
8741
8732
8721
9055
8715
metis partition time  3.696849822998047
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011382341384887695
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.7160983085632324
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.646506071090698
self.buckets_partition() spend  sec:  3.7275333404541016
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.34896230697631836  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.788386821746826  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.784655094146729  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3495144844055176  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.763667583465576  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.765267848968506  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.34958362579345703  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.430355072021484  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.431955337524414  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.35891151428222656  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.689597129821777  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.691182136535645  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3627495765686035  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.597966194152832  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.5995512008667  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.37097883224487305  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.749985218048096  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.752129554748535  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.37741804122924805  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.789458274841309  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.791061878204346  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.37584352493286133  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.286939144134521  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.288990020751953  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.38985729217529297  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.851715564727783  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.853766441345215  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3845682144165039  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.246774673461914  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.24831771850586  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.39212703704833984  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.312320232391357  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.314390182495117  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.39592695236206055  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.257966041564941  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.259838104248047  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.402097225189209  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.37529468536377  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.377259731292725  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.41625308990478516  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.819500923156738  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.821465969085693  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.41940736770629883  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.765756607055664  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.767351150512695  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.42594051361083984  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.75456953048706  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.756362438201904  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4288616180419922  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.597179889678955  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.598841667175293  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43063831329345703  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.3647780418396  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.366366863250732  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.437924861907959  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.412413120269775  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.414383888244629  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4408297538757324  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.35159969329834  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.353562831878662  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.45569372177124023  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.80931806564331  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.810904026031494  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.45201873779296875  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.35285234451294  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.354933738708496  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

number of input  17861623
----------------------------------------after optimizer
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.468904972076416  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9615357518196106
pure train time :  4.146937370300293
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 0.441 seconds, peak memory: 47.394 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.394 GB
Metis partitioning: 2.016 seconds, peak memory: 47.394 GB
Split the graph: 0.817 seconds
Construct subgraphs: 0.039 seconds
metis partition ---------------pure dgl.metis_partition spent  3.3140923976898193
9135
9135
8878
9048
9027
9125
9156
8722
9135
8716
8719
8694
8790
9126
9103
9118
8980
8741
8732
8721
9055
8715
metis partition time  3.3186511993408203
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011852025985717773
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.336921215057373
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.333693504333496
self.buckets_partition() spend  sec:  3.348886013031006
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.347135066986084  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.737945556640625  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.73413896560669  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3496580123901367  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.756479263305664  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.758260250091553  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.34943532943725586  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.410726547241211  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.41236400604248  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.35898256301879883  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.687979698181152  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.689617156982422  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3626852035522461  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.57496690750122  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.57658576965332  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3716921806335449  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.763291835784912  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.764890193939209  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3758401870727539  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.767751216888428  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.769411087036133  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3748345375061035  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.27308988571167  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.275218963623047  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.38918590545654297  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.7787446975708  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.780484676361084  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.38682985305786133  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.3131103515625  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.315199375152588  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.39075422286987305  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.271720886230469  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.273460865020752  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.396822452545166  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.297203540802002  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.29885721206665  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.40442800521850586  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.401713371276855  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.40339994430542  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.41582441329956055  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.811856269836426  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.81346845626831  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4221663475036621  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.823289394378662  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.824933528900146  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4269576072692871  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.812852382659912  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.814667224884033  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43017053604125977  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.657420635223389  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.65923547744751  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4313821792602539  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.383579730987549  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.38553524017334  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43668699264526367  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.358532428741455  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.360533714294434  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4418630599975586  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.348379135131836  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.350380420684814  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4531545639038086  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.80767297744751  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.809258937835693  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4528040885925293  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.361216068267822  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.363094806671143  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

number of input  17869806
----------------------------------------after optimizer
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4693264961242676  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.9129177331924438
pure train time :  4.174858808517456
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 0.451 seconds, peak memory: 47.403 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.403 GB
Metis partitioning: 2.140 seconds, peak memory: 47.403 GB
Split the graph: 0.528 seconds
Construct subgraphs: 0.029 seconds
metis partition ---------------pure dgl.metis_partition spent  3.149965524673462
8715
8700
8965
8796
9200
8674
9203
8725
9046
8996
9133
9199
8790
9000
9194
8950
9200
8780
8674
9203
8678
8750
metis partition time  3.1545310020446777
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010309219360351562
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1723008155822754
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.1082072257995605
self.buckets_partition() spend  sec:  3.1826655864715576
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.34054040908813477  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.244121551513672  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.24022388458252  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.34002113342285156  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.200439453125  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.202035427093506  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3521151542663574  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.610652923583984  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.612223148345947  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.35338926315307617  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.332318305969238  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.334323406219482  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3665146827697754  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.85120964050293  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.853145599365234  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.36035871505737305  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.148633003234863  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.15047836303711  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3788418769836426  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.916194915771484  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.917952537536621  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3734707832336426  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.2674880027771  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.269609451293945  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.38688087463378906  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.713464736938477  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.715049266815186  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.39036989212036133  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.652143955230713  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.653826236724854  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3994307518005371  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.806979656219482  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.808595657348633  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4058341979980469  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.876210689544678  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.878190040588379  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.40284061431884766  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.393579959869385  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.395387649536133  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4138469696044922  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.685839653015137  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.687511920928955  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4234580993652344  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.896613121032715  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.898393154144287  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.42237091064453125  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.558168888092041  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.559784412384033  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4329643249511719  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.905653953552246  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.90818738937378  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.432586669921875  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.39184284210205  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.393819332122803  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43360424041748047  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.242274761199951  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.244198322296143  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4502105712890625  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.911655902862549  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.913761138916016  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4464144706726074  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.306056499481201  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.307697772979736  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4535989761352539  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.430743217468262  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.432700634002686  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

number of input  17863221
----------------------------------------after optimizer
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.47078895568847656  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.876482367515564
pure train time :  4.486880302429199
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 0.479 seconds, peak memory: 47.421 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.421 GB
Metis partitioning: 2.145 seconds, peak memory: 47.421 GB
Split the graph: 0.828 seconds
Construct subgraphs: 0.036 seconds
metis partition ---------------pure dgl.metis_partition spent  3.503997564315796
8715
8700
8965
8796
9200
8674
9203
8725
9046
8996
9133
9199
8790
9000
9194
8950
9200
8780
8674
9203
8678
8750
metis partition time  3.508788585662842
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011545181274414062
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.529005527496338
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.5148351192474365
self.buckets_partition() spend  sec:  3.5406084060668945
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.33918142318725586  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.21628475189209  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.212919235229492  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.34171485900878906  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.24811601638794  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.250184059143066  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3526468276977539  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.614363193511963  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.615958213806152  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3531684875488281  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.36378812789917  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.36538314819336  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3670830726623535  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.833048820495605  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.834827423095703  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.36234092712402344  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.204575538635254  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.206359386444092  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.37780237197875977  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.852459907531738  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.854235649108887  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.37302541732788086  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.277406692504883  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.279061317443848  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3845829963684082  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.653658390045166  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.655242919921875  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.39133596420288086  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.622689723968506  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.625115871429443  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3984951972961426  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.75416612625122  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.75586986541748  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4052882194519043  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.87996244430542  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.88187837600708  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.40407848358154297  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.394029140472412  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.395685195922852  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.41410398483276367  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.674673080444336  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.676326274871826  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4228949546813965  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.911357402801514  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.913073539733887  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4236912727355957  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.608601570129395  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.61020803451538  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4337592124938965  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.898331642150879  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.900185108184814  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43150901794433594  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.418498516082764  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.420346736907959  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4339580535888672  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.267503261566162  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.269560813903809  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.45090579986572266  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.935986518859863  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.93775749206543  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.44585084915161133  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.296395778656006  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.298041820526123  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4529242515563965  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.377710342407227  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.379314422607422  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

number of input  17867026
----------------------------------------after optimizer
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4700746536254883  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8332375288009644
pure train time :  4.592716932296753
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 0.494 seconds, peak memory: 47.421 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.421 GB
Metis partitioning: 2.061 seconds, peak memory: 47.461 GB
Split the graph: 0.569 seconds
Construct subgraphs: 0.040 seconds
metis partition ---------------pure dgl.metis_partition spent  3.166503667831421
9135
9135
8878
9048
9027
9125
9156
8722
9135
8716
8719
8694
8790
9126
9103
9118
8980
8741
8732
8721
9055
8715
metis partition time  3.171344518661499
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01200103759765625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.1924657821655273
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.153558731079102
self.buckets_partition() spend  sec:  3.2045319080352783
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.34743785858154297  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.734760284423828  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.731156349182129  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3491811752319336  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.761722564697266  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.763606071472168  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3513979911804199  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.448204517364502  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.449998378753662  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3587965965270996  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.68080997467041  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.682519912719727  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.36589765548706055  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.692038536071777  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.693974494934082  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.37189579010009766  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.778355121612549  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.779957294464111  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3781561851501465  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.834062576293945  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.836361408233643  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.37689876556396484  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.338499069213867  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.340525150299072  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.38957977294921875  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.84378719329834  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.845813274383545  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.38421058654785156  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.223395347595215  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.225257396697998  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3911323547363281  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.298563957214355  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.30063009262085  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.39551830291748047  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.232858180999756  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.234399795532227  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.40361785888671875  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.430718898773193  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.43225908279419  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.41359996795654297  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.758599281311035  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.7608962059021  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.42124414443969727  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.807211875915527  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.809099674224854  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4253835678100586  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.770872116088867  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.772469520568848  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.42986249923706055  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.627685546875  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.629333972930908  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4298872947692871  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.377982139587402  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.37963056564331  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4350252151489258  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.295257568359375  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.297226428985596  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.440584659576416  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.32160997390747  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.323695182800293  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4524369239807129  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.75731372833252  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.759011268615723  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4517345428466797  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.310238361358643  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.311769008636475  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

number of input  17849188
----------------------------------------after optimizer
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4676194190979004  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7953879833221436
pure train time :  4.638675689697266
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 0.499 seconds, peak memory: 47.461 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.461 GB
Metis partitioning: 2.492 seconds, peak memory: 47.461 GB
Split the graph: 0.691 seconds
Construct subgraphs: 0.044 seconds
metis partition ---------------pure dgl.metis_partition spent  3.7272510528564453
8715
8700
8965
8796
9200
8674
9203
8725
9046
8996
9133
9199
8790
9000
9194
8950
9200
8780
8674
9203
8678
8750
metis partition time  3.731125831604004
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.014569282531738281
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.752671957015991
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  8.106170654296875
self.buckets_partition() spend  sec:  3.767406463623047
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3405423164367676  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.23906421661377  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.23569631576538  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3401479721069336  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.241452693939209  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.243465423583984  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3508434295654297  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.526565074920654  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.52814531326294  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3531780242919922  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.37606430053711  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.377607345581055  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.367584228515625  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.861918449401855  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.863680839538574  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.36226654052734375  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.193367958068848  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.195003986358643  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.37727880477905273  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.849711418151855  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.85134744644165  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.376070499420166  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.291539669036865  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.293558120727539  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3853888511657715  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.665284156799316  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.667340755462646  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.3915691375732422  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.611586570739746  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.613200664520264  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4012923240661621  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.852123737335205  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.853737831115723  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.40555524826049805  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.863770484924316  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.865685939788818  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4040184020996094  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.382364749908447  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.384358406066895  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.41403865814208984  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.689950466156006  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.691944122314453  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.4222745895385742  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.88020133972168  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.882551193237305  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.42468833923339844  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.597493648529053  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 12.599101066589355  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.27099609375 GB
    Memory Allocated: 0.43491315841674805  GigaBytes
Max Memory Allocated: 13.165934085845947  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.981531620025635  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.983980178833008  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.43016910552978516  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.384541034698486  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.386509895324707  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.43240928649902344  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.26493787765503  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.267065525054932  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.44940757751464844  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.855895042419434  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.857544422149658  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.44577598571777344  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.294854164123535  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.296467304229736  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.45172929763793945  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.387465000152588  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.389184951782227  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

number of input  17865772
----------------------------------------after optimizer
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4687614440917969  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7599130868911743
pure train time :  4.452175617218018
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 0.461 seconds, peak memory: 47.970 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 47.970 GB
Metis partitioning: 2.269 seconds, peak memory: 47.987 GB
Split the graph: 0.528 seconds
Construct subgraphs: 0.034 seconds
metis partition ---------------pure dgl.metis_partition spent  3.293905019760132
8715
8700
8965
8796
9200
8674
9203
8725
9046
8996
9133
9199
8790
9000
9194
8950
9200
8780
8674
9203
8678
8750
metis partition time  3.2987215518951416
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011776924133300781
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.317199945449829
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.305893421173096
self.buckets_partition() spend  sec:  3.3290367126464844
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.33873987197875977  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.241806030273438  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.238425731658936  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.33985137939453125  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.195181369781494  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.196759700775146  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.3509640693664551  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.610845565795898  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.61242389678955  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.3537321090698242  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.35816478729248  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.359758377075195  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.3665289878845215  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.857789516448975  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.859884262084961  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.3629155158996582  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.259898662567139  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.261599063873291  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.37629079818725586  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.836382865905762  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.837995052337646  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.3726515769958496  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.221455097198486  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.223067283630371  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.3860640525817871  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.626044273376465  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.627923488616943  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.3906383514404297  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.600300788879395  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.601902484893799  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.39855098724365234  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.795291423797607  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.796891212463379  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4053807258605957  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.875370979309082  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.87698221206665  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4033961296081543  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.381093502044678  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.383058547973633  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4123530387878418  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.6335129737854  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.635478019714355  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4217538833618164  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.891047477722168  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.89265775680542  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.42451953887939453  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.609684944152832  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.611314296722412  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.43444061279296875  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.906592845916748  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.908222198486328  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.43117427825927734  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.379626750946045  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.381637573242188  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4354276657104492  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.279692649841309  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.281513214111328  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4498739242553711  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.917762756347656  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.919374942779541  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.44655370712280273  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.31747817993164  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.319090366363525  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.45348167419433594  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.403219223022461  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.405197620391846  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

number of input  17854546
----------------------------------------after optimizer
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4703054428100586  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7254287600517273
pure train time :  4.545278787612915
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 0.490 seconds, peak memory: 48.167 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.167 GB
Metis partitioning: 2.355 seconds, peak memory: 48.184 GB
Split the graph: 0.657 seconds
Construct subgraphs: 0.042 seconds
metis partition ---------------pure dgl.metis_partition spent  3.544377565383911
8715
8700
8965
8796
9200
8674
9203
8725
9046
8996
9133
9199
8790
9000
9194
8950
9200
8780
8674
9203
8678
8750
metis partition time  3.5483973026275635
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.013427257537841797
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.569159507751465
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  8.152226209640503
self.buckets_partition() spend  sec:  3.582646369934082
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.3408350944519043  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.247875690460205  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.244361877441406  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.33963775634765625  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.17345905303955  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.175532817840576  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.3531951904296875  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.61311960220337  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.61542797088623  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.35305070877075195  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.305879592895508  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.307581901550293  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.3651590347290039  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.828418254852295  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.830277442932129  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.36128759384155273  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.163525581359863  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.16537618637085  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.3781886100769043  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.840922355651855  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.84261417388916  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.37497758865356445  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.291285514831543  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.293376445770264  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.38729238510131836  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.715696334838867  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.717311382293701  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.39028406143188477  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.617757320404053  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.619341850280762  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.39927005767822266  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.853824615478516  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.855469226837158  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4061775207519531  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.885383605957031  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.887239933013916  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.40336036682128906  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.379599571228027  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.381252765655518  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.41269779205322266  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.632672786712646  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.63427734375  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4218459129333496  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.890713691711426  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.892589092254639  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4250907897949219  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.63307523727417  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.634651184082031  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.43294715881347656  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.894452095031738  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.89636754989624  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4313831329345703  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.422705173492432  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.424727439880371  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4347653388977051  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.274611949920654  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.276598453521729  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4511113166809082  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.954919338226318  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.956632614135742  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4444451332092285  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.310757637023926  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.312835216522217  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4522275924682617  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.386429786682129  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.388408184051514  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

number of input  17859757
----------------------------------------after optimizer
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4693279266357422  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7023205757141113
pure train time :  4.68626856803894
the output layer 
self.num_batch (get_in_degree_bucketing) 22
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  22
Convert a graph into a bidirected graph: 0.447 seconds, peak memory: 48.227 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.227 GB
Metis partitioning: 2.305 seconds, peak memory: 48.227 GB
Split the graph: 0.535 seconds
Construct subgraphs: 0.035 seconds
metis partition ---------------pure dgl.metis_partition spent  3.3240463733673096
8715
8700
8965
8796
9200
8674
9203
8725
9046
8996
9133
9199
8790
9000
9194
8950
9200
8780
8674
9203
8678
8750
metis partition time  3.3276548385620117
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009659767150878906
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  3.3470325469970703
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  7.563209295272827
self.buckets_partition() spend  sec:  3.35674786567688
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.3387947082519531  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.232193946838379  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.228723049163818  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.34160804748535156  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.22879409790039  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.230463981628418  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.3499321937561035  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.477465629577637  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.479114055633545  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.35279035568237305  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.328905582427979  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.330477714538574  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.3657493591308594  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.858821392059326  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.86057186126709  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.36165428161621094  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.194252967834473  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.19594144821167  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.3759613037109375  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.794117450714111  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.79588794708252  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.3729267120361328  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.24089241027832  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.242679595947266  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.3847975730895996  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.694068431854248  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.696113586425781  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.3917670249938965  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.661628246307373  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.66325569152832  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.398470401763916  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.794053077697754  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.795680522918701  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.405853271484375  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.874366283416748  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.87610673904419  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  12
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4035515785217285  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.388147354125977  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.390114307403564  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  13
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.41535425186157227  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.6881103515625  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.68968677520752  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  14
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.42173004150390625  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.888335704803467  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.890156269073486  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  15
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.42499780654907227  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.619935512542725  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.621623992919922  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  16
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4329371452331543  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.898962020874023  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.90088701248169  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  17
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4313678741455078  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.382953643798828  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.38491678237915  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  18
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.43612241744995117  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.327941417694092  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.32972002029419  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  19
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.44991397857666016  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.877654075622559  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.879608154296875  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  20
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4478130340576172  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.350780010223389  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 12.352484703063965  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

step  21
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97216796875 GB
    Memory Allocated: 0.4514904022216797  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 23.97412109375 GB
    Memory Allocated: 12.359171867370605  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 23.97412109375 GB
    Memory Allocated: 12.361215114593506  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

number of input  17854499
----------------------------------------after optimizer
 Nvidia-smi: 23.97412109375 GB
    Memory Allocated: 0.4688272476196289  GigaBytes
Max Memory Allocated: 13.194433212280273  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6705588102340698
pure train time :  4.769820213317871
epoch_time_list  [30.392202138900757, 29.061830282211304, 32.23606777191162, 30.83169198036194, 28.315833806991577, 27.616981983184814, 27.801101684570312, 27.705150365829468, 27.7227942943573, 26.77770447731018, 27.727104902267456, 27.623382329940796, 28.117961883544922, 27.488329648971558, 30.351831912994385, 30.364200830459595, 32.11482310295105, 30.159635066986084, 31.63290762901306, 28.451404571533203]

loading_time list   [0.5413393974304199, 0.607649564743042, 0.6136269569396973, 0.5157122611999512, 0.4690883159637451, 0.452272891998291, 0.49512791633605957, 0.39229393005371094, 0.5063199996948242, 0.4687614440917969, 0.49689388275146484, 0.42008018493652344, 0.4579799175262451, 0.43409299850463867, 0.3261690139770508, 0.5003917217254639, 0.6614861488342285, 0.4286036491394043, 0.514937162399292, 0.5030369758605957]

 data loader gen time  19.752464771270752
	---backpack schedule time  [7.90592360496521, 7.24410605430603, 7.95431923866272, 7.676727056503296, 7.5169408321380615, 7.451732158660889, 7.540194511413574, 8.240423202514648, 7.542461395263672, 6.985016584396362, 7.282548189163208, 7.706334114074707, 7.397967576980591, 7.173571825027466, 7.593918561935425, 7.2385170459747314, 8.169486999511719, 7.359397649765015, 8.215266227722168, 7.621006011962891]
	---connection_check_time_list  [7.1768577098846436, 7.5063157081604, 9.82800579071045, 9.390474796295166, 7.512893438339233, 6.80830454826355, 6.8595967292785645, 6.2732250690460205, 6.741286039352417, 6.423393249511719, 6.763758182525635, 6.431995391845703, 7.030346870422363, 6.446768522262573, 8.650699377059937, 9.298513889312744, 9.649627685546875, 8.624010562896729, 9.361708402633667, 6.853827714920044]
	---block_gen_time_list  [4.468689680099487, 4.330232858657837, 4.558909177780151, 4.307283163070679, 4.190036296844482, 4.10870623588562, 4.192252159118652, 4.112858295440674, 4.223831415176392, 4.195143699645996, 4.463533878326416, 4.386333227157593, 4.541301965713501, 4.368520021438599, 4.891685485839844, 4.652096509933472, 4.569957971572876, 4.613354921340942, 4.884260177612305, 4.632934093475342]
training time  [9.685912132263184, 8.732496500015259, 8.609907627105713, 8.289688110351562, 7.995577812194824, 8.171236515045166, 8.091626405715942, 8.067607879638672, 8.07669448852539, 8.085329055786133, 8.081984281539917, 8.058701515197754, 8.058103322982788, 8.450319290161133, 8.15575385093689, 8.019775390625, 8.36160159111023, 8.50796890258789, 7.9823338985443115, 8.150207281112671]
---feature block loading time  [4.192323684692383, 3.8633651733398438, 4.032075643539429, 3.8346400260925293, 3.76690673828125, 3.9430298805236816, 3.8614983558654785, 3.8213613033294678, 3.8469533920288086, 3.8540589809417725, 3.8573267459869385, 3.8295981884002686, 3.8013036251068115, 3.8790760040283203, 3.464355230331421, 3.2832579612731934, 3.8188042640686035, 3.87442684173584, 3.195164680480957, 3.278907537460327]


epoch_time avg   28.74819678068161
loading_time avg   0.47047100961208344
 data loader gen time avg 20.10208062827587
	---backpack schedule time avg 7.56467393040657
	---connection_check_time avg  7.483122229576111
	---block_gen_time avg  4.439175397157669
training time  8.144676342606544
---feature block loading time  3.7110018581151962
pure train time per /epoch  [5.469909906387329, 4.770061492919922, 4.4890031814575195, 4.367109775543213, 4.143428087234497, 4.145544052124023, 4.1462790966033936, 4.161462783813477, 4.146023273468018, 4.146068334579468, 4.141020774841309, 4.146937370300293, 4.174858808517456, 4.486880302429199, 4.592716932296753, 4.638675689697266, 4.452175617218018, 4.545278787612915, 4.68626856803894, 4.769820213317871]
pure train time average  4.346502851037418
num_input list  [17868596, 17854472, 17861221, 17861355, 17865522, 17866952, 17867579, 17860468, 17856502, 17863374, 17858188, 17861623, 17869806, 17863221, 17867026, 17849188, 17865772, 17854546, 17859757, 17854499]
num_input  average  17861483.35
