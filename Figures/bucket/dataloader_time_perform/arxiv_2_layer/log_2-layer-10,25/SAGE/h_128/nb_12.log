main start at this time 1712952989.066941
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.12072229385375977
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0004169940948486328
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01014089584350586
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.12139081954956055
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.2654199600219727
self.buckets_partition() spend  sec:  0.1315474510192871
dataloader gen time  14.191268682479858
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.95458984375 GB
    Memory Allocated: 0.4165821075439453  GigaBytes
Max Memory Allocated: 0.4165821075439453  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.45263671875 GB
    Memory Allocated: 20.385798931121826  GigaBytes
Max Memory Allocated: 20.758623600006104  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.45263671875 GB
    Memory Allocated: 20.389248847961426  GigaBytes
Max Memory Allocated: 20.758623600006104  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.46044921875 GB
    Memory Allocated: 0.4506816864013672  GigaBytes
Max Memory Allocated: 20.758623600006104  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.79443359375 GB
    Memory Allocated: 20.789597988128662  GigaBytes
Max Memory Allocated: 21.17128849029541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.79443359375 GB
    Memory Allocated: 20.792917728424072  GigaBytes
Max Memory Allocated: 21.17128849029541  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.79443359375 GB
    Memory Allocated: 0.4604811668395996  GigaBytes
Max Memory Allocated: 21.17128849029541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.89013671875 GB
    Memory Allocated: 20.739628791809082  GigaBytes
Max Memory Allocated: 21.17128849029541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.89013671875 GB
    Memory Allocated: 20.74251890182495  GigaBytes
Max Memory Allocated: 21.17128849029541  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.89013671875 GB
    Memory Allocated: 0.47415924072265625  GigaBytes
Max Memory Allocated: 21.17128849029541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.83906888961792  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.84206485748291  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 0.48458385467529297  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.789631366729736  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.792967319488525  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 0.4914064407348633  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.352560997009277  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.355820178985596  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 0.5087900161743164  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.773303031921387  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.776432991027832  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 0.5185813903808594  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.627299785614014  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.63008975982666  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 0.5288443565368652  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.596970081329346  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.59978199005127  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 0.540651798248291  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.607768535614014  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.61102819442749  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 0.551389217376709  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.5271315574646  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.530334949493408  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 0.5604982376098633  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.478784561157227  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.481863498687744  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 0.5922760963439941  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.205625534057617
pure train time :  5.382134199142456
train time :  8.567248344421387
end to end time :  22.75855565071106
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.12232303619384766
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.00040411949157714844
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010886669158935547
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1228947639465332
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.2307469844818115
self.buckets_partition() spend  sec:  0.13379931449890137
dataloader gen time  13.099597930908203
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 0.4500417709350586  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.4351806640625  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 20.427329540252686  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.90771484375 GB
    Memory Allocated: 0.4553995132446289  GigaBytes
Max Memory Allocated: 21.21929931640625  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.83740234375 GB
    Memory Allocated: 20.838618755340576  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.83740234375 GB
    Memory Allocated: 20.84154748916626  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.83740234375 GB
    Memory Allocated: 0.46466588973999023  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.84326171875 GB
    Memory Allocated: 20.782721042633057  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.84326171875 GB
    Memory Allocated: 20.785611152648926  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.84326171875 GB
    Memory Allocated: 0.47668981552124023  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.762065887451172  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.76533317565918  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.48652076721191406  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.741179943084717  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.744260787963867  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.4957742691040039  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.37718152999878  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.38015079498291  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.5122599601745605  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.778669357299805  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.781604766845703  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.5203089714050293  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.593915939331055  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.5967059135437  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.5334291458129883  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.60325860977173  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.60678482055664  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.5435638427734375  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.570912837982178  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.574360847473145  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.5547552108764648  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.595299243927002  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.59807777404785  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.5628409385681152  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.482381343841553  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.48546028137207  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.5930075645446777  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.479515790939331
pure train time :  2.284454345703125
train time :  5.422256708145142
end to end time :  18.52187967300415
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.1231544017791748
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0006353855133056641
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010443449020385742
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.12392759323120117
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.2415506839752197
self.buckets_partition() spend  sec:  0.13439083099365234
dataloader gen time  13.47781777381897
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.4478745460510254  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.370405673980713  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.36322259902954  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.45376110076904297  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.78788948059082  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.790818214416504  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.46390342712402344  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.781866550445557  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.784756660461426  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.4749317169189453  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.791043758392334  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.794983863830566  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.48644495010375977  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.77800703048706  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.781136989593506  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.4957308769226074  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.400591373443604  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.403695106506348  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.5112795829772949  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.75747537612915  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.760356903076172  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.5217413902282715  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.691093921661377  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.694282054901123  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.5307478904724121  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.553287982940674  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.55656385421753  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.5413036346435547  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.58423137664795  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.587234497070312  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.5497031211853027  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.460366249084473  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.463730812072754  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.5636396408081055  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.507479190826416  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.51057720184326  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.5938911437988281  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7356531620025635
pure train time :  2.21987247467041
train time :  5.562862873077393
end to end time :  19.04072380065918
load pickle file time  0.36574769020080566
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.12293672561645508
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0006148815155029297
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010394811630249023
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.12373828887939453
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.248178482055664
self.buckets_partition() spend  sec:  0.13415265083312988
dataloader gen time  12.810437202453613
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.448458194732666  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.396528244018555  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 20.389248371124268  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 21.86669921875 GB
    Memory Allocated: 0.45378732681274414  GigaBytes
Max Memory Allocated: 21.220460414886475  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.849192142486572  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.852120876312256  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.46234846115112305  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.775023937225342  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.77791404724121  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4757266044616699  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.787426948547363  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.790892124176025  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4872469902038574  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.737164974212646  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.740527629852295  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.49572038650512695  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.405757904052734  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.409177780151367  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5099592208862305  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.77610206604004  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.779765605926514  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5186786651611328  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.59833860397339  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.601370811462402  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5291242599487305  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.626524448394775  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.6293044090271  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5404262542724609  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.639058113098145  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.641838550567627  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5514912605285645  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.568440437316895  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.57166814804077  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5601620674133301  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.462793827056885  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.465728759765625  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5917997360229492  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.2394189834594727
pure train time :  2.213376760482788
train time :  5.282134532928467
end to end time :  18.09259271621704
end to end time  18.58717131614685
load pickle file time  0.4751620292663574
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.12451457977294922
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0005462169647216797
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.016373872756958008
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1252126693725586
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.299281120300293
self.buckets_partition() spend  sec:  0.1416161060333252
dataloader gen time  13.584389448165894
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4508094787597656  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.41347885131836  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.40421152114868  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.45214033126831055  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.74729633331299  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.750281810760498  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4647049903869629  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.823573112487793  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.827045440673828  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.47635316848754883  GigaBytes
Max Memory Allocated: 21.230988025665283  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.880231380462646  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.88330316543579  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.48668718338012695  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.787195682525635  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.790164947509766  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4927964210510254  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.357839107513428  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.361024379730225  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5062422752380371  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.703880786895752  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.706762313842773  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5182051658630371  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.64281177520752  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.646098136901855  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5266819000244141  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.552222728729248  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.555448055267334  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5396490097045898  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.582660675048828  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.585439682006836  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5505590438842773  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.585575103759766  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.588843822479248  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5601282119750977  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.505774974822998  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.508853912353516  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.591914176940918  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.7798713445663452
pure train time :  2.2474324703216553
train time :  5.81713604927063
end to end time :  19.401561975479126
end to end time  20.004659175872803
load pickle file time  0.5327613353729248
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.12540245056152344
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0010116100311279297
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011620521545410156
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1266176700592041
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.23732328414917
self.buckets_partition() spend  sec:  0.13826513290405273
dataloader gen time  13.804018497467041
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4515218734741211  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.439335346221924  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.430662155151367  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.45185136795043945  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.744986534118652  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.74809980392456  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4663887023925781  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.777653217315674  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.780855655670166  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.47844934463500977  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.829397678375244  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.832393646240234  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4904952049255371  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.79601287841797  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.79900884628296  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4974784851074219  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.354933261871338  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.358227729797363  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5120368003845215  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.77556085586548  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.77855682373047  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5218582153320312  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.611058712005615  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.614078998565674  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5313830375671387  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.54309892654419  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.545902729034424  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5439419746398926  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.60973596572876  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.612762451171875  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5558605194091797  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.57227611541748  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.57527208328247  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5650439262390137  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.518189430236816  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.521178722381592  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5956144332885742  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.551328420639038
pure train time :  2.2201428413391113
train time :  5.481162786483765
end to end time :  19.28520441055298
end to end time  19.94571876525879
load pickle file time  0.5017719268798828
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.30220627784729004
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0005736351013183594
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011471033096313477
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.30295395851135254
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.4199724197387695
self.buckets_partition() spend  sec:  0.3144524097442627
dataloader gen time  13.279020309448242
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4490199089050293  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.421329498291016  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.413687705993652  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.45433568954467773  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.799428939819336  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.80292844772339  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.46329402923583984  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.72702980041504  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.730520248413086  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.475649356842041  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.786800384521484  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.78988742828369  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.48954057693481445  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.74768352508545  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.75065279006958  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4965205192565918  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.381790161132812  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.385457038879395  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5132713317871094  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.82953977584839  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.83242130279541  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5213747024536133  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.64738893508911  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.650410175323486  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5331935882568359  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.64569854736328  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.648571968078613  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5427036285400391  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.577253341674805  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.580710887908936  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.554689884185791  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.558388710021973  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.56116819381714  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5640358924865723  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.500518798828125  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.503714084625244  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5944762229919434  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.3980488777160645
pure train time :  2.241828203201294
train time :  5.58089542388916
end to end time :  18.859944105148315
end to end time  19.490710020065308
load pickle file time  0.5126590728759766
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.12385392189025879
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0006253719329833984
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011835336685180664
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1246488094329834
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.289064645767212
self.buckets_partition() spend  sec:  0.13650250434875488
dataloader gen time  13.504272937774658
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4477853775024414  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.37330389022827  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.3658709526062  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.452573299407959  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.800649166107178  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.80357789993286  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4642462730407715  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.7806077003479  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.783881187438965  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4755516052246094  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.731749534606934  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.73549795150757  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.48775768280029297  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.797974109649658  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.80094337463379  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4957261085510254  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.427786827087402  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.430712699890137  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5095005035400391  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.703526973724365  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.706408500671387  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5207409858703613  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.634361267089844  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.63776397705078  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.531524658203125  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.655742645263672  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.658522605895996  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5406942367553711  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.558448791503906  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.561227798461914  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5539059638977051  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.561850547790527  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.565030574798584  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5639629364013672  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.520293712615967  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.523372650146484  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5946416854858398  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.2745330333709717
pure train time :  2.2244009971618652
train time :  5.837904453277588
end to end time :  19.342212200164795
end to end time  19.983369827270508
load pickle file time  0.5071518421173096
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.1243581771850586
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0007498264312744141
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011566638946533203
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1255183219909668
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.256150007247925
self.buckets_partition() spend  sec:  0.13710451126098633
dataloader gen time  13.275317192077637
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4473261833190918  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.372828006744385  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.364731311798096  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4524097442626953  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.79795742034912  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.800944328308105  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.46411561965942383  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.770565509796143  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.77345561981201  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4765291213989258  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.817633628845215  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.82079267501831  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.48821258544921875  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.786839485168457  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.79029941558838  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4974327087402344  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.42858123779297  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.4317626953125  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5113463401794434  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.77290630340576  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.775787830352783  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5204939842224121  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.638078212738037  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.640868186950684  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.531745433807373  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.60228157043457  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.605061531066895  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5415034294128418  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.53296709060669  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.535964012145996  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5536274909973145  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.55097723007202  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.554245948791504  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5644407272338867  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.46976947784424  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.473122596740723  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5951528549194336  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.1778677701950073
pure train time :  2.2173802852630615
train time :  5.4203736782073975
end to end time :  18.695744276046753
end to end time  19.33093547821045
load pickle file time  0.42689061164855957
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.12445354461669922
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.000982046127319336
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011427879333496094
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.12560057640075684
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.28725004196167
self.buckets_partition() spend  sec:  0.13704657554626465
dataloader gen time  12.921809434890747
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.44929981231689453  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.364276885986328  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.35598611831665  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.45536231994628906  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.79363489151001  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.797033309936523  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.46614980697631836  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.772289276123047  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.775365829467773  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4778304100036621  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.77160882949829  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.774680614471436  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.48851871490478516  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.78181266784668  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.78480863571167  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.49750852584838867  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.37691831588745  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.38008451461792  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5139079093933105  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.77664279937744  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.77967882156372  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5227255821228027  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.680914402008057  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.683704376220703  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5340971946716309  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.663578510284424  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.666358470916748  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5445985794067383  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.518587112426758  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.521625518798828  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5565009117126465  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.568800449371338  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.571578979492188  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5660467147827148  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.47694444656372  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.480224609375  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5960540771484375  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0830810070037842
pure train time :  2.2152798175811768
train time :  5.410255670547485
end to end time :  18.33208727836609
end to end time  18.88825750350952
load pickle file time  0.41467976570129395
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.13461852073669434
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0005674362182617188
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010898590087890625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.13534092903137207
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.28317928314209
self.buckets_partition() spend  sec:  0.14625883102416992
dataloader gen time  13.290684700012207
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4495863914489746  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.37311553955078  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.36534595489502  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4530820846557617  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.777143478393555  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.780998706817627  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4669198989868164  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.834532737731934  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.837422847747803  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.47860288619995117  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.788601398468018  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.792007446289062  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4869694709777832  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.75439739227295  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.757532119750977  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4955883026123047  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.394818782806396  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.39784002304077  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5132560729980469  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.7668137550354  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.770103931427002  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5238003730773926  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.665053844451904  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.668550491333008  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5351724624633789  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.649246215820312  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.65214204788208  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5432772636413574  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.52371644973755  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.526662349700928  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5538101196289062  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.520190715789795  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.5231351852417  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5654683113098145  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.507777214050293  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.5106258392334  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5957956314086914  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 1.0052510499954224
pure train time :  2.219118595123291
train time :  5.47163987159729
end to end time :  18.76235008239746
end to end time  19.299903631210327
load pickle file time  0.3694581985473633
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.12597966194152832
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0008385181427001953
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.012080192565917969
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.12700486183166504
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.267707586288452
self.buckets_partition() spend  sec:  0.13910436630249023
dataloader gen time  12.65031099319458
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.450225830078125  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.428723335266113  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.421656608581543  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4528059959411621  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.743768215179443  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.747246742248535  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4658689498901367  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.776915550231934  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.779805660247803  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.47689390182495117  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.78936529159546  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.792570114135742  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4880952835083008  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.77773904800415  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.78082799911499  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4953899383544922  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.372596263885498  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.375722408294678  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5120368003845215  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.777841091156006  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.780722618103027  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5197148323059082  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.5769681930542  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.58004665374756  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5329012870788574  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.612287044525146  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.61577272415161  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5463271141052246  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.631464958190918  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.634347915649414  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.554741382598877  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.581632137298584  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.584411144256592  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.564511775970459  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.552534580230713  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.555438995361328  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5952639579772949  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.957871675491333
pure train time :  2.2378668785095215
train time :  5.426227331161499
end to end time :  18.07655954360962
end to end time  18.57558512687683
load pickle file time  0.4589364528656006
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.12473154067993164
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.000576019287109375
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010312080383300781
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.12545061111450195
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.2802340984344482
self.buckets_partition() spend  sec:  0.13578414916992188
dataloader gen time  13.109678030014038
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4491739273071289  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.385244846343994  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.377081394195557  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4533224105834961  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.804668426513672  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.807597160339355  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4643702507019043  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.778183460235596  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.781073570251465  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4741182327270508  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.772773265838623  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.776005268096924  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4855213165283203  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.751888751983643  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.754884719848633  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.49330854415893555  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.355278491973877  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.358444690704346  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.509127140045166  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.779523372650146  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.782687664031982  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5174617767333984  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.587234497070312  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.590271949768066  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.526860237121582  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.557359218597412  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.560543537139893  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5397648811340332  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.572754859924316  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.575533866882324  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5513882637023926  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.584094524383545  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.586873054504395  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5631198883056641  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.562062740325928  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.5648455619812  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5937967300415039  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.912896990776062
pure train time :  2.2168707847595215
train time :  5.354168891906738
end to end time :  18.46387028694153
end to end time  19.052516222000122
load pickle file time  0.35527658462524414
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.12442660331726074
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0004558563232421875
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011067867279052734
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.12502360343933105
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.2662177085876465
self.buckets_partition() spend  sec:  0.13611054420471191
dataloader gen time  12.92120099067688
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4498319625854492  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.420310974121094  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.411621570587158  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4547762870788574  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.79329013824463  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.796218872070312  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.46576690673828125  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.727291107177734  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.730231285095215  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.47754526138305664  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.797245025634766  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.800450325012207  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.48807191848754883  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.788217067718506  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.791186332702637  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4971585273742676  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.391226768493652  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.394507884979248  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5094151496887207  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.683624267578125  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.68677806854248  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5210576057434082  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.64869785308838  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.652215480804443  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5332846641540527  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.604544639587402  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.607473373413086  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5409793853759766  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.584580421447754  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.58735942840576  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5514397621154785  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.571308135986328  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.574586391448975  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5610213279724121  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.487154960632324  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.48997449874878  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5923285484313965  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8743821978569031
pure train time :  2.220590591430664
train time :  5.433030605316162
end to end time :  18.354268550872803
end to end time  18.83791446685791
load pickle file time  0.3152291774749756
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.11591887474060059
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0004436969757080078
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010629415512084961
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.11651110649108887
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.246273994445801
self.buckets_partition() spend  sec:  0.12716054916381836
dataloader gen time  12.430224657058716
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.44982194900512695  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.36429500579834  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.356563568115234  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.45548152923583984  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.80764865875244  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.811224937438965  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4651222229003906  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.729924201965332  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.73349952697754  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.47739696502685547  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.74605894088745  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.74905490875244  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4889073371887207  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.7900447845459  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.79301404953003  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4974689483642578  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.404534816741943  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.40800952911377  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5123486518859863  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.819717407226562  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.822962284088135  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5199451446533203  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.565635681152344  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.568625926971436  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5320024490356445  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.591023921966553  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.593972206115723  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5429091453552246  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.610915184020996  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.614266872406006  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.552131175994873  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.512470722198486  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.515515327453613  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5626115798950195  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.50071144104004  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.503824710845947  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5930395126342773  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.8384539484977722
pure train time :  2.2235586643218994
train time :  5.376514196395874
end to end time :  17.806761264801025
end to end time  18.25114893913269
load pickle file time  0.22786641120910645
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.12485480308532715
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0004868507385253906
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010393142700195312
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.1255178451538086
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.260239362716675
self.buckets_partition() spend  sec:  0.13594698905944824
dataloader gen time  12.459675550460815
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.44802045822143555  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.38123846054077  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.374263763427734  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.45316648483276367  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.752984523773193  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.755913257598877  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4643092155456543  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.787938594818115  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.791162967681885  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.47676753997802734  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.79549789428711  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.7984938621521  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4897794723510742  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.841668128967285  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.84514284133911  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4955739974975586  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.386048316955566  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.38938617706299  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.509091854095459  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.73397970199585  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.73746395111084  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5202999114990234  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.601670265197754  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.60499095916748  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5305886268615723  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.607165336608887  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.61068820953369  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5418705940246582  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.58387517929077  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.58718729019165  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.551506519317627  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.554550647735596  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.557641983032227  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5616350173950195  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.48305654525757  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.485839366912842  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.5922117233276367  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7990452647209167
pure train time :  2.222555637359619
train time :  5.455059051513672
end to end time :  17.914993047714233
end to end time  18.27168917655945
load pickle file time  0.3876943588256836
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.12473320960998535
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0006442070007324219
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009695291519165039
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.12554407119750977
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.2705905437469482
self.buckets_partition() spend  sec:  0.13525867462158203
dataloader gen time  12.582744121551514
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.4494962692260742  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.417312145233154  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.409583568572998  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.45510053634643555  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.786209106445312  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.789137840270996  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.46603822708129883  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.827136516571045  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 20.830334186553955  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98583984375 GB
    Memory Allocated: 0.47719383239746094  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.769865036010742  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.772861003875732  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.4890718460083008  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.79959487915039  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.8028621673584  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.49813270568847656  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.368521213531494  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.372331619262695  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5130777359008789  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.777734756469727  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.780788898468018  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5232510566711426  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.645269870758057  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.648059844970703  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5328140258789062  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.575420379638672  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.57912588119507  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5431547164916992  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.5926513671875  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.595935344696045  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5537118911743164  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.529232501983643  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.532167434692383  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5632977485656738  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.473231315612793  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.476503372192383  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5935459136962891  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7652651071548462
pure train time :  2.226435899734497
train time :  5.46274995803833
end to end time :  18.045520305633545
end to end time  18.56194758415222
load pickle file time  0.35383057594299316
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.12403011322021484
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0006103515625
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011941909790039062
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.12477993965148926
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.260512351989746
self.buckets_partition() spend  sec:  0.13674068450927734
dataloader gen time  12.730109930038452
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.4493594169616699  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.40388584136963  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.396096229553223  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.45424747467041016  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.798171997070312  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.80165195465088  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.46468257904052734  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.79456329345703  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.7974534034729  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.47693347930908203  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.79176902770996  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.79515504837036  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.4884305000305176  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.800550937652588  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.80352020263672  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.4943523406982422  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.373009204864502  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.376195430755615  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.509434700012207  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.744499683380127  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.748180389404297  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5206027030944824  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.625868797302246  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.62941265106201  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5322146415710449  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.600695610046387  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.60347557067871  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5418682098388672  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.547409057617188  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.550211429595947  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5510883331298828  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.526914596557617  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.529716968536377  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5624117851257324  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.484554290771484  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.487488269805908  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.593172550201416  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7288459539413452
pure train time :  2.222341537475586
train time :  5.51588773727417
end to end time :  18.246017932891846
end to end time  18.729023218154907
load pickle file time  0.4263482093811035
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.12442445755004883
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.00044417381286621094
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.011873245239257812
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.12501859664916992
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.2602787017822266
self.buckets_partition() spend  sec:  0.13691091537475586
dataloader gen time  12.852932453155518
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.4487338066101074  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.38424825668335  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.37641716003418  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.45423364639282227  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.755334854125977  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.75838804244995  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.4662299156188965  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.77610206604004  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.778992176055908  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.47713470458984375  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.75133991241455  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.75433588027954  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.4885540008544922  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.833598136901855  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.837162494659424  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.4976968765258789  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.45811176300049  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.461330890655518  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5085077285766602  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.69913625717163  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.70213222503662  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5187187194824219  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.63918113708496  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.642695903778076  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5301351547241211  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.60300922393799  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.606501579284668  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5413479804992676  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.57121181488037  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.574424266815186  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5516300201416016  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.505229949951172  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.508225917816162  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5618810653686523  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.458662033081055  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.462061882019043  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5932683944702148  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.7059352993965149
pure train time :  2.22796893119812
train time :  5.412540912628174
end to end time :  18.26549196243286
end to end time  18.819618463516235
load pickle file time  0.3754556179046631
generate_dataloader_bucket_block=======
the output layer 
self.num_batch (get_in_degree_bucketing) 12
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  12
type of fanout_dst_nids  <class 'torch.Tensor'>
sum(estimated_mem)
27.023624836713726
24
the last batch value is  1464
G_BUCKET_ID_list [[11, 3, 2], [19, 13, 0], [23, 8], [14, 9, 7], [17, 10, 4], [6, 5, 1], [16, 12], [22], [21], [20], [18], [15]]
G_BUCKET_ID_list length 12
backpack scheduling spend  0.1238868236541748
len(g_bucket_nids_list)  12
len(local_split_batches_nid_list)  12
current group_mem  1.403347350375729
current group_mem  3.001967961271789
current group_mem  3.0000069573568977
current group_mem  3.0006915325832333
current group_mem  2.9975327611562568
current group_mem  1.0749997896799088
current group_mem  2.939728300182595
current group_mem  2.232189497508864
current group_mem  2.1946883605045633
current group_mem  1.920127067184496
current group_mem  1.793769060001223
current group_mem  1.4645761989081698
batches output list generation spend  0.0005245208740234375
self.weights_list  [0.08493114447197196, 0.08506849942260049, 0.08395439815639133, 0.0870270792741554, 0.08625382177432073, 0.0849972783370894, 0.08370003713670887, 0.08103942087083038, 0.08075453652878603, 0.08072401320642414, 0.08071383876563684, 0.08083593205508442]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010833501815795898
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.12457513809204102
num_output  196571
self.output_nids  196571
output nodes length match
global output equals  True
partition total batch output list spend :  2.268742799758911
self.buckets_partition() spend  sec:  0.13542771339416504
dataloader gen time  12.770983934402466
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.44977474212646484  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.41401767730713  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.405009269714355  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.45394134521484375  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.83863353729248  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.841562271118164  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.46214866638183594  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.77240800857544  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.77529811859131  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.4755697250366211  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.790404319763184  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.79353380203247  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.4868803024291992  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.789888381958008  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.793084621429443  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.49449920654296875  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.31791591644287  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.320841789245605  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5114126205444336  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.735379219055176  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.738690853118896  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5212521553039551  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.643004894256592  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.646624088287354  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5315628051757812  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.557443618774414  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.56022357940674  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5428423881530762  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.61551332473755  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.618900775909424  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5526566505432129  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.568445682525635  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.571788787841797  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

step  11
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.563413143157959  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.458741188049316  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 20.46153497695923  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 22.98779296875 GB
    Memory Allocated: 0.5925073623657227  GigaBytes
Max Memory Allocated: 21.2604022026062  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 0.6743476390838623
pure train time :  2.220588207244873
train time :  5.458064556121826
end to end time :  18.229077339172363
end to end time  18.73326277732849
Total (block generation + training)time/epoch 18.916134459631785
Total (block generation + training)time/epoch all [18.58717131614685, 20.004659175872803, 19.94571876525879, 19.490710020065308, 19.983369827270508, 19.33093547821045, 18.88825750350952, 19.299903631210327, 18.57558512687683, 19.052516222000122, 18.83791446685791, 18.25114893913269, 18.27168917655945, 18.56194758415222, 18.729023218154907, 18.819618463516235, 18.73326277732849]
pure train time per /epoch  [5.382134199142456, 2.284454345703125, 2.21987247467041, 2.213376760482788, 2.2474324703216553, 2.2201428413391113, 2.241828203201294, 2.2244009971618652, 2.2173802852630615, 2.2152798175811768, 2.219118595123291, 2.2378668785095215, 2.2168707847595215, 2.220590591430664, 2.2235586643218994, 2.222555637359619, 2.226435899734497, 2.222341537475586, 2.22796893119812, 2.220588207244873]
pure train time average  2.2245727707357967
dataloader time  [12.810437202453613, 13.584389448165894, 13.804018497467041, 13.279020309448242, 13.504272937774658, 13.275317192077637, 12.921809434890747, 13.290684700012207, 12.65031099319458, 13.109678030014038, 12.92120099067688, 12.430224657058716, 12.459675550460815, 12.582744121551514, 12.730109930038452, 12.852932453155518, 12.770983934402466]
dataloader time avg per epoch 12.884611148100634

input num list  [12586103, 12583576, 12580756, 12586729, 12584981, 12579751, 12588539, 12583005, 12582038, 12580723, 12582939, 12587416, 12581294, 12581591, 12579357, 12578742, 12581715, 12579822, 12581170, 12572220]
      backpack schedule time  [2.333822011947632, 2.298086643218994, 2.3043813705444336, 2.3212780952453613, 2.366490125656128, 2.3027796745300293, 2.4881038665771484, 2.3601531982421875, 2.3198461532592773, 2.3474576473236084, 2.34991455078125, 2.329153537750244, 2.34637188911438, 2.323948860168457, 2.3068113327026367, 2.3122222423553467, 2.3439626693725586, 2.319387197494507, 2.321406841278076, 2.3271901607513428]
------backpack schedule time avg 2.3415749967098236
		connection_check_time_list  [7.159987688064575, 6.096908807754517, 6.658994436264038, 6.154088497161865, 6.8730785846710205, 7.083161115646362, 6.368842601776123, 6.666967868804932, 6.628608703613281, 6.189210653305054, 6.658968925476074, 6.035859107971191, 6.433345556259155, 6.362289667129517, 6.021689176559448, 5.991592168807983, 6.0213963985443115, 6.121718883514404, 6.366427421569824, 6.269439697265625]
------connection check time avg 6.380787283182144
		block_gen_time_list  [4.089030981063843, 4.070381164550781, 3.9091968536376953, 3.7640914916992188, 3.745314598083496, 3.8208227157592773, 3.8270349502563477, 3.8459625244140625, 3.7355146408081055, 3.7950539588928223, 3.7181520462036133, 3.708042621612549, 3.748220920562744, 3.6625542640686035, 3.541347026824951, 3.587860107421875, 3.651069164276123, 3.7148585319519043, 3.6005098819732666, 3.6036126613616943]
------block gen time avg 3.7066206634044647
